import{c as Ze,g as Ea,a as Sp,p as rf}from"./p5-1003a71f.js";import{r as _s,H as xp,e as Op,A as mp,O as Ws,l as wp,n as Ep}from"./index-27e8f055.js";function Kt(t){return Kt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kt(t)}function ee(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var zs=Object.prototype.toString,nf=function(e){var r=zs.call(e),n=r==="[object Arguments]";return n||(n=r!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&zs.call(e.callee)==="[object Function]"),n},Aa,As;function Dp(){if(As)return Aa;As=1;var t;if(!Object.keys){var e=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=nf,a=Object.prototype.propertyIsEnumerable,i=!a.call({toString:null},"toString"),s=a.call(function(){},"prototype"),o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],u=function(v){var p=v.constructor;return p&&p.prototype===v},c={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if(typeof window>"u")return!1;for(var v in window)try{if(!c["$"+v]&&e.call(window,v)&&window[v]!==null&&typeof window[v]=="object")try{u(window[v])}catch{return!0}}catch{return!0}return!1}(),g=function(v){if(typeof window>"u"||!f)return u(v);try{return u(v)}catch{return!1}};t=function(p){var l=p!==null&&typeof p=="object",y=r.call(p)==="[object Function]",h=n(p),d=l&&r.call(p)==="[object String]",S=[];if(!l&&!y&&!h)throw new TypeError("Object.keys called on a non-object");var T=s&&y;if(d&&p.length>0&&!e.call(p,0))for(var C=0;C<p.length;++C)S.push(String(C));if(h&&p.length>0)for(var x=0;x<p.length;++x)S.push(String(x));else for(var O in p)!(T&&O==="prototype")&&e.call(p,O)&&S.push(String(O));if(i)for(var w=g(p),E=0;E<o.length;++E)!(w&&o[E]==="constructor")&&e.call(p,o[E])&&S.push(o[E]);return S}}return Aa=t,Aa}var Mp=Array.prototype.slice,Vp=nf,Hs=Object.keys,Zn=Hs?function(e){return Hs(e)}:Dp(),$s=Object.keys;Zn.shim=function(){if(Object.keys){var e=function(){var r=Object.keys(arguments);return r&&r.length===arguments.length}(1,2);e||(Object.keys=function(n){return Vp(n)?$s(Mp.call(n)):$s(n)})}else Object.keys=Zn;return Object.keys||Zn};var Rp=Zn,bp=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var a=42;e[r]=a;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var i=Object.getOwnPropertySymbols(e);if(i.length!==1||i[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,r);if(s.value!==a||s.enumerable!==!0)return!1}return!0},Ps=typeof Symbol<"u"&&Symbol,Lp=bp,Bp=function(){return typeof Ps!="function"||typeof Symbol!="function"||typeof Ps("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Lp()},kp="Function.prototype.bind called on incompatible ",Ha=Array.prototype.slice,Np=Object.prototype.toString,Fp="[object Function]",Up=function(e){var r=this;if(typeof r!="function"||Np.call(r)!==Fp)throw new TypeError(kp+r);for(var n=Ha.call(arguments,1),a,i=function(){if(this instanceof a){var f=r.apply(this,n.concat(Ha.call(arguments)));return Object(f)===f?f:this}else return r.apply(e,n.concat(Ha.call(arguments)))},s=Math.max(0,r.length-n.length),o=[],u=0;u<s;u++)o.push("$"+u);if(a=Function("binder","return function ("+o.join(",")+"){ return binder.apply(this,arguments); }")(i),r.prototype){var c=function(){};c.prototype=r.prototype,a.prototype=new c,c.prototype=null}return a},Gp=Up,af=Function.prototype.bind||Gp,_p=af,Wp=_p.call(Function.call,Object.prototype.hasOwnProperty),ne,Ur=SyntaxError,sf=Function,Nr=TypeError,$a=function(t){try{return sf('"use strict"; return ('+t+").constructor;")()}catch{}},vr=Object.getOwnPropertyDescriptor;if(vr)try{vr({},"")}catch{vr=null}var Pa=function(){throw new Nr},zp=vr?function(){try{return arguments.callee,Pa}catch{try{return vr(arguments,"callee").get}catch{return Pa}}}():Pa,xr=Bp(),yt=Object.getPrototypeOf||function(t){return t.__proto__},Rr={},Ap=typeof Uint8Array>"u"?ne:yt(Uint8Array),pr={"%AggregateError%":typeof AggregateError>"u"?ne:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?ne:ArrayBuffer,"%ArrayIteratorPrototype%":xr?yt([][Symbol.iterator]()):ne,"%AsyncFromSyncIteratorPrototype%":ne,"%AsyncFunction%":Rr,"%AsyncGenerator%":Rr,"%AsyncGeneratorFunction%":Rr,"%AsyncIteratorPrototype%":Rr,"%Atomics%":typeof Atomics>"u"?ne:Atomics,"%BigInt%":typeof BigInt>"u"?ne:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?ne:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?ne:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?ne:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?ne:Float32Array,"%Float64Array%":typeof Float64Array>"u"?ne:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?ne:FinalizationRegistry,"%Function%":sf,"%GeneratorFunction%":Rr,"%Int8Array%":typeof Int8Array>"u"?ne:Int8Array,"%Int16Array%":typeof Int16Array>"u"?ne:Int16Array,"%Int32Array%":typeof Int32Array>"u"?ne:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":xr?yt(yt([][Symbol.iterator]())):ne,"%JSON%":typeof JSON=="object"?JSON:ne,"%Map%":typeof Map>"u"?ne:Map,"%MapIteratorPrototype%":typeof Map>"u"||!xr?ne:yt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?ne:Promise,"%Proxy%":typeof Proxy>"u"?ne:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?ne:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?ne:Set,"%SetIteratorPrototype%":typeof Set>"u"||!xr?ne:yt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?ne:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":xr?yt(""[Symbol.iterator]()):ne,"%Symbol%":xr?Symbol:ne,"%SyntaxError%":Ur,"%ThrowTypeError%":zp,"%TypedArray%":Ap,"%TypeError%":Nr,"%Uint8Array%":typeof Uint8Array>"u"?ne:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?ne:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?ne:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?ne:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?ne:WeakMap,"%WeakRef%":typeof WeakRef>"u"?ne:WeakRef,"%WeakSet%":typeof WeakSet>"u"?ne:WeakSet};try{null.error}catch(t){var Hp=yt(yt(t));pr["%Error.prototype%"]=Hp}var $p=function t(e){var r;if(e==="%AsyncFunction%")r=$a("async function () {}");else if(e==="%GeneratorFunction%")r=$a("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=$a("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var a=t("%AsyncGenerator%");a&&(r=yt(a.prototype))}return pr[e]=r,r},js={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},yn=af,aa=Wp,Pp=yn.call(Function.call,Array.prototype.concat),jp=yn.call(Function.apply,Array.prototype.splice),Ks=yn.call(Function.call,String.prototype.replace),ia=yn.call(Function.call,String.prototype.slice),Kp=yn.call(Function.call,RegExp.prototype.exec),Xp=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Yp=/\\(\\)?/g,qp=function(e){var r=ia(e,0,1),n=ia(e,-1);if(r==="%"&&n!=="%")throw new Ur("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new Ur("invalid intrinsic syntax, expected opening `%`");var a=[];return Ks(e,Xp,function(i,s,o,u){a[a.length]=o?Ks(u,Yp,"$1"):s||i}),a},Qp=function(e,r){var n=e,a;if(aa(js,n)&&(a=js[n],n="%"+a[0]+"%"),aa(pr,n)){var i=pr[n];if(i===Rr&&(i=$p(n)),typeof i>"u"&&!r)throw new Nr("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:a,name:n,value:i}}throw new Ur("intrinsic "+e+" does not exist!")},Zp=function(e,r){if(typeof e!="string"||e.length===0)throw new Nr("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Nr('"allowMissing" argument must be a boolean');if(Kp(/^%?[^%]*%?$/,e)===null)throw new Ur("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=qp(e),a=n.length>0?n[0]:"",i=Qp("%"+a+"%",r),s=i.name,o=i.value,u=!1,c=i.alias;c&&(a=c[0],jp(n,Pp([0,1],c)));for(var f=1,g=!0;f<n.length;f+=1){var v=n[f],p=ia(v,0,1),l=ia(v,-1);if((p==='"'||p==="'"||p==="`"||l==='"'||l==="'"||l==="`")&&p!==l)throw new Ur("property names with quotes must have matching quotes");if((v==="constructor"||!g)&&(u=!0),a+="."+v,s="%"+a+"%",aa(pr,s))o=pr[s];else if(o!=null){if(!(v in o)){if(!r)throw new Nr("base intrinsic for "+e+" exists, but the property is not available.");return}if(vr&&f+1>=n.length){var y=vr(o,v);g=!!y,g&&"get"in y&&!("originalValue"in y.get)?o=y.get:o=o[v]}else g=aa(o,v),o=o[v];g&&!u&&(pr[s]=o)}}return o},Ip=Zp,Si=Ip("%Object.defineProperty%",!0),xi=function(){if(Si)try{return Si({},"a",{value:1}),!0}catch{return!1}return!1};xi.hasArrayLengthDefineBug=function(){if(!xi())return null;try{return Si([],"length",{value:1}).length!==1}catch{return!0}};var Jp=xi,el=Rp,tl=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",rl=Object.prototype.toString,nl=Array.prototype.concat,of=Object.defineProperty,al=function(t){return typeof t=="function"&&rl.call(t)==="[object Function]"},il=Jp(),uf=of&&il,sl=function(t,e,r,n){e in t&&(!al(n)||!n())||(uf?of(t,e,{configurable:!0,enumerable:!1,value:r,writable:!0}):t[e]=r)},ff=function(t,e){var r=arguments.length>2?arguments[2]:{},n=el(e);tl&&(n=nl.call(n,Object.getOwnPropertySymbols(e)));for(var a=0;a<n.length;a+=1)sl(t,n[a],e[n[a]],r[n[a]])};ff.supportsDescriptors=!!uf;var cf=ff,In={exports:{}};typeof self<"u"?In.exports=self:typeof window<"u"?In.exports=window:In.exports=Function("return this")();var gf=In.exports,ol=gf,vf=function(){return typeof Ze!="object"||!Ze||Ze.Math!==Math||Ze.Array!==Array?ol:Ze},ul=cf,fl=vf,cl=function(){var e=fl();if(ul.supportsDescriptors){var r=Object.getOwnPropertyDescriptor(e,"globalThis");(!r||r.configurable&&(r.enumerable||!r.writable||globalThis!==e))&&Object.defineProperty(e,"globalThis",{configurable:!0,enumerable:!1,value:e,writable:!0})}else(typeof globalThis!="object"||globalThis!==e)&&(e.globalThis=e);return e},gl=cf,vl=gf,pf=vf,pl=cl,ll=pf(),lf=function(){return ll};gl(lf,{getPolyfill:pf,implementation:vl,shim:pl});var hl=lf;const yl=Ea(hl);function Xs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function dl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Xs(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Xs(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var nt=yl(),hf={vtkObject:function(){return null}};function ot(t){if(t==null||t.isA)return t;if(!t.vtkClass)return nt.console&&nt.console.error&&nt.console.error("Invalid VTK object"),null;var e=hf[t.vtkClass];if(!e)return nt.console&&nt.console.error&&nt.console.error("No vtk class found for Object of type ".concat(t.vtkClass)),null;var r=dl({},t);Object.keys(r).forEach(function(a){r[a]&&Kt(r[a])==="object"&&r[a].vtkClass&&(r[a]=ot(r[a]))});var n=e(r);return n&&n.modified&&n.modified(),n}function Tl(t,e){hf[t]=e}ot.register=Tl;var se=1e-6,Re=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function yf(){var t=new Re(9);return Re!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Ki(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Cl(t){var e=new Re(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Sl(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function xl(t,e,r,n,a,i,s,o,u){var c=new Re(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=n,c[4]=a,c[5]=i,c[6]=s,c[7]=o,c[8]=u,c}function Ol(t,e,r,n,a,i,s,o,u,c){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=s,t[6]=o,t[7]=u,t[8]=c,t}function dr(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function df(t,e){if(t===e){var r=e[1],n=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Xi(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],o=e[5],u=e[6],c=e[7],f=e[8],g=f*s-o*c,v=-f*i+o*u,p=c*i-s*u,l=r*g+n*v+a*p;return l?(l=1/l,t[0]=g*l,t[1]=(-f*n+a*c)*l,t[2]=(o*n-a*s)*l,t[3]=v*l,t[4]=(f*r-a*u)*l,t[5]=(-o*r+a*i)*l,t[6]=p*l,t[7]=(-c*r+n*u)*l,t[8]=(s*r-n*i)*l,t):null}function ml(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],o=e[5],u=e[6],c=e[7],f=e[8];return t[0]=s*f-o*c,t[1]=a*c-n*f,t[2]=n*o-a*s,t[3]=o*u-i*f,t[4]=r*f-a*u,t[5]=a*i-r*o,t[6]=i*c-s*u,t[7]=n*u-r*c,t[8]=r*s-n*i,t}function wl(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],s=t[5],o=t[6],u=t[7],c=t[8];return e*(c*i-s*u)+r*(-c*a+s*o)+n*(u*a-i*o)}function Yi(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],o=e[4],u=e[5],c=e[6],f=e[7],g=e[8],v=r[0],p=r[1],l=r[2],y=r[3],h=r[4],d=r[5],S=r[6],T=r[7],C=r[8];return t[0]=v*n+p*s+l*c,t[1]=v*a+p*o+l*f,t[2]=v*i+p*u+l*g,t[3]=y*n+h*s+d*c,t[4]=y*a+h*o+d*f,t[5]=y*i+h*u+d*g,t[6]=S*n+T*s+C*c,t[7]=S*a+T*o+C*f,t[8]=S*i+T*u+C*g,t}function El(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],o=e[4],u=e[5],c=e[6],f=e[7],g=e[8],v=r[0],p=r[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=s,t[4]=o,t[5]=u,t[6]=v*n+p*s+c,t[7]=v*a+p*o+f,t[8]=v*i+p*u+g,t}function Dl(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],o=e[4],u=e[5],c=e[6],f=e[7],g=e[8],v=Math.sin(r),p=Math.cos(r);return t[0]=p*n+v*s,t[1]=p*a+v*o,t[2]=p*i+v*u,t[3]=p*s-v*n,t[4]=p*o-v*a,t[5]=p*u-v*i,t[6]=c,t[7]=f,t[8]=g,t}function Ml(t,e,r){var n=r[0],a=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Vl(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Rl(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function bl(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Ll(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Bl(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=r+r,o=n+n,u=a+a,c=r*s,f=n*s,g=n*o,v=a*s,p=a*o,l=a*u,y=i*s,h=i*o,d=i*u;return t[0]=1-g-l,t[3]=f-d,t[6]=v+h,t[1]=f+d,t[4]=1-c-l,t[7]=p-y,t[2]=v-h,t[5]=p+y,t[8]=1-c-g,t}function kl(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],o=e[5],u=e[6],c=e[7],f=e[8],g=e[9],v=e[10],p=e[11],l=e[12],y=e[13],h=e[14],d=e[15],S=r*o-n*s,T=r*u-a*s,C=r*c-i*s,x=n*u-a*o,O=n*c-i*o,w=a*c-i*u,E=f*y-g*l,V=f*h-v*l,D=f*d-p*l,M=g*h-v*y,L=g*d-p*y,N=v*d-p*h,B=S*N-T*L+C*M+x*D-O*V+w*E;return B?(B=1/B,t[0]=(o*N-u*L+c*M)*B,t[1]=(u*D-s*N-c*V)*B,t[2]=(s*L-o*D+c*E)*B,t[3]=(a*L-n*N-i*M)*B,t[4]=(r*N-a*D+i*V)*B,t[5]=(n*D-r*L-i*E)*B,t[6]=(y*w-h*O+d*x)*B,t[7]=(h*C-l*w-d*T)*B,t[8]=(l*O-y*C+d*S)*B,t):null}function Nl(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Fl(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Ul(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Gl(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function Tf(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function _l(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function Wl(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t}function zl(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Al(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],s=t[4],o=t[5],u=t[6],c=t[7],f=t[8],g=e[0],v=e[1],p=e[2],l=e[3],y=e[4],h=e[5],d=e[6],S=e[7],T=e[8];return Math.abs(r-g)<=se*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(n-v)<=se*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(a-p)<=se*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(i-l)<=se*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(s-y)<=se*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(o-h)<=se*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(u-d)<=se*Math.max(1,Math.abs(u),Math.abs(d))&&Math.abs(c-S)<=se*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(f-T)<=se*Math.max(1,Math.abs(f),Math.abs(T))}var Hl=Yi,$l=Tf;const Pl=Object.freeze(Object.defineProperty({__proto__:null,add:Gl,adjoint:ml,clone:Cl,copy:Sl,create:yf,determinant:wl,equals:Al,exactEquals:zl,frob:Ul,fromMat2d:Ll,fromMat4:Ki,fromQuat:Bl,fromRotation:Rl,fromScaling:bl,fromTranslation:Vl,fromValues:xl,identity:dr,invert:Xi,mul:Hl,multiply:Yi,multiplyScalar:_l,multiplyScalarAndAdd:Wl,normalFromMat4:kl,projection:Nl,rotate:Dl,scale:Ml,set:Ol,str:Fl,sub:$l,subtract:Tf,translate:El,transpose:df},Symbol.toStringTag,{value:"Module"}));function qi(){var t=new Re(16);return Re!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function jl(t){var e=new Re(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Fe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Kl(t,e,r,n,a,i,s,o,u,c,f,g,v,p,l,y){var h=new Re(16);return h[0]=t,h[1]=e,h[2]=r,h[3]=n,h[4]=a,h[5]=i,h[6]=s,h[7]=o,h[8]=u,h[9]=c,h[10]=f,h[11]=g,h[12]=v,h[13]=p,h[14]=l,h[15]=y,h}function Xl(t,e,r,n,a,i,s,o,u,c,f,g,v,p,l,y,h){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=s,t[6]=o,t[7]=u,t[8]=c,t[9]=f,t[10]=g,t[11]=v,t[12]=p,t[13]=l,t[14]=y,t[15]=h,t}function ae(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ye(t,e){if(t===e){var r=e[1],n=e[2],a=e[3],i=e[6],s=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=i,t[11]=e[14],t[12]=a,t[13]=s,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function He(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],o=e[5],u=e[6],c=e[7],f=e[8],g=e[9],v=e[10],p=e[11],l=e[12],y=e[13],h=e[14],d=e[15],S=r*o-n*s,T=r*u-a*s,C=r*c-i*s,x=n*u-a*o,O=n*c-i*o,w=a*c-i*u,E=f*y-g*l,V=f*h-v*l,D=f*d-p*l,M=g*h-v*y,L=g*d-p*y,N=v*d-p*h,B=S*N-T*L+C*M+x*D-O*V+w*E;return B?(B=1/B,t[0]=(o*N-u*L+c*M)*B,t[1]=(a*L-n*N-i*M)*B,t[2]=(y*w-h*O+d*x)*B,t[3]=(v*O-g*w-p*x)*B,t[4]=(u*D-s*N-c*V)*B,t[5]=(r*N-a*D+i*V)*B,t[6]=(h*C-l*w-d*T)*B,t[7]=(f*w-v*C+p*T)*B,t[8]=(s*L-o*D+c*E)*B,t[9]=(n*D-r*L-i*E)*B,t[10]=(l*O-y*C+d*S)*B,t[11]=(g*C-f*O-p*S)*B,t[12]=(o*V-s*M-u*E)*B,t[13]=(r*M-n*V+a*E)*B,t[14]=(y*T-l*x-h*S)*B,t[15]=(f*x-g*T+v*S)*B,t):null}function Yl(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],o=e[5],u=e[6],c=e[7],f=e[8],g=e[9],v=e[10],p=e[11],l=e[12],y=e[13],h=e[14],d=e[15];return t[0]=o*(v*d-p*h)-g*(u*d-c*h)+y*(u*p-c*v),t[1]=-(n*(v*d-p*h)-g*(a*d-i*h)+y*(a*p-i*v)),t[2]=n*(u*d-c*h)-o*(a*d-i*h)+y*(a*c-i*u),t[3]=-(n*(u*p-c*v)-o*(a*p-i*v)+g*(a*c-i*u)),t[4]=-(s*(v*d-p*h)-f*(u*d-c*h)+l*(u*p-c*v)),t[5]=r*(v*d-p*h)-f*(a*d-i*h)+l*(a*p-i*v),t[6]=-(r*(u*d-c*h)-s*(a*d-i*h)+l*(a*c-i*u)),t[7]=r*(u*p-c*v)-s*(a*p-i*v)+f*(a*c-i*u),t[8]=s*(g*d-p*y)-f*(o*d-c*y)+l*(o*p-c*g),t[9]=-(r*(g*d-p*y)-f*(n*d-i*y)+l*(n*p-i*g)),t[10]=r*(o*d-c*y)-s*(n*d-i*y)+l*(n*c-i*o),t[11]=-(r*(o*p-c*g)-s*(n*p-i*g)+f*(n*c-i*o)),t[12]=-(s*(g*h-v*y)-f*(o*h-u*y)+l*(o*v-u*g)),t[13]=r*(g*h-v*y)-f*(n*h-a*y)+l*(n*v-a*g),t[14]=-(r*(o*h-u*y)-s*(n*h-a*y)+l*(n*u-a*o)),t[15]=r*(o*v-u*g)-s*(n*v-a*g)+f*(n*u-a*o),t}function ql(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],s=t[5],o=t[6],u=t[7],c=t[8],f=t[9],g=t[10],v=t[11],p=t[12],l=t[13],y=t[14],h=t[15],d=e*s-r*i,S=e*o-n*i,T=e*u-a*i,C=r*o-n*s,x=r*u-a*s,O=n*u-a*o,w=c*l-f*p,E=c*y-g*p,V=c*h-v*p,D=f*y-g*l,M=f*h-v*l,L=g*h-v*y;return d*L-S*M+T*D+C*V-x*E+O*w}function ke(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],o=e[4],u=e[5],c=e[6],f=e[7],g=e[8],v=e[9],p=e[10],l=e[11],y=e[12],h=e[13],d=e[14],S=e[15],T=r[0],C=r[1],x=r[2],O=r[3];return t[0]=T*n+C*o+x*g+O*y,t[1]=T*a+C*u+x*v+O*h,t[2]=T*i+C*c+x*p+O*d,t[3]=T*s+C*f+x*l+O*S,T=r[4],C=r[5],x=r[6],O=r[7],t[4]=T*n+C*o+x*g+O*y,t[5]=T*a+C*u+x*v+O*h,t[6]=T*i+C*c+x*p+O*d,t[7]=T*s+C*f+x*l+O*S,T=r[8],C=r[9],x=r[10],O=r[11],t[8]=T*n+C*o+x*g+O*y,t[9]=T*a+C*u+x*v+O*h,t[10]=T*i+C*c+x*p+O*d,t[11]=T*s+C*f+x*l+O*S,T=r[12],C=r[13],x=r[14],O=r[15],t[12]=T*n+C*o+x*g+O*y,t[13]=T*a+C*u+x*v+O*h,t[14]=T*i+C*c+x*p+O*d,t[15]=T*s+C*f+x*l+O*S,t}function me(t,e,r){var n=r[0],a=r[1],i=r[2],s,o,u,c,f,g,v,p,l,y,h,d;return e===t?(t[12]=e[0]*n+e[4]*a+e[8]*i+e[12],t[13]=e[1]*n+e[5]*a+e[9]*i+e[13],t[14]=e[2]*n+e[6]*a+e[10]*i+e[14],t[15]=e[3]*n+e[7]*a+e[11]*i+e[15]):(s=e[0],o=e[1],u=e[2],c=e[3],f=e[4],g=e[5],v=e[6],p=e[7],l=e[8],y=e[9],h=e[10],d=e[11],t[0]=s,t[1]=o,t[2]=u,t[3]=c,t[4]=f,t[5]=g,t[6]=v,t[7]=p,t[8]=l,t[9]=y,t[10]=h,t[11]=d,t[12]=s*n+f*a+l*i+e[12],t[13]=o*n+g*a+y*i+e[13],t[14]=u*n+v*a+h*i+e[14],t[15]=c*n+p*a+d*i+e[15]),t}function Gr(t,e,r){var n=r[0],a=r[1],i=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function vt(t,e,r,n){var a=n[0],i=n[1],s=n[2],o=Math.hypot(a,i,s),u,c,f,g,v,p,l,y,h,d,S,T,C,x,O,w,E,V,D,M,L,N,B,_;return o<se?null:(o=1/o,a*=o,i*=o,s*=o,u=Math.sin(r),c=Math.cos(r),f=1-c,g=e[0],v=e[1],p=e[2],l=e[3],y=e[4],h=e[5],d=e[6],S=e[7],T=e[8],C=e[9],x=e[10],O=e[11],w=a*a*f+c,E=i*a*f+s*u,V=s*a*f-i*u,D=a*i*f-s*u,M=i*i*f+c,L=s*i*f+a*u,N=a*s*f+i*u,B=i*s*f-a*u,_=s*s*f+c,t[0]=g*w+y*E+T*V,t[1]=v*w+h*E+C*V,t[2]=p*w+d*E+x*V,t[3]=l*w+S*E+O*V,t[4]=g*D+y*M+T*L,t[5]=v*D+h*M+C*L,t[6]=p*D+d*M+x*L,t[7]=l*D+S*M+O*L,t[8]=g*N+y*B+T*_,t[9]=v*N+h*B+C*_,t[10]=p*N+d*B+x*_,t[11]=l*N+S*B+O*_,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Cf(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[4],s=e[5],o=e[6],u=e[7],c=e[8],f=e[9],g=e[10],v=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*a+c*n,t[5]=s*a+f*n,t[6]=o*a+g*n,t[7]=u*a+v*n,t[8]=c*a-i*n,t[9]=f*a-s*n,t[10]=g*a-o*n,t[11]=v*a-u*n,t}function Sf(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],s=e[1],o=e[2],u=e[3],c=e[8],f=e[9],g=e[10],v=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a-c*n,t[1]=s*a-f*n,t[2]=o*a-g*n,t[3]=u*a-v*n,t[8]=i*n+c*a,t[9]=s*n+f*a,t[10]=o*n+g*a,t[11]=u*n+v*a,t}function xf(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],s=e[1],o=e[2],u=e[3],c=e[4],f=e[5],g=e[6],v=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a+c*n,t[1]=s*a+f*n,t[2]=o*a+g*n,t[3]=u*a+v*n,t[4]=c*a-i*n,t[5]=f*a-s*n,t[6]=g*a-o*n,t[7]=v*a-u*n,t}function Of(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function mf(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ql(t,e,r){var n=r[0],a=r[1],i=r[2],s=Math.hypot(n,a,i),o,u,c;return s<se?null:(s=1/s,n*=s,a*=s,i*=s,o=Math.sin(e),u=Math.cos(e),c=1-u,t[0]=n*n*c+u,t[1]=a*n*c+i*o,t[2]=i*n*c-a*o,t[3]=0,t[4]=n*a*c-i*o,t[5]=a*a*c+u,t[6]=i*a*c+n*o,t[7]=0,t[8]=n*i*c+a*o,t[9]=a*i*c-n*o,t[10]=i*i*c+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Zl(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Il(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Jl(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function wf(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],o=n+n,u=a+a,c=i+i,f=n*o,g=n*u,v=n*c,p=a*u,l=a*c,y=i*c,h=s*o,d=s*u,S=s*c;return t[0]=1-(p+y),t[1]=g+S,t[2]=v-d,t[3]=0,t[4]=g-S,t[5]=1-(f+y),t[6]=l+h,t[7]=0,t[8]=v+d,t[9]=l-h,t[10]=1-(f+p),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function e0(t,e){var r=new Re(3),n=-e[0],a=-e[1],i=-e[2],s=e[3],o=e[4],u=e[5],c=e[6],f=e[7],g=n*n+a*a+i*i+s*s;return g>0?(r[0]=(o*s+f*n+u*i-c*a)*2/g,r[1]=(u*s+f*a+c*n-o*i)*2/g,r[2]=(c*s+f*i+o*a-u*n)*2/g):(r[0]=(o*s+f*n+u*i-c*a)*2,r[1]=(u*s+f*a+c*n-o*i)*2,r[2]=(c*s+f*i+o*a-u*n)*2),wf(t,e,r),t}function t0(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Ef(t,e){var r=e[0],n=e[1],a=e[2],i=e[4],s=e[5],o=e[6],u=e[8],c=e[9],f=e[10];return t[0]=Math.hypot(r,n,a),t[1]=Math.hypot(i,s,o),t[2]=Math.hypot(u,c,f),t}function Df(t,e){var r=new Re(3);Ef(r,e);var n=1/r[0],a=1/r[1],i=1/r[2],s=e[0]*n,o=e[1]*a,u=e[2]*i,c=e[4]*n,f=e[5]*a,g=e[6]*i,v=e[8]*n,p=e[9]*a,l=e[10]*i,y=s+f+l,h=0;return y>0?(h=Math.sqrt(y+1)*2,t[3]=.25*h,t[0]=(g-p)/h,t[1]=(v-u)/h,t[2]=(o-c)/h):s>f&&s>l?(h=Math.sqrt(1+s-f-l)*2,t[3]=(g-p)/h,t[0]=.25*h,t[1]=(o+c)/h,t[2]=(v+u)/h):f>l?(h=Math.sqrt(1+f-s-l)*2,t[3]=(v-u)/h,t[0]=(o+c)/h,t[1]=.25*h,t[2]=(g+p)/h):(h=Math.sqrt(1+l-s-f)*2,t[3]=(o-c)/h,t[0]=(v+u)/h,t[1]=(g+p)/h,t[2]=.25*h),t}function Mf(t,e,r,n){var a=e[0],i=e[1],s=e[2],o=e[3],u=a+a,c=i+i,f=s+s,g=a*u,v=a*c,p=a*f,l=i*c,y=i*f,h=s*f,d=o*u,S=o*c,T=o*f,C=n[0],x=n[1],O=n[2];return t[0]=(1-(l+h))*C,t[1]=(v+T)*C,t[2]=(p-S)*C,t[3]=0,t[4]=(v-T)*x,t[5]=(1-(g+h))*x,t[6]=(y+d)*x,t[7]=0,t[8]=(p+S)*O,t[9]=(y-d)*O,t[10]=(1-(g+l))*O,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function r0(t,e,r,n,a){var i=e[0],s=e[1],o=e[2],u=e[3],c=i+i,f=s+s,g=o+o,v=i*c,p=i*f,l=i*g,y=s*f,h=s*g,d=o*g,S=u*c,T=u*f,C=u*g,x=n[0],O=n[1],w=n[2],E=a[0],V=a[1],D=a[2],M=(1-(y+d))*x,L=(p+C)*x,N=(l-T)*x,B=(p-C)*O,_=(1-(v+d))*O,A=(h+S)*O,W=(l+T)*w,z=(h-S)*w,R=(1-(v+y))*w;return t[0]=M,t[1]=L,t[2]=N,t[3]=0,t[4]=B,t[5]=_,t[6]=A,t[7]=0,t[8]=W,t[9]=z,t[10]=R,t[11]=0,t[12]=r[0]+E-(M*E+B*V+W*D),t[13]=r[1]+V-(L*E+_*V+z*D),t[14]=r[2]+D-(N*E+A*V+R*D),t[15]=1,t}function Qi(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=r+r,o=n+n,u=a+a,c=r*s,f=n*s,g=n*o,v=a*s,p=a*o,l=a*u,y=i*s,h=i*o,d=i*u;return t[0]=1-g-l,t[1]=f+d,t[2]=v-h,t[3]=0,t[4]=f-d,t[5]=1-c-l,t[6]=p+y,t[7]=0,t[8]=v+h,t[9]=p-y,t[10]=1-c-g,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function n0(t,e,r,n,a,i,s){var o=1/(r-e),u=1/(a-n),c=1/(i-s);return t[0]=i*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i*2*u,t[6]=0,t[7]=0,t[8]=(r+e)*o,t[9]=(a+n)*u,t[10]=(s+i)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*i*2*c,t[15]=0,t}function Vf(t,e,r,n,a){var i=1/Math.tan(e/2),s;return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(s=1/(n-a),t[10]=(a+n)*s,t[14]=2*a*n*s):(t[10]=-1,t[14]=-2*n),t}var a0=Vf;function i0(t,e,r,n,a){var i=1/Math.tan(e/2),s;return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(s=1/(n-a),t[10]=a*s,t[14]=a*n*s):(t[10]=-1,t[14]=-n),t}function s0(t,e,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),u=2/(s+o),c=2/(a+i);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-((s-o)*u*.5),t[9]=(a-i)*c*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function Rf(t,e,r,n,a,i,s){var o=1/(e-r),u=1/(n-a),c=1/(i-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*o,t[13]=(a+n)*u,t[14]=(s+i)*c,t[15]=1,t}var bf=Rf;function o0(t,e,r,n,a,i,s){var o=1/(e-r),u=1/(n-a),c=1/(i-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+r)*o,t[13]=(a+n)*u,t[14]=i*c,t[15]=1,t}function Lf(t,e,r,n){var a,i,s,o,u,c,f,g,v,p,l=e[0],y=e[1],h=e[2],d=n[0],S=n[1],T=n[2],C=r[0],x=r[1],O=r[2];return Math.abs(l-C)<se&&Math.abs(y-x)<se&&Math.abs(h-O)<se?ae(t):(f=l-C,g=y-x,v=h-O,p=1/Math.hypot(f,g,v),f*=p,g*=p,v*=p,a=S*v-T*g,i=T*f-d*v,s=d*g-S*f,p=Math.hypot(a,i,s),p?(p=1/p,a*=p,i*=p,s*=p):(a=0,i=0,s=0),o=g*s-v*i,u=v*a-f*s,c=f*i-g*a,p=Math.hypot(o,u,c),p?(p=1/p,o*=p,u*=p,c*=p):(o=0,u=0,c=0),t[0]=a,t[1]=o,t[2]=f,t[3]=0,t[4]=i,t[5]=u,t[6]=g,t[7]=0,t[8]=s,t[9]=c,t[10]=v,t[11]=0,t[12]=-(a*l+i*y+s*h),t[13]=-(o*l+u*y+c*h),t[14]=-(f*l+g*y+v*h),t[15]=1,t)}function u0(t,e,r,n){var a=e[0],i=e[1],s=e[2],o=n[0],u=n[1],c=n[2],f=a-r[0],g=i-r[1],v=s-r[2],p=f*f+g*g+v*v;p>0&&(p=1/Math.sqrt(p),f*=p,g*=p,v*=p);var l=u*v-c*g,y=c*f-o*v,h=o*g-u*f;return p=l*l+y*y+h*h,p>0&&(p=1/Math.sqrt(p),l*=p,y*=p,h*=p),t[0]=l,t[1]=y,t[2]=h,t[3]=0,t[4]=g*h-v*y,t[5]=v*l-f*h,t[6]=f*y-g*l,t[7]=0,t[8]=f,t[9]=g,t[10]=v,t[11]=0,t[12]=a,t[13]=i,t[14]=s,t[15]=1,t}function f0(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function c0(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function g0(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function Bf(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function v0(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function p0(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function l0(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function h0(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],s=t[4],o=t[5],u=t[6],c=t[7],f=t[8],g=t[9],v=t[10],p=t[11],l=t[12],y=t[13],h=t[14],d=t[15],S=e[0],T=e[1],C=e[2],x=e[3],O=e[4],w=e[5],E=e[6],V=e[7],D=e[8],M=e[9],L=e[10],N=e[11],B=e[12],_=e[13],A=e[14],W=e[15];return Math.abs(r-S)<=se*Math.max(1,Math.abs(r),Math.abs(S))&&Math.abs(n-T)<=se*Math.max(1,Math.abs(n),Math.abs(T))&&Math.abs(a-C)<=se*Math.max(1,Math.abs(a),Math.abs(C))&&Math.abs(i-x)<=se*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(s-O)<=se*Math.max(1,Math.abs(s),Math.abs(O))&&Math.abs(o-w)<=se*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(u-E)<=se*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-V)<=se*Math.max(1,Math.abs(c),Math.abs(V))&&Math.abs(f-D)<=se*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(g-M)<=se*Math.max(1,Math.abs(g),Math.abs(M))&&Math.abs(v-L)<=se*Math.max(1,Math.abs(v),Math.abs(L))&&Math.abs(p-N)<=se*Math.max(1,Math.abs(p),Math.abs(N))&&Math.abs(l-B)<=se*Math.max(1,Math.abs(l),Math.abs(B))&&Math.abs(y-_)<=se*Math.max(1,Math.abs(y),Math.abs(_))&&Math.abs(h-A)<=se*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(d-W)<=se*Math.max(1,Math.abs(d),Math.abs(W))}var Oi=ke,y0=Bf;const mi=Object.freeze(Object.defineProperty({__proto__:null,add:g0,adjoint:Yl,clone:jl,copy:Fe,create:qi,determinant:ql,equals:h0,exactEquals:l0,frob:c0,fromQuat:Qi,fromQuat2:e0,fromRotation:Ql,fromRotationTranslation:wf,fromRotationTranslationScale:Mf,fromRotationTranslationScaleOrigin:r0,fromScaling:mf,fromTranslation:Of,fromValues:Kl,fromXRotation:Zl,fromYRotation:Il,fromZRotation:Jl,frustum:n0,getRotation:Df,getScaling:Ef,getTranslation:t0,identity:ae,invert:He,lookAt:Lf,mul:Oi,multiply:ke,multiplyScalar:v0,multiplyScalarAndAdd:p0,ortho:bf,orthoNO:Rf,orthoZO:o0,perspective:a0,perspectiveFromFieldOfView:s0,perspectiveNO:Vf,perspectiveZO:i0,rotate:vt,rotateX:Cf,rotateY:Sf,rotateZ:xf,scale:Gr,set:Xl,str:f0,sub:y0,subtract:Bf,targetTo:u0,translate:me,transpose:ye},Symbol.toStringTag,{value:"Module"}));function kf(){var t=new Re(3);return Re!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function d0(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function Ys(t,e,r){var n=new Re(3);return n[0]=t,n[1]=e,n[2]=r,n}function sa(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function Jr(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function $t(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function _t(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function T0(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function fn(t,e){var r=e[0],n=e[1],a=e[2],i=r*r+n*n+a*a;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function Nf(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ja(t,e,r){var n=e[0],a=e[1],i=e[2],s=r[0],o=r[1],u=r[2];return t[0]=a*u-i*o,t[1]=i*s-n*u,t[2]=n*o-a*s,t}function ce(t,e,r){var n=e[0],a=e[1],i=e[2],s=r[3]*n+r[7]*a+r[11]*i+r[15];return s=s||1,t[0]=(r[0]*n+r[4]*a+r[8]*i+r[12])/s,t[1]=(r[1]*n+r[5]*a+r[9]*i+r[13])/s,t[2]=(r[2]*n+r[6]*a+r[10]*i+r[14])/s,t}function qs(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Qs(t,e){var r=t[0],n=t[1],a=t[2],i=e[0],s=e[1],o=e[2];return Math.abs(r-i)<=se*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-s)<=se*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-o)<=se*Math.max(1,Math.abs(a),Math.abs(o))}var wi=$t,Ff=d0;(function(){var t=kf();return function(e,r,n,a,i,s){var o,u;for(r||(r=3),n||(n=0),a?u=Math.min(a*r+n,e.length):u=e.length,o=n;o<u;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],i(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();function C0(){var t=new Re(4);return Re!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function S0(t,e,r,n){var a=new Re(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a}function x0(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=r*r+n*n+a*a+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=r*s,t[1]=n*s,t[2]=a*s,t[3]=i*s,t}function mn(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3];return t[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*s,t[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*s,t[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*s,t[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*s,t}(function(){var t=C0();return function(e,r,n,a,i,s){var o,u;for(r||(r=4),n||(n=0),a?u=Math.min(a*r+n,e.length):u=e.length,o=n;o<u;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],i(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();function yr(){var t=new Re(4);return Re!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Zi(t,e,r){r=r*.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function O0(t,e){var r=Math.acos(e[3])*2,n=Math.sin(r/2);return n>se?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function Zs(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],o=r[0],u=r[1],c=r[2],f=r[3];return t[0]=n*f+s*o+a*c-i*u,t[1]=a*f+s*u+i*o-n*c,t[2]=i*f+s*c+n*u-a*o,t[3]=s*f-n*o-a*u-i*c,t}function Ka(t,e,r,n){var a=e[0],i=e[1],s=e[2],o=e[3],u=r[0],c=r[1],f=r[2],g=r[3],v,p,l,y,h;return p=a*u+i*c+s*f+o*g,p<0&&(p=-p,u=-u,c=-c,f=-f,g=-g),1-p>se?(v=Math.acos(p),l=Math.sin(v),y=Math.sin((1-n)*v)/l,h=Math.sin(n*v)/l):(y=1-n,h=n),t[0]=y*a+h*u,t[1]=y*i+h*c,t[2]=y*s+h*f,t[3]=y*o+h*g,t}function m0(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function w0(t,e){var r=e[0]+e[4]+e[8],n;if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[a*3+a]&&(a=2);var i=(a+1)%3,s=(a+2)%3;n=Math.sqrt(e[a*3+a]-e[i*3+i]-e[s*3+s]+1),t[a]=.5*n,n=.5/n,t[3]=(e[i*3+s]-e[s*3+i])*n,t[i]=(e[i*3+a]+e[a*3+i])*n,t[s]=(e[s*3+a]+e[a*3+s])*n}return t}var Is=S0,Uf=x0;(function(){var t=kf(),e=Ys(1,0,0),r=Ys(0,1,0);return function(n,a,i){var s=Nf(a,i);return s<-.999999?(ja(t,e,a),Ff(t)<1e-6&&ja(t,r,a),fn(t,t),Zi(n,t,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(ja(t,a,i),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+s,Uf(n,n))}})();(function(){var t=yr(),e=yr();return function(r,n,a,i,s,o){return Ka(t,n,s,o),Ka(e,a,i,o),Ka(r,t,e,2*o*(1-o)),r}})();(function(){var t=yf();return function(e,r,n,a){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],Uf(e,w0(e,t))}})();function E0(t){if(Array.isArray(t))return t}function D0(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],a=!0,i=!1,s,o;try{for(r=r.call(t);!(a=(s=r.next()).done)&&(n.push(s.value),!(e&&n.length===e));a=!0);}catch(u){i=!0,o=u}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw o}}return n}}function Ei(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Gf(t,e){if(t){if(typeof t=="string")return Ei(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ei(t,e)}}function M0(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $e(t,e){return E0(t)||D0(t,e)||Gf(t,e)||M0()}function V0(t){if(Array.isArray(t))return Ei(t)}function R0(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function b0(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y(t){return V0(t)||R0(t)||Gf(t)||b0()}function cn(t,e){return cn=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},cn(t,e)}function L0(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sn(t,e,r){return L0()?sn=Reflect.construct:sn=function(a,i,s){var o=[null];o.push.apply(o,i);var u=Function.bind.apply(a,o),c=new u;return s&&cn(c,s.prototype),c},sn.apply(null,arguments)}var B0=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,a,i;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(a=n;a--!==0;)if(!t(e[a],r[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(r).length)return!1;for(a=n;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,i[a]))return!1;for(a=n;a--!==0;){var s=i[a];if(!t(e[s],r[s]))return!1}return!0}return e!==e&&r!==r};const k0=Ea(B0);function Da(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Js(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ma(t,e,r){return e&&Js(t.prototype,e),r&&Js(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ze(t){return ze=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ze(t)}function N0(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ze(t),t!==null););return t}function Dt(){return typeof Reflect<"u"&&Reflect.get?Dt=Reflect.get:Dt=function(e,r,n){var a=N0(e,r);if(a){var i=Object.getOwnPropertyDescriptor(a,r);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Dt.apply(this,arguments)}function _f(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cn(t,e)}function Di(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Wf(t,e){if(e&&(Kt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Di(t)}function F0(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function oa(t){var e=typeof Map=="function"?new Map:void 0;return oa=function(n){if(n===null||!F0(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,a)}function a(){return sn(n,arguments,ze(this).constructor)}return a.prototype=Object.create(n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),cn(a,n)},oa(t)}function U0(t){var e=G0();return function(){var n=ze(t),a;if(e){var i=ze(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Wf(this,a)}}function G0(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Xa=function(t){_f(r,t);var e=U0(r);function r(){return Da(this,r),e.apply(this,arguments)}return Ma(r,[{key:"push",value:function(){for(var a=0;a<arguments.length;a++)this.includes(arguments[a])||Dt(ze(r.prototype),"push",this).call(this,arguments[a]);return this.length}}]),r}(oa(Array));function eo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ua(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?eo(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):eo(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Mi=0,_0=Symbol("void");function W0(){return Mi}var zf={};function ur(){}var z0=["log","debug","info","warn","error","time","timeEnd","group","groupEnd"];z0.forEach(function(t){zf[t]=ur});nt.console=console.hasOwnProperty("log")?console:zf;var Xe={debug:ur,error:nt.console.error||ur,info:nt.console.info||ur,log:nt.console.log||ur,warn:nt.console.warn||ur};function A0(t,e){Xe[t]&&(Xe[t]=e||ur)}function H0(){Xe.log.apply(Xe,arguments)}function $0(){Xe.info.apply(Xe,arguments)}function Xt(){Xe.debug.apply(Xe,arguments)}function P(){Xe.error.apply(Xe,arguments)}function Va(){Xe.warn.apply(Xe,arguments)}var to={};function P0(t){to[t]||(Xe.error(t),to[t]=!0)}var Pe=Object.create(null);Pe.Float32Array=Float32Array;Pe.Float64Array=Float64Array;Pe.Uint8Array=Uint8Array;Pe.Int8Array=Int8Array;Pe.Uint16Array=Uint16Array;Pe.Int16Array=Int16Array;Pe.Uint32Array=Uint32Array;Pe.Int32Array=Int32Array;Pe.Uint8ClampedArray=Uint8ClampedArray;try{Pe.BigInt64Array=BigInt64Array,Pe.BigUint64Array=BigUint64Array}catch{}function dn(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return sn(Pe[t]||Float64Array,r)}function Af(t){for(var e,r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return(e=Pe[t]||Float64Array).from.apply(e,n)}function Ii(t){return t.charAt(0).toUpperCase()+t.slice(1)}function xe(t){return Ii(t[0]==="_"?t.slice(1):t)}function j0(t){return t.charAt(0).toLowerCase()+t.slice(1)}function K0(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3,n=["TB","GB","MB","KB"],a=Number(t),i="B";a>r;)a/=r,i=n.pop();return"".concat(a.toFixed(e)," ").concat(i)}function X0(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ",r=[],n=t;n>1e3;)r.push("000".concat(n%1e3).slice(-3)),n=Math.floor(n/1e3);return n>0&&r.push(n),r.reverse(),r.join(e)}function Hf(t){Object.keys(t).forEach(function(e){Array.isArray(t[e])&&(t[e]=[].concat(t[e]))})}function Y0(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}function q0(t,e){return Object.keys(t).find(function(r){return t[r]===e})}function $f(t){return t&&t.isA?t.getState():t}function Pf(t){setTimeout(t,0)}function Q0(t,e){var r=performance.now();t.finally(function(){var n=performance.now()-r;e(n)})}function Ne(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Hf(e);var r=[];if(Number.isInteger(e.mtime)||(e.mtime=++Mi),!("classHierarchy"in e))e.classHierarchy=new Xa("vtkObject");else if(!(e.classHierarchy instanceof Xa)){for(var n=new Xa,a=0;a<e.classHierarchy.length;a++)n.push(e.classHierarchy[a]);e.classHierarchy=n}function i(o){r[o]=null}function s(o){function u(){i(o)}return Object.freeze({unsubscribe:u})}return t.isDeleted=function(){return!!e.deleted},t.modified=function(o){if(e.deleted){P("instance deleted - cannot call any method");return}o&&o<t.getMTime()||(e.mtime=++Mi,r.forEach(function(u){return u&&u(t)}))},t.onModified=function(o){if(e.deleted)return P("instance deleted - cannot call any method"),null;var u=r.length;return r.push(o),s(u)},t.getMTime=function(){return e.mtime},t.isA=function(o){for(var u=e.classHierarchy.length;u--;)if(e.classHierarchy[u]===o)return!0;return!1},t.getClassName=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.classHierarchy[e.classHierarchy.length-1-o]},t.set=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,f=!1;return Object.keys(o).forEach(function(g){var v=c?null:t["set".concat(Ii(g))];v&&Array.isArray(o[g])&&v.length>1?f=v.apply(void 0,Y(o[g]))||f:v?f=v(o[g])||f:(["mtime"].indexOf(g)===-1&&!u&&Va("Warning: Set value to model directly ".concat(g,", ").concat(o[g])),f=e[g]!==o[g]||f,e[g]=o[g])}),f},t.get=function(){for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];if(!u.length)return e;var f={};return u.forEach(function(g){f[g]=e[g]}),f},t.getReferenceByName=function(o){return e[o]},t.delete=function(){Object.keys(e).forEach(function(o){return delete e[o]}),r.forEach(function(o,u){return i(u)}),e.deleted=!0},t.getState=function(){if(e.deleted)return null;var o=ua(ua({},e),{},{vtkClass:t.getClassName()});Object.keys(o).forEach(function(c){o[c]===null||o[c]===void 0||c[0]==="_"?delete o[c]:o[c].isA?o[c]=o[c].getState():Array.isArray(o[c])&&(o[c]=o[c].map($f))});var u={};return Object.keys(o).sort().forEach(function(c){u[c]=o[c]}),u.mtime&&delete u.mtime,u},t.shallowCopy=function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(o.getClassName()!==t.getClassName())throw new Error("Cannot ShallowCopy ".concat(o.getClassName()," into ").concat(t.getClassName()));var c=o.get(),f=Object.keys(e).sort(),g=Object.keys(c).sort();g.forEach(function(v){var p=f.indexOf(v);p===-1?u&&Xt("add ".concat(v," in shallowCopy")):f.splice(p,1),e[v]=c[v]}),f.length&&u&&Xt("Untouched keys: ".concat(f.join(", "))),t.modified()},t.toJSON=function(){return t.getState()},t}var Z0={object:function(e,r,n){return function(){return ua({},r[n.name])}}};function je(t,e,r){r.forEach(function(n){if(Kt(n)==="object"){var a=Z0[n.type];a?t["get".concat(xe(n.name))]=a(t,e,n):t["get".concat(xe(n.name))]=function(){return e[n.name]}}else t["get".concat(xe(n))]=function(){return e[n]}})}var I0={enum:function(e,r,n){var a="_on".concat(xe(n.name),"Changed");return function(i){if(typeof i=="string"){if(n.enum[i]!==void 0)return r[n.name]!==n.enum[i]?(r[n.name]=n.enum[i],e.modified(),!0):!1;throw P("Set Enum with invalid argument ".concat(n,", ").concat(i)),new RangeError("Set Enum with invalid string argument")}if(typeof i=="number"){if(r[n.name]!==i){if(Object.keys(n.enum).map(function(u){return n.enum[u]}).indexOf(i)!==-1){var s,o=r[n.name];return r[n.name]=i,(s=r[a])===null||s===void 0||s.call(r,e,r,i,o),e.modified(),!0}throw P("Set Enum outside numeric range ".concat(n,", ").concat(i)),new RangeError("Set Enum outside numeric range")}return!1}throw P("Set Enum with invalid argument (String/Number) ".concat(n,", ").concat(i)),new TypeError("Set Enum with invalid argument (String/Number)")}},object:function(e,r,n){var a="_on".concat(xe(n.name),"Changed");return function(i){if(!k0(r[n.name],i)){var s,o=r[n.name];return r[n.name]=i,(s=r[a])===null||s===void 0||s.call(r,e,r,i,o),e.modified(),!0}return!1}}};function ro(t){if(Kt(t)==="object"){var e=I0[t.type];if(e)return function(r,n){return e(r,n,t)};throw P("No setter for field ".concat(t)),new TypeError("No setter for field")}return function(n,a){var i="_on".concat(xe(t),"Changed");return function(o){if(a.deleted)return P("instance deleted - cannot call any method"),!1;if(a[t]!==o){var u,c=a[t.name];return a[t]=o,(u=a[i])===null||u===void 0||u.call(a,n,a,o,c),n.modified(),!0}return!1}}}function Ra(t,e,r){r.forEach(function(n){Kt(n)==="object"?t["set".concat(xe(n.name))]=ro(n)(t,e):t["set".concat(xe(n))]=ro(n)(t,e)})}function be(t,e,r){je(t,e,r),Ra(t,e,r)}function Tn(t,e,r){r.forEach(function(n){t["get".concat(xe(n))]=function(){return e[n]?Array.from(e[n]):e[n]},t["get".concat(xe(n),"ByReference")]=function(){return e[n]}})}function jf(t,e,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;r.forEach(function(i){if(e[i]&&n&&e[i].length!==n)throw new RangeError("Invalid initial number of values for array (".concat(i,")"));var s="_on".concat(xe(i),"Changed");t["set".concat(xe(i))]=function(){if(e.deleted)return P("instance deleted - cannot call any method"),!1;for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];var f=u,g,v=!1;if(f.length===1&&(f[0]==null||f[0].length>=0)&&(f=f[0],v=!0),f==null)g=e[i]!==f;else{if(n&&f.length!==n)if(f.length<n&&a!==void 0)for(f=Array.from(f),v=!1;f.length<n;)f.push(a);else throw new RangeError("Invalid number of values for array setter (".concat(i,")"));g=e[i]==null||e[i].length!==f.length;for(var p=0;!g&&p<f.length;++p)g=e[i][p]!==f[p];g&&v&&(f=Array.from(f))}if(g){var l,y=e[i.name];e[i]=f,(l=e[s])===null||l===void 0||l.call(e,t,e,f,y),t.modified()}return g},t["set".concat(xe(i),"From")]=function(o){var u=e[i];o.forEach(function(c,f){u[f]=c})}})}function Kf(t,e,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;Tn(t,e,r),jf(t,e,r,n,a)}function ba(t,e,r){for(var n=0;n<r.length;n++){var a=r[n];e[a]!==void 0&&(e["_".concat(a)]=e[a],delete e[a])}}function J0(t,e,r,n){e.inputData?e.inputData=e.inputData.map(ot):e.inputData=[],e.inputConnection?e.inputConnection=e.inputConnection.map(ot):e.inputConnection=[],e.output?e.output=e.output.map(ot):e.output=[],e.inputArrayToProcess?e.inputArrayToProcess=e.inputArrayToProcess.map(ot):e.inputArrayToProcess=[],e.numberOfInputs=r;function a(l){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){P("instance deleted - cannot call any method");return}if(y>=e.numberOfInputs){P("algorithm ".concat(t.getClassName()," only has ").concat(e.numberOfInputs," input ports. To add more input ports, use addInputData()"));return}(e.inputData[y]!==l||e.inputConnection[y])&&(e.inputData[y]=l,e.inputConnection[y]=null,t.modified&&t.modified())}function i(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[l]&&(e.inputData[l]=e.inputConnection[l]()),e.inputData[l]}function s(l){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){P("instance deleted - cannot call any method");return}if(y>=e.numberOfInputs){var h="algorithm ".concat(t.getClassName()," only has ");h+="".concat(e.numberOfInputs),h+=" input ports. To add more input ports, use addInputConnection()",P(h);return}e.inputData[y]=null,e.inputConnection[y]=l}function o(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[l]}function u(){for(var l=e.numberOfInputs;l&&!e.inputData[l-1]&&!e.inputConnection[l-1];)l--;return l===e.numberOfInputs&&e.numberOfInputs++,l}function c(l){if(e.deleted){P("instance deleted - cannot call any method");return}s(l,u())}function f(l){if(e.deleted){P("instance deleted - cannot call any method");return}a(l,u())}function g(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.deleted?(P("instance deleted - cannot call any method"),null):(t.shouldUpdate()&&t.update(),e.output[l])}t.shouldUpdate=function(){for(var l=t.getMTime(),y=1/0,h=n;h--;){if(!e.output[h]||e.output[h].isDeleted())return!0;var d=e.output[h].getMTime();if(d<l)return!0;d<y&&(y=d)}for(h=e.numberOfInputs;h--;){var S,T;if((S=e.inputConnection[h])!==null&&S!==void 0&&S.filter.shouldUpdate()||((T=t.getInputData(h))===null||T===void 0?void 0:T.getMTime())>y)return!0}return!1};function v(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,y=function(){return g(l)};return y.filter=t,y}if(e.numberOfInputs){for(var p=e.numberOfInputs;p--;)e.inputData.push(null),e.inputConnection.push(null);t.setInputData=a,t.setInputConnection=s,t.addInputData=f,t.addInputConnection=c,t.getInputData=i,t.getInputConnection=o}n&&(t.getOutputData=g,t.getOutputPort=v),t.update=function(){var l=[];if(e.numberOfInputs)for(var y=0;y<e.numberOfInputs;)l[y]=t.getInputData(y),y++;t.shouldUpdate()&&t.requestData&&t.requestData(l,e.output)},t.getNumberOfInputPorts=function(){return e.numberOfInputs},t.getNumberOfOutputPorts=function(){return n||e.output.length},t.getInputArrayToProcess=function(l){var y=e.inputArrayToProcess[l],h=e.inputData[l];return y&&h?h["get".concat(y.fieldAssociation)]().getArray(y.arrayName):null},t.setInputArrayToProcess=function(l,y,h){for(var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Scalars";e.inputArrayToProcess.length<l;)e.inputArrayToProcess.push(null);e.inputArrayToProcess[l]={arrayName:y,fieldAssociation:h,attributeType:d}}}var Xf=Symbol("Event abort");function eh(t,e,r){var n=[],a=t.delete,i=1;function s(c){for(var f=0;f<n.length;++f){var g=$e(n[f],1),v=g[0];if(v===c){n.splice(f,1);return}}}function o(c){function f(){s(c)}return Object.freeze({unsubscribe:f})}function u(){var c=arguments;if(e.deleted){P("instance deleted - cannot call any method");return}for(var f=n.slice(),g=function(y){var h=$e(f[y],3),d=h[1],S=h[2];if(!d)return"continue";if(S<0)setTimeout(function(){return d.apply(t,c)},1-S);else{var T=d.apply(t,c);if(T===Xf)return"break"}},v=0;v<f.length;++v){var p=g(v);if(p!=="continue"&&p==="break")break}}t["invoke".concat(xe(r))]=u,t["on".concat(xe(r))]=function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!c.apply)return console.error("Invalid callback for event ".concat(r)),null;if(e.deleted)return P("instance deleted - cannot call any method"),null;var g=i++;return n.push([g,c,f]),n.sort(function(v,p){return p[2]-v[2]}),o(g)},t.delete=function(){a(),n.forEach(function(c){var f=$e(c,1),g=f[0];return s(g)})}}function ve(t,e){var r=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i={},s={};return t(s,i,a),Object.freeze(s)};return e&&ot.register(e,r),r}function th(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e.filter(function(s){return!!s}).map(function(s){return s.apply(void 0,a)})}}function Yf(t){return t&&t.isA&&t.isA("vtkObject")}function Vi(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(Yf(t)){if(n.indexOf(t)>=0)return r;n.push(t);var a=e(t);a!==void 0&&r.push(a);var i=t.get();Object.keys(i).forEach(function(s){var o=i[s];Array.isArray(o)?o.forEach(function(u){Vi(u,e,r,n)}):Vi(o,e,r,n)})}return r}function rh(t,e,r){var n=this,a,i=function(){for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];var f=n,g=function(){a=null,r||t.apply(f,u)},v=r&&!a;clearTimeout(a),a=setTimeout(g,e),v&&t.apply(f,u)};return i.cancel=function(){return clearTimeout(a)},i}function nh(t,e){var r=!1,n=null;function a(){r=!1,n!==null&&(i.apply(void 0,Y(n)),n=null)}function i(){for(var s=arguments.length,o=new Array(s),u=0;u<s;u++)o[u]=arguments[u];if(r){n=o;return}r=!0,t.apply(void 0,o),setTimeout(a,e)}return i}function qf(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};e.keystore=Object.assign(e.keystore||{},r),t.setKey=function(n,a){e.keystore[n]=a},t.getKey=function(n){return e.keystore[n]},t.getAllKeys=function(){return Object.keys(e.keystore)},t.deleteKey=function(n){return delete e.keystore[n]},t.clearKeystore=function(){return t.getAllKeys().forEach(function(n){return delete e.keystore[n]})}}var ah=1,wn="__root__";function ih(t,e){qf(t,e);var r=t.delete;e.proxyId="".concat(ah++),e.ui=JSON.parse(JSON.stringify(e.ui||[])),je(t,e,["proxyId","proxyGroup","proxyName"]),be(t,e,["proxyManager"]);var n={},a={};function i(c,f){a[f]||(a[f]=[]);for(var g=a[f],v=0;v<c.length;v++)g.push(c[v].name),n[c[v].name]=c[v],c[v].children&&c[v].children.length&&i(c[v].children,c[v].name)}i(e.ui,wn),t.updateUI=function(c){e.ui=JSON.parse(JSON.stringify(c||[])),Object.keys(n).forEach(function(f){return delete n[f]}),Object.keys(a).forEach(function(f){return delete a[f]}),i(e.ui,wn),t.modified()};function s(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wn;return a[c]}t.updateProxyProperty=function(c,f){var g=n[c];g?Object.assign(g,f):n[c]=ua({},f)},t.activate=function(){if(e.proxyManager){var c="setActive".concat(xe(t.getProxyGroup().slice(0,-1)));e.proxyManager[c]&&e.proxyManager[c](t)}},e.propertyLinkSubscribers={},t.registerPropertyLinkForGC=function(c,f){f in e.propertyLinkSubscribers||(e.propertyLinkSubscribers[f]=[]),e.propertyLinkSubscribers[f].push(c)},t.gcPropertyLinks=function(c){for(var f=e.propertyLinkSubscribers[c]||[];f.length;)f.pop().unbind(t)},e.propertyLinkMap={},t.getPropertyLink=function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.propertyLinkMap[c])return e.propertyLinkMap[c];var g=null,v=[],p=0,l=!1;function y(C){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(l)return null;var O=[],w=null;for(p=v.length;p--;){var E=v[p];E.instance===C?w=E:O.push(E)}if(!w)return null;var V=w.instance["get".concat(xe(w.propertyName))]();if(!Y0(V,g)||x){for(g=V,l=!0;O.length;){var D=O.pop();D.instance.set(ee({},D.propertyName,g))}l=!1}return e.propertyLinkMap[c].persistent&&(e.propertyLinkMap[c].value=V),V}function h(C,x){var O=[];for(p=v.length;p--;){var w=v[p];w.instance===C&&(w.propertyName===x||x===void 0)&&(w.subscription.unsubscribe(),O.push(p))}for(;O.length;)v.splice(O.pop(),1)}function d(C,x){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,w=C.onModified(y),E=v[0];return v.push({instance:C,propertyName:x,subscription:w}),O&&(e.propertyLinkMap[c].persistent&&e.propertyLinkMap[c].value!==void 0?C.set(ee({},x,e.propertyLinkMap[c].value)):E&&y(E.instance,!0)),{unsubscribe:function(){return h(C,x)}}}function S(){for(;v.length;)v.pop().subscription.unsubscribe()}var T={bind:d,unbind:h,unsubscribe:S,persistent:f};return e.propertyLinkMap[c]=T,T};function o(){for(var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wn,f=[],g=e.proxyId,v=s(c)||[],p=0;p<v.length;p++){var l=v[p],y=t["get".concat(xe(l))],h=y?y():void 0,d={id:g,name:l,value:h},S=o(l);S.length&&(d.children=S),f.push(d)}return f}t.listPropertyNames=function(){return o().map(function(c){return c.name})},t.getPropertyByName=function(c){return o().find(function(f){return f.name===c})},t.getPropertyDomainByName=function(c){return(n[c]||{}).domain},t.getProxySection=function(){return{id:e.proxyId,name:e.proxyGroup,ui:e.ui,properties:o()}},t.delete=function(){for(var c=Object.keys(e.propertyLinkMap),f=c.length;f--;)e.propertyLinkMap[c[f]].unsubscribe();Object.keys(e.propertyLinkSubscribers).forEach(t.gcPropertyLinks),r()},t.getState=function(){return null};function u(){if(e.links)for(var c=0;c<e.links.length;c++){var f=e.links[c],g=f.link,v=f.property,p=f.persistent,l=f.updateOnBind,y=f.type;if(y==="application"){var h=e.proxyManager.getPropertyLink(g,p);t.registerPropertyLinkForGC(h,"application"),h.bind(t,v,l)}}}Pf(u)}function sh(t,e,r){for(var n=t.delete,a=[],i=Object.keys(r),s=i.length;s--;){var o=i[s],u=r[o],c=u.modelKey,f=u.property,g=u.modified,v=g===void 0?!0:g,p=xe(f),l=xe(o);t["get".concat(l)]=e[c]["get".concat(p)],t["set".concat(l)]=e[c]["set".concat(p)],v&&a.push(e[c].onModified(t.modified))}t.delete=function(){for(;a.length;)a.pop().unsubscribe();n()}}function oh(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};e.this=t;function a(u){for(var c=Object.keys(u),f=c.length;f--;){var g=c[f];e[g].set(u[g])}}for(var i=Object.keys(n),s=i.length,o=function(){var c=i[s];e[c]=n[c];var f=r[c];t["set".concat(xe(c))]=function(g){if(g!==e[c]){e[c]=g;var v=f[g];a(v),t.modified()}}};s--;)o();i.length&&je(t,e,i)}var no=10,ao=40,io=800;function uh(t){var e=0,r=0,n=0,a=0;return"detail"in t&&(r=t.detail),"wheelDelta"in t&&(r=-t.wheelDelta/120),"wheelDeltaY"in t&&(r=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=r,r=0),n=e*no,a=r*no,"deltaY"in t&&(a=t.deltaY),"deltaX"in t&&(n=t.deltaX),(n||a)&&t.deltaMode&&(t.deltaMode===1?(n*=ao,a*=ao):(n*=io,a*=io)),n&&!e&&(e=n<1?-1:1),a&&!r&&(r=a<1?-1:1),{spinX:e,spinY:r,pixelX:n,pixelY:a}}var m={algo:J0,capitalize:Ii,chain:th,debounce:rh,enumToString:q0,event:eh,EVENT_ABORT:Xf,formatBytesToProperUnit:K0,formatNumbersWithThousandSeparator:X0,get:je,getArray:Tn,getCurrentGlobalMTime:W0,getStateArrayMapFunc:$f,isVtkObject:Yf,keystore:qf,measurePromiseExecution:Q0,moveToProtected:ba,newInstance:ve,newTypedArray:dn,newTypedArrayFrom:Af,normalizeWheel:uh,obj:Ne,proxy:ih,proxyPropertyMapping:sh,proxyPropertyState:oh,safeArrays:Hf,set:Ra,setArray:jf,setGet:be,setGetArray:Kf,setImmediate:Pf,setLoggerFunction:A0,throttle:nh,traverseInstanceTree:Vi,TYPED_ARRAYS:Pe,uncapitalize:j0,VOID:_0,vtkDebugMacro:Xt,vtkErrorMacro:P,vtkInfoMacro:$0,vtkLogMacro:H0,vtkOnceErrorMacro:P0,vtkWarningMacro:Va},fh=m.vtkErrorMacro,ch=["Build","Render"];function gh(t,e){e.classHierarchy.push("vtkViewNode"),t.build=function(n){},t.render=function(n){},t.traverse=function(n){var a=n.getTraverseOperation(),i=t[a];if(i){i(n);return}t.apply(n,!0);for(var s=0;s<e.children.length;s++)e.children[s].traverse(n);t.apply(n,!1)},t.apply=function(n,a){var i=t[n.getOperation()];i&&i(a,n)},t.getViewNodeFor=function(n){if(e.renderable===n)return t;for(var a=0;a<e.children.length;++a){var i=e.children[a],s=i.getViewNodeFor(n);if(s)return s}},t.getFirstAncestorOfType=function(n){return e._parent?e._parent.isA(n)?e._parent:e._parent.getFirstAncestorOfType(n):null},t.addMissingNode=function(n){if(n){var a=e._renderableChildMap.get(n);if(a!==void 0)a.setVisited(!0);else{var i=t.createViewNode(n);i&&(i.setParent(t),i.setVisited(!0),e._renderableChildMap.set(n,i),e.children.push(i))}}},t.addMissingNodes=function(n){if(!(!n||!n.length))for(var a=0;a<n.length;++a){var i=n[a],s=e._renderableChildMap.get(i);if(s!==void 0)s.setVisited(!0);else{var o=t.createViewNode(i);o&&(o.setParent(t),o.setVisited(!0),e._renderableChildMap.set(i,o),e.children.push(o))}}},t.addMissingChildren=function(n){if(!(!n||!n.length))for(var a=0;a<n.length;++a){var i=n[a],s=e.children.indexOf(i);s===-1&&(i.setParent(t),e.children.push(i)),i.setVisited(!0)}},t.prepareNodes=function(){for(var n=0;n<e.children.length;++n)e.children[n].setVisited(!1)},t.setVisited=function(n){e.visited=n},t.removeUnusedNodes=function(){for(var n=null,a=0;a<e.children.length;++a){var i=e.children[a],s=i.getVisited();if(s)i.setVisited(!1);else{var o=i.getRenderable();o&&e._renderableChildMap.delete(o),n||(n=[]),n.push(i),i.delete()}}n&&(e.children=e.children.filter(function(u){return!n.includes(u)}))},t.createViewNode=function(n){if(!e.myFactory)return fh("Cannot create view nodes without my own factory"),null;var a=e.myFactory.createNode(n);return a&&a.setRenderable(n),a};var r=t.delete;t.delete=function(){for(var n=0;n<e.children.length;n++)e.children[n].delete();r()}}var vh={renderable:null,myFactory:null,children:[],visited:!1};function Qf(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vh,r),m.obj(t,e),m.event(t,e,"event"),e._renderableChildMap=new Map,m.get(t,e,["visited"]),m.setGet(t,e,["_parent","renderable","myFactory"]),m.getArray(t,e,["children"]),m.moveToProtected(t,e,["parent"]),gh(t,e)}var ph=m.newInstance(Qf,"vtkViewNode"),Se={newInstance:ph,extend:Qf,PASS_TYPES:ch};function lh(t,e){e.overrides||(e.overrides={}),e.classHierarchy.push("vtkViewNodeFactory"),t.createNode=function(r){if(r.isDeleted())return null;for(var n=0,a=r.getClassName(n++),i=!1,s=Object.keys(e.overrides);a&&!i;)s.indexOf(a)!==-1?i=!0:a=r.getClassName(n++);if(!i)return null;var o=e.overrides[a]();return o.setMyFactory(t),o},t.registerOverride=function(r,n){e.overrides[r]=n}}var hh={};function Zf(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,hh,r),m.obj(t,e),lh(t,e)}var yh=m.newInstance(Zf,"vtkViewNodeFactory"),If={newInstance:yh,extend:Zf},Jf=Object.create(null);function Ye(t,e){Jf[t]=e}function dh(t,e){e.classHierarchy.push("vtkOpenGLViewNodeFactory")}var Th={};function ec(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Th,r),e.overrides=Jf,If.extend(t,e,r),dh(t,e)}var Ch=m.newInstance(ec,"vtkOpenGLViewNodeFactory"),Sh={newInstance:Ch,extend:ec};function xh(t,e){e.classHierarchy.push("vtkOpenGLCamera"),t.buildPass=function(r){r&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext())},t.opaquePass=function(r){if(r){var n=e._openGLRenderer.getTiledSizeAndOrigin();e.context.viewport(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize),e.context.scissor(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize)}},t.translucentPass=t.opaquePass,t.zBufferPass=t.opaquePass,t.opaqueZBufferPass=t.opaquePass,t.volumePass=t.opaquePass,t.getKeyMatrices=function(r){if(r!==e.lastRenderer||e._openGLRenderWindow.getMTime()>e.keyMatrixTime.getMTime()||t.getMTime()>e.keyMatrixTime.getMTime()||r.getMTime()>e.keyMatrixTime.getMTime()||e.renderable.getMTime()>e.keyMatrixTime.getMTime()){Fe(e.keyMatrices.wcvc,e.renderable.getViewMatrix()),Ki(e.keyMatrices.normalMatrix,e.keyMatrices.wcvc),Xi(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),ye(e.keyMatrices.wcvc,e.keyMatrices.wcvc);var n=e._openGLRenderer.getAspectRatio();Fe(e.keyMatrices.vcpc,e.renderable.getProjectionMatrix(n,-1,1)),ye(e.keyMatrices.vcpc,e.keyMatrices.vcpc),ke(e.keyMatrices.wcpc,e.keyMatrices.vcpc,e.keyMatrices.wcvc),e.keyMatrixTime.modified(),e.lastRenderer=r}return e.keyMatrices}}var Oh={context:null,lastRenderer:null,keyMatrixTime:null,keyMatrices:null};function mh(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Oh,r),Se.extend(t,e,r),e.keyMatrixTime={},Ne(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(9),vcpc:new Float64Array(16),wcvc:new Float64Array(16),wcpc:new Float64Array(16)},be(t,e,["context","keyMatrixTime"]),xh(t,e)}var wh=ve(mh);Ye("vtkCamera",wh);var Eh=Xt;function Dh(t,e){e.classHierarchy.push("vtkOpenGLRenderer"),t.buildPass=function(r){if(r){if(!e.renderable)return;t.updateLights(),t.prepareNodes(),t.addMissingNode(e.renderable.getActiveCamera()),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes()}},t.updateLights=function(){for(var r=0,n=e.renderable.getLightsByReference(),a=0;a<n.length;++a)n[a].getSwitch()>0&&r++;return r||(Eh("No lights are on, creating one."),e.renderable.createLight()),r},t.zBufferPass=function(r){if(r){var n=0,a=e.context;e.renderable.getTransparent()||(e.context.clearColor(1,0,0,1),n|=a.COLOR_BUFFER_BIT),e.renderable.getPreserveDepthBuffer()||(a.clearDepth(1),n|=a.DEPTH_BUFFER_BIT,e.context.depthMask(!0));var i=t.getTiledSizeAndOrigin();a.enable(a.SCISSOR_TEST),a.scissor(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),a.viewport(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),a.colorMask(!0,!0,!0,!0),n&&a.clear(n),a.enable(a.DEPTH_TEST)}},t.opaqueZBufferPass=function(r){return t.zBufferPass(r)},t.cameraPass=function(r){r&&t.clear()},t.getAspectRatio=function(){var r=e._parent.getSizeByReference(),n=e.renderable.getViewportByReference();return r[0]*(n[2]-n[0])/((n[3]-n[1])*r[1])},t.getTiledSizeAndOrigin=function(){var r=e.renderable.getViewportByReference(),n=[0,0,1,1],a=r[0]-n[0],i=r[1]-n[1],s=e._parent.normalizedDisplayToDisplay(a,i),o=Math.round(s[0]),u=Math.round(s[1]),c=r[2]-n[0],f=r[3]-n[1],g=e._parent.normalizedDisplayToDisplay(c,f),v=Math.round(g[0])-o,p=Math.round(g[1])-u;return v<0&&(v=0),p<0&&(p=0),{usize:v,vsize:p,lowerLeftU:o,lowerLeftV:u}},t.clear=function(){var r=0,n=e.context;if(!e.renderable.getTransparent()){var a=e.renderable.getBackgroundByReference();e.context.clearColor(a[0],a[1],a[2],a[3]),r|=n.COLOR_BUFFER_BIT}e.renderable.getPreserveDepthBuffer()||(n.clearDepth(1),r|=n.DEPTH_BUFFER_BIT,e.context.depthMask(!0)),n.colorMask(!0,!0,!0,!0);var i=t.getTiledSizeAndOrigin();n.enable(n.SCISSOR_TEST),n.scissor(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),n.viewport(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),r&&n.clear(r),n.enable(n.DEPTH_TEST)},t.releaseGraphicsResources=function(){e.selector!==null&&e.selector.releaseGraphicsResources()},t.setOpenGLRenderWindow=function(r){e._openGLRenderWindow!==r&&(t.releaseGraphicsResources(),e._openGLRenderWindow=r,e.context=null,r&&(e.context=e._openGLRenderWindow.getContext()))}}var Mh={context:null,selector:null};function Vh(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Mh,r),Se.extend(t,e,r),je(t,e,["shaderCache"]),be(t,e,["selector"]),ba(t,e,["openGLRenderWindow"]),Dh(t,e)}var Rh=ve(Vh,"vtkOpenGLRenderer");Ye("vtkRenderer",Rh);function bh(t,e){e.classHierarchy.push("vtkOpenGLActor"),t.buildPass=function(r){if(r){e._openGLRenderWindow=t.getFirstAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(var n=0;n<e.children.length;n++){var a=e.children[n];a.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(a)):e.oglmapper=a}}},t.traverseZBufferPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseOpaqueZBufferPass=function(r){return t.traverseOpaquePass(r)},t.traverseOpaquePass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.activateTextures=function(){if(e.ogltextures){e.activeTextures=[];for(var r=0;r<e.ogltextures.length;r++){var n=e.ogltextures[r];n.render(),n.getHandle()&&e.activeTextures.push(n)}}},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},t.zBufferPass=function(r,n){return t.opaquePass(r,n)},t.opaqueZBufferPass=function(r,n){return t.opaquePass(r,n)},t.opaquePass=function(r,n){if(r)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.translucentPass=function(r,n){if(r)e.context.depthMask(!1),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.getKeyMatrices=function(){return e.renderable.getMTime()>e.keyMatrixTime.getMTime()&&(e.renderable.computeMatrix(),Fe(e.keyMatrices.mcwc,e.renderable.getMatrix()),ye(e.keyMatrices.mcwc,e.keyMatrices.mcwc),e.renderable.getIsIdentity()?dr(e.keyMatrices.normalMatrix):(Ki(e.keyMatrices.normalMatrix,e.keyMatrices.mcwc),Xi(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),df(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),e.keyMatrixTime.modified()),e.keyMatrices}}var Lh={context:null,keyMatrixTime:null,keyMatrices:null,activeTextures:null};function Bh(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Lh,r),Se.extend(t,e,r),e.keyMatrixTime={},Ne(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:dr(new Float64Array(9)),mcwc:ae(new Float64Array(16))},be(t,e,["context"]),je(t,e,["activeTextures"]),bh(t,e)}var kh=ve(Bh);Ye("vtkActor",kh);function Nh(t,e){e.classHierarchy.push("vtkOpenGLActor2D"),t.buildPass=function(r){if(r){if(!e.renderable)return;e._openGLRenderWindow=t.getFirstAncestorOfType("vtkOpenGLRenderWindow"),e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(var n=0;n<e.children.length;n++){var a=e.children[n];a.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(a)):e.oglmapper=a}}},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;n.incrementOverlayActorCount()}},t.traverseOpaquePass=function(r){!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseOverlayPass=function(r){!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e._openGLRenderer.getSelector()&&!e.renderable.getNestedPickable||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.activateTextures=function(){if(e.ogltextures){e.activeTextures=[];for(var r=0;r<e.ogltextures.length;r++){var n=e.ogltextures[r];n.render(),n.getHandle()&&e.activeTextures.push(n)}}},t.opaquePass=function(r,n){if(r)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.translucentPass=function(r,n){if(r)e.context.depthMask(!1),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.overlayPass=function(r,n){if(r)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()}}var Fh={context:null,activeTextures:null};function Uh(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Fh,r),Se.extend(t,e,r),be(t,e,["context"]),je(t,e,["activeTextures"]),Nh(t,e)}var Gh=ve(Uh);Ye("vtkActor2D",Gh);function Jn(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function _h(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function tc(t){let e,r,n;t.length!==2?(e=Jn,r=(o,u)=>Jn(t(o),u),n=(o,u)=>t(o)-u):(e=t===Jn||t===_h?t:Wh,r=t,n=t);function a(o,u,c=0,f=o.length){if(c<f){if(e(u,u)!==0)return f;do{const g=c+f>>>1;r(o[g],u)<0?c=g+1:f=g}while(c<f)}return c}function i(o,u,c=0,f=o.length){if(c<f){if(e(u,u)!==0)return f;do{const g=c+f>>>1;r(o[g],u)<=0?c=g+1:f=g}while(c<f)}return c}function s(o,u,c=0,f=o.length){const g=a(o,u,c,f-1);return g>c&&n(o[g-1],u)>-n(o[g],u)?g-1:g}return{left:a,center:s,right:i}}function Wh(){return 0}function zh(t){return t===null?NaN:+t}const Ah=tc(Jn),Hh=Ah.right;tc(zh).center;const $h=Hh,Ph=Math.sqrt(50),jh=Math.sqrt(10),Kh=Math.sqrt(2);function fa(t,e,r){const n=(e-t)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=Ph?10:i>=jh?5:i>=Kh?2:1;let o,u,c;return a<0?(c=Math.pow(10,-a)/s,o=Math.round(t*c),u=Math.round(e*c),o/c<t&&++o,u/c>e&&--u,c=-c):(c=Math.pow(10,a)*s,o=Math.round(t/c),u=Math.round(e/c),o*c<t&&++o,u*c>e&&--u),u<o&&.5<=r&&r<2?fa(t,e,r*2):[o,u,c]}function Xh(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[a,i,s]=n?fa(e,t,r):fa(t,e,r);if(!(i>=a))return[];const o=i-a+1,u=new Array(o);if(n)if(s<0)for(let c=0;c<o;++c)u[c]=(i-c)/-s;else for(let c=0;c<o;++c)u[c]=(i-c)*s;else if(s<0)for(let c=0;c<o;++c)u[c]=(a+c)/-s;else for(let c=0;c<o;++c)u[c]=(a+c)*s;return u}function Ri(t,e,r){return e=+e,t=+t,r=+r,fa(t,e,r)[2]}function Yh(t,e,r){e=+e,t=+t,r=+r;const n=e<t,a=n?Ri(e,t,r):Ri(t,e,r);return(n?-1:1)*(a<0?1/-a:a)}function qh(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Ji(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function rc(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Cn(){}var gn=.7,ca=1/gn,Fr="\\s*([+-]?\\d+)\\s*",vn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Tt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Qh=/^#([0-9a-f]{3,8})$/,Zh=new RegExp(`^rgb\\(${Fr},${Fr},${Fr}\\)$`),Ih=new RegExp(`^rgb\\(${Tt},${Tt},${Tt}\\)$`),Jh=new RegExp(`^rgba\\(${Fr},${Fr},${Fr},${vn}\\)$`),ey=new RegExp(`^rgba\\(${Tt},${Tt},${Tt},${vn}\\)$`),ty=new RegExp(`^hsl\\(${vn},${Tt},${Tt}\\)$`),ry=new RegExp(`^hsla\\(${vn},${Tt},${Tt},${vn}\\)$`),so={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ji(Cn,pn,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:oo,formatHex:oo,formatHex8:ny,formatHsl:ay,formatRgb:uo,toString:uo});function oo(){return this.rgb().formatHex()}function ny(){return this.rgb().formatHex8()}function ay(){return nc(this).formatHsl()}function uo(){return this.rgb().formatRgb()}function pn(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=Qh.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?fo(e):r===3?new Ae(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?En(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?En(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Zh.exec(t))?new Ae(e[1],e[2],e[3],1):(e=Ih.exec(t))?new Ae(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Jh.exec(t))?En(e[1],e[2],e[3],e[4]):(e=ey.exec(t))?En(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=ty.exec(t))?vo(e[1],e[2]/100,e[3]/100,1):(e=ry.exec(t))?vo(e[1],e[2]/100,e[3]/100,e[4]):so.hasOwnProperty(t)?fo(so[t]):t==="transparent"?new Ae(NaN,NaN,NaN,0):null}function fo(t){return new Ae(t>>16&255,t>>8&255,t&255,1)}function En(t,e,r,n){return n<=0&&(t=e=r=NaN),new Ae(t,e,r,n)}function iy(t){return t instanceof Cn||(t=pn(t)),t?(t=t.rgb(),new Ae(t.r,t.g,t.b,t.opacity)):new Ae}function bi(t,e,r,n){return arguments.length===1?iy(t):new Ae(t,e,r,n??1)}function Ae(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}Ji(Ae,bi,rc(Cn,{brighter(t){return t=t==null?ca:Math.pow(ca,t),new Ae(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?gn:Math.pow(gn,t),new Ae(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ae(lr(this.r),lr(this.g),lr(this.b),ga(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:co,formatHex:co,formatHex8:sy,formatRgb:go,toString:go}));function co(){return`#${gr(this.r)}${gr(this.g)}${gr(this.b)}`}function sy(){return`#${gr(this.r)}${gr(this.g)}${gr(this.b)}${gr((isNaN(this.opacity)?1:this.opacity)*255)}`}function go(){const t=ga(this.opacity);return`${t===1?"rgb(":"rgba("}${lr(this.r)}, ${lr(this.g)}, ${lr(this.b)}${t===1?")":`, ${t})`}`}function ga(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function lr(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function gr(t){return t=lr(t),(t<16?"0":"")+t.toString(16)}function vo(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new it(t,e,r,n)}function nc(t){if(t instanceof it)return new it(t.h,t.s,t.l,t.opacity);if(t instanceof Cn||(t=pn(t)),!t)return new it;if(t instanceof it)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,a=Math.min(e,r,n),i=Math.max(e,r,n),s=NaN,o=i-a,u=(i+a)/2;return o?(e===i?s=(r-n)/o+(r<n)*6:r===i?s=(n-e)/o+2:s=(e-r)/o+4,o/=u<.5?i+a:2-i-a,s*=60):o=u>0&&u<1?0:s,new it(s,o,u,t.opacity)}function oy(t,e,r,n){return arguments.length===1?nc(t):new it(t,e,r,n??1)}function it(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}Ji(it,oy,rc(Cn,{brighter(t){return t=t==null?ca:Math.pow(ca,t),new it(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?gn:Math.pow(gn,t),new it(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,a=2*r-n;return new Ae(Ya(t>=240?t-240:t+120,a,n),Ya(t,a,n),Ya(t<120?t+240:t-120,a,n),this.opacity)},clamp(){return new it(po(this.h),Dn(this.s),Dn(this.l),ga(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=ga(this.opacity);return`${t===1?"hsl(":"hsla("}${po(this.h)}, ${Dn(this.s)*100}%, ${Dn(this.l)*100}%${t===1?")":`, ${t})`}`}}));function po(t){return t=(t||0)%360,t<0?t+360:t}function Dn(t){return Math.max(0,Math.min(1,t||0))}function Ya(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const es=t=>()=>t;function uy(t,e){return function(r){return t+r*e}}function fy(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function cy(t){return(t=+t)==1?ac:function(e,r){return r-e?fy(e,r,t):es(isNaN(e)?r:e)}}function ac(t,e){var r=e-t;return r?uy(t,r):es(isNaN(t)?e:t)}const lo=function t(e){var r=cy(e);function n(a,i){var s=r((a=bi(a)).r,(i=bi(i)).r),o=r(a.g,i.g),u=r(a.b,i.b),c=ac(a.opacity,i.opacity);return function(f){return a.r=s(f),a.g=o(f),a.b=u(f),a.opacity=c(f),a+""}}return n.gamma=t,n}(1);function gy(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=t[a]*(1-i)+e[a]*i;return n}}function vy(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function py(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=ts(t[s],e[s]);for(;s<r;++s)i[s]=e[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function ly(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function va(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function hy(t,e){var r={},n={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?r[a]=ts(t[a],e[a]):n[a]=e[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Li=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,qa=new RegExp(Li.source,"g");function yy(t){return function(){return t}}function dy(t){return function(e){return t(e)+""}}function Ty(t,e){var r=Li.lastIndex=qa.lastIndex=0,n,a,i,s=-1,o=[],u=[];for(t=t+"",e=e+"";(n=Li.exec(t))&&(a=qa.exec(e));)(i=a.index)>r&&(i=e.slice(r,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,u.push({i:s,x:va(n,a)})),r=qa.lastIndex;return r<e.length&&(i=e.slice(r),o[s]?o[s]+=i:o[++s]=i),o.length<2?u[0]?dy(u[0].x):yy(e):(e=u.length,function(c){for(var f=0,g;f<e;++f)o[(g=u[f]).i]=g.x(c);return o.join("")})}function ts(t,e){var r=typeof e,n;return e==null||r==="boolean"?es(e):(r==="number"?va:r==="string"?(n=pn(e))?(e=n,lo):Ty:e instanceof pn?lo:e instanceof Date?ly:vy(e)?gy:Array.isArray(e)?py:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?hy:va)(t,e)}function Cy(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function Sy(t){return function(){return t}}function xy(t){return+t}var ho=[0,1];function Br(t){return t}function Bi(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:Sy(isNaN(e)?NaN:.5)}function Oy(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function my(t,e,r){var n=t[0],a=t[1],i=e[0],s=e[1];return a<n?(n=Bi(a,n),i=r(s,i)):(n=Bi(n,a),i=r(i,s)),function(o){return i(n(o))}}function wy(t,e,r){var n=Math.min(t.length,e.length)-1,a=new Array(n),i=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)a[s]=Bi(t[s],t[s+1]),i[s]=r(e[s],e[s+1]);return function(o){var u=$h(t,o,1,n)-1;return i[u](a[u](o))}}function Ey(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Dy(){var t=ho,e=ho,r=ts,n,a,i,s=Br,o,u,c;function f(){var v=Math.min(t.length,e.length);return s!==Br&&(s=Oy(t[0],t[v-1])),o=v>2?wy:my,u=c=null,g}function g(v){return v==null||isNaN(v=+v)?i:(u||(u=o(t.map(n),e,r)))(n(s(v)))}return g.invert=function(v){return s(a((c||(c=o(e,t.map(n),va)))(v)))},g.domain=function(v){return arguments.length?(t=Array.from(v,xy),f()):t.slice()},g.range=function(v){return arguments.length?(e=Array.from(v),f()):e.slice()},g.rangeRound=function(v){return e=Array.from(v),r=Cy,f()},g.clamp=function(v){return arguments.length?(s=v?!0:Br,f()):s!==Br},g.interpolate=function(v){return arguments.length?(r=v,f()):r},g.unknown=function(v){return arguments.length?(i=v,g):i},function(v,p){return n=v,a=p,f()}}function My(){return Dy()(Br,Br)}function Vy(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function pa(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function _r(t){return t=pa(Math.abs(t)),t?t[1]:NaN}function Ry(t,e){return function(r,n){for(var a=r.length,i=[],s=0,o=t[0],u=0;a>0&&o>0&&(u+o+1>n&&(o=Math.max(1,n-u)),i.push(r.substring(a-=o,a+o)),!((u+=o+1)>n));)o=t[s=(s+1)%t.length];return i.reverse().join(e)}}function by(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var Ly=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function la(t){if(!(e=Ly.exec(t)))throw new Error("invalid format: "+t);var e;return new rs({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}la.prototype=rs.prototype;function rs(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}rs.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function By(t){e:for(var e=t.length,r=1,n=-1,a;r<e;++r)switch(t[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(a+1):t}var ic;function ky(t,e){var r=pa(t,e);if(!r)return t+"";var n=r[0],a=r[1],i=a-(ic=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+pa(t,Math.max(0,e+i-1))[0]}function yo(t,e){var r=pa(t,e);if(!r)return t+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const To={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Vy,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>yo(t*100,e),r:yo,s:ky,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Co(t){return t}var So=Array.prototype.map,xo=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Ny(t){var e=t.grouping===void 0||t.thousands===void 0?Co:Ry(So.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",i=t.numerals===void 0?Co:by(So.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"−":t.minus+"",u=t.nan===void 0?"NaN":t.nan+"";function c(g){g=la(g);var v=g.fill,p=g.align,l=g.sign,y=g.symbol,h=g.zero,d=g.width,S=g.comma,T=g.precision,C=g.trim,x=g.type;x==="n"?(S=!0,x="g"):To[x]||(T===void 0&&(T=12),C=!0,x="g"),(h||v==="0"&&p==="=")&&(h=!0,v="0",p="=");var O=y==="$"?r:y==="#"&&/[boxX]/.test(x)?"0"+x.toLowerCase():"",w=y==="$"?n:/[%p]/.test(x)?s:"",E=To[x],V=/[defgprs%]/.test(x);T=T===void 0?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,T)):Math.max(0,Math.min(20,T));function D(M){var L=O,N=w,B,_,A;if(x==="c")N=E(M)+N,M="";else{M=+M;var W=M<0||1/M<0;if(M=isNaN(M)?u:E(Math.abs(M),T),C&&(M=By(M)),W&&+M==0&&l!=="+"&&(W=!1),L=(W?l==="("?l:o:l==="-"||l==="("?"":l)+L,N=(x==="s"?xo[8+ic/3]:"")+N+(W&&l==="("?")":""),V){for(B=-1,_=M.length;++B<_;)if(A=M.charCodeAt(B),48>A||A>57){N=(A===46?a+M.slice(B+1):M.slice(B))+N,M=M.slice(0,B);break}}}S&&!h&&(M=e(M,1/0));var z=L.length+M.length+N.length,R=z<d?new Array(d-z+1).join(v):"";switch(S&&h&&(M=e(R+M,R.length?d-N.length:1/0),R=""),p){case"<":M=L+M+N+R;break;case"=":M=L+R+M+N;break;case"^":M=R.slice(0,z=R.length>>1)+L+M+N+R.slice(z);break;default:M=R+L+M+N;break}return i(M)}return D.toString=function(){return g+""},D}function f(g,v){var p=c((g=la(g),g.type="f",g)),l=Math.max(-8,Math.min(8,Math.floor(_r(v)/3)))*3,y=Math.pow(10,-l),h=xo[8+l/3];return function(d){return p(y*d)+h}}return{format:c,formatPrefix:f}}var Mn,sc,oc;Fy({thousands:",",grouping:[3],currency:["$",""]});function Fy(t){return Mn=Ny(t),sc=Mn.format,oc=Mn.formatPrefix,Mn}function Uy(t){return Math.max(0,-_r(Math.abs(t)))}function Gy(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(_r(e)/3)))*3-_r(Math.abs(t)))}function _y(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,_r(e)-_r(t))+1}function Wy(t,e,r,n){var a=Yh(t,e,r),i;switch(n=la(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(i=Gy(a,s))&&(n.precision=i),oc(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=_y(a,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=Uy(a))&&(n.precision=i-(n.type==="%")*2);break}}return sc(n)}function zy(t){var e=t.domain;return t.ticks=function(r){var n=e();return Xh(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var a=e();return Wy(a[0],a[a.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),a=0,i=n.length-1,s=n[a],o=n[i],u,c,f=10;for(o<s&&(c=s,s=o,o=c,c=a,a=i,i=c);f-- >0;){if(c=Ri(s,o,r),c===u)return n[a]=s,n[i]=o,e(n);if(c>0)s=Math.floor(s/c)*c,o=Math.ceil(o/c)*c;else if(c<0)s=Math.ceil(s*c)/c,o=Math.floor(o*c)/c;else break;u=c}return t},t}function ns(){var t=My();return t.copy=function(){return Ey(t,ns())},qh.apply(t,arguments),zy(t)}var as={exports:{}};as.exports;(function(t){(function(e,r,n){function a(u){var c=this,f=o();c.next=function(){var g=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=g-(c.c=g|0)},c.c=1,c.s0=f(" "),c.s1=f(" "),c.s2=f(" "),c.s0-=f(u),c.s0<0&&(c.s0+=1),c.s1-=f(u),c.s1<0&&(c.s1+=1),c.s2-=f(u),c.s2<0&&(c.s2+=1),f=null}function i(u,c){return c.c=u.c,c.s0=u.s0,c.s1=u.s1,c.s2=u.s2,c}function s(u,c){var f=new a(u),g=c&&c.state,v=f.next;return v.int32=function(){return f.next()*4294967296|0},v.double=function(){return v()+(v()*2097152|0)*11102230246251565e-32},v.quick=v,g&&(typeof g=="object"&&i(g,f),v.state=function(){return i(f,{})}),v}function o(){var u=4022871197,c=function(f){f=String(f);for(var g=0;g<f.length;g++){u+=f.charCodeAt(g);var v=.02519603282416938*u;u=v>>>0,v-=u,v*=u,u=v>>>0,v-=u,u+=v*4294967296}return(u>>>0)*23283064365386963e-26};return c}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.alea=s})(Ze,t,!1)})(as);var Ay=as.exports,is={exports:{}};is.exports;(function(t){(function(e,r,n){function a(o){var u=this,c="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var g=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^g^g>>>8},o===(o|0)?u.x=o:c+=o;for(var f=0;f<c.length+64;f++)u.x^=c.charCodeAt(f)|0,u.next()}function i(o,u){return u.x=o.x,u.y=o.y,u.z=o.z,u.w=o.w,u}function s(o,u){var c=new a(o),f=u&&u.state,g=function(){return(c.next()>>>0)/4294967296};return g.double=function(){do var v=c.next()>>>11,p=(c.next()>>>0)/4294967296,l=(v+p)/(1<<21);while(l===0);return l},g.int32=c.next,g.quick=g,f&&(typeof f=="object"&&i(f,c),g.state=function(){return i(c,{})}),g}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xor128=s})(Ze,t,!1)})(is);var Hy=is.exports,ss={exports:{}};ss.exports;(function(t){(function(e,r,n){function a(o){var u=this,c="";u.next=function(){var g=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(g^g<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,o===(o|0)?u.x=o:c+=o;for(var f=0;f<c.length+64;f++)u.x^=c.charCodeAt(f)|0,f==c.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(o,u){return u.x=o.x,u.y=o.y,u.z=o.z,u.w=o.w,u.v=o.v,u.d=o.d,u}function s(o,u){var c=new a(o),f=u&&u.state,g=function(){return(c.next()>>>0)/4294967296};return g.double=function(){do var v=c.next()>>>11,p=(c.next()>>>0)/4294967296,l=(v+p)/(1<<21);while(l===0);return l},g.int32=c.next,g.quick=g,f&&(typeof f=="object"&&i(f,c),g.state=function(){return i(c,{})}),g}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xorwow=s})(Ze,t,!1)})(ss);var $y=ss.exports,os={exports:{}};os.exports;(function(t){(function(e,r,n){function a(o){var u=this;u.next=function(){var f=u.x,g=u.i,v,p;return v=f[g],v^=v>>>7,p=v^v<<24,v=f[g+1&7],p^=v^v>>>10,v=f[g+3&7],p^=v^v>>>3,v=f[g+4&7],p^=v^v<<7,v=f[g+7&7],v=v^v<<13,p^=v^v<<9,f[g]=p,u.i=g+1&7,p};function c(f,g){var v,p=[];if(g===(g|0))p[0]=g;else for(g=""+g,v=0;v<g.length;++v)p[v&7]=p[v&7]<<15^g.charCodeAt(v)+p[v+1&7]<<13;for(;p.length<8;)p.push(0);for(v=0;v<8&&p[v]===0;++v);for(v==8?p[7]=-1:p[v],f.x=p,f.i=0,v=256;v>0;--v)f.next()}c(u,o)}function i(o,u){return u.x=o.x.slice(),u.i=o.i,u}function s(o,u){o==null&&(o=+new Date);var c=new a(o),f=u&&u.state,g=function(){return(c.next()>>>0)/4294967296};return g.double=function(){do var v=c.next()>>>11,p=(c.next()>>>0)/4294967296,l=(v+p)/(1<<21);while(l===0);return l},g.int32=c.next,g.quick=g,f&&(f.x&&i(f,c),g.state=function(){return i(c,{})}),g}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xorshift7=s})(Ze,t,!1)})(os);var Py=os.exports,us={exports:{}};us.exports;(function(t){(function(e,r,n){function a(o){var u=this;u.next=function(){var f=u.w,g=u.X,v=u.i,p,l;return u.w=f=f+1640531527|0,l=g[v+34&127],p=g[v=v+1&127],l^=l<<13,p^=p<<17,l^=l>>>15,p^=p>>>12,l=g[v]=l^p,u.i=v,l+(f^f>>>16)|0};function c(f,g){var v,p,l,y,h,d=[],S=128;for(g===(g|0)?(p=g,g=null):(g=g+"\0",p=0,S=Math.max(S,g.length)),l=0,y=-32;y<S;++y)g&&(p^=g.charCodeAt((y+32)%g.length)),y===0&&(h=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,y>=0&&(h=h+1640531527|0,v=d[y&127]^=p+h,l=v==0?l+1:0);for(l>=128&&(d[(g&&g.length||0)&127]=-1),l=127,y=4*128;y>0;--y)p=d[l+34&127],v=d[l=l+1&127],p^=p<<13,v^=v<<17,p^=p>>>15,v^=v>>>12,d[l]=p^v;f.w=h,f.X=d,f.i=l}c(u,o)}function i(o,u){return u.i=o.i,u.w=o.w,u.X=o.X.slice(),u}function s(o,u){o==null&&(o=+new Date);var c=new a(o),f=u&&u.state,g=function(){return(c.next()>>>0)/4294967296};return g.double=function(){do var v=c.next()>>>11,p=(c.next()>>>0)/4294967296,l=(v+p)/(1<<21);while(l===0);return l},g.int32=c.next,g.quick=g,f&&(f.X&&i(f,c),g.state=function(){return i(c,{})}),g}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xor4096=s})(Ze,t,!1)})(us);var jy=us.exports,fs={exports:{}};fs.exports;(function(t){(function(e,r,n){function a(o){var u=this,c="";u.next=function(){var g=u.b,v=u.c,p=u.d,l=u.a;return g=g<<25^g>>>7^v,v=v-p|0,p=p<<24^p>>>8^l,l=l-g|0,u.b=g=g<<20^g>>>12^v,u.c=v=v-p|0,u.d=p<<16^v>>>16^l,u.a=l-g|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,o===Math.floor(o)?(u.a=o/4294967296|0,u.b=o|0):c+=o;for(var f=0;f<c.length+20;f++)u.b^=c.charCodeAt(f)|0,u.next()}function i(o,u){return u.a=o.a,u.b=o.b,u.c=o.c,u.d=o.d,u}function s(o,u){var c=new a(o),f=u&&u.state,g=function(){return(c.next()>>>0)/4294967296};return g.double=function(){do var v=c.next()>>>11,p=(c.next()>>>0)/4294967296,l=(v+p)/(1<<21);while(l===0);return l},g.int32=c.next,g.quick=g,f&&(typeof f=="object"&&i(f,c),g.state=function(){return i(c,{})}),g}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.tychei=s})(Ze,t,!1)})(fs);var Ky=fs.exports,uc={exports:{}};const Xy={},Yy=Object.freeze(Object.defineProperty({__proto__:null,default:Xy},Symbol.toStringTag,{value:"Module"})),qy=Sp(Yy);(function(t){(function(e,r,n){var a=256,i=6,s=52,o="random",u=n.pow(a,i),c=n.pow(2,s),f=c*2,g=a-1,v;function p(C,x,O){var w=[];x=x==!0?{entropy:!0}:x||{};var E=d(h(x.entropy?[C,T(r)]:C??S(),3),w),V=new l(w),D=function(){for(var M=V.g(i),L=u,N=0;M<c;)M=(M+N)*a,L*=a,N=V.g(1);for(;M>=f;)M/=2,L/=2,N>>>=1;return(M+N)/L};return D.int32=function(){return V.g(4)|0},D.quick=function(){return V.g(4)/4294967296},D.double=D,d(T(V.S),r),(x.pass||O||function(M,L,N,B){return B&&(B.S&&y(B,V),M.state=function(){return y(V,{})}),N?(n[o]=M,L):M})(D,E,"global"in x?x.global:this==n,x.state)}function l(C){var x,O=C.length,w=this,E=0,V=w.i=w.j=0,D=w.S=[];for(O||(C=[O++]);E<a;)D[E]=E++;for(E=0;E<a;E++)D[E]=D[V=g&V+C[E%O]+(x=D[E])],D[V]=x;(w.g=function(M){for(var L,N=0,B=w.i,_=w.j,A=w.S;M--;)L=A[B=g&B+1],N=N*a+A[g&(A[B]=A[_=g&_+L])+(A[_]=L)];return w.i=B,w.j=_,N})(a)}function y(C,x){return x.i=C.i,x.j=C.j,x.S=C.S.slice(),x}function h(C,x){var O=[],w=typeof C,E;if(x&&w=="object")for(E in C)try{O.push(h(C[E],x-1))}catch{}return O.length?O:w=="string"?C:C+"\0"}function d(C,x){for(var O=C+"",w,E=0;E<O.length;)x[g&E]=g&(w^=x[g&E]*19)+O.charCodeAt(E++);return T(x)}function S(){try{var C;return v&&(C=v.randomBytes)?C=C(a):(C=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(C)),T(C)}catch{var x=e.navigator,O=x&&x.plugins;return[+new Date,e,O,e.screen,T(r)]}}function T(C){return String.fromCharCode.apply(0,C)}if(d(n.random(),r),t.exports){t.exports=p;try{v=qy}catch{}}else n["seed"+o]=p})(typeof self<"u"?self:Ze,[],Math)})(uc);var Qy=uc.exports,Zy=Ay,Iy=Hy,Jy=$y,e1=Py,t1=jy,r1=Ky,jr=Qy;jr.alea=Zy;jr.xor128=Iy;jr.xorwow=Jy;jr.xorshift7=e1;jr.xor4096=t1;jr.tychei=r1;var n1=1e-6,a1=1e-12,Oo=m.vtkWarningMacro;function ki(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3,e=Array(t),r=0;r<t;++r)e[r]=0;return e}function Te(t){return t/180*Math.PI}function ln(t){return t*180/Math.PI}var Vn=Math.round;function at(t){for(var e=1;e<t;)e*=2;return e}function Rn(t){return t===at(t)}function Ni(t,e,r){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r}function Pt(t,e,r){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r}function mo(t,e,r,n){return n[0]=t[0]+e[0]*r,n[1]=t[1]+e[1]*r,n[2]=t[2]+e[2]*r,n}function ie(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function hn(t,e,r){var n=t[1]*e[2]-t[2]*e[1],a=t[2]*e[0]-t[0]*e[2],i=t[0]*e[1]-t[1]*e[0];return r[0]=n,r[1]=a,r[2]=i,r}function fc(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;switch(e){case 1:return Math.abs(t);case 2:return Math.sqrt(t[0]*t[0]+t[1]*t[1]);case 3:return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);default:{for(var r=0,n=0;n<e;n++)r+=t[n]*t[n];return Math.sqrt(r)}}}function Wr(t){var e=fc(t);return e!==0&&(t[0]/=e,t[1]/=e,t[2]/=e),e}function lt(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])+(t[2]-e[2])*(t[2]-e[2])}function i1(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function s1(t){var e=i1(t);return e!==0&&(t[0]/=e,t[1]/=e),e}function ea(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.length===2?e[0][0]*e[1][1]-e[1][0]*e[0][1]:e.length===4?e[0]*e[3]-e[1]*e[2]:Number.NaN}function o1(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n1;if(t.length!==e.length)return!1;function n(a,i){return Math.abs(a-e[i])<=r}return t.every(n)}var u1=o1;function Qa(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!"".concat(t).includes("e"))return+"".concat(Math.round("".concat(t,"e+").concat(e)),"e-").concat(e);var r="".concat(t).split("e"),n="";return+r[1]+e>0&&(n="+"),+"".concat(Math.round("".concat(+r[0],"e").concat(n).concat(+r[1]+e)),"e-").concat(e)}function wo(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return e[0]=Qa(t[0],r),e[1]=Qa(t[1],r),e[2]=Qa(t[2],r),e}function f1(t,e,r){var n,a,i,s,o=0,u,c,f,g=ki(r);for(n=0;n<r;n++){for(s=0,a=0;a<r;a++)(f=Math.abs(t[n*r+a]))>s&&(s=f);if(s===0)return Oo("Unable to factor linear system"),0;g[n]=1/s}for(a=0;a<r;a++){for(n=0;n<a;n++){for(u=t[n*r+a],i=0;i<n;i++)u-=t[n*r+i]*t[i*r+a];t[n*r+a]=u}for(s=0,n=a;n<r;n++){for(u=t[n*r+a],i=0;i<a;i++)u-=t[n*r+i]*t[i*r+a];t[n*r+a]=u,(c=g[n]*Math.abs(u))>=s&&(s=c,o=n)}if(a!==o){for(i=0;i<r;i++)c=t[o*r+i],t[o*r+i]=t[a*r+i],t[a*r+i]=c;g[o]=g[a]}if(e[a]=o,Math.abs(t[a*r+a])<=a1)return Oo("Unable to factor linear system"),0;if(a!==r-1)for(c=1/t[a*r+a],n=a+1;n<r;n++)t[n*r+a]*=c}return 1}function c1(t,e,r,n){var a,i,s,o,u;for(s=-1,a=0;a<n;a++){if(o=e[a],u=r[o],r[o]=r[a],s>=0)for(i=s;i<=a-1;i++)u-=t[a*n+i]*r[i];else u!==0&&(s=a);r[a]=u}for(a=n-1;a>=0;a--){for(u=r[a],i=a+1;i<n;i++)u-=t[a*n+i]*r[i];r[a]=u/t[a*n+a]}}function g1(t,e,r){if(r===2){var n=ki(2),a=ea(t[0],t[1],t[2],t[3]);return a===0?0:(n[0]=(t[3]*e[0]-t[1]*e[1])/a,n[1]=(-(t[2]*e[0])+t[0]*e[1])/a,e[0]=n[0],e[1]=n[1],1)}if(r===1)return t[0]===0?0:(e[0]/=t[0],1);var i=ki(r);return f1(t,i,r)===0?0:(c1(t,i,e,r),1)}function v1(t,e){var r=$e(t,3),n=r[0],a=r[1],i=r[2],s=1/3,o=1/6,u=2/3,c=5/6,f,g,v;n>o&&n<=s?(g=1,f=(s-n)/o,v=0):n>s&&n<=.5?(g=1,v=(n-s)/o,f=0):n>.5&&n<=u?(v=1,g=(u-n)/o,f=0):n>u&&n<=c?(v=1,f=(n-u)/o,g=0):n>c&&n<=1?(f=1,v=(1-n)/o,g=0):(f=1,g=n/o,v=0),f=a*f+(1-a),g=a*g+(1-a),v=a*v+(1-a),f*=i,g*=i,v*=i,e[0]=f,e[1]=g,e[2]=v}function La(t){return t[0]=1,t[1]=-1,t[2]=1,t[3]=-1,t[4]=1,t[5]=-1,t}function Za(t){return!(t[1]-t[0]<0)}function Ia(t,e,r){return t<e?e:t>r?r:t}function Eo(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[0,0,0];return n[0]=Ia(t[0],e[0],r[0]),n[1]=Ia(t[1],e[1],r[1]),n[2]=Ia(t[2],e[2],r[2]),n}var p1=Number.isNaN,cc=p1;function gc(){return[].concat([Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE])}function Do(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function l1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Do(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Do(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Fi=1e-6,vc="coincide",pc="disjoint";function h1(t,e,r){return t[0]*(r[0]-e[0])+t[1]*(r[1]-e[1])+t[2]*(r[2]-e[2])}function lc(t,e,r){var n=r[0]*(t[0]-e[0])+r[1]*(t[1]-e[1])+r[2]*(t[2]-e[2]);return Math.abs(n)}function hc(t,e,r,n){var a=[];Pt(t,e,a);var i=ie(r,a);n[0]=t[0]-i*r[0],n[1]=t[1]-i*r[1],n[2]=t[2]-i*r[2]}function yc(t,e,r){var n=ie(t,e),a=ie(e,e);return a===0&&(a=1),r[0]=t[0]-n*e[0]/a,r[1]=t[1]-n*e[1]/a,r[2]=t[2]-n*e[2]/a,r}function dc(t,e,r,n){var a=[];Pt(t,e,a);var i=ie(r,a),s=ie(r,r);s!==0?(n[0]=t[0]-i*r[0]/s,n[1]=t[1]-i*r[1]/s,n[2]=t[2]-i*r[2]/s):(n[0]=t[0],n[1]=t[1],n[2]=t[2])}function Tc(t,e,r,n){var a={intersection:!1,betweenPoints:!1,t:Number.MAX_VALUE,x:[]},i=[],s=[];Pt(e,t,i),Pt(r,t,s);var o=ie(n,s),u=ie(n,i),c,f;return u<0?c=-u:c=u,o<0?f=-o*Fi:f=o*Fi,c<=f||(a.t=o/u,a.x[0]=t[0]+a.t*i[0],a.x[1]=t[1]+a.t*i[1],a.x[2]=t[2]+a.t*i[2],a.intersection=!0,a.betweenPoints=a.t>=0&&a.t<=1),a}function Cc(t,e,r,n){var a={intersection:!1,l0:[],l1:[],error:null},i=[];hn(e,n,i);var s=i.map(function(v){return Math.abs(v)});if(s[0]+s[1]+s[2]<Fi){var o=[];return Pt(t,r,o),ie(e,o)===0?a.error=vc:a.error=pc,a}var u;s[0]>s[1]&&s[0]>s[2]?u="x":s[1]>s[2]?u="y":u="z";var c=[],f=-ie(e,t),g=-ie(n,r);switch(u){case"x":c[0]=0,c[1]=(g*e[2]-f*n[2])/i[0],c[2]=(f*n[1]-g*e[1])/i[0];break;case"y":c[0]=(f*n[2]-g*e[2])/i[1],c[1]=0,c[2]=(g*e[0]-f*n[0])/i[1];break;case"z":c[0]=(g*e[1]-f*n[1])/i[2],c[1]=(f*n[0]-g*e[0])/i[2],c[2]=0;break}return a.l0=c,Ni(c,i,a.l1),a.intersection=!0,a}var y1={evaluate:h1,distanceToPlane:lc,projectPoint:hc,projectVector:yc,generalizedProjectPoint:dc,intersectWithLine:Tc,intersectWithPlane:Cc,DISJOINT:pc,COINCIDE:vc};function d1(t,e){e.classHierarchy.push("vtkPlane"),t.distanceToPlane=function(r){return lc(r,e.origin,e.normal)},t.projectPoint=function(r,n){hc(r,e.origin,e.normal,n)},t.projectVector=function(r,n){return yc(r,e.normal,n)},t.push=function(r){if(r!==0)for(var n=0;n<3;n++)e.origin[n]+=r*e.normal[n]},t.generalizedProjectPoint=function(r,n){dc(r,e.origin,e.normal,n)},t.evaluateFunction=function(r,n,a){return Array.isArray(r)?e.normal[0]*(r[0]-e.origin[0])+e.normal[1]*(r[1]-e.origin[1])+e.normal[2]*(r[2]-e.origin[2]):e.normal[0]*(r-e.origin[0])+e.normal[1]*(n-e.origin[1])+e.normal[2]*(a-e.origin[2])},t.evaluateGradient=function(r){var n=[e.normal[0],e.normal[1],e.normal[2]];return n},t.intersectWithLine=function(r,n){return Tc(r,n,e.origin,e.normal)},t.intersectWithPlane=function(r,n){return Cc(r,n,e.origin,e.normal)}}var T1={normal:[0,0,1],origin:[0,0,0]};function Sc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,T1,r),m.obj(t,e),m.setGetArray(t,e,["normal","origin"],3),d1(t,e)}var C1=m.newInstance(Sc,"vtkPlane"),zr=l1({newInstance:C1,extend:Sc},y1);function Mo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function S1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Mo(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mo(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Ba=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];function xc(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function Lt(t){return t[0]<=t[1]&&t[2]<=t[3]&&t[4]<=t[5]}function cs(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function gs(t){return cs(t,Ba)}function ha(t,e,r,n){var a=$e(t,6),i=a[0],s=a[1],o=a[2],u=a[3],c=a[4],f=a[5];return t[0]=i<e?i:e,t[1]=s>e?s:e,t[2]=o<r?o:r,t[3]=u>r?u:r,t[4]=c<n?c:n,t[5]=f>n?f:n,t}function vs(t,e){if(e.length===0)return t;if(Array.isArray(e[0]))for(var r=0;r<e.length;++r)ha.apply(void 0,[t].concat(Y(e[r])));else for(var n=0;n<e.length;n+=3)ha.apply(void 0,[t].concat(Y(e.slice(n,n+3))));return t}function Oc(t,e,r,n,a,i,s){var o=$e(t,6),u=o[0],c=o[1],f=o[2],g=o[3],v=o[4],p=o[5];return s===void 0?(t[0]=Math.min(e[0],u),t[1]=Math.max(e[1],c),t[2]=Math.min(e[2],f),t[3]=Math.max(e[3],g),t[4]=Math.min(e[4],v),t[5]=Math.max(e[5],p)):(t[0]=Math.min(e,u),t[1]=Math.max(r,c),t[2]=Math.min(n,f),t[3]=Math.max(a,g),t[4]=Math.min(i,v),t[5]=Math.max(s,p)),t}function mc(t,e,r,n){var a=$e(t,6),i=a[0],s=a[1],o=a[2],u=a[3],c=a[4],f=a[5];return t[0]=e,t[1]=e>s?e:s,t[2]=r,t[3]=r>u?r:u,t[4]=n,t[5]=n>f?n:f,i!==e||o!==r||c!==n}function wc(t,e,r,n){var a=$e(t,6),i=a[0],s=a[1],o=a[2],u=a[3],c=a[4],f=a[5];return t[0]=e<i?e:i,t[1]=e,t[2]=r<o?r:o,t[3]=r,t[4]=n<c?n:c,t[5]=n,s!==e||u!==r||f!==n}function Ec(t,e){return t[0]-=e,t[1]+=e,t[2]-=e,t[3]+=e,t[4]-=e,t[5]+=e,t}function ps(t,e,r,n){return Lt(t)?(e>=0?(t[0]*=e,t[1]*=e):(t[0]=e*t[1],t[1]=e*t[0]),r>=0?(t[2]*=r,t[3]*=r):(t[2]=r*t[3],t[3]=r*t[2]),n>=0?(t[4]*=n,t[5]*=n):(t[4]=n*t[5],t[5]=n*t[4]),!0):!1}function ls(t){return[.5*(t[0]+t[1]),.5*(t[2]+t[3]),.5*(t[4]+t[5])]}function x1(t,e,r,n){if(!Lt(t))return!1;var a=ls(t);return t[0]-=a[0],t[1]-=a[0],t[2]-=a[1],t[3]-=a[1],t[4]-=a[2],t[5]-=a[2],ps(t,e,r,n),t[0]+=a[0],t[1]+=a[0],t[2]+=a[1],t[3]+=a[1],t[4]+=a[2],t[5]+=a[2],!0}function on(t,e){return t[e*2+1]-t[e*2]}function ka(t){return[on(t,0),on(t,1),on(t,2)]}function Dc(t){return t.slice(0,2)}function Mc(t){return t.slice(2,4)}function Vc(t){return t.slice(4,6)}function Rc(t){var e=ka(t);return e[0]>e[1]?e[0]>e[2]?e[0]:e[2]:e[1]>e[2]?e[1]:e[2]}function bc(t){if(Lt(t)){var e=ka(t);return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}return null}function hs(t){return[t[0],t[2],t[4]]}function ys(t){return[t[1],t[3],t[5]]}function bn(t,e){return t<=0&&e>=0||t>=0&&e<=0}function ds(t,e){for(var r=0,n=0;n<2;n++)for(var a=2;a<4;a++)for(var i=4;i<6;i++)e[r]=[t[n],t[a],t[i]],r++;return e}function Lc(t,e,r){return e[0]=t[0],e[1]=t[2],e[2]=t[4],r[0]=t[1],r[1]=t[3],r[2]=t[5],e}function Bc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];r.length<6&&gs(r);for(var n=ds(t,[]),a=0;a<n.length;++a)ce(n[a],n[a],e);return vs(r,n)}function kc(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e[0]=.5*(t[1]-t[0]),e[1]=.5*(t[3]-t[2]),e[2]=.5*(t[5]-t[4]),e}function Nc(t,e,r,n){for(var a=[].concat(Ba),i=t.getData(),s=0;s<i.length;s+=3){var o=[i[s],i[s+1],i[s+2]],u=ie(o,e);a[0]=Math.min(u,a[0]),a[1]=Math.max(u,a[1]);var c=ie(o,r);a[2]=Math.min(c,a[2]),a[3]=Math.max(c,a[3]);var f=ie(o,n);a[4]=Math.min(f,a[4]),a[5]=Math.max(f,a[5])}return a}function Fc(t,e,r,n,a){for(var i=!0,s=[],o=0,u=[],c=[0,0,0],f=0,g=1,v=2,p=0;p<3;p++)e[p]<t[2*p]?(s[p]=g,c[p]=t[2*p],i=!1):e[p]>t[2*p+1]?(s[p]=f,c[p]=t[2*p+1],i=!1):s[p]=v;if(i)return n[0]=e[0],n[1]=e[1],n[2]=e[2],a[0]=0,1;for(var l=0;l<3;l++)s[l]!==v&&r[l]!==0?u[l]=(c[l]-e[l])/r[l]:u[l]=-1;for(var y=0;y<3;y++)u[o]<u[y]&&(o=y);if(u[o]>1||u[o]<0)return 0;a[0]=u[o];for(var h=0;h<3;h++)if(o!==h){if(n[h]=e[h]+u[o]*r[h],n[h]<t[2*h]||n[h]>t[2*h+1])return 0}else n[h]=c[h];return 1}function Uc(t,e,r){for(var n=[],a=0,i=1,s=1,o=4;o<=5;++o){n[2]=t[o];for(var u=2;u<=3;++u){n[1]=t[u];for(var c=0;c<=1;++c)if(n[0]=t[c],a=zr.evaluate(r,e,n),s&&(i=a>=0?1:-1,s=0),a===0||i>0&&a<0||i<0&&a>0)return 1}}return 0}function Gc(t,e){if(!(Lt(t)&&Lt(e)))return!1;for(var r=[0,0,0,0,0,0],n,a=0;a<3;a++)if(n=!1,e[a*2]>=t[a*2]&&e[a*2]<=t[a*2+1]?(n=!0,r[a*2]=e[a*2]):t[a*2]>=e[a*2]&&t[a*2]<=e[a*2+1]&&(n=!0,r[a*2]=t[a*2]),e[a*2+1]>=t[a*2]&&e[a*2+1]<=t[a*2+1]?(n=!0,r[a*2+1]=e[2*a+1]):t[a*2+1]>=e[a*2]&&t[a*2+1]<=e[a*2+1]&&(n=!0,r[a*2+1]=t[a*2+1]),!n)return!1;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],!0}function ya(t,e){if(!(Lt(t)&&Lt(e)))return!1;for(var r=0;r<3;r++)if(!(e[r*2]>=t[r*2]&&e[r*2]<=t[r*2+1])&&!(t[r*2]>=e[r*2]&&t[r*2]<=e[r*2+1])&&!(e[r*2+1]>=t[r*2]&&e[r*2+1]<=t[r*2+1])&&!(t[r*2+1]>=e[r*2]&&t[r*2+1]<=e[r*2+1]))return!1;return!0}function da(t,e,r,n){return!(e<t[0]||e>t[1]||r<t[2]||r>t[3]||n<t[4]||n>t[5])}function O1(t,e){return!(!ya(t,e)||!da.apply(void 0,[t].concat(Y(hs(e))))||!da.apply(void 0,[t].concat(Y(ys(e)))))}function _c(t,e,r){for(var n=[[0,1,2,3,4,5,6,7],[0,1,4,5,2,3,6,7],[0,2,4,6,1,3,5,7]],a=[0,0,0,0,0,0,0,0],i=0,s=0;s<2;s++)for(var o=2;o<4;o++)for(var u=4;u<6;u++){var c=[t[s],t[o],t[u]];a[i++]=zr.evaluate(r,e,c)}for(var f=2;f--&&!(bn(a[n[f][0]],a[n[f][4]])&&bn(a[n[f][1]],a[n[f][5]])&&bn(a[n[f][2]],a[n[f][6]])&&bn(a[n[f][3]],a[n[f][7]])););if(f<0)return!1;for(var g=Math.sign(r[f]),v=Math.abs((t[f*2+1]-t[f*2])*r[f]),p=g>0?1:0,l=0;l<4;l++)if(v!==0){var y=Math.abs(a[n[f][l]])/v;g>0&&y<p&&(p=y),g<0&&y>p&&(p=y)}var h=(1-p)*t[f*2]+p*t[f*2+1];return g>0?t[f*2]=h:t[f*2+1]=h,!0}var m1=function(){function t(e){Da(this,t),this.bounds=e,this.bounds||(this.bounds=new Float64Array(Ba))}return Ma(t,[{key:"getBounds",value:function(){return this.bounds}},{key:"equals",value:function(r){return xc(this.bounds,r)}},{key:"isValid",value:function(){return Lt(this.bounds)}},{key:"setBounds",value:function(r){return cs(this.bounds,r)}},{key:"reset",value:function(){return gs(this.bounds)}},{key:"addPoint",value:function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return ha.apply(void 0,[this.bounds].concat(n))}},{key:"addPoints",value:function(r){return vs(this.bounds,r)}},{key:"addBounds",value:function(r,n,a,i,s,o){return Oc(this.bounds,r,n,a,i,s,o)}},{key:"setMinPoint",value:function(r,n,a){return mc(this.bounds,r,n,a)}},{key:"setMaxPoint",value:function(r,n,a){return wc(this.bounds,r,n,a)}},{key:"inflate",value:function(r){return Ec(this.bounds,r)}},{key:"scale",value:function(r,n,a){return ps(this.bounds,r,n,a)}},{key:"getCenter",value:function(){return ls(this.bounds)}},{key:"getLength",value:function(r){return on(this.bounds,r)}},{key:"getLengths",value:function(){return ka(this.bounds)}},{key:"getMaxLength",value:function(){return Rc(this.bounds)}},{key:"getDiagonalLength",value:function(){return bc(this.bounds)}},{key:"getMinPoint",value:function(){return hs(this.bounds)}},{key:"getMaxPoint",value:function(){return ys(this.bounds)}},{key:"getXRange",value:function(){return Dc(this.bounds)}},{key:"getYRange",value:function(){return Mc(this.bounds)}},{key:"getZRange",value:function(){return Vc(this.bounds)}},{key:"getCorners",value:function(r){return ds(this.bounds,r)}},{key:"computeCornerPoints",value:function(r,n){return Lc(this.bounds,r,n)}},{key:"computeLocalBounds",value:function(r,n,a){return Nc(this.bounds,r,n,a)}},{key:"transformBounds",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Bc(this.bounds,r,n)}},{key:"computeScale3",value:function(r){return kc(this.bounds,r)}},{key:"cutWithPlane",value:function(r,n){return _c(this.bounds,r,n)}},{key:"intersectBox",value:function(r,n,a,i){return Fc(this.bounds,r,n,a,i)}},{key:"intersectPlane",value:function(r,n){return Uc(this.bounds,r,n)}},{key:"intersect",value:function(r){return Gc(this.bounds,r)}},{key:"intersects",value:function(r){return ya(this.bounds,r)}},{key:"containsPoint",value:function(r,n,a){return da(this.bounds,r,n,a)}},{key:"contains",value:function(r){return ya(this.bounds,r)}}]),t}();function w1(t){var e=t&&t.bounds;return new m1(e)}var E1={equals:xc,isValid:Lt,setBounds:cs,reset:gs,addPoint:ha,addPoints:vs,addBounds:Oc,setMinPoint:mc,setMaxPoint:wc,inflate:Ec,scale:ps,scaleAboutCenter:x1,getCenter:ls,getLength:on,getLengths:ka,getMaxLength:Rc,getDiagonalLength:bc,getMinPoint:hs,getMaxPoint:ys,getXRange:Dc,getYRange:Mc,getZRange:Vc,getCorners:ds,computeCornerPoints:Lc,computeLocalBounds:Nc,transformBounds:Bc,computeScale3:kc,cutWithPlane:_c,intersectBox:Fc,intersectPlane:Uc,intersect:Gc,intersects:ya,containsPoint:da,contains:O1,INIT_BOUNDS:Ba},Ce=S1({newInstance:w1},E1),D1={DISPLAY:0,WORLD:1},Wc={CoordinateSystem:D1};function Vo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function M1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vo(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vo(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Ui=Wc.CoordinateSystem;function Ro(t){return function(){return m.vtkErrorMacro("vtkProp::".concat(t," - NOT IMPLEMENTED"))}}function V1(t,e){e.classHierarchy.push("vtkProp"),t.getMTime=function(){for(var r=e.mtime,n=0;n<e.textures.length;++n){var a=e.textures[n].getMTime();a>r&&(r=a)}return r},t.processSelectorPixelBuffers=function(r,n){},t.getNestedProps=function(){return null},t.getActors=function(){return[]},t.getActors2D=function(){return[]},t.getVolumes=function(){return[]},t.pick=Ro("pick"),t.hasKey=Ro("hasKey"),t.getNestedVisibility=function(){return e.visibility&&(!e._parentProp||e._parentProp.getNestedVisibility())},t.getNestedPickable=function(){return e.pickable&&(!e._parentProp||e._parentProp.getNestedPickable())},t.getNestedDragable=function(){return e.dragable&&(!e._parentProp||e._parentProp.getNestedDragable())},t.getRedrawMTime=function(){return e.mtime},t.setEstimatedRenderTime=function(r){e.estimatedRenderTime=r,e.savedEstimatedRenderTime=r},t.restoreEstimatedRenderTime=function(){e.estimatedRenderTime=e.savedEstimatedRenderTime},t.addEstimatedRenderTime=function(r){e.estimatedRenderTime+=r},t.setAllocatedRenderTime=function(r){e.allocatedRenderTime=r,e.savedEstimatedRenderTime=e.estimatedRenderTime,e.estimatedRenderTime=0},t.getSupportsSelection=function(){return!1},t.getTextures=function(){return e.textures},t.hasTexture=function(r){return e.textures.indexOf(r)!==-1},t.addTexture=function(r){r&&!t.hasTexture(r)&&(e.textures=e.textures.concat(r),t.modified())},t.removeTexture=function(r){var n=e.textures.filter(function(a){return a!==r});e.textures.length!==n.length&&(e.textures=n,t.modified())},t.removeAllTextures=function(){e.textures=[],t.modified()},t.setCoordinateSystemToWorld=function(){return t.setCoordinateSystem(Ui.WORLD)},t.setCoordinateSystemToDisplay=function(){return t.setCoordinateSystem(Ui.DISPLAY)}}var R1={allocatedRenderTime:10,coordinateSystem:Ui.WORLD,dragable:!0,estimatedRenderTime:0,paths:null,pickable:!0,renderTimeMultiplier:1,savedEstimatedRenderTime:0,textures:[],useBounds:!0,visibility:!0};function zc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,R1,r),m.obj(t,e),m.get(t,e,["estimatedRenderTime","allocatedRenderTime"]),m.setGet(t,e,["_parentProp","coordinateSystem","dragable","pickable","renderTimeMultiplier","useBounds","visibility"]),m.moveToProtected(t,e,["parentProp"]),V1(t,e)}var b1=m.newInstance(zc,"vtkProp"),Sn=M1({newInstance:b1,extend:zc},Wc);function L1(t,e){e.classHierarchy.push("vtkProp3D"),t.addPosition=function(n){e.position=e.position.map(function(a,i){return a+n[i]}),t.modified()},t.getOrientationWXYZ=function(){var n=yr();Df(n,e.rotation);var a=new Float64Array(3),i=O0(a,n);return[ln(i),a[0],a[1],a[2]]},t.rotateX=function(n){n!==0&&(Cf(e.rotation,e.rotation,Te(n)),t.modified())},t.rotateY=function(n){n!==0&&(Sf(e.rotation,e.rotation,Te(n)),t.modified())},t.rotateZ=function(n){n!==0&&(xf(e.rotation,e.rotation,Te(n)),t.modified())},t.rotateWXYZ=function(n,a,i,s){if(!(n===0||a===0&&i===0&&s===0)){var o=Te(n),u=yr();Zi(u,[a,i,s],o);var c=new Float64Array(16);Qi(c,u),ke(e.rotation,e.rotation,c),t.modified()}},t.setOrientation=function(n,a,i){return n===e.orientation[0]&&a===e.orientation[1]&&i===e.orientation[2]?!1:(e.orientation=[n,a,i],ae(e.rotation),t.rotateZ(i),t.rotateX(n),t.rotateY(a),t.modified(),!0)},t.setUserMatrix=function(n){return u1(e.userMatrix,n)?!1:(Fe(e.userMatrix,n),t.modified(),!0)},t.getMatrix=function(){return t.computeMatrix(),e.matrix},t.computeMatrix=function(){if(t.getMTime()>e.matrixMTime.getMTime()){ae(e.matrix),e.userMatrix&&ke(e.matrix,e.matrix,e.userMatrix),me(e.matrix,e.matrix,e.origin),me(e.matrix,e.matrix,e.position),ke(e.matrix,e.matrix,e.rotation),Gr(e.matrix,e.matrix,e.scale),me(e.matrix,e.matrix,[-e.origin[0],-e.origin[1],-e.origin[2]]),ye(e.matrix,e.matrix),e.isIdentity=!0;for(var n=0;n<4;++n)for(var a=0;a<4;++a)(n===a?1:0)!==e.matrix[n+a*4]&&(e.isIdentity=!1);e.matrixMTime.modified()}},t.getCenter=function(){return Ce.getCenter(e.bounds)},t.getLength=function(){return Ce.getLength(e.bounds)},t.getXRange=function(){return Ce.getXRange(e.bounds)},t.getYRange=function(){return Ce.getYRange(e.bounds)},t.getZRange=function(){return Ce.getZRange(e.bounds)},t.getUserMatrix=function(){return e.userMatrix};function r(){t.computeMatrix()}t.onModified(r)}var B1={origin:[0,0,0],position:[0,0,0],orientation:[0,0,0],rotation:null,scale:[1,1,1],bounds:[1,-1,1,-1,1,-1],userMatrix:null,userMatrixMTime:null,cachedProp3D:null,isIdentity:!0,matrixMTime:null};function Ac(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,B1,r),Sn.extend(t,e,r),e.matrixMTime={},m.obj(e.matrixMTime),m.get(t,e,["bounds","isIdentity"]),m.getArray(t,e,["orientation"]),m.setGetArray(t,e,["origin","position","scale"],3),e.matrix=ae(new Float64Array(16)),e.rotation=ae(new Float64Array(16)),e.userMatrix=ae(new Float64Array(16)),e.transform=null,L1(t,e)}var k1=m.newInstance(Ac,"vtkProp3D"),N1={newInstance:k1,extend:Ac},Hc={FLAT:0,GOURAUD:1,PHONG:2},Ie={POINTS:0,WIREFRAME:1,SURFACE:2},F1=Hc,Ts={Shading:Hc,Representation:Ie,Interpolation:F1};function bo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function U1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bo(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bo(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var en=Ts.Representation,tn=Ts.Interpolation;function Lo(t){return function(){return m.vtkErrorMacro("vtkProperty::".concat(t," - NOT IMPLEMENTED"))}}function G1(t,e){e.classHierarchy.push("vtkProperty"),t.setColor=function(r,n,a){Array.isArray(r)?(e.color[0]!==r[0]||e.color[1]!==r[1]||e.color[2]!==r[2])&&(e.color[0]=r[0],e.color[1]=r[1],e.color[2]=r[2],t.modified()):(e.color[0]!==r||e.color[1]!==n||e.color[2]!==a)&&(e.color[0]=r,e.color[1]=n,e.color[2]=a,t.modified()),t.setDiffuseColor(e.color),t.setAmbientColor(e.color),t.setSpecularColor(e.color)},t.computeCompositeColor=Lo("ComputeCompositeColor"),t.getColor=function(){var r=0;e.ambient+e.diffuse+e.specular>0&&(r=1/(e.ambient+e.diffuse+e.specular));for(var n=0;n<3;n++)e.color[n]=r*(e.ambient*e.ambientColor[n]+e.diffuse*e.diffuseColor[n]+e.specular*e.specularColor[n]);return[].concat(e.color)},t.setSpecularPower=function(r){var n=1/Math.max(1,r);(e.roughness!==n||e.specularPower!==r)&&(e.specularPower=r,e.roughness=n,t.modified())},t.addShaderVariable=Lo("AddShaderVariable"),t.setInterpolationToFlat=function(){return t.setInterpolation(tn.FLAT)},t.setInterpolationToGouraud=function(){return t.setInterpolation(tn.GOURAUD)},t.setInterpolationToPhong=function(){return t.setInterpolation(tn.PHONG)},t.getInterpolationAsString=function(){return m.enumToString(tn,e.interpolation)},t.setRepresentationToWireframe=function(){return t.setRepresentation(en.WIREFRAME)},t.setRepresentationToSurface=function(){return t.setRepresentation(en.SURFACE)},t.setRepresentationToPoints=function(){return t.setRepresentation(en.POINTS)},t.getRepresentationAsString=function(){return m.enumToString(en,e.representation)}}var _1={color:[1,1,1],ambientColor:[1,1,1],diffuseColor:[1,1,1],specularColor:[1,1,1],edgeColor:[0,0,0],ambient:0,diffuse:1,metallic:0,roughness:.6,normalStrength:1,emission:1,baseIOR:1.45,specular:0,specularPower:1,opacity:1,interpolation:tn.GOURAUD,representation:en.SURFACE,edgeVisibility:!1,backfaceCulling:!1,frontfaceCulling:!1,pointSize:1,lineWidth:1,lighting:!0,shading:!1,materialName:null};function $c(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_1,r),m.obj(t,e),m.setGet(t,e,["lighting","interpolation","ambient","diffuse","metallic","roughness","normalStrength","emission","baseIOR","specular","specularPower","opacity","edgeVisibility","lineWidth","pointSize","backfaceCulling","frontfaceCulling","representation","diffuseTexture","metallicTexture","roughnessTexture","normalTexture","ambientOcclusionTexture","emissionTexture"]),m.setGetArray(t,e,["ambientColor","specularColor","diffuseColor","edgeColor"],3),G1(t,e)}var W1=m.newInstance($c,"vtkProperty"),Tr=U1({newInstance:W1,extend:$c},Ts);function Bo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function z1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Bo(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Bo(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var A1=m.vtkDebugMacro;function H1(t,e){e.classHierarchy.push("vtkActor");var r=z1({},t);t.getActors=function(){return[t]},t.getIsOpaque=function(){if(e.forceOpaque)return!0;if(e.forceTranslucent)return!1;e.property||t.getProperty();var n=e.property.getOpacity()>=1;return n=n&&(!e.texture||!e.texture.isTranslucent()),n=n&&(!e.mapper||e.mapper.getIsOpaque()),n},t.hasTranslucentPolygonalGeometry=function(){return e.mapper===null?!1:(e.property===null&&t.setProperty(t.makeProperty()),!t.getIsOpaque())},t.makeProperty=Tr.newInstance,t.getProperty=function(){return e.property===null&&(e.property=t.makeProperty()),e.property},t.getBounds=function(){if(e.mapper===null)return e.bounds;var n=e.mapper.getBounds();if(!n||n.length!==6)return n;if(n[0]>n[1])return e.mapperBounds=n.concat(),e.bounds=[1,-1,1,-1,1,-1],e.boundsMTime.modified(),n;if(!e.mapperBounds||n[0]!==e.mapperBounds[0]||n[1]!==e.mapperBounds[1]||n[2]!==e.mapperBounds[2]||n[3]!==e.mapperBounds[3]||n[4]!==e.mapperBounds[4]||n[5]!==e.mapperBounds[5]||t.getMTime()>e.boundsMTime.getMTime()){A1("Recomputing bounds..."),e.mapperBounds=n.concat();var a=[];Ce.getCorners(n,a),t.computeMatrix();var i=new Float64Array(16);ye(i,e.matrix),a.forEach(function(s){return ce(s,s,i)}),e.bounds[0]=e.bounds[2]=e.bounds[4]=Number.MAX_VALUE,e.bounds[1]=e.bounds[3]=e.bounds[5]=-Number.MAX_VALUE,e.bounds=e.bounds.map(function(s,o){return o%2===0?a.reduce(function(u,c){return u>c[o/2]?c[o/2]:u},s):a.reduce(function(u,c){return u<c[(o-1)/2]?c[(o-1)/2]:u},s)}),e.boundsMTime.modified()}return e.bounds},t.getMTime=function(){var n=r.getMTime();if(e.property!==null){var a=e.property.getMTime();n=a>n?a:n}if(e.backfaceProperty!==null){var i=e.backfaceProperty.getMTime();n=i>n?i:n}return n},t.getRedrawMTime=function(){var n=e.mtime;if(e.mapper!==null){var a=e.mapper.getMTime();n=a>n?a:n,e.mapper.getInput()!==null&&(e.mapper.getInputAlgorithm().update(),a=e.mapper.getInput().getMTime(),n=a>n?a:n)}return n},t.getSupportsSelection=function(){return e.mapper?e.mapper.getSupportsSelection():!1},t.processSelectorPixelBuffers=function(n,a){e.mapper&&e.mapper.processSelectorPixelBuffers&&e.mapper.processSelectorPixelBuffers(n,a)}}var $1={mapper:null,property:null,backfaceProperty:null,forceOpaque:!1,forceTranslucent:!1,bounds:[1,-1,1,-1,1,-1]};function Pc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$1,r),N1.extend(t,e,r),e.boundsMTime={},m.obj(e.boundsMTime),m.set(t,e,["property"]),m.setGet(t,e,["backfaceProperty","forceOpaque","forceTranslucent","mapper"]),H1(t,e)}var P1=m.newInstance(Pc,"vtkActor"),Ar={newInstance:P1,extend:Pc},jc={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},dt={VOID:"",CHAR:"Int8Array",SIGNED_CHAR:"Int8Array",UNSIGNED_CHAR:"Uint8Array",SHORT:"Int16Array",UNSIGNED_SHORT:"Uint16Array",INT:"Int32Array",UNSIGNED_INT:"Uint32Array",FLOAT:"Float32Array",DOUBLE:"Float64Array"},j1=dt.FLOAT,Kc={DefaultDataType:j1,DataTypeByteSize:jc,VtkDataTypes:dt};function ko(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ta(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ko(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ko(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var K1=P,X1=Kc.DefaultDataType;function Gi(t,e,r){var n=t.length,a,i,s,o;if(n===0)return{min:Number.MAX_VALUE,max:-Number.MAX_VALUE};for(a=t[e],i=a,o=e;o<n;o+=r)s=t[o],s<a?a=s:s>i&&(i=s);return{min:a,max:i}}function Y1(){var t=Number.MAX_VALUE,e=-Number.MAX_VALUE,r=0,n=0;return{add:function(i){t>i&&(t=i),e<i&&(e=i),r++,n+=i},get:function(){return{min:t,max:e,count:r,sum:n,mean:n/r}},getRange:function(){return{min:t,max:e}}}}function Xc(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(e<0&&r>1){for(var n=t.length,a=n/r,i=new Float64Array(a),s=0,o=0;s<a;++s){for(var u,c=o+r;o<c;++o)i[s]+=t[o]*t[o];u=s,i[u]=Math.pow(i[u],.5)}return Gi(i,0,1)}return Gi(t,e<0?0:e,r)}function No(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t||[];r.length<=e;)r.push(null);return r}function Cs(t){return Object.prototype.toString.call(t).slice(8,-1)}function q1(t){for(var e=t.getNumberOfComponents(),r=0,n=new Array(e),a=0;a<t.getNumberOfTuples();++a){t.getTuple(a,n);var i=fc(n,e);i>r&&(r=i)}return r}var Q1={computeRange:Xc,createRangeHelper:Y1,fastComputeRange:Gi,getDataType:Cs,getMaxNorm:q1};function Z1(t,e){e.classHierarchy.push("vtkDataArray");function r(n){if(n<0)return!1;var a=t.getNumberOfComponents(),i=e.values.length/(a>0?a:1);if(n===i)return!0;if(n>i){var s=e.values;return e.values=dn(e.dataType,(n+i)*a),e.values.set(s),!0}return e.size>n*a&&(e.size=n*a,t.dataChange()),!0}t.dataChange=function(){e.ranges=null,t.modified()},t.resize=function(n){r(n);var a=n*t.getNumberOfComponents();return e.size!==a?(e.size=a,t.dataChange(),!0):!1},t.initialize=function(){t.resize(0)},t.getElementComponentSize=function(){return e.values.BYTES_PER_ELEMENT},t.getComponent=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.values[n*e.numberOfComponents+a]},t.setComponent=function(n,a,i){i!==e.values[n*e.numberOfComponents+a]&&(e.values[n*e.numberOfComponents+a]=i,t.dataChange())},t.getValue=function(n){var a=n/e.numberOfComponents,i=n%e.numberOfComponents;return t.getComponent(a,i)},t.setValue=function(n,a){var i=n/e.numberOfComponents,s=n%e.numberOfComponents;t.setComponent(i,s,a)},t.getData=function(){return e.size===e.values.length?e.values:e.values.subarray(0,e.size)},t.getRange=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,a=n<0?e.numberOfComponents:n,i=null;return e.ranges||(e.ranges=No(e.ranges,e.numberOfComponents)),i=e.ranges[a],i?(e.rangeTuple[0]=i.min,e.rangeTuple[1]=i.max,e.rangeTuple):(i=Xc(t.getData(),n,e.numberOfComponents),e.ranges[a]=i,e.rangeTuple[0]=i.min,e.rangeTuple[1]=i.max,e.rangeTuple)},t.setRange=function(n,a){e.ranges||(e.ranges=No(e.ranges,e.numberOfComponents));var i={min:n.min,max:n.max};return e.ranges[a]=i,e.rangeTuple[0]=i.min,e.rangeTuple[1]=i.max,e.rangeTuple},t.setTuple=function(n,a){for(var i=n*e.numberOfComponents,s=0;s<e.numberOfComponents;s++)e.values[i+s]=a[s]},t.setTuples=function(n,a){for(var i=n*e.numberOfComponents,s=Math.min(a.length,e.size-i),o=0;o<s;)e.values[i++]=a[o++]},t.insertTuple=function(n,a){return e.size<=n*e.numberOfComponents&&(e.size=(n+1)*e.numberOfComponents,r(n+1)),t.setTuple(n,a),n},t.insertTuples=function(n,a){var i=n+a.length/e.numberOfComponents;return e.size<i*e.numberOfComponents&&(e.size=i*e.numberOfComponents,r(i)),t.setTuples(n,a),i},t.insertNextTuple=function(n){var a=e.size/e.numberOfComponents;return t.insertTuple(a,n)},t.insertNextTuples=function(n){var a=e.size/e.numberOfComponents;return t.insertTuples(a,n)},t.getTuple=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=e.numberOfComponents||1,s=n*i;switch(i){case 4:a[3]=e.values[s+3];case 3:a[2]=e.values[s+2];case 2:a[1]=e.values[s+1];case 1:a[0]=e.values[s];break;default:for(var o=i-1;o>=0;--o)a[o]=e.values[s+o]}return a},t.getTuples=function(n,a){var i=(n??0)*e.numberOfComponents,s=(a??t.getNumberOfTuples())*e.numberOfComponents,o=t.getData().subarray(i,s);return o.length>0?o:null},t.getTupleLocation=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return n*e.numberOfComponents},t.getNumberOfComponents=function(){return e.numberOfComponents},t.getNumberOfValues=function(){return e.size},t.getNumberOfTuples=function(){return e.size/e.numberOfComponents},t.getDataType=function(){return e.dataType},t.newClone=function(){return qc({empty:!0,name:e.name,dataType:e.dataType,numberOfComponents:e.numberOfComponents})},t.getName=function(){return e.name||(t.modified(),e.name="vtkDataArray".concat(t.getMTime())),e.name},t.setData=function(n,a){e.values=n,e.size=n.length,e.dataType=Cs(n),a&&(e.numberOfComponents=a),e.size%e.numberOfComponents!==0&&(e.numberOfComponents=1),t.dataChange()},t.getState=function(){if(e.deleted)return null;var n=Ta(Ta({},e),{},{vtkClass:t.getClassName()});n.values=Array.from(n.values),delete n.buffer,Object.keys(n).forEach(function(i){n[i]||delete n[i]});var a={};return Object.keys(n).sort().forEach(function(i){a[i]=n[i]}),a.mtime&&delete a.mtime,a},t.deepCopy=function(n){t.shallowCopy(n),t.setData(n.getData().slice())},t.interpolateTuple=function(n,a,i,s,o,u){var c=e.numberOfComponents||1;(c!==a.getNumberOfComponents()||c!==s.getNumberOfComponents())&&K1("numberOfComponents must match");var f=a.getTuple(i),g=s.getTuple(o),v=[];switch(v.length=c,c){case 4:v[3]=f[3]+(g[3]-f[3])*u;case 3:v[2]=f[2]+(g[2]-f[2])*u;case 2:v[1]=f[1]+(g[1]-f[1])*u;case 1:v[0]=f[0]+(g[0]-f[0])*u;break;default:for(var p=0;p<c;p++)v[p]=f[p]+(g[p]-f[p])*u}return t.insertTuple(n,v)}}var I1={name:"",numberOfComponents:1,dataType:X1,rangeTuple:[0,0]};function Yc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,I1,r),!e.empty&&!e.values&&!e.size)throw new TypeError("Cannot create vtkDataArray object without: size > 0, values");if(e.values?Array.isArray(e.values)&&(e.values=Af(e.dataType,e.values)):e.values=dn(e.dataType,e.size),e.values){var n;e.size=(n=e.size)!==null&&n!==void 0?n:e.values.length,e.dataType=Cs(e.values)}Ne(t,e),Ra(t,e,["name","numberOfComponents"]),Z1(t,e)}var qc=ve(Yc,"vtkDataArray"),ge=Ta(Ta({newInstance:qc,extend:Yc},Q1),Kc);function J1(t,e){e.classHierarchy.push("vtkAbstractMapper"),t.update=function(){t.getInputData()},t.addClippingPlane=function(r){return r.isA("vtkPlane")?e.clippingPlanes.includes(r)?!1:(e.clippingPlanes.push(r),t.modified(),!0):!1},t.getNumberOfClippingPlanes=function(){return e.clippingPlanes.length},t.removeAllClippingPlanes=function(){return e.clippingPlanes.length===0?!1:(e.clippingPlanes.length=0,t.modified(),!0)},t.removeClippingPlane=function(r){var n=e.clippingPlanes.indexOf(r);return n===-1?!1:(e.clippingPlanes.splice(n,1),t.modified(),!0)},t.getClippingPlanes=function(){return e.clippingPlanes},t.setClippingPlanes=function(r){if(r)if(!Array.isArray(r))t.addClippingPlane(r);else for(var n=r.length,a=0;a<n&&a<6;a++)t.addClippingPlane(r[a])},t.getClippingPlaneInDataCoords=function(r,n,a){var i=e.clippingPlanes,s=r;if(i){var o=i.length;if(n>=0&&n<o){var u=i[n],c=u.getNormal(),f=u.getOrigin(),g=c[0],v=c[1],p=c[2],l=-(g*f[0]+v*f[1]+p*f[2]);a[0]=g*s[0]+v*s[4]+p*s[8]+l*s[12],a[1]=g*s[1]+v*s[5]+p*s[9]+l*s[13],a[2]=g*s[2]+v*s[6]+p*s[10]+l*s[14],a[3]=g*s[3]+v*s[7]+p*s[11]+l*s[15];return}}m.vtkErrorMacro("Clipping plane index ".concat(n," is out of range."))}}var ed={clippingPlanes:[]};function td(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ed,r),m.obj(t,e),m.algo(t,e,1,0),e.clippingPlanes||(e.clippingPlanes=[]),J1(t,e)}var Qc={extend:td};function rd(t,e){t.getBounds=function(){return 0},t.getBounds=function(r){t.getBounds();for(var n=0;n<6;n++)r[n]=e.bounds[n]},t.getCenter=function(){t.getBounds();for(var r=0;r<3;r++)e.center[r]=(e.bounds[2*r+1]+e.bounds[2*r])/2;return e.center.slice()},t.getLength=function(){var r=0,n=0;t.getBounds();for(var a=0;a<3;a++)r=e.bounds[2*a+1]-e.bounds[2*a],n+=r*r;return Math.sqrt(n)}}var nd={bounds:[1,-1,1,-1,1,-1],center:[0,0,0],viewSpecificProperties:null};function ad(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nd,r),Qc.extend(t,e,r),e.bounds||La(e.bounds),e.center||(e.center=[0,0,0]),m.setGet(t,e,["viewSpecificProperties"]),e.viewSpecificProperties||(e.viewSpecificProperties={}),rd(t,e)}var id={extend:ad},Fo=m.vtkErrorMacro,sd=m.vtkWarningMacro;function od(t,e){e.classHierarchy.push("vtkFieldData");var r=t.getState;e.arrays&&(e.arrays=e.arrays.map(function(n){return{data:ot(n.data)}})),t.initialize=function(){t.initializeFields(),t.copyAllOn(),t.clearFieldFlags()},t.initializeFields=function(){e.arrays=[],e.copyFieldFlags={},t.modified()},t.copyStructure=function(n){t.initializeFields(),e.copyFieldFlags=n.getCopyFieldFlags().map(function(a){return a}),e.arrays=n.arrays().map(function(a){return{array:a}})},t.getNumberOfArrays=function(){return e.arrays.length},t.getNumberOfActiveArrays=function(){return e.arrays.length},t.addArray=function(n){var a=n.getName(),i=t.getArrayWithIndex(a),s=i.array,o=i.index;return s!=null?(e.arrays[o]={data:n},o):(e.arrays=[].concat(e.arrays,{data:n}),e.arrays.length-1)},t.removeAllArrays=function(){e.arrays=[]},t.removeArray=function(n){var a=e.arrays.findIndex(function(i){return i.getName()===n});return t.removeArrayByIndex(a)},t.removeArrayByIndex=function(n){return n!==-1&&n<e.arrays.length?(e.arrays.splice(n,1),!0):!1},t.getArrays=function(){return e.arrays.map(function(n){return n.data})},t.getArray=function(n){return typeof n=="number"?t.getArrayByIndex(n):t.getArrayByName(n)},t.getArrayByName=function(n){return e.arrays.reduce(function(a,i,s){return i.data.getName()===n?i.data:a},null)},t.getArrayWithIndex=function(n){var a=e.arrays.findIndex(function(i){return i.data.getName()===n});return{array:a!==-1?e.arrays[a].data:null,index:a}},t.getArrayByIndex=function(n){return n>=0&&n<e.arrays.length?e.arrays[n].data:null},t.hasArray=function(n){return t.getArrayWithIndex(n).index>=0},t.getArrayName=function(n){var a=e.arrays[n];return a?a.data.getName():""},t.getCopyFieldFlags=function(){return e.copyFieldFlags},t.getFlag=function(n){return e.copyFieldFlags[n]},t.passData=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;n.getArrays().forEach(function(s){var o=t.getFlag(s.getName());if(o!==!1&&!(e.doCopyAllOff&&o!==!0)&&s){var u=t.getArrayByName(s.getName());if(u)if(s.getNumberOfComponents()===u.getNumberOfComponents())if(a>-1&&a<s.getNumberOfTuples()){var v=i>-1?i:a;u.insertTuple(v,s.getTuple(a))}else u.insertTuples(0,s.getTuples());else Fo("Unhandled case in passData");else if(a<0||a>s.getNumberOfTuples())t.addArray(s),n.getAttributes(s).forEach(function(p){t.setAttribute(s,p)});else{var c=s.getNumberOfComponents(),f=s.getNumberOfValues(),g=i>-1?i:a;f<=g*c&&(f=(g+1)*c),u=ge.newInstance({name:s.getName(),dataType:s.getDataType(),numberOfComponents:c,values:m.newTypedArray(s.getDataType(),f),size:0}),u.insertTuple(g,s.getTuple(a)),t.addArray(u),n.getAttributes(s).forEach(function(p){t.setAttribute(u,p)})}}})},t.interpolateData=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5;n.getArrays().forEach(function(u){var c=t.getFlag(u.getName());if(c!==!1&&!(e.doCopyAllOff&&c!==!0)&&u){var f=t.getArrayByName(u.getName());if(f)if(u.getNumberOfComponents()===f.getNumberOfComponents())if(a>-1&&a<u.getNumberOfTuples()){var l=s>-1?s:a;f.interpolateTuple(l,u,a,u,i,o),sd("Unexpected case in interpolateData")}else f.insertTuples(u.getTuples());else Fo("Unhandled case in interpolateData");else if(a<0||i<0||a>u.getNumberOfTuples())t.addArray(u),n.getAttributes(u).forEach(function(y){t.setAttribute(u,y)});else{var g=u.getNumberOfComponents(),v=u.getNumberOfValues(),p=s>-1?s:a;v<=p*g&&(v=(p+1)*g),f=ge.newInstance({name:u.getName(),dataType:u.getDataType(),numberOfComponents:g,values:m.newTypedArray(u.getDataType(),v),size:0}),f.interpolateTuple(p,u,a,u,i,o),t.addArray(f),n.getAttributes(u).forEach(function(y){t.setAttribute(f,y)})}}})},t.copyFieldOn=function(n){e.copyFieldFlags[n]=!0},t.copyFieldOff=function(n){e.copyFieldFlags[n]=!1},t.copyAllOn=function(){(!e.doCopyAllOn||e.doCopyAllOff)&&(e.doCopyAllOn=!0,e.doCopyAllOff=!1,t.modified())},t.copyAllOff=function(){(e.doCopyAllOn||!e.doCopyAllOff)&&(e.doCopyAllOn=!1,e.doCopyAllOff=!0,t.modified())},t.clearFieldFlags=function(){e.copyFieldFlags={}},t.deepCopy=function(n){e.arrays=n.getArrays().map(function(a){var i=a.newClone();return i.deepCopy(a),{data:i}})},t.copyFlags=function(n){return n.getCopyFieldFlags().map(function(a){return a})},t.reset=function(){return e.arrays.forEach(function(n){return n.data.reset()})},t.getMTime=function(){return e.arrays.reduce(function(n,a){return a.data.getMTime()>n?a.data.getMTime():n},e.mtime)},t.getNumberOfComponents=function(){return e.arrays.reduce(function(n,a){return n+a.data.getNumberOfComponents()},0)},t.getNumberOfTuples=function(){return e.arrays.length>0?e.arrays[0].getNumberOfTuples():0},t.getState=function(){var n=r();return n&&(n.arrays=e.arrays.map(function(a){return{data:a.data.getState()}})),n}}var ud={arrays:[],copyFieldFlags:[],doCopyAllOn:!0,doCopyAllOff:!1};function Zc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ud,r),m.obj(t,e),od(t,e)}var fd=m.newInstance(Zc,"vtkFieldData"),cd={newInstance:fd,extend:Zc},gd={SCALARS:0,VECTORS:1,NORMALS:2,TCOORDS:3,TENSORS:4,GLOBALIDS:5,PEDIGREEIDS:6,EDGEFLAG:7,NUM_ATTRIBUTES:8},vd={MAX:0,EXACT:1,NOLIMIT:2},pd={DUPLICATECELL:1,HIGHCONNECTIVITYCELL:2,LOWCONNECTIVITYCELL:4,REFINEDCELL:8,EXTERIORCELL:16,HIDDENCELL:32},ld={DUPLICATEPOINT:1,HIDDENPOINT:2},hd={COPYTUPLE:0,INTERPOLATE:1,PASSDATA:2,ALLCOPY:3},yd="vtkGhostType",dd={DEFAULT:0,SINGLE:1,DOUBLE:2},Ss={AttributeCopyOperations:hd,AttributeLimitTypes:vd,AttributeTypes:gd,CellGhostTypes:pd,DesiredOutputPrecision:dd,PointGhostTypes:ld,ghostArrayName:yd};function Uo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ic(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Uo(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Uo(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Nt=Ss.AttributeTypes,It=Ss.AttributeCopyOperations,Ln=m.vtkWarningMacro;function Td(t,e){var r=["Scalars","Vectors","Normals","TCoords","Tensors","GlobalIds","PedigreeIds"];function n(s){var o=r.find(function(u){return Nt[u.toUpperCase()]===s||typeof s!="number"&&u.toLowerCase()===s.toLowerCase()});return typeof o>"u"&&(o=null),o}e.classHierarchy.push("vtkDataSetAttributes");var a=Ic({},t);t.checkNumberOfComponents=function(s){return!0},t.setAttribute=function(s,o){var u=n(o);if(s&&u.toUpperCase()==="PEDIGREEIDS"&&!s.isA("vtkDataArray"))return Ln("Cannot set attribute ".concat(u,". The attribute must be a vtkDataArray.")),-1;if(s&&!t.checkNumberOfComponents(s,u))return Ln("Cannot set attribute ".concat(u,". Incorrect number of components.")),-1;var c=e["active".concat(u)];if(c>=0&&c<e.arrays.length){if(e.arrays[c]===s)return c;t.removeArrayByIndex(c)}return s?(c=t.addArray(s),e["active".concat(u)]=c):e["active".concat(u)]=-1,t.modified(),e["active".concat(u)]},t.getAttributes=function(s){return r.filter(function(o){return t["get".concat(o)]()===s})},t.setActiveAttributeByName=function(s,o){return t.setActiveAttributeByIndex(t.getArrayWithIndex(s).index,o)},t.setActiveAttributeByIndex=function(s,o){var u=n(o);if(s>=0&&s<e.arrays.length){if(u.toUpperCase()!=="PEDIGREEIDS"){var c=t.getArrayByIndex(s);if(!c.isA("vtkDataArray"))return Ln("Cannot set attribute ".concat(u,". Only vtkDataArray subclasses can be set as active attributes.")),-1;if(!t.checkNumberOfComponents(c,u))return Ln("Cannot set attribute ".concat(u,". Incorrect number of components.")),-1}return e["active".concat(u)]=s,t.modified(),s}return s===-1&&(e["active".concat(u)]=s,t.modified()),-1},t.getActiveAttribute=function(s){var o=n(s);return t["get".concat(o)]()},t.removeAllArrays=function(){r.forEach(function(s){e["active".concat(s)]=-1}),a.removeAllArrays()},t.removeArrayByIndex=function(s){return s!==-1&&r.forEach(function(o){s===e["active".concat(o)]?e["active".concat(o)]=-1:s<e["active".concat(o)]&&(e["active".concat(o)]-=1)}),a.removeArrayByIndex(s)},r.forEach(function(s){var o="active".concat(s);t["get".concat(s)]=function(){return t.getArrayByIndex(e[o])},t["set".concat(s)]=function(u){return t.setAttribute(u,s)},t["setActive".concat(s)]=function(u){return t.setActiveAttributeByIndex(t.getArrayWithIndex(u).index,s)},t["copy".concat(s,"Off")]=function(){var u=s.toUpperCase();e.copyAttributeFlags[It.PASSDATA][Nt[u]]=!1},t["copy".concat(s,"On")]=function(){var u=s.toUpperCase();e.copyAttributeFlags[It.PASSDATA][Nt[u]]=!0}}),t.initializeAttributeCopyFlags=function(){e.copyAttributeFlags=[],Object.keys(It).filter(function(s){return s!=="ALLCOPY"}).forEach(function(s){e.copyAttributeFlags[It[s]]=Object.keys(Nt).filter(function(o){return o!=="NUM_ATTRIBUTES"}).reduce(function(o,u){return o[Nt[u]]=!0,o},[])}),e.copyAttributeFlags[It.COPYTUPLE][Nt.GLOBALIDS]=!1,e.copyAttributeFlags[It.INTERPOLATE][Nt.GLOBALIDS]=!1,e.copyAttributeFlags[It.COPYTUPLE][Nt.PEDIGREEIDS]=!1},t.initialize=m.chain(t.initialize,t.initializeAttributeCopyFlags),e.dataArrays&&Object.keys(e.dataArrays).length&&Object.keys(e.dataArrays).forEach(function(s){!e.dataArrays[s].ref&&e.dataArrays[s].type==="vtkDataArray"&&t.addArray(ge.newInstance(e.dataArrays[s]))});var i=t.shallowCopy;t.shallowCopy=function(s,o){i(s,o),e.arrays=s.getArrays().map(function(u){var c=u.newClone();return c.shallowCopy(u,o),{data:c}})},t.initializeAttributeCopyFlags()}var Cd={activeScalars:-1,activeVectors:-1,activeTensors:-1,activeNormals:-1,activeTCoords:-1,activeGlobalIds:-1,activePedigreeIds:-1};function Jc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Cd,r),cd.extend(t,e,r),m.setGet(t,e,["activeScalars","activeNormals","activeTCoords","activeVectors","activeTensors","activeGlobalIds","activePedigreeIds"]),e.arrays||(e.arrays={}),Td(t,e)}var Sd=m.newInstance(Jc,"vtkDataSetAttributes"),Go=Ic({newInstance:Sd,extend:Jc},Ss),xd={UNIFORM:0,DATA_OBJECT_FIELD:0,COORDINATE:1,POINT_DATA:1,POINT:2,POINT_FIELD_DATA:2,CELL:3,CELL_FIELD_DATA:3,VERTEX:4,VERTEX_FIELD_DATA:4,EDGE:5,EDGE_FIELD_DATA:5,ROW:6,ROW_DATA:6},Od={FIELD_ASSOCIATION_POINTS:0,FIELD_ASSOCIATION_CELLS:1,FIELD_ASSOCIATION_NONE:2,FIELD_ASSOCIATION_POINTS_THEN_CELLS:3,FIELD_ASSOCIATION_VERTICES:4,FIELD_ASSOCIATION_EDGES:5,FIELD_ASSOCIATION_ROWS:6,NUMBER_OF_ASSOCIATIONS:7},md={FieldDataTypes:xd,FieldAssociations:Od};function _o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function wd(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_o(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_o(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var _i=["pointData","cellData","fieldData"];function Ed(t,e){e.classHierarchy.push("vtkDataSet"),_i.forEach(function(n){e[n]?e[n]=ot(e[n]):e[n]=Go.newInstance()});var r=t.shallowCopy;t.shallowCopy=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r(n,a),_i.forEach(function(i){e[i]=Go.newInstance(),e[i].shallowCopy(n.getReferenceByName(i))})}}var Dd={};function eg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Dd,r),m.obj(t,e),m.setGet(t,e,_i),Ed(t,e)}var Md=m.newInstance(eg,"vtkDataSet"),Cr=wd({newInstance:Md,extend:eg},md),tt={UNCHANGED:0,SINGLE_POINT:1,X_LINE:2,Y_LINE:3,Z_LINE:4,XY_PLANE:5,YZ_PLANE:6,XZ_PLANE:7,XYZ_GRID:8,EMPTY:9},tg={StructuredType:tt};function Wo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Vd(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Wo(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Wo(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Ot=tg.StructuredType;function Rd(t){for(var e=0,r=0;r<3;++r)t[r*2]<t[r*2+1]&&e++;return t[0]>t[1]||t[2]>t[3]||t[4]>t[5]?Ot.EMPTY:e===3?Ot.XYZ_GRID:e===2?t[0]===t[1]?Ot.YZ_PLANE:t[2]===t[3]?Ot.XZ_PLANE:Ot.XY_PLANE:e===1?t[0]<t[1]?Ot.X_LINE:t[2]<t[3]?Ot.Y_LINE:Ot.Z_LINE:Ot.SINGLE_POINT}var bd=Vd({getDataDescriptionFromExtent:Rd},tg),Jt=m.vtkErrorMacro;function Ld(t,e){e.classHierarchy.push("vtkImageData"),t.setExtent=function(){if(e.deleted)return Jt("instance deleted - cannot call any method"),!1;for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.length===1?n[0]:n;if(i.length!==6)return!1;var s=e.extent.some(function(o,u){return o!==i[u]});return s&&(e.extent=i.slice(),e.dataDescription=bd.getDataDescriptionFromExtent(e.extent),t.modified()),s},t.setDimensions=function(){var r,n,a;if(e.deleted){Jt("instance deleted - cannot call any method");return}if(arguments.length===1){var i=arguments.length<=0?void 0:arguments[0];r=i[0],n=i[1],a=i[2]}else if(arguments.length===3)r=arguments.length<=0?void 0:arguments[0],n=arguments.length<=1?void 0:arguments[1],a=arguments.length<=2?void 0:arguments[2];else{Jt("Bad dimension specification");return}t.setExtent(0,r-1,0,n-1,0,a-1)},t.getDimensions=function(){return[e.extent[1]-e.extent[0]+1,e.extent[3]-e.extent[2]+1,e.extent[5]-e.extent[4]+1]},t.getNumberOfCells=function(){for(var r=t.getDimensions(),n=1,a=0;a<3;a++){if(r[a]===0)return 0;r[a]>1&&(n*=r[a]-1)}return n},t.getNumberOfPoints=function(){var r=t.getDimensions();return r[0]*r[1]*r[2]},t.getPoint=function(r){var n=t.getDimensions();if(n[0]===0||n[1]===0||n[2]===0)return Jt("Requesting a point from an empty image."),null;var a=new Float64Array(3);switch(e.dataDescription){case tt.EMPTY:return null;case tt.SINGLE_POINT:break;case tt.X_LINE:a[0]=r;break;case tt.Y_LINE:a[1]=r;break;case tt.Z_LINE:a[2]=r;break;case tt.XY_PLANE:a[0]=r%n[0],a[1]=r/n[0];break;case tt.YZ_PLANE:a[1]=r%n[1],a[2]=r/n[1];break;case tt.XZ_PLANE:a[0]=r%n[0],a[2]=r/n[0];break;case tt.XYZ_GRID:a[0]=r%n[0],a[1]=r/n[0]%n[1],a[2]=r/(n[0]*n[1]);break;default:Jt("Invalid dataDescription");break}var i=[0,0,0];return t.indexToWorld(a,i),i},t.getBounds=function(){return t.extentToBounds(t.getSpatialExtent())},t.extentToBounds=function(r){return Ce.transformBounds(r,e.indexToWorld)},t.getSpatialExtent=function(){return Ce.inflate(Y(e.extent),.5)},t.computeTransforms=function(){Of(e.indexToWorld,e.origin),e.indexToWorld[0]=e.direction[0],e.indexToWorld[1]=e.direction[1],e.indexToWorld[2]=e.direction[2],e.indexToWorld[4]=e.direction[3],e.indexToWorld[5]=e.direction[4],e.indexToWorld[6]=e.direction[5],e.indexToWorld[8]=e.direction[6],e.indexToWorld[9]=e.direction[7],e.indexToWorld[10]=e.direction[8],Gr(e.indexToWorld,e.indexToWorld,e.spacing),He(e.worldToIndex,e.indexToWorld)},t.indexToWorld=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return ce(n,r,e.indexToWorld),n},t.indexToWorldVec3=t.indexToWorld,t.worldToIndex=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return ce(n,r,e.worldToIndex),n},t.worldToIndexVec3=t.worldToIndex,t.indexToWorldBounds=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Ce.transformBounds(r,e.indexToWorld,n)},t.worldToIndexBounds=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Ce.transformBounds(r,e.worldToIndex,n)},t.onModified(t.computeTransforms),t.computeTransforms(),t.getCenter=function(){return Ce.getCenter(t.getBounds())},t.computeHistogram=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,a=[0,0,0,0,0,0];t.worldToIndexBounds(r,a);var i=[0,0,0],s=[0,0,0];Ce.computeCornerPoints(a,i,s),wo(i,i),wo(s,s);var o=t.getDimensions();Eo(i,[0,0,0],[o[0]-1,o[1]-1,o[2]-1],i),Eo(s,[0,0,0],[o[0]-1,o[1]-1,o[2]-1],s);for(var u=o[0],c=o[0]*o[1],f=t.getPointData().getScalars().getData(),g=-1/0,v=1/0,p=0,l=0,y=0,h=i[2];h<=s[2];h++)for(var d=i[1];d<=s[1];d++)for(var S=i[0]+d*u+h*c,T=i[0];T<=s[0];T++){if(!n||n([T,d,h],a)){var C=f[S];C>g&&(g=C),C<v&&(v=C),p+=C*C,l+=C,y+=1}++S}var x=y>0?l/y:0,O=y?Math.abs(p/y-x*x):0,w=Math.sqrt(O);return{minimum:v,maximum:g,average:x,variance:O,sigma:w,count:y}},t.computeIncrements=function(r){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,a=[],i=n,s=0;s<3;++s)a[s]=i,i*=r[s*2+1]-r[s*2]+1;return a},t.computeOffsetIndex=function(r){var n=$e(r,3),a=n[0],i=n[1],s=n[2],o=t.getExtent(),u=t.getPointData().getScalars().getNumberOfComponents(),c=t.computeIncrements(o,u);return Math.floor((Math.round(a)-o[0])*c[0]+(Math.round(i)-o[2])*c[1]+(Math.round(s)-o[4])*c[2])},t.getOffsetIndexFromWorld=function(r){for(var n=t.getExtent(),a=t.worldToIndex(r),i=0;i<3;++i)if(a[i]<n[i*2]||a[i]>n[i*2+1])return Jt("GetScalarPointer: Pixel ".concat(a," is not in memory. Current extent = ").concat(n)),NaN;return t.computeOffsetIndex(a)},t.getScalarValueFromWorld=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=t.getPointData().getScalars().getNumberOfComponents();if(n<0||n>=a)return Jt("GetScalarPointer: Scalar Component ".concat(n," is not within bounds. Current Scalar numberOfComponents: ").concat(a)),NaN;var i=t.getOffsetIndexFromWorld(r);return Number.isNaN(i)?i:t.getPointData().getScalars().getComponent(i,n)}}var Bd={direction:null,indexToWorld:null,worldToIndex:null,spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:tt.EMPTY};function rg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Bd,r),Cr.extend(t,e,r),e.direction?Array.isArray(e.direction)&&(e.direction=new Float64Array(e.direction.slice(0,9))):e.direction=dr(new Float64Array(9)),e.indexToWorld=new Float64Array(16),e.worldToIndex=new Float64Array(16),m.get(t,e,["indexToWorld","worldToIndex"]),m.setGetArray(t,e,["origin","spacing"],3),m.setGetArray(t,e,["direction"],9),m.getArray(t,e,["extent"],6),Ld(t,e)}var kd=m.newInstance(rg,"vtkImageData"),Nd={newInstance:kd,extend:rg},Fd={MAGNITUDE:0,COMPONENT:1,RGBCOLORS:2},Wi={LUMINANCE:1,LUMINANCE_ALPHA:2,RGB:3,RGBA:4},Na={VectorMode:Fd,ScalarMappingTarget:Wi},Ud={DEFAULT:0,MAP_SCALARS:1,DIRECT_SCALARS:2},Gd={DEFAULT:0,USE_POINT_DATA:1,USE_CELL_DATA:2,USE_POINT_FIELD_DATA:3,USE_CELL_FIELD_DATA:4,USE_FIELD_DATA:5},_d={BY_ID:0,BY_NAME:1},Qt={ColorMode:Ud,GetArray:_d,ScalarMode:Gd};function zo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Wd(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zo(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zo(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Ao=Na.ScalarMappingTarget,pt=Na.VectorMode,er=ge.VtkDataTypes,Bn=Qt.ColorMode,Ho=m.vtkErrorMacro;function zd(t){return t}function $o(t){return Math.floor(t*255+.5)}function Ad(t,e){e.classHierarchy.push("vtkScalarsToColors"),t.setVectorModeToMagnitude=function(){return t.setVectorMode(pt.MAGNITUDE)},t.setVectorModeToComponent=function(){return t.setVectorMode(pt.COMPONENT)},t.setVectorModeToRGBColors=function(){return t.setVectorMode(pt.RGBCOLORS)},t.build=function(){},t.isOpaque=function(){return!0},t.setAnnotations=function(r,n){if(!(r&&!n||!r&&n)){if(r&&n&&r.length!==n.length){Ho("Values and annotations do not have the same number of tuples so ignoring");return}if(e.annotationArray=[],n&&r)for(var a=n.length,i=0;i<a;i++)e.annotationArray.push({value:r[i],annotation:String(n[i])});t.updateAnnotatedValueMap(),t.modified()}},t.setAnnotation=function(r,n){var a=t.checkForAnnotatedValue(r),i=!1;return a>=0?e.annotationArray[a].annotation!==n&&(e.annotationArray[a].annotation=n,i=!0):(e.annotationArray.push({value:r,annotation:n}),a=e.annotationArray.length-1,i=!0),i&&(t.updateAnnotatedValueMap(),t.modified()),a},t.getNumberOfAnnotatedValues=function(){return e.annotationArray.length},t.getAnnotatedValue=function(r){return r<0||r>=e.annotationArray.length?null:e.annotationArray[r].value},t.getAnnotation=function(r){return e.annotationArray[r]===void 0?null:e.annotationArray[r].annotation},t.getAnnotatedValueIndex=function(r){return e.annotationArray.length?t.checkForAnnotatedValue(r):-1},t.removeAnnotation=function(r){var n=t.checkForAnnotatedValue(r),a=n>=0;return a&&(e.annotationArray.splice(n,1),t.updateAnnotatedValueMap(),t.modified()),a},t.resetAnnotations=function(){e.annotationArray=[],e.annotatedValueMap=[],t.modified()},t.getAnnotationColor=function(r,n){if(e.indexedLookup){var a=t.getAnnotatedValueIndex(r);t.getIndexedColor(a,n)}else t.getColor(parseFloat(r),n),n[3]=1},t.checkForAnnotatedValue=function(r){return t.getAnnotatedValueIndexInternal(r)},t.getAnnotatedValueIndexInternal=function(r){if(e.annotatedValueMap[r]!==void 0){var n=e.annotationArray.length;return e.annotatedValueMap[r]%n}return-1},t.getIndexedColor=function(r,n){n[0]=0,n[1]=0,n[2]=0,n[3]=0},t.updateAnnotatedValueMap=function(){e.annotatedValueMap=[];for(var r=e.annotationArray.length,n=0;n<r;n++)e.annotatedValueMap[e.annotationArray[n].value]=n},t.mapScalars=function(r,n,a){var i=r.getNumberOfComponents(),s=null;if(n===Bn.DEFAULT&&r.getDataType()===er.UNSIGNED_CHAR||n===Bn.DIRECT_SCALARS&&r)s=t.convertToRGBA(r,i,r.getNumberOfTuples());else{var o={type:"vtkDataArray",name:"temp",numberOfComponents:4,dataType:er.UNSIGNED_CHAR},u=m.newTypedArray(o.dataType,4*r.getNumberOfTuples());o.values=u,o.size=u.length,s=ge.newInstance(o);var c=a;c<0&&i>1?t.mapVectorsThroughTable(r,s,Ao.RGBA,-1,-1):(c<0&&(c=0),c>=i&&(c=i-1),t.mapScalarsThroughTable(r,s,Ao.RGBA,c))}return s},t.mapVectorsToMagnitude=function(r,n,a){for(var i=r.getNumberOfTuples(),s=r.getNumberOfComponents(),o=n.getData(),u=r.getData(),c=0;c<i;c++){for(var f=0,g=0;g<a;g++)f+=u[c*s+g]*u[c*s+g];o[c]=Math.sqrt(f)}},t.mapVectorsThroughTable=function(r,n,a,i,s){var o=t.getVectorMode(),u=s,c=i,f=r.getNumberOfComponents();o===pt.COMPONENT?(c===-1&&(c=t.getVectorComponent()),c<0&&(c=0),c>=f&&(c=f-1)):(u===-1&&(u=t.getVectorSize()),u<=0?(c=0,u=f):(c<0&&(c=0),c>=f&&(c=f-1),c+u>f&&(u=f-c)),o===pt.MAGNITUDE&&(f===1||u===1)&&(o=pt.COMPONENT));var g=0;switch(c>0&&(g=c),o){case pt.COMPONENT:{t.mapScalarsThroughTable(r,n,a,g);break}case pt.RGBCOLORS:break;case pt.MAGNITUDE:default:{var v=ge.newInstance({numberOfComponents:1,values:new Float32Array(r.getNumberOfTuples())});t.mapVectorsToMagnitude(r,v,u),t.mapScalarsThroughTable(v,n,a,0);break}}},t.luminanceToRGBA=function(r,n,a,i){for(var s=i(a),o=n.getData(),u=r.getData(),c=o.length,f=0,g=1,v=0,p=f;p<c;p+=g){var l=i(o[p]);u[v*4]=l,u[v*4+1]=l,u[v*4+2]=l,u[v*4+3]=s,v++}},t.luminanceAlphaToRGBA=function(r,n,a,i){for(var s=n.getData(),o=r.getData(),u=s.length,c=0,f=2,g=0,v=c;v<u;v+=f){var p=i(s[v]);o[g]=p,o[g+1]=p,o[g+2]=p,o[g+3]=i(s[v+1])*a,g+=4}},t.rGBToRGBA=function(r,n,a,i){for(var s=$o(a),o=n.getData(),u=r.getData(),c=o.length,f=0,g=3,v=0,p=f;p<c;p+=g)u[v*4]=i(o[p]),u[v*4+1]=i(o[p+1]),u[v*4+2]=i(o[p+2]),u[v*4+3]=s,v++},t.rGBAToRGBA=function(r,n,a,i){for(var s=n.getData(),o=r.getData(),u=s.length,c=0,f=4,g=0,v=c;v<u;v+=f)o[g*4]=i(s[v]),o[g*4+1]=i(s[v+1]),o[g*4+2]=i(s[v+2]),o[g*4+3]=i(s[v+3])*a,g++},t.convertToRGBA=function(r,n,a){var i=e.alpha;if(n===4&&i>=1&&r.getDataType()===er.UNSIGNED_CHAR)return r;var s=ge.newInstance({numberOfComponents:4,empty:!0,size:4*a,dataType:er.UNSIGNED_CHAR});if(a<=0)return s;i=i>0?i:0,i=i<1?i:1;var o=zd;switch((r.getDataType()===er.FLOAT||r.getDataType()===er.DOUBLE)&&(o=$o),n){case 1:t.luminanceToRGBA(s,r,i,o);break;case 2:t.luminanceAlphaToRGBA(s,r,o);break;case 3:t.rGBToRGBA(s,r,i,o);break;case 4:t.rGBAToRGBA(s,r,i,o);break;default:return Ho("Cannot convert colors"),null}return s},t.usingLogScale=function(){return!1},t.getNumberOfAvailableColors=function(){return 256*256*256},t.setRange=function(r,n){return t.setMappingRange(r,n)},t.getRange=function(){return t.getMappingRange()},t.areScalarsOpaque=function(r,n,a){if(!r)return t.isOpaque();var i=r.getNumberOfComponents();if(n===Bn.DEFAULT&&r.getDataType()===er.UNSIGNED_CHAR||n===Bn.DIRECT_SCALARS){if(i===3||i===1)return e.alpha>=1;var s=r.getRange(i-1);return s[0]===255}return!0}}var Hd={alpha:1,vectorComponent:0,vectorSize:-1,vectorMode:pt.COMPONENT,mappingRange:null,annotationArray:null,annotatedValueMap:null,indexedLookup:!1};function ng(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Hd,r),m.obj(t,e),e.mappingRange=[0,255],e.annotationArray=[],e.annotatedValueMap=[],m.setGet(t,e,["vectorSize","vectorComponent","vectorMode","alpha","indexedLookup"]),m.setArray(t,e,["mappingRange"],2),m.getArray(t,e,["mappingRange"]),Ad(t,e)}var $d=m.newInstance(ng,"vtkScalarsToColors"),ag=Wd({newInstance:$d,extend:ng},Na),Po=m.vtkErrorMacro,jo=0,Ko=1,Ja=2;function Pd(t,e){e.classHierarchy.push("vtkLookupTable"),t.isOpaque=function(){if(e.opaqueFlagBuildTime.getMTime()<t.getMTime()){var r=!0;e.nanColor[3]<1&&(r=0),e.useBelowRangeColor&&e.belowRangeColor[3]<1&&(r=0),e.useAboveRangeColor&&e.aboveRangeColor[3]<1&&(r=0);for(var n=3;n<e.table.length&&r;n+=4)e.table[n]<255&&(r=!1);e.opaqueFlag=r,e.opaqueFlagBuildTime.modified()}return e.opaqueFlag},t.usingLogScale=function(){return!1},t.getNumberOfAvailableColors=function(){return e.table.length/4},t.linearIndexLookup=function(r,n){var a=0;return r<n.range[0]?a=n.maxIndex+jo+1.5:r>n.range[1]?a=n.maxIndex+Ko+1.5:(a=(r+n.shift)*n.scale,a=a<n.maxIndex?a:n.maxIndex),Math.floor(a)},t.linearLookup=function(r,n,a){var i=0;cc(r)?i=Math.floor(a.maxIndex+1.5+Ja):i=t.linearIndexLookup(r,a);var s=4*i;return n.slice(s,s+4)},t.indexedLookupFunction=function(r,n,a){var i=t.getAnnotatedValueIndexInternal(r);i===-1&&(i=e.numberOfColors+Ja);var s=4*i;return[n[s],n[s+1],n[s+2],n[s+3]]},t.lookupShiftAndScale=function(r,n){n.shift=-r[0],n.scale=Number.MAX_VALUE,r[1]>r[0]&&(n.scale=(n.maxIndex+1)/(r[1]-r[0]))},t.mapScalarsThroughTable=function(r,n,a,i){var s=t.linearLookup;e.indexedLookup&&(s=t.indexedLookupFunction);var o=t.getMappingRange(),u={maxIndex:t.getNumberOfColors()-1,range:o,shift:0,scale:0};t.lookupShiftAndScale(o,u);var c=t.getAlpha(),f=r.getNumberOfTuples(),g=r.getNumberOfComponents(),v=n.getData(),p=r.getData();if(c>=1){if(a===Wi.RGBA)for(var l=0;l<f;l++){var y=s(p[l*g+i],e.table,u);v[l*4]=y[0],v[l*4+1]=y[1],v[l*4+2]=y[2],v[l*4+3]=y[3]}}else if(a===Wi.RGBA)for(var h=0;h<f;h++){var d=s(p[h*g+i],e.table,u);v[h*4]=d[0],v[h*4+1]=d[1],v[h*4+2]=d[2],v[h*4+3]=Math.floor(d[3]*c+.5)}},t.forceBuild=function(){var r=0,n=0,a=0,i=0,s=e.numberOfColors-1;s&&(r=(e.hueRange[1]-e.hueRange[0])/s,n=(e.saturationRange[1]-e.saturationRange[0])/s,a=(e.valueRange[1]-e.valueRange[0])/s,i=(e.alphaRange[1]-e.alphaRange[0])/s),e.table.length=4*s+16;for(var o=[],u=[],c=0;c<=s;c++)o[0]=e.hueRange[0]+c*r,o[1]=e.saturationRange[0]+c*n,o[2]=e.valueRange[0]+c*a,v1(o,u),u[3]=e.alphaRange[0]+c*i,e.table[c*4]=u[0]*255+.5,e.table[c*4+1]=u[1]*255+.5,e.table[c*4+2]=u[2]*255+.5,e.table[c*4+3]=u[3]*255+.5;t.buildSpecialColors(),e.buildTime.modified()},t.setTable=function(r){if(r.getNumberOfComponents()!==4){Po("Expected 4 components for RGBA colors");return}if(r.getDataType()!==dt.UNSIGNED_CHAR){Po("Expected unsigned char values for RGBA colors");return}e.numberOfColors=r.getNumberOfTuples();var n=r.getData();e.table.length=n.length;for(var a=0;a<n.length;a++)e.table[a]=n[a];t.buildSpecialColors(),e.insertTime.modified(),t.modified()},t.buildSpecialColors=function(){var r=e.numberOfColors,n=e.table,a=(r+jo)*4;e.useBelowRangeColor||r===0?(n[a]=e.belowRangeColor[0]*255+.5,n[a+1]=e.belowRangeColor[1]*255+.5,n[a+2]=e.belowRangeColor[2]*255+.5,n[a+3]=e.belowRangeColor[3]*255+.5):(n[a]=n[0],n[a+1]=n[1],n[a+2]=n[2],n[a+3]=n[3]),a=(r+Ko)*4,e.useAboveRangeColor||r===0?(n[a]=e.aboveRangeColor[0]*255+.5,n[a+1]=e.aboveRangeColor[1]*255+.5,n[a+2]=e.aboveRangeColor[2]*255+.5,n[a+3]=e.aboveRangeColor[3]*255+.5):(n[a]=n[4*(r-1)+0],n[a+1]=n[4*(r-1)+1],n[a+2]=n[4*(r-1)+2],n[a+3]=n[4*(r-1)+3]),a=(r+Ja)*4,n[a]=e.nanColor[0]*255+.5,n[a+1]=e.nanColor[1]*255+.5,n[a+2]=e.nanColor[2]*255+.5,n[a+3]=e.nanColor[3]*255+.5},t.build=function(){(e.table.length<1||t.getMTime()>e.buildTime.getMTime()&&e.insertTime.getMTime()<=e.buildTime.getMTime())&&t.forceBuild()},e.table.length>0&&e.insertTime.modified()}var jd={numberOfColors:256,hueRange:[0,.66667],saturationRange:[1,1],valueRange:[1,1],alphaRange:[1,1],nanColor:[.5,0,0,1],belowRangeColor:[0,0,0,1],aboveRangeColor:[1,1,1,1],useAboveRangeColor:!1,useBelowRangeColor:!1,alpha:1};function ig(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,jd,r),ag.extend(t,e,r),e.table||(e.table=[]),e.buildTime={},m.obj(e.buildTime),e.opaqueFlagBuildTime={},m.obj(e.opaqueFlagBuildTime,{mtime:0}),e.insertTime={},m.obj(e.insertTime,{mtime:0}),m.get(t,e,["buildTime"]),m.setGet(t,e,["numberOfColors","useAboveRangeColor","useBelowRangeColor"]),m.setArray(t,e,["alphaRange","hueRange","saturationRange","valueRange"],2),m.setArray(t,e,["nanColor","belowRangeColor","aboveRangeColor"],4),m.getArray(t,e,["hueRange","saturationRange","valueRange","alphaRange","nanColor","belowRangeColor","aboveRangeColor"]),Pd(t,e)}var Kd=m.newInstance(ig,"vtkLookupTable"),rn={newInstance:Kd,extend:ig},sg=1,xs=0,Xd=["VTK_RESOLVE_OFF","VTK_RESOLVE_POLYGON_OFFSET"];function Yd(){return sg}function qd(t){sg=t}function Qd(){return xs}function Fa(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;xs=t}function Zd(){Fa(0)}function Id(){Fa(0)}function Jd(){Fa(1)}function eT(){return Xd[xs]}var zi={getResolveCoincidentTopologyAsString:eT,getResolveCoincidentTopologyPolygonOffsetFaces:Yd,getResolveCoincidentTopology:Qd,setResolveCoincidentTopology:Fa,setResolveCoincidentTopologyPolygonOffsetFaces:qd,setResolveCoincidentTopologyToDefault:Zd,setResolveCoincidentTopologyToOff:Id,setResolveCoincidentTopologyToPolygonOffset:Jd};function og(t,e,r){r.forEach(function(n){t["get".concat(n.method)]=function(){return e[n.key]},t["set".concat(n.method)]=function(a,i){e[n.key]={factor:a,offset:i}}})}var Os=["Polygon","Line","Point"],tT={Polygon:{factor:2,offset:0},Line:{factor:1,offset:-1},Point:{factor:0,offset:-2}},fr={};og(fr,tT,Os.map(function(t){return{key:t,method:"ResolveCoincidentTopology".concat(t,"OffsetParameters")}}));function rT(t,e){e.resolveCoincidentTopology===void 0&&(e.resolveCoincidentTopology=!1),m.setGet(t,e,["resolveCoincidentTopology"]),e.topologyOffset={Polygon:{factor:0,offset:0},Line:{factor:0,offset:0},Point:{factor:0,offset:0}},Object.keys(zi).forEach(function(r){t[r]=zi[r]}),Object.keys(fr).forEach(function(r){t[r]=fr[r]}),og(t,e.topologyOffset,Os.map(function(r){return{key:r,method:"RelativeCoincidentTopology".concat(r,"OffsetParameters")}})),t.getCoincidentTopologyPolygonOffsetParameters=function(){var r=fr.getResolveCoincidentTopologyPolygonOffsetParameters(),n=t.getRelativeCoincidentTopologyPolygonOffsetParameters();return{factor:r.factor+n.factor,offset:r.offset+n.offset}},t.getCoincidentTopologyLineOffsetParameters=function(){var r=fr.getResolveCoincidentTopologyLineOffsetParameters(),n=t.getRelativeCoincidentTopologyLineOffsetParameters();return{factor:r.factor+n.factor,offset:r.offset+n.offset}},t.getCoincidentTopologyPointOffsetParameter=function(){var r=fr.getResolveCoincidentTopologyPointOffsetParameters(),n=t.getRelativeCoincidentTopologyPointOffsetParameters();return{factor:r.factor+n.factor,offset:r.offset+n.offset}}}var ms={implementCoincidentTopologyMethods:rT,staticOffsetAPI:fr,otherStaticMethods:zi,CATEGORIES:Os},We={MIN_KNOWN_PASS:0,ACTOR_PASS:0,COMPOSITE_INDEX_PASS:1,ID_LOW24:2,ID_HIGH24:3,MAX_KNOWN_PASS:3},ug={PassTypes:We};function Xo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ei(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Xo(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Xo(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Yo=Cr.FieldAssociations,nT=ms.staticOffsetAPI,aT=ms.otherStaticMethods,ti=Qt.ColorMode,tr=Qt.ScalarMode,ri=Qt.GetArray,iT=Na.VectorMode,sT=ge.VtkDataTypes;function qr(t){return function(){return m.vtkErrorMacro("vtkMapper::".concat(t," - NOT IMPLEMENTED"))}}function oT(t,e){e.classHierarchy.push("vtkMapper"),t.getBounds=function(){var r=t.getInputData();return r?(e.static||t.update(),e.bounds=r.getBounds()):e.bounds=gc(),e.bounds},t.setForceCompileOnly=function(r){e.forceCompileOnly=r},t.createDefaultLookupTable=function(){e.lookupTable=rn.newInstance()},t.getColorModeAsString=function(){return m.enumToString(ti,e.colorMode)},t.setColorModeToDefault=function(){return t.setColorMode(0)},t.setColorModeToMapScalars=function(){return t.setColorMode(1)},t.setColorModeToDirectScalars=function(){return t.setColorMode(2)},t.getScalarModeAsString=function(){return m.enumToString(tr,e.scalarMode)},t.setScalarModeToDefault=function(){return t.setScalarMode(0)},t.setScalarModeToUsePointData=function(){return t.setScalarMode(1)},t.setScalarModeToUseCellData=function(){return t.setScalarMode(2)},t.setScalarModeToUsePointFieldData=function(){return t.setScalarMode(3)},t.setScalarModeToUseCellFieldData=function(){return t.setScalarMode(4)},t.setScalarModeToUseFieldData=function(){return t.setScalarMode(5)},t.getAbstractScalars=function(r,n,a,i,s){if(!r||!e.scalarVisibility)return{scalars:null,cellFLag:!1};var o=null,u=!1;if(n===tr.DEFAULT)o=r.getPointData().getScalars(),o||(o=r.getCellData().getScalars(),u=!0);else if(n===tr.USE_POINT_DATA)o=r.getPointData().getScalars();else if(n===tr.USE_CELL_DATA)o=r.getCellData().getScalars(),u=!0;else if(n===tr.USE_POINT_FIELD_DATA){var c=r.getPointData();a===ri.BY_ID?o=c.getArrayByIndex(i):o=c.getArrayByName(s)}else if(n===tr.USE_CELL_FIELD_DATA){var f=r.getCellData();u=!0,a===ri.BY_ID?o=f.getArrayByIndex(i):o=f.getArrayByName(s)}else if(n===tr.USE_FIELD_DATA){var g=r.getFieldData();a===ri.BY_ID?o=g.getArrayByIndex(i):o=g.getArrayByName(s)}return{scalars:o,cellFlag:u}},t.mapScalars=function(r,n){var a=t.getAbstractScalars(r,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!a){e.colorCoordinates=null,e.colorTextureMap=null,e.colorMapColors=null;return}var i="".concat(t.getMTime()).concat(a.getMTime()).concat(n);if(e.colorBuildString!==i){if(e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]),t.canUseTextureMapForColoring(r))t.mapScalarsToTexture(a,n);else{e.colorCoordinates=null,e.colorTextureMap=null;var s=t.getLookupTable();s&&(s.build(),e.colorMapColors=s.mapScalars(a,e.colorMode,e.fieldDataTupleId))}e.colorBuildString="".concat(t.getMTime()).concat(a.getMTime()).concat(n)}},t.scalarToTextureCoordinate=function(r,n,a){var i=.5,s=1;return cc(r)||(s=.49,i=(r-n)*a,i>1e3?i=1e3:i<-1e3&&(i=-1e3)),{texCoordS:i,texCoordT:s}},t.createColorTextureCoordinates=function(r,n,a,i,s,o,u,c,f){var g=(o[1]-o[0])/c,v=[];v[0]=o[0]-g,v[1]=o[1]+g;var p=1/(v[1]-v[0]),l=n.getData(),y=r.getData(),h=0,d=0;if(s<0||s>=i)for(var S=0;S<a;++S){for(var T=0,C=0;C<i;++C)T+=y[h]*y[h],h++;var x=Math.sqrt(T);f&&(x=rn.applyLogScale(x,u,o));var O=t.scalarToTextureCoordinate(x,v[0],p);l[d]=O.texCoordS,l[d+1]=O.texCoordT,d+=2}else{h+=s;for(var w=0;w<a;++w){var E=y[h];f&&(E=rn.applyLogScale(E,u,o));var V=t.scalarToTextureCoordinate(E,v[0],p);l[d]=V.texCoordS,l[d+1]=V.texCoordT,d+=2,h+=i}}},t.mapScalarsToTexture=function(r,n){var a=e.lookupTable.getRange(),i=e.lookupTable.usingLogScale();i&&rn.getLogRange(a,a);var s=e.lookupTable.getAlpha();if(e.colorMapColors=null,e.colorTextureMap==null||t.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getAlpha()!==n){e.lookupTable.setAlpha(n),e.colorTextureMap=null,e.lookupTable.build();var o=e.lookupTable.getNumberOfAvailableColors();o>4094&&(o=4094),o+=2;for(var u=(a[1]-a[0])/(o-1-2),c=new Float64Array(o*2),f=0;f<o;++f)c[f]=a[0]+f*u-u,i&&(c[f]=Math.pow(10,c[f]));for(var g=0;g<o;++g)c[g+o]=NaN;e.colorTextureMap=Nd.newInstance(),e.colorTextureMap.setExtent(0,o-1,0,1,0,0);var v=ge.newInstance({numberOfComponents:1,values:c});e.colorTextureMap.getPointData().setScalars(e.lookupTable.mapScalars(v,e.colorMode,0)),e.lookupTable.setAlpha(s)}if(!e.colorCoordinates||t.getMTime()>e.colorCoordinates.getMTime()||t.getInputData(0).getMTime()>e.colorCoordinates.getMTime()||e.lookupTable.getMTime()>e.colorCoordinates.getMTime()){e.colorCoordinates=null;var p=r.getNumberOfComponents(),l=r.getNumberOfTuples();e.colorCoordinates=ge.newInstance({numberOfComponents:2,values:new Float32Array(l*2)});var y=e.lookupTable.getVectorComponent();e.lookupTable.getVectorMode()===iT.MAGNITUDE&&r.getNumberOfComponents()>1&&(y=-1),t.createColorTextureCoordinates(r,e.colorCoordinates,l,p,y,a,e.lookupTable.getRange(),e.colorTextureMap.getPointData().getScalars().getNumberOfTuples()/2-2,i)}},t.getIsOpaque=function(){var r=t.getInputData(),n=t.getAbstractScalars(r,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName),a=n.scalars;if(!e.scalarVisibility||a==null)return!0;var i=t.getLookupTable();return i?(i.build(),i.areScalarsOpaque(a,e.colorMode,-1)):!0},t.canUseTextureMapForColoring=function(r){if(!e.interpolateScalarsBeforeMapping||e.lookupTable&&e.lookupTable.getIndexedLookup())return!1;var n=t.getAbstractScalars(r,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName),a=n.scalars;return!(!a||n.cellFlag||e.colorMode===ti.DEFAULT&&a.getDataType()===sT.UNSIGNED_CHAR||e.colorMode===ti.DIRECT_SCALARS)},t.clearColorArrays=function(){e.colorMapColors=null,e.colorCoordinates=null,e.colorTextureMap=null},t.getLookupTable=function(){return e.lookupTable||t.createDefaultLookupTable(),e.lookupTable},t.getMTime=function(){var r=e.mtime;if(e.lookupTable!==null){var n=e.lookupTable.getMTime();r=n>r?n:r}return r},t.getPrimitiveCount=function(){var r=t.getInputData(),n={points:r.getPoints().getNumberOfValues()/3,verts:r.getVerts().getNumberOfValues()-r.getVerts().getNumberOfCells(),lines:r.getLines().getNumberOfValues()-2*r.getLines().getNumberOfCells(),triangles:r.getPolys().getNumberOfValues()-3*r.getPolys().getNumberOfCells()};return n},t.acquireInvertibleLookupTable=qr("AcquireInvertibleLookupTable"),t.valueToColor=qr("ValueToColor"),t.colorToValue=qr("ColorToValue"),t.useInvertibleColorFor=qr("UseInvertibleColorFor"),t.clearInvertibleColor=qr("ClearInvertibleColor"),t.processSelectorPixelBuffers=function(r,n){if(!(!r||!e.selectionWebGLIdsToVTKIds||!e.populateSelectionSettings)){var a=r.getRawPixelBuffer(We.ID_LOW24),i=r.getRawPixelBuffer(We.ID_HIGH24),s=r.getCurrentPass(),o=r.getFieldAssociation(),u=null;o===Yo.FIELD_ASSOCIATION_POINTS?u=e.selectionWebGLIdsToVTKIds.points:o===Yo.FIELD_ASSOCIATION_CELLS&&(u=e.selectionWebGLIdsToVTKIds.cells),u&&n.forEach(function(c){if(s===We.ID_LOW24){var f=0;i&&(f+=i[c],f*=256),f+=a[c+2],f*=256,f+=a[c+1],f*=256,f+=a[c];var g=u[f],v=r.getPixelBuffer(We.ID_LOW24);v[c]=g&255,v[c+1]=(g&65280)>>8,v[c+2]=(g&16711680)>>16}else if(s===We.ID_HIGH24&&i){var p=0;p+=i[c],p*=256,p+=a[c],p*=256,p+=a[c+1],p*=256,p+=a[c+2];var l=u[p],y=r.getPixelBuffer(We.ID_HIGH24);y[c]=(l&4278190080)>>24}})}}}var uT={colorMapColors:null,static:!1,lookupTable:null,scalarVisibility:!0,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,fieldDataTupleId:-1,populateSelectionSettings:!0,selectionWebGLIdsToVTKIds:null,interpolateScalarsBeforeMapping:!1,colorCoordinates:null,colorTextureMap:null,forceCompileOnly:0,useInvertibleColors:!1,invertibleScalars:null,customShaderAttributes:[]};function fg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,uT,r),id.extend(t,e,r),m.get(t,e,["colorCoordinates","colorMapColors","colorTextureMap"]),m.setGet(t,e,["colorByArrayName","arrayAccessMode","colorMode","fieldDataTupleId","interpolateScalarsBeforeMapping","lookupTable","populateSelectionSettings","renderTime","scalarMode","scalarVisibility","selectionWebGLIdsToVTKIds","static","useLookupTableScalarRange","customShaderAttributes"]),m.setGetArray(t,e,["scalarRange"],2),ms.implementCoincidentTopologyMethods(t,e),oT(t,e)}var fT=m.newInstance(fg,"vtkMapper"),Yt=ei(ei(ei({newInstance:fT,extend:fg},nT),aT),Qt);function qo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ws(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qo(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qo(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cg(t){var e=0;return t.filter(function(r,n){return n===e?(e+=r+1,!0):!1})}function gg(t){for(var e=0,r=0;r<t.length;)r+=t[r]+1,e++;return e}var cT={extractCellSizes:cg,getNumberOfCells:gg};function gT(t,e){e.classHierarchy.push("vtkCellArray");var r=ws({},t);t.getNumberOfCells=function(n){return e.numberOfCells!==void 0&&!n||(e.cellSizes?e.numberOfCells=e.cellSizes.length:e.numberOfCells=gg(t.getData())),e.numberOfCells},t.getCellSizes=function(n){return e.cellSizes!==void 0&&!n||(e.cellSizes=cg(t.getData())),e.cellSizes},t.resize=function(n){var a=t.getNumberOfTuples();r.resize(n);var i=t.getNumberOfTuples();i<a&&(i===0?(e.numberOfCells=0,e.cellSizes=[]):(e.numberOfCells=void 0,e.cellSizes=void 0))},t.setData=function(n){r.setData(n,1),e.numberOfCells=void 0,e.cellSizes=void 0},t.getCell=function(n){var a=n,i=e.values[a++];return e.values.subarray(a,a+i)},t.insertNextCell=function(n){var a=t.getNumberOfCells();return t.insertNextTuples([n.length].concat(Y(n))),++e.numberOfCells,e.cellSizes!=null&&e.cellSizes.push(n.length),a}}function vT(t){return ws({empty:!0,numberOfComponents:1,dataType:dt.UNSIGNED_INT},t)}function vg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};ge.extend(t,e,vT(r)),gT(t,e)}var pT=m.newInstance(vg,"vtkCellArray"),Qo=ws({newInstance:pT,extend:vg},cT),lT=m.vtkErrorMacro,hT=[1,-1,1,-1,1,-1];function yT(t,e){e.classHierarchy.push("vtkPoints"),t.getNumberOfPoints=t.getNumberOfTuples,t.setNumberOfPoints=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;t.getNumberOfPoints()!==r&&(e.size=r*n,e.values=m.newTypedArray(e.dataType,e.size),t.setNumberOfComponents(n),t.modified())},t.setPoint=function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];t.setTuple(r,a)},t.getPoint=t.getTuple,t.insertNextPoint=function(r,n,a){return t.insertNextTuple([r,n,a])},t.getBounds=function(){if(t.getNumberOfComponents()===3){var r=t.getRange(0);e.bounds[0]=r[0],e.bounds[1]=r[1];var n=t.getRange(1);e.bounds[2]=n[0],e.bounds[3]=n[1];var a=t.getRange(2);return e.bounds[4]=a[0],e.bounds[5]=a[1],e.bounds}if(t.getNumberOfComponents()!==2)return lT(`getBounds called on an array with components of
        `.concat(t.getNumberOfComponents())),hT;var i=t.getRange(0);e.bounds[0]=i[0],e.bounds[1]=i[1];var s=t.getRange(1);return e.bounds[2]=s[0],e.bounds[3]=s[1],e.bounds[4]=0,e.bounds[5]=0,e.bounds},t.computeBounds=t.getBounds,t.setNumberOfComponents(e.numberOfComponents<2?3:e.numberOfComponents)}var dT={empty:!0,numberOfComponents:3,dataType:dt.FLOAT,bounds:[1,-1,1,-1,1,-1]};function pg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dT,r),ge.extend(t,e,r),yT(t,e)}var TT=m.newInstance(pg,"vtkPoints"),Ca={newInstance:TT,extend:pg};function CT(t,e){e.classHierarchy.push("vtkCell"),t.initialize=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(n){e.pointsIds=n;var i=e.points.getData();i.length!==3*e.pointsIds.length&&(i=m.newTypedArray(r.getDataType(),3*e.pointsIds.length));var s=r.getData();e.pointsIds.forEach(function(o,u){var c=3*o,f=3*u;i[f]=s[c],i[++f]=s[++c],i[++f]=s[++c]}),e.points.setData(i)}else{e.points=r,e.pointsIds=new Array(r.getNumberOfPoints());for(var a=r.getNumberOfPoints()-1;a>=0;--a)e.pointsIds[a]=a}},t.getBounds=function(){var r=e.points.getNumberOfPoints(),n=[];if(r){e.points.getPoint(0,n),e.bounds[0]=n[0],e.bounds[1]=n[0],e.bounds[2]=n[1],e.bounds[3]=n[1],e.bounds[4]=n[2],e.bounds[5]=n[2];for(var a=1;a<r;a++)e.points.getPoint(a,n),e.bounds[0]=n[0]<e.bounds[0]?n[0]:e.bounds[0],e.bounds[1]=n[0]>e.bounds[1]?n[0]:e.bounds[1],e.bounds[2]=n[1]<e.bounds[2]?n[1]:e.bounds[2],e.bounds[3]=n[1]>e.bounds[3]?n[1]:e.bounds[3],e.bounds[4]=n[2]<e.bounds[4]?n[2]:e.bounds[4],e.bounds[5]=n[2]>e.bounds[5]?n[2]:e.bounds[5]}else La(e.bounds);return e.bounds},t.getLength2=function(){t.getBounds();for(var r=0,n=0,a=0;a<3;a++)n=e.bounds[2*a+1]-e.bounds[2*a],r+=n*n;return r},t.getParametricDistance=function(r){for(var n,a=0,i=0;i<3;i++)r[i]<0?n=-r[i]:r[i]>1?n=r[i]-1:n=0,n>a&&(a=n);return a},t.getNumberOfPoints=function(){return e.points.getNumberOfPoints()},t.deepCopy=function(r){r.initialize(e.points,e.pointsIds)},t.getCellDimension=function(){},t.intersectWithLine=function(r,n,a,i,s,o,u){},t.evaluatePosition=function(r,n,a,i,s,o){m.vtkErrorMacro("vtkCell.evaluatePosition is not implemented.")}}var ST={bounds:[-1,-1,-1,-1,-1,-1],pointsIds:[]};function lg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ST,r),m.obj(t,e),e.points||(e.points=Ca.newInstance()),m.get(t,e,["points","pointsIds"]),CT(t,e)}var xT=m.newInstance(lg,"vtkCell"),Sa={newInstance:xT,extend:lg};function OT(t,e){var r=e;for(e>=t.array.length&&(r+=t.array.length);r>t.array.length;)t.array.push({ncells:0,cells:null});t.array.length=r}function mT(t,e){e.classHierarchy.push("vtkCellLinks"),t.buildLinks=function(r){var n=r.getPoints().getNumberOfPoints(),a=r.getNumberOfCells(),i=new Uint32Array(n);if(r.isA("vtkPolyData")){for(var s=0;s<a;++s){var o=r.getCellPoints(s),u=o.cellPointIds;u.forEach(function(y){t.incrementLinkCount(y)})}t.allocateLinks(n),e.maxId=n-1;for(var c=function(h){var d=r.getCellPoints(h),S=d.cellPointIds;S.forEach(function(T){t.insertCellReference(T,i[T]++,h)})},f=0;f<a;++f)c(f)}else{for(var g=0;g<a;g++){var v=Sa.newInstance();v.getPointsIds().forEach(function(y){t.incrementLinkCount(y)})}t.allocateLinks(n),e.maxId=n-1;for(var p=function(h){var d=Sa.newInstance();d.getPointsIds().forEach(function(S){t.insertCellReference(S,i[S]++,h)})},l=0;l<a;++l)p(l)}},t.allocate=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.array=Array(r).fill().map(function(){return{ncells:0,cells:null}}),e.extend=n,e.maxId=-1},t.initialize=function(){e.array=null},t.getLink=function(r){return e.array[r]},t.getNcells=function(r){return e.array[r].ncells},t.getCells=function(r){return e.array[r].cells},t.insertNextPoint=function(r){e.array.push({ncells:r,cells:Array(r)}),++e.maxId},t.insertNextCellReference=function(r,n){e.array[r].cells[e.array[r].ncells++]=n},t.deletePoint=function(r){e.array[r].ncells=0,e.array[r].cells=null},t.removeCellReference=function(r,n){e.array[n].cells=e.array[n].cells.filter(function(a){return a!==r}),e.array[n].ncells=e.array[n].cells.length},t.addCellReference=function(r,n){e.array[n].cells[e.array[n].ncells++]=r},t.resizeCellList=function(r,n){e.array[r].cells.length=n},t.squeeze=function(){OT(e,e.maxId+1)},t.reset=function(){e.maxId=-1},t.deepCopy=function(r){e.array=Y(r.array),e.extend=r.extend,e.maxId=r.maxId},t.incrementLinkCount=function(r){++e.array[r].ncells},t.allocateLinks=function(r){for(var n=0;n<r;++n)e.array[n].cells=new Array(e.array[n].ncells)},t.insertCellReference=function(r,n,a){e.array[r].cells[n]=a}}var wT={array:null,maxId:0,extend:0};function hg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wT,r),m.obj(t,e),mT(t,e)}var ET=m.newInstance(hg,"vtkCellLinks"),DT={newInstance:ET,extend:hg},he={VTK_EMPTY_CELL:0,VTK_VERTEX:1,VTK_POLY_VERTEX:2,VTK_LINE:3,VTK_POLY_LINE:4,VTK_TRIANGLE:5,VTK_TRIANGLE_STRIP:6,VTK_POLYGON:7,VTK_PIXEL:8,VTK_QUAD:9,VTK_TETRA:10,VTK_VOXEL:11,VTK_HEXAHEDRON:12,VTK_WEDGE:13,VTK_PYRAMID:14,VTK_PENTAGONAL_PRISM:15,VTK_HEXAGONAL_PRISM:16,VTK_QUADRATIC_EDGE:21,VTK_QUADRATIC_TRIANGLE:22,VTK_QUADRATIC_QUAD:23,VTK_QUADRATIC_POLYGON:36,VTK_QUADRATIC_TETRA:24,VTK_QUADRATIC_HEXAHEDRON:25,VTK_QUADRATIC_WEDGE:26,VTK_QUADRATIC_PYRAMID:27,VTK_BIQUADRATIC_QUAD:28,VTK_TRIQUADRATIC_HEXAHEDRON:29,VTK_QUADRATIC_LINEAR_QUAD:30,VTK_QUADRATIC_LINEAR_WEDGE:31,VTK_BIQUADRATIC_QUADRATIC_WEDGE:32,VTK_BIQUADRATIC_QUADRATIC_HEXAHEDRON:33,VTK_BIQUADRATIC_TRIANGLE:34,VTK_CUBIC_LINE:35,VTK_CONVEX_POINT_SET:41,VTK_POLYHEDRON:42,VTK_PARAMETRIC_CURVE:51,VTK_PARAMETRIC_SURFACE:52,VTK_PARAMETRIC_TRI_SURFACE:53,VTK_PARAMETRIC_QUAD_SURFACE:54,VTK_PARAMETRIC_TETRA_REGION:55,VTK_PARAMETRIC_HEX_REGION:56,VTK_HIGHER_ORDER_EDGE:60,VTK_HIGHER_ORDER_TRIANGLE:61,VTK_HIGHER_ORDER_QUAD:62,VTK_HIGHER_ORDER_POLYGON:63,VTK_HIGHER_ORDER_TETRAHEDRON:64,VTK_HIGHER_ORDER_WEDGE:65,VTK_HIGHER_ORDER_PYRAMID:66,VTK_HIGHER_ORDER_HEXAHEDRON:67,VTK_LAGRANGE_CURVE:68,VTK_LAGRANGE_TRIANGLE:69,VTK_LAGRANGE_QUADRILATERAL:70,VTK_LAGRANGE_TETRAHEDRON:71,VTK_LAGRANGE_HEXAHEDRON:72,VTK_LAGRANGE_WEDGE:73,VTK_LAGRANGE_PYRAMID:74,VTK_NUMBER_OF_CELL_TYPES:75},Ai=["vtkEmptyCell","vtkVertex","vtkPolyVertex","vtkLine","vtkPolyLine","vtkTriangle","vtkTriangleStrip","vtkPolygon","vtkPixel","vtkQuad","vtkTetra","vtkVoxel","vtkHexahedron","vtkWedge","vtkPyramid","vtkPentagonalPrism","vtkHexagonalPrism","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkQuadraticEdge","vtkQuadraticTriangle","vtkQuadraticQuad","vtkQuadraticTetra","vtkQuadraticHexahedron","vtkQuadraticWedge","vtkQuadraticPyramid","vtkBiQuadraticQuad","vtkTriQuadraticHexahedron","vtkQuadraticLinearQuad","vtkQuadraticLinearWedge","vtkBiQuadraticQuadraticWedge","vtkBiQuadraticQuadraticHexahedron","vtkBiQuadraticTriangle","vtkCubicLine","vtkQuadraticPolygon","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkConvexPointSet","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkParametricCurve","vtkParametricSurface","vtkParametricTriSurface","vtkParametricQuadSurface","vtkParametricTetraRegion","vtkParametricHexRegion","UnknownClass","UnknownClass","UnknownClass","vtkHigherOrderEdge","vtkHigherOrderTriangle","vtkHigherOrderQuad","vtkHigherOrderPolygon","vtkHigherOrderTetrahedron","vtkHigherOrderWedge","vtkHigherOrderPyramid","vtkHigherOrderHexahedron"];function Zo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function MT(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zo(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zo(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function VT(t){return t<Ai.length?Ai[t]:"UnknownClass"}function RT(t){return Ai.findIndex(t)}function bT(t){return t<he.VTK_QUADRATIC_EDGE||t===he.VTK_CONVEX_POINT_SET||t===he.VTK_POLYHEDRON}function LT(t){return t===he.VTK_TRIANGLE_STRIP||t===he.VTK_POLY_LINE||t===he.VTK_POLY_VERTEX}var BT={getClassNameFromTypeId:VT,getTypeIdFromClassName:RT,isLinear:bT,hasSubCells:LT};function kT(t,e){e.classHierarchy.push("vtkCellTypes"),t.allocate=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:512,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.size=r>0?r:1,e.extend=n>0?n:1,e.maxId=-1,e.typeArray=new Uint8Array(r),e.locationArray=new Uint32Array(r)},t.insertCell=function(r,n,a){e.typeArray[r]=n,e.locationArray[r]=a,r>e.maxId&&(e.maxId=r)},t.insertNextCell=function(r,n){return t.insertCell(++e.maxId,r,n),e.maxId},t.setCellTypes=function(r,n,a){e.size=r,e.typeArray=n,e.locationArray=a,e.maxId=r-1},t.getCellLocation=function(r){return e.locationArray[r]},t.deleteCell=function(r){e.typeArray[r]=he.VTK_EMPTY_CELL},t.getNumberOfTypes=function(){return e.maxId+1},t.isType=function(r){for(var n=t.getNumberOfTypes(),a=0;a<n;++a)if(r===t.getCellType(a))return!0;return!1},t.insertNextType=function(r){return t.insertNextCell(r,-1)},t.getCellType=function(r){return e.typeArray[r]},t.reset=function(){e.maxId=-1},t.deepCopy=function(r){t.allocate(r.getSize(),r.getExtend()),e.typeArray.set(r.getTypeArray()),e.locationArray.set(r.getLocationArray()),e.maxId=r.getMaxId()}}var NT={size:0,maxId:-1,extend:1e3};function yg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,NT,r),m.obj(t,e),m.get(t,e,["size","maxId","extend"]),m.getArray(t,e,["typeArray","locationArray"]),kT(t,e)}var FT=m.newInstance(yg,"vtkCellTypes"),UT=MT({newInstance:FT,extend:yg},BT),GT={NO_INTERSECTION:0,YES_INTERSECTION:1,ON_LINE:2},dg={IntersectionState:GT};function Io(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Jo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Io(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Io(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ta=dg.IntersectionState;function kr(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,a={t:Number.MIN_VALUE,distance:0},i=[],s;i[0]=r[0]-e[0],i[1]=r[1]-e[1],i[2]=r[2]-e[2];var o=i[0]*(t[0]-e[0])+i[1]*(t[1]-e[1])+i[2]*(t[2]-e[2]),u=ie(i,i),c=1e-5*o;return u!==0&&(a.t=o/u),c<0&&(c=-c),-c<u&&u<c||u<=0||a.t<0?s=e:a.t>1?s=r:(s=i,i[0]=e[0]+a.t*i[0],i[1]=e[1]+a.t*i[1],i[2]=e[2]+a.t*i[2]),n&&(n[0]=s[0],n[1]=s[1],n[2]=s[2]),a.distance=lt(s,t),a}function Tg(t,e,r,n,a,i){var s=[],o=[],u=[];a[0]=0,i[0]=0,Pt(e,t,s),Pt(n,r,o),Pt(r,t,u);var c=[ie(s,s),-ie(s,o),-ie(s,o),ie(o,o)],f=[];if(f[0]=ie(s,u),f[1]=-ie(o,u),g1(c,f,2)===0){for(var g=Number.MAX_VALUE,v=[t,e,r,n],p=[r,r,t,t],l=[n,n,e,e],y=[i[0],i[0],a[0],a[0]],h=[a[0],a[0],i[0],i[0]],d,S=0;S<4;S++)d=kr(v[S],p[S],l[S]),d.distance<g&&(g=d.distance,y[S]=d.t,h[S]=S%2);return ta.ON_LINE}return a[0]=f[0],i[0]=f[1],a[0]>=0&&a[0]<=1&&i[0]>=0&&i[0]<=1?ta.YES_INTERSECTION:ta.NO_INTERSECTION}var _T={distanceToLine:kr,intersection:Tg};function WT(t,e){e.classHierarchy.push("vtkLine");function r(n){return n>=0&&n<=1}t.getCellDimension=function(){return 1},t.intersectWithLine=function(n,a,i,s,o){var u={intersect:0,t:Number.MAX_VALUE,subId:0,betweenPoints:null};o[1]=0,o[2]=0;var c=[],f=[],g=[];e.points.getPoint(0,f),e.points.getPoint(1,g);var v=[],p=[],l=Tg(n,a,f,g,v,p);if(u.t=v[0],u.betweenPoints=r(u.t),o[0]=p[0],l===ta.YES_INTERSECTION){for(var y=0;y<3;y++)s[y]=f[y]+o[0]*(g[y]-f[y]),c[y]=n[y]+u.t*(a[y]-n[y]);if(lt(s,c)<=i*i)return u.intersect=1,u}else{var h;if(u.t<0)return h=kr(n,f,g,s),h.distance<=i*i&&(u.t=0,u.intersect=1,u.betweenPoints=!0),u;if(u.t>1)return h=kr(a,f,g,s),h.distance<=i*i&&(u.t=1,u.intersect=1,u.betweenPoints=!0),u;if(o[0]<0)return o[0]=0,h=kr(f,n,a,s),u.t=h.t,h.distance<=i*i&&(u.intersect=1),u;if(o[0]>1)return o[0]=1,h=kr(g,n,a,s),u.t=h.t,h.distance<=i*i&&(u.intersect=1),u}return u},t.evaluateLocation=function(n,a,i){var s=[],o=[];e.points.getPoint(0,s),e.points.getPoint(1,o);for(var u=0;u<3;u++)a[u]=s[u]+n[0]*(o[u]-s[u]);i[0]=1-n[0],i[1]=n[0]}}var zT={};function Cg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zT,r),Sa.extend(t,e,r),WT(t,e)}var AT=m.newInstance(Cg,"vtkLine"),Qe=Jo(Jo({newInstance:AT,extend:Cg},_T),dg);function HT(t,e){e.classHierarchy.push("vtkPointSet"),e.points?e.points=ot(e.points):e.points=Ca.newInstance(),t.getNumberOfPoints=function(){return e.points.getNumberOfPoints()},t.getBounds=function(){return e.points.getBounds()},t.computeBounds=function(){t.getBounds()};var r=t.shallowCopy;t.shallowCopy=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r(n,a),e.points=Ca.newInstance(),e.points.shallowCopy(n.getPoints())}}var $T={};function Sg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$T,r),Cr.extend(t,e,r),m.setGet(t,e,["points"]),HT(t,e)}var PT=m.newInstance(Sg,"vtkPointSet"),jT={newInstance:PT,extend:Sg};function eu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function KT(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?eu(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):eu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Es(t,e,r,n){var a=r[0]-e[0],i=r[1]-e[1],s=r[2]-e[2],o=t[0]-e[0],u=t[1]-e[1],c=t[2]-e[2];n[0]=i*c-s*u,n[1]=s*o-a*c,n[2]=a*u-i*o}function xa(t,e,r,n){Es(t,e,r,n);var a=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);a!==0&&(n[0]/=a,n[1]/=a,n[2]/=a)}function XT(t,e,r,n,a,i){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:1e-6,o=!1,u=[],c=[],f=[],g=[],v=[];xa(t,e,r,g),xa(n,a,i,v);var p=-ie(g,t),l=-ie(v,n),y=[ie(v,t)+l,ie(v,e)+l,ie(v,r)+l];if(y[0]*y[1]>s&&y[0]*y[2]>s)return{intersect:!1,coplanar:o,pt1:u,pt2:c,surfaceId:f};var h=[ie(g,n)+p,ie(g,a)+p,ie(g,i)+p];if(h[0]*h[1]>s&&h[0]*h[2]>s)return{intersect:!1,coplanar:o,pt1:u,pt2:c,surfaceId:f};if(Math.abs(g[0]-v[0])<1e-9&&Math.abs(g[1]-v[1])<1e-9&&Math.abs(g[2]-v[2])<1e-9&&Math.abs(p-l)<1e-9)return o=!0,{intersect:!1,coplanar:o,pt1:u,pt2:c,surfaceId:f};var d=[t,e,r],S=[n,a,i],T=ie(g,v),C=(p-l*T)/(T*T-1),x=(l-p*T)/(T*T-1),O=[C*g[0]+x*v[0],C*g[1]+x*v[1],C*g[2]+x*v[2]],w=hn(g,v,[]);Wr(w);for(var E=0,V=0,D=[],M=[],L=50,N=50,B=0;B<3;B++){var _=B,A=(B+1)%3,W=zr.intersectWithLine(d[_],d[A],n,v);W.intersection&&W.t>0-s&&W.t<1+s&&(W.t<1+s&&W.t>1-s&&(L=E),D[E++]=ie(W.x,w)-ie(O,w));var z=zr.intersectWithLine(S[_],S[A],t,g);z.intersection&&z.t>0-s&&z.t<1+s&&(z.t<1+s&&z.t>1-s&&(N=V),M[V++]=ie(z.x,w)-ie(O,w))}if(E>2){E--;var R=D[2];D[2]=D[L],D[L]=R}if(V>2){V--;var b=M[2];M[2]=M[N],M[N]=b}if(E!==2||V!==2)return{intersect:!1,coplanar:o,pt1:u,pt2:c,surfaceId:f};if(Number.isNaN(D[0])||Number.isNaN(D[1])||Number.isNaN(M[0])||Number.isNaN(M[1]))return{intersect:!1,coplanar:o,pt1:u,pt2:c,surfaceId:f};if(D[0]>D[1]){var F=D[1];D[1]=D[0],D[0]=F}if(M[0]>M[1]){var G=M[1];M[1]=M[0],M[0]=G}var U,H;return D[1]<M[0]||M[1]<D[0]?{intersect:!1,coplanar:o,pt1:u,pt2:c,surfaceId:f}:(D[0]<M[0]?D[1]<M[1]?(f[0]=2,f[1]=1,U=M[0],H=D[1]):(f[0]=2,f[1]=2,U=M[0],H=M[1]):D[1]<M[1]?(f[0]=1,f[1]=1,U=D[0],H=D[1]):(f[0]=1,f[1]=2,U=D[0],H=M[1]),mo(O,w,U,u),mo(O,w,H,c),{intersect:!0,coplanar:o,pt1:u,pt2:c,surfaceId:f})}var YT={computeNormalDirection:Es,computeNormal:xa,intersectWithTriangle:XT};function qT(t,e){e.classHierarchy.push("vtkTriangle"),t.getCellDimension=function(){return 2},t.intersectWithLine=function(r,n,a,i,s){var o={subId:0,t:Number.MAX_VALUE,intersect:0,betweenPoints:!1};s[2]=0;var u=[],c=a*a,f=[],g=[],v=[];e.points.getPoint(0,f),e.points.getPoint(1,g),e.points.getPoint(2,v);var p=[],l=[];if(xa(f,g,v,p),p[0]!==0||p[1]!==0||p[2]!==0){var y=zr.intersectWithLine(r,n,f,p);if(o.betweenPoints=y.betweenPoints,o.t=y.t,i[0]=y.x[0],i[1]=y.x[1],i[2]=y.x[2],!y.intersection)return s[0]=0,s[1]=0,o.intersect=0,o;var h=t.evaluatePosition(i,u,s,l);if(h.evaluation>=0)return h.dist2<=c?(o.intersect=1,o):(o.intersect=h.evaluation,o)}var d=lt(f,g),S=lt(g,v),T=lt(v,f);e.line||(e.line=Qe.newInstance()),d>S&&d>T?(e.line.getPoints().setPoint(0,f),e.line.getPoints().setPoint(1,g)):S>T&&S>d?(e.line.getPoints().setPoint(0,g),e.line.getPoints().setPoint(1,v)):(e.line.getPoints().setPoint(0,v),e.line.getPoints().setPoint(1,f));var C=e.line.intersectWithLine(r,n,a,i,s);if(o.betweenPoints=C.betweenPoints,o.t=C.t,C.intersect){for(var x=[],O=[],w=[],E=0;E<3;E++)x[E]=f[E]-v[E],O[E]=g[E]-v[E],w[E]=i[E]-v[E];return s[0]=ie(w,x)/T,s[1]=ie(w,O)/S,o.intersect=1,o}return s[0]=0,s[1]=0,o.intersect=0,o},t.evaluatePosition=function(r,n,a,i){var s={subId:0,dist2:0,evaluation:-1},o,u,c=[],f=[],g=[],v=[],p,l=[],y=[],h=[],d=0,S=0,T=[],C,x,O,w=[],E=[],V=[],D=[];s.subId=0,a[2]=0,e.points.getPoint(1,c),e.points.getPoint(2,f),e.points.getPoint(0,g),Es(c,f,g,v),zr.generalizedProjectPoint(r,c,v,D);var M=0;for(o=0;o<3;o++)v[o]<0?p=-v[o]:p=v[o],p>M&&(M=p,S=o);for(u=0,o=0;o<3;o++)o!==S&&(T[u++]=o);for(o=0;o<2;o++)l[o]=D[T[o]]-g[T[o]],y[o]=c[T[o]]-g[T[o]],h[o]=f[T[o]]-g[T[o]];if(d=ea(y,h),d===0)return a[0]=0,a[1]=0,s.evaluation=-1,s;if(a[0]=ea(l,h)/d,a[1]=ea(y,l)/d,i[0]=1-(a[0]+a[1]),i[1]=a[0],i[2]=a[1],i[0]>=0&&i[0]<=1&&i[1]>=0&&i[1]<=1&&i[2]>=0&&i[2]<=1)n&&(s.dist2=lt(D,r),n[0]=D[0],n[1]=D[1],n[2]=D[2]),s.evaluation=1;else{var L;if(n){if(i[1]<0&&i[2]<0)for(C=lt(r,g),x=Qe.distanceToLine(r,c,g,L,E),O=Qe.distanceToLine(r,g,f,L,V),C<x?(s.dist2=C,w=g):(s.dist2=x,w=E),O<s.dist2&&(s.dist2=O,w=V),o=0;o<3;o++)n[o]=w[o];else if(i[2]<0&&i[0]<0)for(C=lt(r,c),x=Qe.distanceToLine(r,c,g,L,E),O=Qe.distanceToLine(r,c,f,L,V),C<x?(s.dist2=C,w=c):(s.dist2=x,w=E),O<s.dist2&&(s.dist2=O,w=V),o=0;o<3;o++)n[o]=w[o];else if(i[1]<0&&i[0]<0)for(C=lt(r,f),x=Qe.distanceToLine(r,f,g,L,E),O=Qe.distanceToLine(r,c,f,L,V),C<x?(s.dist2=C,w=f):(s.dist2=x,w=E),O<s.dist2&&(s.dist2=O,w=V),o=0;o<3;o++)n[o]=w[o];else if(i[0]<0){var N=Qe.distanceToLine(r,c,f,n);s.dist2=N.distance}else if(i[1]<0){var B=Qe.distanceToLine(r,f,g,n);s.dist2=B.distance}else if(i[2]<0){var _=Qe.distanceToLine(r,c,g,n);s.dist2=_.distance}}s.evaluation=0}return s},t.evaluateLocation=function(r,n,a){var i=[],s=[],o=[];e.points.getPoint(0,i),e.points.getPoint(1,s),e.points.getPoint(2,o);for(var u=1-r[0]-r[1],c=0;c<3;c++)n[c]=i[c]*u+s[c]*r[0]+o[c]*r[1];a[0]=u,a[1]=r[0],a[2]=r[1]},t.getParametricDistance=function(r){var n,a=0,i=[];i[0]=r[0],i[1]=r[1],i[2]=1-r[0]-r[1];for(var s=0;s<3;s++)i[s]<0?n=-i[s]:i[s]>1?n=i[s]-1:n=0,n>a&&(a=n);return a}}var QT={};function xg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,QT,r),Sa.extend(t,e,r),qT(t,e)}var ZT=m.newInstance(xg,"vtkTriangle"),IT=KT({newInstance:ZT,extend:xg},YT),ni=["verts","lines","polys","strips"],Qr,tu=m.vtkWarningMacro,JT=(Qr={},ee(Qr,he.VTK_LINE,Qe),ee(Qr,he.VTK_POLY_LINE,Qe),ee(Qr,he.VTK_TRIANGLE,IT),Qr);function e2(t,e){e.classHierarchy.push("vtkPolyData");function r(a){return a.replace(/(?:^\w|[A-Z]|\b\w)/g,function(i){return i.toUpperCase()}).replace(/\s+/g,"")}ni.forEach(function(a){t["getNumberOf".concat(r(a))]=function(){return e[a].getNumberOfCells()},e[a]?e[a]=ot(e[a]):e[a]=Qo.newInstance()}),t.getNumberOfCells=function(){return ni.reduce(function(a,i){return a+e[i].getNumberOfCells()},0)};var n=t.shallowCopy;t.shallowCopy=function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(a,i),ni.forEach(function(s){e[s]=Qo.newInstance(),e[s].shallowCopy(a.getReferenceByName(s))})},t.buildCells=function(){var a=t.getNumberOfVerts(),i=t.getNumberOfLines(),s=t.getNumberOfPolys(),o=t.getNumberOfStrips(),u=a+i+s+o,c=new Uint8Array(u),f=c,g=new Uint32Array(u),v=g;if(a){var p=0;e.verts.getCellSizes().forEach(function(d,S){v[S]=p,f[S]=d>1?he.VTK_POLY_VERTEX:he.VTK_VERTEX,p+=d+1}),v=v.subarray(a),f=f.subarray(a)}if(i){var l=0;e.lines.getCellSizes().forEach(function(d,S){v[S]=l,f[S]=d>2?he.VTK_POLY_LINE:he.VTK_LINE,d===1&&tu("Building VTK_LINE ",S," with only one point, but VTK_LINE needs at least two points. Check the input."),l+=d+1}),v=v.subarray(i),f=f.subarray(i)}if(s){var y=0;e.polys.getCellSizes().forEach(function(d,S){switch(v[S]=y,d){case 3:f[S]=he.VTK_TRIANGLE;break;case 4:f[S]=he.VTK_QUAD;break;default:f[S]=he.VTK_POLYGON;break}d<3&&tu("Building VTK_TRIANGLE ",S," with less than three points, but VTK_TRIANGLE needs at least three points. Check the input."),y+=d+1}),v+=v.subarray(s),f+=f.subarray(s)}if(o){var h=0;f.fill(he.VTK_TRIANGLE_STRIP,0,o),e.strips.getCellSizes().forEach(function(d,S){v[S]=h,h+=d+1})}e.cells=UT.newInstance(),e.cells.setCellTypes(u,c,g)},t.buildLinks=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;e.cells===void 0&&t.buildCells(),e.links=DT.newInstance(),a>0?e.links.allocate(a):e.links.allocate(t.getPoints().getNumberOfPoints()),e.links.buildLinks(t)},t.getCellType=function(a){return e.cells.getCellType(a)},t.getCellPoints=function(a){var i=t.getCellType(a),s=null;switch(i){case he.VTK_VERTEX:case he.VTK_POLY_VERTEX:s=e.verts;break;case he.VTK_LINE:case he.VTK_POLY_LINE:s=e.lines;break;case he.VTK_TRIANGLE:case he.VTK_QUAD:case he.VTK_POLYGON:s=e.polys;break;case he.VTK_TRIANGLE_STRIP:s=e.strips;break;default:return s=null,{type:0,cellPointIds:null}}var o=e.cells.getCellLocation(a),u=s.getCell(o);return{cellType:i,cellPointIds:u}},t.getPointCells=function(a){return e.links.getCells(a)},t.getCellEdgeNeighbors=function(a,i,s){var o=e.links.getLink(i),u=e.links.getLink(s);return o.cells.filter(function(c){return c!==a&&u.cells.indexOf(c)!==-1})},t.getCell=function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=t.getCellPoints(a),o=i||JT[s.cellType].newInstance();return o.initialize(t.getPoints(),s.cellPointIds),o}}var t2={};function Og(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,t2,r),jT.extend(t,e,r),m.get(t,e,["cells","links"]),m.setGet(t,e,["verts","lines","polys","strips"]),e2(t,e)}var r2=m.newInstance(Og,"vtkPolyData"),qt={newInstance:r2,extend:Og};function ru(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function n2(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ru(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ru(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function a2(t,e){e.classHierarchy.push("vtkTexture"),t.imageLoaded=function(){e.image.removeEventListener("load",t.imageLoaded),e.imageLoaded=!0,t.modified()},t.setJsImageData=function(r){e.jsImageData!==r&&(r!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.canvas=null),e.jsImageData=r,e.imageLoaded=!0,t.modified())},t.setCanvas=function(r){e.canvas!==r&&(r!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.jsImageData=null),e.canvas=r,t.modified())},t.setImage=function(r){e.image!==r&&(r!==null&&(t.setInputData(null),t.setInputConnection(null),e.canvas=null,e.jsImageData=null),e.image=r,e.imageLoaded=!1,r.complete?t.imageLoaded():r.addEventListener("load",t.imageLoaded),t.modified())},t.getDimensionality=function(){var r=0,n=0,a=1;if(t.getInputData()){var i=t.getInputData();r=i.getDimensions()[0],n=i.getDimensions()[1],a=i.getDimensions()[2]}e.jsImageData&&(r=e.jsImageData.width,n=e.jsImageData.height),e.canvas&&(r=e.canvas.width,n=e.canvas.height),e.image&&(r=e.image.width,n=e.image.height);var s=(r>1)+(n>1)+(a>1);return s},t.getInputAsJsImageData=function(){if(!e.imageLoaded||t.getInputData())return null;if(e.jsImageData)return e.jsImageData();if(e.canvas){var r=e.canvas.getContext("2d"),n=r.getImageData(0,0,e.canvas.width,e.canvas.height);return n}if(e.image){var a=document.createElement("canvas");a.width=e.image.width,a.height=e.image.height;var i=a.getContext("2d");i.translate(0,a.height),i.scale(1,-1),i.drawImage(e.image,0,0,e.image.width,e.image.height);var s=i.getImageData(0,0,a.width,a.height);return s}return null}}var i2=function(e,r,n,a){for(var i=[1,2,1],s=4,o=i,u=s,c=e.length/(r*n),f=r,g=n,v=e,p=[v],l=0;l<a;l++){var y=Y(v);f/=2,g/=2,v=new Uint8ClampedArray(f*g*c);for(var h=c*f,d=0,S=0;S<v.length;S+=c){S%h===0&&(d+=2*c*f);for(var T=0;T<c;T++){var C=y[d+T];C+=y[d+c+T],C+=y[d-2*h+T],C+=y[d-2*h+c+T],C/=4,v[S+T]=C}d+=2*c}for(var x=Y(v),O=0;O<v.length;O+=c)for(var w=0;w<c;w++){for(var E=-(o.length-1)/2,V=u,D=0,M=0;M<o.length;M++){var L=O+w+E*c,N=L%h-(O+w)%h;N>c&&(L+=h),N<-c&&(L-=h),x[L]?D+=x[L]*o[M]:V-=o[M],E+=1}v[O+w]=D/V}x=Y(v);for(var B=0;B<v.length;B+=c)for(var _=0;_<c;_++){for(var A=-(o.length-1)/2,W=u,z=0,R=0;R<o.length;R++){var b=B+_+A*h;x[b]?z+=x[b]*o[R]:W-=o[R],A+=1}v[B+_]=z/W}p.push(v)}return p},s2={image:null,canvas:null,jsImageData:null,imageLoaded:!1,repeat:!1,interpolate:!1,edgeClamp:!1,mipLevel:0,resizable:!1};function mg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,s2,r),m.obj(t,e),m.algo(t,e,6,0),m.get(t,e,["canvas","image","jsImageData","imageLoaded","resizable"]),m.setGet(t,e,["repeat","edgeClamp","interpolate","mipLevel"]),a2(t,e)}var o2=m.newInstance(mg,"vtkTexture"),u2={generateMipmaps:i2},Ua=n2({newInstance:o2,extend:mg},u2);function nu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function nn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nu(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var f2=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],au=[[8,7,11,3],[9,1,10,5],[4,9,0,8],[2,11,6,10],[0,3,2,1],[4,5,6,7]],kn=[[0,1],[1,3],[2,3],[0,2],[4,5],[5,7],[6,7],[4,6],[0,4],[1,5],[3,7],[2,6]],iu=[0,1,0,1,0,1,0,1,2,2,2,2],de=[[1,2],[1,2],[0,2],[0,2],[0,1],[0,1]],q=new Float64Array(3),Nn=new Float64Array(3),fe=new Float64Array(3),cr=new Float64Array(3),rr=new Float64Array(3),Fn=new Float64Array(3),ai=new Float64Array(16);function ii(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font="".concat(e.fontStyle," ").concat(e.fontSize,"px ").concat(e.fontFamily)}function c2(t,e){e.classHierarchy.push("vtkCubeAxesActorHelper"),t.setRenderable=function(r){e.renderable!==r&&(e.renderable=r,e.tmActor.addTexture(e.renderable.getTmTexture()),e.tmActor.setProperty(r.getProperty()),e.tmActor.setParentProp(r),t.modified())},t.createPolyDataForOneLabel=function(r,n,a,i,s,o,u){var c=e.renderable.get_tmAtlas().get(r);if(c){var f=e.renderable.getTextPolyData().getPoints().getData(),g=e.lastSize;q[0]=f[n*3],q[1]=f[n*3+1],q[2]=f[n*3+2],ce(fe,q,a),fe[0]+=.1,ce(Nn,fe,i),$t(rr,Nn,q),fe[0]-=.1,fe[1]+=.1,ce(Nn,fe,i),$t(Fn,Nn,q);for(var v=0;v<3;v++)rr[v]/=.5*.1*g[0],Fn[v]/=.5*.1*g[1];var p=u.ptIdx,l=u.cellIdx;q[0]=f[n*3],q[1]=f[n*3+1],q[2]=f[n*3+2],s[0]<-.5?_t(fe,rr,s[0]*o-c.width):s[0]>.5?_t(fe,rr,s[0]*o):_t(fe,rr,s[0]*o-c.width/2),Jr(q,q,fe),_t(fe,Fn,s[1]*o-c.height/2),Jr(q,q,fe),u.points[p*3]=q[0],u.points[p*3+1]=q[1],u.points[p*3+2]=q[2],u.tcoords[p*2]=c.tcoords[0],u.tcoords[p*2+1]=c.tcoords[1],p++,_t(fe,rr,c.width),Jr(q,q,fe),u.points[p*3]=q[0],u.points[p*3+1]=q[1],u.points[p*3+2]=q[2],u.tcoords[p*2]=c.tcoords[2],u.tcoords[p*2+1]=c.tcoords[3],p++,_t(fe,Fn,c.height),Jr(q,q,fe),u.points[p*3]=q[0],u.points[p*3+1]=q[1],u.points[p*3+2]=q[2],u.tcoords[p*2]=c.tcoords[4],u.tcoords[p*2+1]=c.tcoords[5],p++,_t(fe,rr,c.width),$t(q,q,fe),u.points[p*3]=q[0],u.points[p*3+1]=q[1],u.points[p*3+2]=q[2],u.tcoords[p*2]=c.tcoords[6],u.tcoords[p*2+1]=c.tcoords[7],p++,u.polys[l*4]=3,u.polys[l*4+1]=p-4,u.polys[l*4+2]=p-3,u.polys[l*4+3]=p-2,l++,u.polys[l*4]=3,u.polys[l*4+1]=p-4,u.polys[l*4+2]=p-2,u.polys[l*4+3]=p-1,u.ptIdx+=4,u.cellIdx+=2}},t.updateTexturePolyData=function(){var r=e.camera.getCompositeProjectionMatrix(e.lastAspectRatio,-1,1);ye(r,r);var n=e.renderable.getTextValues().length,a=n*4,i=n*2,s=new Float64Array(a*3),o=new Uint16Array(i*4),u=new Float32Array(a*2);He(ai,r);for(var c={ptIdx:0,cellIdx:0,polys:o,points:s,tcoords:u},f=0,g=0,v=0,p=e.renderable.getTextPolyData().getPoints().getData(),l=e.renderable.getTextValues();f<p.length/3;){q[0]=p[f*3],q[1]=p[f*3+1],q[2]=p[f*3+2],ce(fe,q,r),q[0]=p[f*3+3],q[1]=p[f*3+4],q[2]=p[f*3+5],ce(cr,q,r),$t(fe,fe,cr);var y=[fe[0],fe[1]];s1(y),t.createPolyDataForOneLabel(l[g],f,r,ai,y,e.renderable.getAxisTitlePixelOffset(),c),f+=2,g++;for(var h=0;h<e.renderable.getTickCounts()[v];h++)t.createPolyDataForOneLabel(l[g],f,r,ai,y,e.renderable.getTickLabelPixelOffset(),c),f++,g++;v++}var d=ge.newInstance({numberOfComponents:2,values:u,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(d),e.tmPolyData.getPoints().setData(s,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(o,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updateAPISpecificData=function(r,n,a){(e.lastSize[0]!==r[0]||e.lastSize[1]!==r[1])&&(e.lastSize[0]=r[0],e.lastSize[1]=r[1],e.lastAspectRatio=r[0]/r[1],e.forceUpdate=!0),e.camera=n,t.updateTexturePolyData()}}var g2=m.newInstance(function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},r),m.obj(t,e),e.tmPolyData=qt.newInstance(),e.tmMapper=Yt.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmActor=Ar.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),m.setGet(t,e,["renderable"]),m.get(t,e,["lastSize","lastAspectRatio","axisTextStyle","tickTextStyle","tmActor","ticks"]),e.forceUpdate=!1,e.lastRedrawTime={},m.obj(e.lastRedrawTime,{mtime:0}),e.lastRebuildTime={},m.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.lastTickBounds=[],c2(t,e)},"vtkCubeAxesActorHelper");function v2(t,e){e.classHierarchy.push("vtkCubeAxesActor"),t.setCamera=function(n){e.camera!==n&&(e.cameraModifiedSub&&(e.cameraModifiedSub.unsubscribe(),e.cameraModifiedSub=null),e.camera=n,n&&(e.cameraModifiedSub=n.onModified(t.update)),t.update(),t.modified())},t.computeFacesToDraw=function(){var n=e.camera.getViewMatrix();ye(n,n);for(var a=!1,i=Ce.getDiagonalLength(e.dataBounds),s=Math.sin(e.faceVisibilityAngle*Math.PI/180),o=0;o<6;o++){var u=!1,c=Math.floor(o/2),f=(c+1)%3,g=(c+2)%3;e.dataBounds[f*2]!==e.dataBounds[f*2+1]&&e.dataBounds[g*2]!==e.dataBounds[g*2+1]&&(q[c]=e.dataBounds[o]-.1*i*f2[o][c],q[f]=.5*(e.dataBounds[f*2]+e.dataBounds[f*2+1]),q[g]=.5*(e.dataBounds[g*2]+e.dataBounds[g*2+1]),ce(fe,q,n),q[c]=e.dataBounds[o],ce(cr,q,n),$t(fe,cr,fe),fn(fe,fe),u=fe[2]>s,e.camera.getParallelProjection()||(fn(cr,cr),u=Nf(cr,fe)>s)),u!==e.lastFacesToDraw[o]&&(e.lastFacesToDraw[o]=u,a=!0)}return a},t.updatePolyData=function(n,a,i){var s=0,o=0;s+=8;for(var u=0,c=0;c<12;c++)a[c]>0&&u++;if(o+=u,e.gridLines)for(var f=0;f<6;f++)n[f]&&(s+=i[de[f][0]].length*2+i[de[f][1]].length*2,o+=i[de[f][0]].length+i[de[f][1]].length);for(var g=new Float64Array(s*3),v=new Uint32Array(o*3),p=0,l=0,y=0;y<2;y++)for(var h=0;h<2;h++)for(var d=0;d<2;d++)g[p*3]=e.dataBounds[d],g[p*3+1]=e.dataBounds[2+h],g[p*3+2]=e.dataBounds[4+y],p++;for(var S=0;S<12;S++)a[S]>0&&(v[l*3]=2,v[l*3+1]=kn[S][0],v[l*3+2]=kn[S][1],l++);if(e.gridLines){for(var T=0;T<6;T++)if(n[T]){for(var C=Math.floor(T/2),x=i[de[T][0]],O=0;O<x.length;O++)g[p*3+C]=e.dataBounds[T],g[p*3+de[T][0]]=x[O],g[p*3+de[T][1]]=e.dataBounds[de[T][1]*2],p++,g[p*3+C]=e.dataBounds[T],g[p*3+de[T][0]]=x[O],g[p*3+de[T][1]]=e.dataBounds[de[T][1]*2+1],p++,v[l*3]=2,v[l*3+1]=p-2,v[l*3+2]=p-1,l++;x=i[de[T][1]];for(var w=0;w<x.length;w++)g[p*3+C]=e.dataBounds[T],g[p*3+de[T][1]]=x[w],g[p*3+de[T][0]]=e.dataBounds[de[T][0]*2],p++,g[p*3+C]=e.dataBounds[T],g[p*3+de[T][1]]=x[w],g[p*3+de[T][0]]=e.dataBounds[de[T][0]*2+1],p++,v[l*3]=2,v[l*3+1]=p-2,v[l*3+2]=p-1,l++}}e.polyData.getPoints().setData(g,3),e.polyData.getPoints().modified(),e.polyData.getLines().setData(v,1),e.polyData.getLines().modified(),e.polyData.modified()},t.updateTextData=function(n,a,i,s){for(var o=0,u=0;u<12;u++)a[u]===1&&(o+=2,o+=i[iu[u]].length);for(var c=e.polyData.getPoints().getData(),f=new Float64Array(o*3),g=0,v=0,p=0,l=0;l<6;l++)if(n[l])for(var y=0;y<4;y++){var h=au[l][y];if(a[h]===1){var d=iu[h],S=kn[h][0]*3,T=kn[h][1]*3;f[g*3]=.5*(c[S]+c[T]),f[g*3+1]=.5*(c[S+1]+c[T+1]),f[g*3+2]=.5*(c[S+2]+c[T+2]),g++;var C=Math.floor(l/2);f[g*3+C]=e.dataBounds[l],f[g*3+de[l][0]]=.5*(e.dataBounds[de[l][0]*2]+e.dataBounds[de[l][0]*2+1]),f[g*3+de[l][1]]=.5*(e.dataBounds[de[l][1]*2]+e.dataBounds[de[l][1]*2+1]),g++,e.textValues[v]=e.axisLabels[d],v++;var x=(d+1)%3,O=(d+2)%3,w=i[d],E=s[d];e.tickCounts[p]=w.length;for(var V=0;V<w.length;V++)f[g*3+d]=w[V],f[g*3+x]=c[S+x],f[g*3+O]=c[S+O],g++,e.textValues[v]=E[V],v++;p++}}e.textPolyData.getPoints().setData(f,3),e.textPolyData.modified()},t.update=function(){if(e.camera){for(var n=t.computeFacesToDraw(),a=e.lastFacesToDraw,i=!1,s=0;s<6;s++)e.dataBounds[s]!==e.lastTickBounds[s]&&(i=!0,e.lastTickBounds[s]=e.dataBounds[s]);if(n||i||e.forceUpdate){for(var o=new Array(12).fill(0),u=0;u<6;u++)if(a[u])for(var c=0;c<4;c++)o[au[u][c]]++;for(var f=[],g=[],v=0;v<3;v++){var p=ns().domain([e.dataBounds[v*2],e.dataBounds[v*2+1]]);f[v]=p.ticks(5);var l=p.tickFormat(5);g[v]=f[v].map(l)}t.updatePolyData(a,o,f),t.updateTextData(a,o,f,g),(i||e.forceUpdate)&&t.updateTextureAtlas(g)}e.forceUpdate=!1}},t.updateTextureAtlas=function(n){e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e._tmAtlas.clear();for(var a=0,i=1,s=0;s<3;s++){if(!e._tmAtlas.has(e.axisLabels[s])){ii(e.tmContext,e.axisTextStyle);var o=e.tmContext.measureText(e.axisLabels[s]),u={height:o.actualBoundingBoxAscent+2,startingHeight:i,width:o.width+2,textStyle:e.axisTextStyle};e._tmAtlas.set(e.axisLabels[s],u),i+=u.height,a<u.width&&(a=u.width)}ii(e.tmContext,e.tickTextStyle);for(var c=0;c<n[s].length;c++)if(!e._tmAtlas.has(n[s][c])){var f=e.tmContext.measureText(n[s][c]),g={height:f.actualBoundingBoxAscent+2,startingHeight:i,width:f.width+2,textStyle:e.tickTextStyle};e._tmAtlas.set(n[s][c],g),i+=g.height,a<g.width&&(a=g.width)}}a=at(a),i=at(i),e._tmAtlas.forEach(function(v){v.tcoords=[0,(i-v.startingHeight-v.height)/i,v.width/a,(i-v.startingHeight-v.height)/i,v.width/a,(i-v.startingHeight)/i,0,(i-v.startingHeight)/i]}),e.tmCanvas.width=a,e.tmCanvas.height=i,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,a,i),e._tmAtlas.forEach(function(v,p){ii(e.tmContext,v.textStyle),e.tmContext.fillText(p,1,v.startingHeight+v.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified()},t.onModified(function(){e.forceUpdate=!0,t.update()}),t.setTickTextStyle=function(n){e.tickTextStyle=nn(nn({},e.tickTextStyle),n),t.modified()},t.setAxisTextStyle=function(n){e.axisTextStyle=nn(nn({},e.axisTextStyle),n),t.modified()},t.get_tmAtlas=function(){return e._tmAtlas},t.getBounds=function(){return t.update(),Ce.setBounds(e.bounds,e.gridActor.getBounds()),Ce.scaleAboutCenter(e.bounds,e.boundsScaleFactor,e.boundsScaleFactor,e.boundsScaleFactor),e.bounds};var r=m.chain(t.setProperty,e.gridActor.setProperty);t.setProperty=function(n){return r(n)[0]}}function p2(t){return nn({boundsScaleFactor:1.3,camera:null,dataBounds:Y(Ce.INIT_BOUNDS),faceVisibilityAngle:8,gridLines:!0,axisLabels:null,axisTitlePixelOffset:35,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif"},tickLabelPixelOffset:12,tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif"}},t)}function wg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,p2(r)),Ar.extend(t,e,r),e.lastFacesToDraw=[!1,!1,!1,!1,!1,!1],e.axisLabels=["X-Axis","Y-Axis","Z-Axis"],e.tickCounts=[],e.textValues=[],e.lastTickBounds=[],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.tmTexture=Ua.newInstance(),e.tmTexture.setInterpolate(!1),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),e.gridMapper=Yt.newInstance(),e.polyData=qt.newInstance(),e.gridMapper.setInputData(e.polyData),e.gridActor=Ar.newInstance(),e.gridActor.setMapper(e.gridMapper),e.gridActor.setProperty(t.getProperty()),e.gridActor.setParentProp(t),e.textPolyData=qt.newInstance(),m.setGet(t,e,["axisTitlePixelOffset","boundsScaleFactor","faceVisibilityAngle","gridLines","tickLabelPixelOffset"]),m.setGetArray(t,e,["dataBounds"],6),m.setGetArray(t,e,["axisLabels"],3),m.get(t,e,["axisTextStyle","tickTextStyle","camera","tmTexture","textValues","textPolyData","tickCounts","gridActor"]),v2(t,e)}var l2=m.newInstance(wg,"vtkCubeAxesActor"),Eg={newInstance:l2,extend:wg,newCubeAxesActorHelper:g2};function h2(t,e){e.classHierarchy.push("vtkOpenGLCubeAxesActor"),t.buildPass=function(r){r&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,i=e._openGLRenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e._openGLRenderWindow.getRenderable())}}}var y2={};function d2(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,y2,r),Se.extend(t,e,r),e.CubeAxesActorHelper=Eg.newCubeAxesActorHelper(),h2(t,e)}var T2=ve(d2,"vtkOpenGLCubeAxesActor");Ye("vtkCubeAxesActor",T2);var bt={ARRAY_BUFFER:0,ELEMENT_ARRAY_BUFFER:1,TEXTURE_BUFFER:2},Dg={ObjectType:bt};function su(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ou(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?su(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):su(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ra=Dg.ObjectType,C2={};function S2(t,e){e.classHierarchy.push("vtkOpenGLBufferObject");function r(o){switch(o){case ra.ELEMENT_ARRAY_BUFFER:return e.context.ELEMENT_ARRAY_BUFFER;case ra.TEXTURE_BUFFER:if("TEXTURE_BUFFER"in e.context)return e.context.TEXTURE_BUFFER;case ra.ARRAY_BUFFER:default:return e.context.ARRAY_BUFFER}}var n=null,a=null,i=!0,s="";t.getType=function(){return n},t.setType=function(o){n=o},t.getHandle=function(){return a},t.isReady=function(){return i===!1},t.generateBuffer=function(o){var u=r(o);return a===null&&(a=e.context.createBuffer(),n=o),r(n)===u},t.upload=function(o,u){var c=t.generateBuffer(u);return c?(e.context.bindBuffer(r(n),a),e.context.bufferData(r(n),o,e.context.STATIC_DRAW),i=!1,!0):(s="Trying to upload array buffer to incompatible buffer.",!1)},t.bind=function(){return a?(e.context.bindBuffer(r(n),a),!0):!1},t.release=function(){return a?(e.context.bindBuffer(r(n),null),!0):!1},t.releaseGraphicsResources=function(){a!==null&&(e.context.bindBuffer(r(n),null),e.context.deleteBuffer(a),a=null)},t.setOpenGLRenderWindow=function(o){e._openGLRenderWindow!==o&&(t.releaseGraphicsResources(),e._openGLRenderWindow=o,e.context=null,o&&(e.context=e._openGLRenderWindow.getContext()))},t.getError=function(){return s}}var x2={objectType:ra.ARRAY_BUFFER,context:null};function Mg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,x2,r),m.obj(t,e),m.get(t,e,["_openGLRenderWindow"]),m.moveToProtected(t,e,["openGLRenderWindow"]),S2(t,e)}var O2=m.newInstance(Mg),Ga=ou(ou({newInstance:O2,extend:Mg},C2),Dg),uu=m.vtkErrorMacro;function m2(t,e){var r=new Float64Array(3);T0(r,e);var n=new Float64Array(16);return Mf(n,yr(),t,r),n}function w2(t,e){return t===null||e===null?!1:!(qs(t,[0,0,0])&&qs(e,[1,1,1]))}function E2(t,e){e.classHierarchy.push("vtkOpenGLCellArrayBufferObject"),t.setType(bt.ARRAY_BUFFER),t.createVBO=function(r,n,a,i){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!r.getData()||!r.getData().length)return e.elementCount=0,0;e.blockSize=3,e.vertexOffset=0,e.normalOffset=0,e.tCoordOffset=0,e.tCoordComponents=0,e.colorComponents=0,e.colorOffset=0,e.customData=[];var o=i.points.getData(),u=null,c=null,f=null,g=i.colors?i.colors.getNumberOfComponents():0,v=i.tcoords?i.tcoords.getNumberOfComponents():0;i.normals&&(e.normalOffset=4*e.blockSize,e.blockSize+=3,u=i.normals.getData()),i.customAttributes&&i.customAttributes.forEach(function(te){te&&(e.customData.push({data:te.getData(),offset:4*e.blockSize,components:te.getNumberOfComponents(),name:te.getName()}),e.blockSize+=te.getNumberOfComponents())}),i.tcoords&&(e.tCoordOffset=4*e.blockSize,e.tCoordComponents=v,e.blockSize+=v,c=i.tcoords.getData()),i.colors?(e.colorComponents=i.colors.getNumberOfComponents(),e.colorOffset=0,f=i.colors.getData(),e.colorBO||(e.colorBO=Ga.newInstance()),e.colorBO.setOpenGLRenderWindow(e._openGLRenderWindow)):e.colorBO=null,e.stride=4*e.blockSize;var p=0,l=0,y=0,h=0,d=0,S=0,T,C={anythingToPoints:function($,Q,Z){for(var K=0;K<$;++K)T(Q[Z+K])},linesToWireframe:function($,Q,Z){for(var K=0;K<$-1;++K)T(Q[Z+K]),T(Q[Z+K+1])},polysToWireframe:function($,Q,Z){if($>2)for(var K=0;K<$;++K)T(Q[Z+K]),T(Q[Z+(K+1)%$])},stripsToWireframe:function($,Q,Z){if($>2){for(var K=0;K<$-1;++K)T(Q[Z+K]),T(Q[Z+K+1]);for(var De=0;De<$-2;De++)T(Q[Z+De]),T(Q[Z+De+2])}},polysToSurface:function($,Q,Z){for(var K=0;K<$-2;K++)T(Q[Z+0]),T(Q[Z+K+1]),T(Q[Z+K+2])},stripsToSurface:function($,Q,Z){for(var K=0;K<$-2;K++)T(Q[Z+K]),T(Q[Z+K+1+K%2]),T(Q[Z+K+1+(K+1)%2])}},x={anythingToPoints:function($,Q){return $},linesToWireframe:function($,Q){return $>1?($-1)*2:0},polysToWireframe:function($,Q){return $>2?$*2:0},stripsToWireframe:function($,Q){return $>2?$*4-6:0},polysToSurface:function($,Q){return $>2?($-2)*3:0},stripsToSurface:function($,Q,Z){return $>2?($-2)*3:0}},O=null,w=null;a===Ie.POINTS||n==="verts"?(O=C.anythingToPoints,w=x.anythingToPoints):a===Ie.WIREFRAME||n==="lines"?(O=C["".concat(n,"ToWireframe")],w=x["".concat(n,"ToWireframe")]):(O=C["".concat(n,"ToSurface")],w=x["".concat(n,"ToSurface")]);for(var E=r.getData(),V=E.length,D=0,M=0;M<V;)D+=w(E[M],E),M+=E[M]+1;var L=null,N=new Float32Array(D*e.blockSize);f&&(L=new Uint8Array(D*4));for(var B=0,_=0,A=0,W=0,z=0;z<3;++z){var R=i.points.getRange(z),b=R[1]-R[0];A+=b*b;var F=.5*(R[1]+R[0]);W+=F*F}var G=A>0&&(Math.abs(W)/A>1e6||Math.abs(Math.log10(A))>3||A===0&&W>1e6);if(G){for(var U=new Float64Array(3),H=new Float64Array(3),j=0;j<3;++j){var I=i.points.getRange(j),re=I[1]-I[0];U[j]=.5*(I[1]+I[0]),H[j]=re>0?1/re:1}t.setCoordShiftAndScale(U,H)}else e.coordShiftAndScaleEnabled===!0&&t.setCoordShiftAndScale(null,null);if(s)if(!s.points&&!s.cells)s.points=new Int32Array(D),s.cells=new Int32Array(D);else{var ue=new Int32Array(D+s.points.length);ue.set(s.points),s.points=ue;var Le=new Int32Array(D+s.cells.length);Le.set(s.cells),s.cells=Le}var le=i.vertexOffset;T=function($){if(s&&(s.points[le]=$,s.cells[le]=S+i.cellOffset),++le,p=$*3,e.coordShiftAndScaleEnabled?(N[B++]=(o[p++]-e.coordShift[0])*e.coordScale[0],N[B++]=(o[p++]-e.coordShift[1])*e.coordScale[1],N[B++]=(o[p++]-e.coordShift[2])*e.coordScale[2]):(N[B++]=o[p++],N[B++]=o[p++],N[B++]=o[p++]),u!==null&&(i.haveCellNormals?l=(S+i.cellOffset)*3:l=$*3,N[B++]=u[l++],N[B++]=u[l++],N[B++]=u[l++]),e.customData.forEach(function(Z){d=$*Z.components;for(var K=0;K<Z.components;++K)N[B++]=Z.data[d++]}),c!==null){y=$*v;for(var Q=0;Q<v;++Q)N[B++]=c[y++]}f!==null&&(i.haveCellScalars?h=(S+i.cellOffset)*g:h=$*g,L[_++]=f[h++],L[_++]=f[h++],L[_++]=f[h++],L[_++]=g===4?f[h++]:255)};for(var J=0;J<V;)O(E[J],E,J+1),J+=E[J]+1,S++;return e.elementCount=D,t.upload(N,bt.ARRAY_BUFFER),e.colorBO&&(e.colorBOStride=4,e.colorBO.upload(L,bt.ARRAY_BUFFER)),S},t.setCoordShiftAndScale=function(r,n){if(r!==null&&(r.constructor!==Float64Array||r.length!==3)){uu("Wrong type for coordShift, expected vec3 or null");return}if(n!==null&&(n.constructor!==Float64Array||n.length!==3)){uu("Wrong type for coordScale, expected vec3 or null");return}(e.coordShift===null||r===null||!Qs(r,e.coordShift))&&(e.coordShift=r),(e.coordScale===null||n===null||!Qs(n,e.coordScale))&&(e.coordScale=n),e.coordShiftAndScaleEnabled=w2(e.coordShift,e.coordScale),e.coordShiftAndScaleEnabled?e.inverseShiftAndScaleMatrix=m2(e.coordShift,e.coordScale):e.inverseShiftAndScaleMatrix=null}}var D2={elementCount:0,stride:0,colorBOStride:0,vertexOffset:0,normalOffset:0,tCoordOffset:0,tCoordComponents:0,colorOffset:0,colorComponents:0,tcoordBO:null,customData:[],coordShift:null,coordScale:null,coordShiftAndScaleEnabled:!1,inverseShiftAndScaleMatrix:null};function Vg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,D2,r),Ga.extend(t,e,r),m.setGet(t,e,["colorBO","elementCount","stride","colorBOStride","vertexOffset","normalOffset","tCoordOffset","tCoordComponents","colorOffset","colorComponents","customData"]),m.get(t,e,["coordShift","coordScale","coordShiftAndScaleEnabled","inverseShiftAndScaleMatrix"]),E2(t,e)}var M2=m.newInstance(Vg),V2={newInstance:M2,extend:Vg},R2=m.vtkErrorMacro;function b2(t,e){e.classHierarchy.push("vtkShader"),t.compile=function(){var r=e.context.VERTEX_SHADER;if(!e.source||!e.source.length||e.shaderType==="Unknown")return!1;switch(e.handle!==0&&(e.context.deleteShader(e.handle),e.handle=0),e.shaderType){case"Fragment":r=e.context.FRAGMENT_SHADER;break;case"Vertex":default:r=e.context.VERTEX_SHADER;break}e.handle=e.context.createShader(r),e.context.shaderSource(e.handle,e.source),e.context.compileShader(e.handle);var n=e.context.getShaderParameter(e.handle,e.context.COMPILE_STATUS);if(!n){var a=e.context.getShaderInfoLog(e.handle);return R2("Error compiling shader '".concat(e.source,"': ").concat(a)),e.context.deleteShader(e.handle),e.handle=0,!1}return!0},t.cleanup=function(){e.shaderType==="Unknown"||e.handle===0||(e.context.deleteShader(e.handle),e.handle=0,e.dirty=!0)}}var L2={shaderType:"Unknown",source:"",error:"",handle:0,dirty:!1,context:null};function Rg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,L2,r),m.obj(t,e),m.setGet(t,e,["shaderType","source","error","handle","context"]),b2(t,e)}var B2=m.newInstance(Rg,"vtkShader"),si={newInstance:B2,extend:Rg},ct=m.vtkErrorMacro;function k2(t,e,r,n){var a=typeof r=="string"?r:r.join(`
`),i=n===!1?e:new RegExp(e,"g"),s=t.replace(i,a);return{replace:s!==a,result:s}}function N2(t,e){e.classHierarchy.push("vtkShaderProgram"),t.compileShader=function(){return e.vertexShader.compile()?e.fragmentShader.compile()?!t.attachShader(e.vertexShader)||!t.attachShader(e.fragmentShader)?(ct(e.error),0):t.link()?(t.setCompiled(!0),1):(ct("Links failed: ".concat(e.error)),0):(ct(e.fragmentShader.getSource().split(`
`).map(function(r,n){return"".concat(n,": ").concat(r)}).join(`
`)),ct(e.fragmentShader.getError()),0):(ct(e.vertexShader.getSource().split(`
`).map(function(r,n){return"".concat(n,": ").concat(r)}).join(`
`)),ct(e.vertexShader.getError()),0)},t.cleanup=function(){e.shaderType==="Unknown"||e.handle===0||(e.context.deleteShader(e.handle),e.handle=0)},t.bind=function(){return!e.linked&&!t.link()?!1:(e.context.useProgram(e.handle),t.setBound(!0),!0)},t.isBound=function(){return!!e.bound},t.release=function(){e.context.useProgram(null),t.setBound(!1)},t.setContext=function(r){e.vertexShader.setContext(r),e.fragmentShader.setContext(r),e.geometryShader.setContext(r)},t.link=function(){if(e.linked)return!0;if(e.handle===0)return e.error="Program has not been initialized, and/or does not have shaders.",!1;e.uniformLocs={},e.context.linkProgram(e.handle);var r=e.context.getProgramParameter(e.handle,e.context.LINK_STATUS);if(!r){var n=e.context.getProgramInfoLog(e.handle);return ct("Error linking shader ".concat(n)),e.handle=0,!1}return t.setLinked(!0),e.attributeLocs={},!0},t.setUniformMatrix=function(r,n){var a=t.findUniform(r);if(a===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;var i=new Float32Array(n);return e.context.uniformMatrix4fv(a,!1,i),!0},t.setUniformMatrix3x3=function(r,n){var a=t.findUniform(r);if(a===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;var i=new Float32Array(n);return e.context.uniformMatrix3fv(a,!1,i),!0},t.setUniformf=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1f(a,n),!0)},t.setUniformfv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1fv(a,n),!0)},t.setUniformi=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1i(a,n),!0)},t.setUniformiv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1iv(a,n),!0)},t.setUniform2f=function(r,n,a){var i=t.findUniform(r);if(i===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(a===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2f(i,n,a),!0},t.setUniform2fv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform2fv(a,n),!0)},t.setUniform2i=function(r,n,a){var i=t.findUniform(r);if(i===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(a===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2i(i,n,a),!0},t.setUniform2iv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform2iv(a,n),!0)},t.setUniform3f=function(r,n,a,i){var s=t.findUniform(r);if(s===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(i===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(s,n,a,i),!0},t.setUniform3fArray=function(r,n){var a=t.findUniform(r);if(a===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(!Array.isArray(n)||n.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(a,n[0],n[1],n[2]),!0},t.setUniform3fv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform3fv(a,n),!0)},t.setUniform3i=function(r){var n=t.findUniform(r);if(n===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];var o=i;if(o.length===1&&Array.isArray(o[0])&&(o=o[0]),o.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3i(n,o[0],o[1],o[2]),!0},t.setUniform3iv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform3iv(a,n),!0)},t.setUniform4f=function(r){var n=t.findUniform(r);if(n===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];var o=i;if(o.length===1&&Array.isArray(o[0])&&(o=o[0]),o.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4f(n,o[0],o[1],o[2],o[3]),!0},t.setUniform4fv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform4fv(a,n),!0)},t.setUniform4i=function(r){var n=t.findUniform(r);if(n===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];var o=i;if(o.length===1&&Array.isArray(o[0])&&(o=o[0]),o.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4i(n,o[0],o[1],o[2],o[3]),!0},t.setUniform4iv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform4iv(a,n),!0)},t.findUniform=function(r){if(!r||!e.linked)return-1;var n=e.uniformLocs[r];return n!==void 0?n:(n=e.context.getUniformLocation(e.handle,r),n===null?(e.error="Uniform ".concat(r," not found in current shader program."),e.uniformLocs[r]=-1,-1):(e.uniformLocs[r]=n,n))},t.isUniformUsed=function(r){if(!r)return!1;var n=e.uniformLocs[r];return n!==void 0?n!==null:e.linked?(n=e.context.getUniformLocation(e.handle,r),e.uniformLocs[r]=n,n!==null):(ct("attempt to find uniform when the shader program is not linked"),!1)},t.isAttributeUsed=function(r){if(!r)return!1;if(r in e.attributeLocs)return!0;if(!e.linked)return ct("attempt to find uniform when the shader program is not linked"),!1;var n=e.context.getAttribLocation(e.handle,r);return n===-1?!1:(e.attributeLocs[r]=n,!0)},t.attachShader=function(r){if(r.getHandle()===0)return e.error="Shader object was not initialized, cannot attach it.",!1;if(r.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;if(e.handle===0){var n=e.context.createProgram();if(n===0)return e.error="Could not create shader program.",!1;e.handle=n,e.linked=!1}return r.getShaderType()==="Vertex"&&(e.vertexShaderHandle!==0&&e.comntext.detachShader(e.handle,e.vertexShaderHandle),e.vertexShaderHandle=r.getHandle()),r.getShaderType()==="Fragment"&&(e.fragmentShaderHandle!==0&&e.context.detachShader(e.handle,e.fragmentShaderHandle),e.fragmentShaderHandle=r.getHandle()),e.context.attachShader(e.handle,r.getHandle()),t.setLinked(!1),!0},t.detachShader=function(r){if(r.getHandle()===0)return e.error="shader object was not initialized, cannot attach it.",!1;if(r.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;switch(e.handle===0&&(e.error="This shader program has not been initialized yet."),r.getShaderType()){case"Vertex":return e.vertexShaderHandle!==r.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,r.getHandle()),e.vertexShaderHandle=0,e.linked=!1,!0);case"Fragment":return e.fragmentShaderHandle!==r.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,r.getHandle()),e.fragmentShaderHandle=0,e.linked=!1,!0);default:return!1}},t.setContext=function(r){e.context=r,e.vertexShader.setContext(r),e.fragmentShader.setContext(r),e.geometryShader.setContext(r)},t.setLastCameraMTime=function(r){e.lastCameraMTime=r}}var F2={vertexShaderHandle:0,fragmentShaderHandle:0,geometryShaderHandle:0,vertexShader:null,fragmentShader:null,geometryShader:null,linked:!1,bound:!1,compiled:!1,error:"",handle:0,numberOfOutputs:0,attributesLocs:null,uniformLocs:null,md5Hash:0,context:null,lastCameraMTime:null};function bg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,F2,r),e.attributesLocs={},e.uniformLocs={},e.vertexShader=si.newInstance(),e.vertexShader.setShaderType("Vertex"),e.fragmentShader=si.newInstance(),e.fragmentShader.setShaderType("Fragment"),e.geometryShader=si.newInstance(),e.geometryShader.setShaderType("Geometry"),m.obj(t,e),m.get(t,e,["lastCameraMTime"]),m.setGet(t,e,["error","handle","compiled","bound","md5Hash","vertexShader","fragmentShader","geometryShader","linked"]),N2(t,e)}var U2=m.newInstance(bg,"vtkShaderProgram"),k={newInstance:U2,extend:bg,substitute:k2};function G2(t,e){e.classHierarchy.push("vtkOpenGLVertexArrayObject"),t.exposedMethod=function(){},t.initialize=function(){e.instancingExtension=null,e._openGLRenderWindow.getWebgl2()||(e.instancingExtension=e.context.getExtension("ANGLE_instanced_arrays")),!e.forceEmulation&&e._openGLRenderWindow&&e._openGLRenderWindow.getWebgl2()?(e.extension=null,e.supported=!0,e.handleVAO=e.context.createVertexArray()):(e.extension=e.context.getExtension("OES_vertex_array_object"),!e.forceEmulation&&e.extension?(e.supported=!0,e.handleVAO=e.extension.createVertexArrayOES()):e.supported=!1)},t.isReady=function(){return e.handleVAO!==0||e.supported===!1},t.bind=function(){if(t.isReady()||t.initialize(),t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(e.handleVAO):e.context.bindVertexArray(e.handleVAO);else if(t.isReady())for(var r=e.context,n=0;n<e.buffers.length;++n){var a=e.buffers[n];e.context.bindBuffer(r.ARRAY_BUFFER,a.buffer);for(var i=0;i<a.attributes.length;++i)for(var s=a.attributes[i],o=s.isMatrix?s.size:1,u=0;u<o;++u)r.enableVertexAttribArray(s.index+u),r.vertexAttribPointer(s.index+u,s.size,s.type,s.normalize,s.stride,s.offset+s.stride*u/s.size),s.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(s.index+u,1):r.vertexAttribDivisor(s.index+u,1))}},t.release=function(){if(t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(null):e.context.bindVertexArray(null);else if(t.isReady())for(var r=e.context,n=0;n<e.buffers.length;++n){var a=e.buffers[n];e.context.bindBuffer(r.ARRAY_BUFFER,a.buffer);for(var i=0;i<a.attributes.length;++i)for(var s=a.attributes[i],o=s.isMatrix?s.size:1,u=0;u<o;++u)r.enableVertexAttribArray(s.index+u),r.vertexAttribPointer(s.index+u,s.size,s.type,s.normalize,s.stride,s.offset+s.stride*u/s.size),s.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(s.index+u,0):r.vertexAttribDivisor(s.index+u,0)),r.disableVertexAttribArray(s.index+u)}},t.shaderProgramChanged=function(){t.release(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.handleProgram=0},t.releaseGraphicsResources=function(){t.shaderProgramChanged(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.supported=!0,e.handleProgram=0},t.addAttributeArray=function(r,n,a,i,s,o,u,c){return t.addAttributeArrayWithDivisor(r,n,a,i,s,o,u,c,0,!1)},t.addAttributeArrayWithDivisor=function(r,n,a,i,s,o,u,c,f,g){if(!r||!r.isBound()||n.getHandle()===0||n.getType()!==bt.ARRAY_BUFFER||(e.handleProgram===0&&(e.handleProgram=r.getHandle()),t.isReady()||t.initialize(),!t.isReady()||e.handleProgram!==r.getHandle()))return!1;var v=e.context,p={};if(p.name=a,p.index=v.getAttribLocation(e.handleProgram,a),p.offset=i,p.stride=s,p.type=o,p.size=u,p.normalize=c,p.isMatrix=g,p.divisor=f,p.Index===-1)return!1;if(n.bind(),v.enableVertexAttribArray(p.index),v.vertexAttribPointer(p.index,p.size,p.type,p.normalize,p.stride,p.offset),f>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(p.index,1):v.vertexAttribDivisor(p.index,1)),p.buffer=n.getHandle(),!e.supported){for(var l=!1,y=0;y<e.buffers.length;++y){var h=e.buffers[y];if(h.buffer===p.buffer){l=!0;for(var d=!1,S=0;S<h.attributes.length;++S){var T=h.attributes[S];T.name===a&&(d=!0,h.attributes[S]=p)}d||h.attributes.push(p)}}l||e.buffers.push({buffer:p.buffer,attributes:[p]})}return!0},t.addAttributeMatrixWithDivisor=function(r,n,a,i,s,o,u,c,f){var g=t.addAttributeArrayWithDivisor(r,n,a,i,s,o,u,c,f,!0);if(!g)return g;for(var v=e.context,p=v.getAttribLocation(e.handleProgram,a),l=1;l<u;l++)v.enableVertexAttribArray(p+l),v.vertexAttribPointer(p+l,u,o,c,s,i+s*l/u),f>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(p+l,1):v.vertexAttribDivisor(p+l,1));return!0},t.removeAttributeArray=function(r){if(!t.isReady()||e.handleProgram===0)return!1;if(!e.supported)for(var n=0;n<e.buffers.length;++n)for(var a=e.buffers[n],i=0;i<a.attributes.length;++i){var s=a.attributes[i];if(s.name===r)return a.attributes.splice(i,1),a.attributes.length||e.buffers.splice(n,1),!0}return!0},t.setOpenGLRenderWindow=function(r){e._openGLRenderWindow!==r&&(t.releaseGraphicsResources(),e._openGLRenderWindow=r,e.context=null,r&&(e.context=e._openGLRenderWindow.getContext()))}}var _2={forceEmulation:!1,handleVAO:0,handleProgram:0,supported:!0,buffers:null,context:null};function Lg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_2,r),e.buffers=[],m.obj(t,e),m.get(t,e,["supported"]),m.setGet(t,e,["forceEmulation"]),G2(t,e)}var W2=m.newInstance(Lg,"vtkOpenGLVertexArrayObject"),Bg={newInstance:W2,extend:Lg},Wt={Start:0,Points:0,Lines:1,Tris:2,TriStrips:3,TrisEdges:4,TriStripsEdges:5,End:6};function z2(t,e){e.classHierarchy.push("vtkOpenGLHelper"),t.setOpenGLRenderWindow=function(r){e.context=r.getContext(),e.program.setContext(e.context),e.VAO.setOpenGLRenderWindow(r),e.CABO.setOpenGLRenderWindow(r)},t.releaseGraphicsResources=function(r){e.VAO.releaseGraphicsResources(),e.CABO.releaseGraphicsResources(),e.CABO.setElementCount(0)},t.drawArrays=function(r,n,a,i){if(e.CABO.getElementCount()){var s=t.getOpenGLMode(a),o=t.haveWideLines(r,n),u=e.context,c=u.getParameter(u.DEPTH_WRITEMASK);e.pointPicking&&u.depthMask(!1);var f=s===u.LINES;f&&o?(t.updateShaders(r,n,i),u.drawArraysInstanced(s,0,e.CABO.getElementCount(),2*Math.ceil(n.getProperty().getLineWidth()))):(u.lineWidth(n.getProperty().getLineWidth()),t.updateShaders(r,n,i),u.drawArrays(s,0,e.CABO.getElementCount()),u.lineWidth(1));var g=(s===u.POINTS?1:0)||(s===u.LINES?2:3);return e.pointPicking&&u.depthMask(c),e.CABO.getElementCount()/g}return 0},t.getOpenGLMode=function(r){if(e.pointPicking)return e.context.POINTS;var n=e.primitiveType;return r===Ie.POINTS||n===Wt.Points?e.context.POINTS:r===Ie.WIREFRAME||n===Wt.Lines||n===Wt.TrisEdges||n===Wt.TriStripsEdges?e.context.LINES:e.context.TRIANGLES},t.haveWideLines=function(r,n){return n.getProperty().getLineWidth()>1?!(e.CABO.getOpenGLRenderWindow()&&e.CABO.getOpenGLRenderWindow().getHardwareMaximumLineWidth()>=n.getProperty().getLineWidth()):!1},t.getNeedToRebuildShaders=function(r,n,a){return!!(a.getNeedToRebuildShaders(t,r,n)||t.getProgram()===0||t.getShaderSourceTime().getMTime()<a.getMTime()||t.getShaderSourceTime().getMTime()<n.getMTime())},t.updateShaders=function(r,n,a){if(t.getNeedToRebuildShaders(r,n,a)){var i={Vertex:null,Fragment:null,Geometry:null};a.buildShaders(i,r,n);var s=e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgramArray(i.Vertex,i.Fragment,i.Geometry);s!==t.getProgram()&&(t.setProgram(s),t.getVAO().releaseGraphicsResources()),t.getShaderSourceTime().modified()}else e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgram(t.getProgram());t.getVAO().bind(),a.setMapperShaderParameters(t,r,n),a.setPropertyShaderParameters(t,r,n),a.setCameraShaderParameters(t,r,n),a.setLightingShaderParameters(t,r,n),a.invokeShaderCallbacks(t,r,n)},t.setMapperShaderParameters=function(r,n,a){if(t.haveWideLines(r,n)){t.getProgram().setUniform2f("viewportSize",a.usize,a.vsize);var i=parseFloat(n.getProperty().getLineWidth()),s=i/2;t.getProgram().setUniformf("lineWidthStepSize",i/Math.ceil(i)),t.getProgram().setUniformf("halfLineWidth",s)}e.primitiveType===Wt.Points||n.getProperty().getRepresentation()===Ie.POINTS?t.getProgram().setUniformf("pointSize",n.getProperty().getPointSize()):e.pointPicking&&t.getProgram().setUniformf("pointSize",t.getPointPickingPrimitiveSize())},t.replaceShaderPositionVC=function(r,n,a){var i=r.Vertex;i=k.substitute(i,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform float pointSize;"]).result,i=k.substitute(i,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl","  gl_PointSize = pointSize;"],!1).result,t.getOpenGLMode(a.getProperty().getRepresentation())===e.context.LINES&&t.haveWideLines(n,a)&&(i=k.substitute(i,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform vec2 viewportSize;","uniform float lineWidthStepSize;","uniform float halfLineWidth;"]).result,i=k.substitute(i,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl"," if (halfLineWidth > 0.0)","   {","   float offset = float(gl_InstanceID / 2) * lineWidthStepSize - halfLineWidth;","   vec4 tmpPos = gl_Position;","   vec3 tmpPos2 = tmpPos.xyz / tmpPos.w;","   tmpPos2.x = tmpPos2.x + 2.0 * mod(float(gl_InstanceID), 2.0) * offset / viewportSize[0];","   tmpPos2.y = tmpPos2.y + 2.0 * mod(float(gl_InstanceID + 1), 2.0) * offset / viewportSize[1];","   gl_Position = vec4(tmpPos2.xyz * tmpPos.w, tmpPos.w);","   }"]).result),r.Vertex=i},t.getPointPickingPrimitiveSize=function(){return e.primitiveType===Wt.Points?2:e.primitiveType===Wt.Lines?4:6}}var A2={context:null,program:null,shaderSourceTime:null,VAO:null,attributeUpdateTime:null,CABO:null,primitiveType:0,pointPicking:!1};function kg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,A2,r),m.obj(t,e),e.shaderSourceTime={},m.obj(e.shaderSourceTime),e.attributeUpdateTime={},m.obj(e.attributeUpdateTime),m.setGet(t,e,["program","shaderSourceTime","VAO","attributeUpdateTime","CABO","primitiveType","pointPicking"]),e.program=k.newInstance(),e.VAO=Bg.newInstance(),e.CABO=V2.newInstance(),z2(t,e)}var H2=m.newInstance(kg),Kr={newInstance:H2,extend:kg,primTypes:Wt},$2={CLAMP_TO_EDGE:0,REPEAT:1,MIRRORED_REPEAT:2},Hi={NEAREST:0,LINEAR:1,NEAREST_MIPMAP_NEAREST:2,NEAREST_MIPMAP_LINEAR:3,LINEAR_MIPMAP_NEAREST:4,LINEAR_MIPMAP_LINEAR:5},Ds={Wrap:$2,Filter:Hi},Ng=new Float32Array(1),P2=new Int32Array(Ng.buffer);function j2(t){Ng[0]=t;var e=P2[0],r=e>>16&32768,n=e>>12&2047,a=e>>23&255;return a<103?r:a>142?(r|=31744,r|=(a===255?0:1)&&e&8388607,r):a<113?(n|=2048,r|=(n>>114-a)+(n>>113-a&1),r):(r|=a-112<<10|n>>1,r+=n&1,r)}function K2(t){var e=(t&32768)>>15,r=(t&31744)>>10,n=t&1023;return r===0?(e?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):r===31?n?NaN:(e?-1:1)*(1/0):(e?-1:1)*Math.pow(2,r-15)*(1+n/Math.pow(2,10))}var st={fromHalf:K2,toHalf:j2};function fu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function X2(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fu(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Et=Ds.Wrap,Be=Ds.Filter,oe=ge.VtkDataTypes,oi=Xt,Or=P,Y2=Va,q2=st.toHalf;function Q2(t,e){e.classHierarchy.push("vtkOpenGLTexture"),t.render=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(c?e._openGLRenderWindow=c:(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent()),e.context=e._openGLRenderWindow.getContext(),e.renderable.getInterpolate()?(e.generateMipmap?t.setMinificationFilter(Be.LINEAR_MIPMAP_LINEAR):t.setMinificationFilter(Be.LINEAR),t.setMagnificationFilter(Be.LINEAR)):(t.setMinificationFilter(Be.NEAREST),t.setMagnificationFilter(Be.NEAREST)),e.renderable.getRepeat()&&(t.setWrapR(Et.REPEAT),t.setWrapS(Et.REPEAT),t.setWrapT(Et.REPEAT)),e.renderable.getInputData()&&e.renderable.setImage(null),!e.handle||e.renderable.getMTime()>e.textureBuildTime.getMTime()){if(e.renderable.getImage()!==null&&(e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(Be.LINEAR_MIPMAP_LINEAR)),e.renderable.getImage()&&e.renderable.getImageLoaded()&&(t.create2DFromImage(e.renderable.getImage()),t.activate(),t.sendParameters(),e.textureBuildTime.modified())),e.renderable.getCanvas()!==null){e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(Be.LINEAR_MIPMAP_LINEAR));var f=e.renderable.getCanvas();t.create2DFromRaw(f.width,f.height,4,oe.UNSIGNED_CHAR,f,!0),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}if(e.renderable.getJsImageData()!==null){var g=e.renderable.getJsImageData();e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(Be.LINEAR_MIPMAP_LINEAR)),t.create2DFromRaw(g.width,g.height,4,oe.UNSIGNED_CHAR,g.data,!0),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}var v=e.renderable.getInputData(0);if(v&&v.getPointData().getScalars()){for(var p=v.getExtent(),l=v.getPointData().getScalars(),y=[],h=0;h<e.renderable.getNumberOfInputPorts();++h){var d=e.renderable.getInputData(h),S=d?d.getPointData().getScalars().getData():null;S&&y.push(S)}e.renderable.getInterpolate()&&l.getNumberOfComponents()===4&&(e.generateMipmap=!0,t.setMinificationFilter(Be.LINEAR_MIPMAP_LINEAR)),y.length%6===0?t.createCubeFromRaw(p[1]-p[0]+1,p[3]-p[2]+1,l.getNumberOfComponents(),l.getDataType(),y):t.create2DFromRaw(p[1]-p[0]+1,p[3]-p[2]+1,l.getNumberOfComponents(),l.getDataType(),l.getData()),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}}e.handle&&t.activate()},t.destroyTexture=function(){t.deactivate(),e.context&&e.handle&&e.context.deleteTexture(e.handle),e.handle=0,e.numberOfDimensions=0,e.target=0,e.components=0,e.width=0,e.height=0,e.depth=0,t.resetFormatAndType()},t.createTexture=function(){e.handle||(e.handle=e.context.createTexture(),e.target&&(e.context.bindTexture(e.target,e.handle),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.bindTexture(e.target,null)))},t.getTextureUnit=function(){return e._openGLRenderWindow?e._openGLRenderWindow.getTextureUnitForTexture(t):-1},t.activate=function(){e._openGLRenderWindow.activateTexture(t),t.bind()},t.deactivate=function(){e._openGLRenderWindow&&e._openGLRenderWindow.deactivateTexture(t)},t.releaseGraphicsResources=function(c){c&&e.handle&&(c.activateTexture(t),c.deactivateTexture(t),e.context.deleteTexture(e.handle),e.handle=0,e.numberOfDimensions=0,e.target=0,e.internalFormat=0,e.format=0,e.openGLDataType=0,e.components=0,e.width=0,e.height=0,e.depth=0),e.shaderProgram&&(e.shaderProgram.releaseGraphicsResources(c),e.shaderProgram=null)},t.bind=function(){e.context.bindTexture(e.target,e.handle),e.autoParameters&&t.getMTime()>e.sendParametersTime.getMTime()&&t.sendParameters()},t.isBound=function(){var c=!1;if(e.context&&e.handle){var f=0;switch(e.target){case e.context.TEXTURE_2D:f=e.context.TEXTURE_BINDING_2D;break;default:Y2("impossible case");break}var g=e.context.getIntegerv(f);c=g===e.handle}return c},t.sendParameters=function(){e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e._openGLRenderWindow.getWebgl2()&&(e.context.texParameteri(e.target,e.context.TEXTURE_BASE_LEVEL,e.baseLevel),e.context.texParameteri(e.target,e.context.TEXTURE_MAX_LEVEL,e.maxLevel)),e.sendParametersTime.modified()},t.getInternalFormat=function(c,f){return e._forceInternalFormat||(e.internalFormat=t.getDefaultInternalFormat(c,f)),e.internalFormat||oi("Unable to find suitable internal format for T=".concat(c," NC= ").concat(f)),e.internalFormat},t.getDefaultInternalFormat=function(c,f){var g=0;return g=e._openGLRenderWindow.getDefaultTextureInternalFormat(c,f,e.oglNorm16Ext,e.useHalfFloat),g||(g||(oi("Unsupported internal texture type!"),oi("Unable to find suitable internal format for T=".concat(c," NC= ").concat(f))),g)},t.setInternalFormat=function(c){e._forceInternalFormat=!0,c!==e.internalFormat&&(e.internalFormat=c,t.modified())},t.getFormat=function(c,f){return e.format=t.getDefaultFormat(c,f),e.format},t.getDefaultFormat=function(c,f){if(e._openGLRenderWindow.getWebgl2())switch(f){case 1:return e.context.RED;case 2:return e.context.RG;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}else switch(f){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}},t.resetFormatAndType=function(){e.format=0,e.internalFormat=0,e._forceInternalFormat=!1,e.openGLDataType=0},t.getDefaultDataType=function(c){if(e._openGLRenderWindow.getWebgl2())switch(c){case oe.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case(e.oglNorm16Ext&&!e.useHalfFloat&&oe.SHORT):return e.context.SHORT;case(e.oglNorm16Ext&&!e.useHalfFloat&&oe.UNSIGNED_SHORT):return e.context.UNSIGNED_SHORT;case(e.useHalfFloat&&oe.SHORT):return e.context.HALF_FLOAT;case(e.useHalfFloat&&oe.UNSIGNED_SHORT):return e.context.HALF_FLOAT;case oe.FLOAT:case oe.VOID:default:return e.context.FLOAT}switch(c){case oe.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case oe.FLOAT:case oe.VOID:default:if(e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear"))return e.context.FLOAT;{var f=e.context.getExtension("OES_texture_half_float");if(f&&e.context.getExtension("OES_texture_half_float_linear"))return f.HALF_FLOAT_OES}return e.context.UNSIGNED_BYTE}},t.getOpenGLDataType=function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return(!e.openGLDataType||f)&&(e.openGLDataType=t.getDefaultDataType(c)),e.openGLDataType},t.getShiftAndScale=function(){var c=0,f=1;switch(e.openGLDataType){case e.context.BYTE:f=127.5,c=f-128;break;case e.context.UNSIGNED_BYTE:f=255,c=0;break;case e.context.SHORT:f=32767.5,c=f-32768;break;case e.context.UNSIGNED_SHORT:f=65536,c=0;break;case e.context.INT:f=21474836475e-1,c=f-2147483648;break;case e.context.UNSIGNED_INT:f=4294967295,c=0;break;case e.context.FLOAT:}return{shift:c,scale:f}},t.getOpenGLFilterMode=function(c){switch(c){case Be.NEAREST:return e.context.NEAREST;case Be.LINEAR:return e.context.LINEAR;case Be.NEAREST_MIPMAP_NEAREST:return e.context.NEAREST_MIPMAP_NEAREST;case Be.NEAREST_MIPMAP_LINEAR:return e.context.NEAREST_MIPMAP_LINEAR;case Be.LINEAR_MIPMAP_NEAREST:return e.context.LINEAR_MIPMAP_NEAREST;case Be.LINEAR_MIPMAP_LINEAR:return e.context.LINEAR_MIPMAP_LINEAR;default:return e.context.NEAREST}},t.getOpenGLWrapMode=function(c){switch(c){case Et.CLAMP_TO_EDGE:return e.context.CLAMP_TO_EDGE;case Et.REPEAT:return e.context.REPEAT;case Et.MIRRORED_REPEAT:return e.context.MIRRORED_REPEAT;default:return e.context.CLAMP_TO_EDGE}};function r(c,f){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,v=[],p=e.width*e.height*e.components;if(g&&(p*=e.depth),c!==oe.FLOAT&&e.openGLDataType===e.context.FLOAT)for(var l=0;l<f.length;l++)if(f[l]){var y=f[l].length>p?f[l].subarray(0,p):f[l];v.push(new Float32Array(y))}else v.push(null);if(c!==oe.UNSIGNED_CHAR&&e.openGLDataType===e.context.UNSIGNED_BYTE)for(var h=0;h<f.length;h++)if(f[h]){var d=f[h].length>p?f[h].subarray(0,p):f[h];v.push(new Uint8Array(d))}else v.push(null);var S=!1;if(e._openGLRenderWindow.getWebgl2())S=e.openGLDataType===e.context.HALF_FLOAT;else{var T=e.context.getExtension("OES_texture_half_float");S=T&&e.openGLDataType===T.HALF_FLOAT_OES}if(S)for(var C=0;C<f.length;C++)if(f[C]){for(var x=new Uint16Array(p),O=f[C],w=0;w<p;w++)x[w]=q2(O[w]);v.push(x)}else v.push(null);if(v.length===0)for(var E=0;E<f.length;E++)v.push(f[E]);return v}function n(c){if(e._openGLRenderWindow.getWebgl2())return c;var f=[],g=e.width,v=e.height,p=e.components;if(c&&(!Rn(g)||!Rn(v)))for(var l=e.context.getExtension("OES_texture_half_float"),y=at(g),h=at(v),d=y*h*e.components,S=0;S<c.length;S++)if(c[S]!==null){var T=null,C=v/h,x=g/y,O=!1;e.openGLDataType===e.context.FLOAT?T=new Float32Array(d):l&&e.openGLDataType===l.HALF_FLOAT_OES?(T=new Uint16Array(d),O=!0):T=new Uint8Array(d);for(var w=0;w<h;w++){var E=w*y*p,V=w*C,D=Math.floor(V),M=Math.ceil(V);M>=v&&(M=v-1);var L=V-D,N=1-L;D=D*g*p,M=M*g*p;for(var B=0;B<y;B++){var _=B*p,A=B*x,W=Math.floor(A),z=Math.ceil(A);z>=g&&(z=g-1);var R=A-W;W*=p,z*=p;for(var b=0;b<p;b++)O?T[E+_+b]=st.toHalf(st.fromHalf(c[S][D+W+b])*N*(1-R)+st.fromHalf(c[S][D+z+b])*N*R+st.fromHalf(c[S][M+W+b])*L*(1-R)+st.fromHalf(c[S][M+z+b])*L*R):T[E+_+b]=c[S][D+W+b]*N*(1-R)+c[S][D+z+b]*N*R+c[S][M+W+b]*L*(1-R)+c[S][M+z+b]*L*R}}f.push(T),e.width=y,e.height=h}else f.push(null);if(f.length===0)for(var F=0;F<c.length;F++)f.push(c[F]);return f}function a(c){if(e._openGLRenderWindow){var f;if(e.resizable||(f=e.renderable)!==null&&f!==void 0&&f.getResizable())return!1;if(e._openGLRenderWindow.getWebgl2()){var g=e._openGLRenderWindow.getGLInformations();return!(g.RENDERER.value.match(/WebKit/gi)&&navigator.platform.match(/Mac/gi)&&e.oglNorm16Ext&&(c===oe.UNSIGNED_SHORT||c===oe.SHORT))}return!1}return!1}t.create2DFromRaw=function(c,f,g,v,p){var l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;if(t.getOpenGLDataType(v,!0),t.getInternalFormat(v,g),t.getFormat(v,g),!e.internalFormat||!e.format||!e.openGLDataType)return Or("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=g,e.width=c,e.height=f,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();var y=[p],h=r(v,y),d=n(h);return e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,l),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),a(v)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),d[0]!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,d[0])):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,d[0]),e.generateMipmap&&e.context.generateMipmap(e.target),l&&e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,!1),t.deactivate(),!0},t.createCubeFromRaw=function(c,f,g,v,p){if(t.getOpenGLDataType(v),t.getInternalFormat(v,g),t.getFormat(v,g),!e.internalFormat||!e.format||!e.openGLDataType)return Or("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_CUBE_MAP,e.components=g,e.width=c,e.height=f,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),e.maxLevel=p.length/6-1,t.createTexture(),t.bind();for(var l=r(v,p),y=n(l),h=[],d=e.width,S=e.height,T=0;T<y.length;T++){T%6===0&&T!==0&&(d/=2,S/=2),h[T]=dn(v,S*d*e.components);for(var C=0;C<S;++C){var x=C*d*e.components,O=(S-C-1)*d*e.components;h[T].set(y[T].slice(O,O+d*e.components),x)}}e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),a(v)&&e.context.texStorage2D(e.target,6,e.internalFormat,e.width,e.height);for(var w=0;w<6;w++)for(var E=0,V=e.width,D=e.height;V>=1&&D>=1;){var M=null;E<=e.maxLevel&&(M=h[6*E+w]),a(v)?M!=null&&e.context.texSubImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+w,E,0,0,V,D,e.format,e.openGLDataType,M):e.context.texImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+w,E,e.internalFormat,V,D,0,e.format,e.openGLDataType,M),E++,V/=2,D/=2}return t.deactivate(),!0},t.createDepthFromRaw=function(c,f,g,v){return t.getOpenGLDataType(g),e.format=e.context.DEPTH_COMPONENT,e._openGLRenderWindow.getWebgl2()?g===oe.FLOAT?e.internalFormat=e.context.DEPTH_COMPONENT32F:e.internalFormat=e.context.DEPTH_COMPONENT16:e.internalFormat=e.context.DEPTH_COMPONENT,!e.internalFormat||!e.format||!e.openGLDataType?(Or("Failed to determine texture parameters."),!1):(e.target=e.context.TEXTURE_2D,e.components=1,e.width=c,e.height=f,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),a(g)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),v!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,v)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,v),e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0)},t.create2DFromImage=function(c){if(t.getOpenGLDataType(oe.UNSIGNED_CHAR),t.getInternalFormat(oe.UNSIGNED_CHAR,4),t.getFormat(oe.UNSIGNED_CHAR,4),!e.internalFormat||!e.format||!e.openGLDataType)return Or("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=4,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1);var f=!e._openGLRenderWindow.getWebgl2()&&(!Rn(c.width)||!Rn(c.height)),g=document.createElement("canvas");g.width=f?at(c.width):c.width,g.height=f?at(c.height):c.height,e.width=g.width,e.height=g.height;var v=g.getContext("2d");v.translate(0,g.height),v.scale(1,-1),v.drawImage(c,0,0,c.width,c.height,0,0,g.width,g.height);var p=g;return a(oe.UNSIGNED_CHAR)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),p!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,p)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,p),e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0};function i(c,f,g){for(var v=new Array(g),p=new Array(g),l=0;l<g;++l)v[l]=c[l],p[l]=f[l]-c[l]||1;return{scale:p,offset:v}}function s(c,f){for(var g=0;g<c.length;g++){var v=c[g],p=f[g]+v;if(v<-2048||v>2048||p<-2048||p>2048)return!1}return!0}function o(c,f,g,v){t.getOpenGLDataType(c);var p=!1;if(e._openGLRenderWindow.getWebgl2())p=e.openGLDataType===e.context.HALF_FLOAT;else{var l=e.context.getExtension("OES_texture_half_float");p=l&&e.openGLDataType===l.HALF_FLOAT_OES}var y=p&&(s(f,g)||v);e.useHalfFloat=y}function u(c,f){for(var g=c.getNumberOfComponents(),v=c.getDataType(),p=c.getData(),l=new Array(g),y=new Array(g),h=0;h<g;++h){var d=c.getRange(h),S=$e(d,2),T=S[0],C=S[1];l[h]=T,y[h]=C}var x=i(l,y,g);return o(v,x.offset,x.scale,f),e.useHalfFloat||t.getOpenGLDataType(v,!0),{numComps:g,dataType:v,data:p,scaleOffsets:x}}t.create2DFilterableFromRaw=function(c,f,g,v,p){var l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;return t.create2DFilterableFromDataArray(c,f,ge.newInstance({numberOfComponents:g,dataType:v,values:p}),l)},t.create2DFilterableFromDataArray=function(c,f,g){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,p=u(g,v),l=p.numComps,y=p.dataType,h=p.data;t.create2DFromRaw(c,f,l,y,h)},t.create3DFromRaw=function(c,f,g,v,p,l){if(t.getOpenGLDataType(p),t.getInternalFormat(p,v),t.getFormat(p,v),!e.internalFormat||!e.format||!e.openGLDataType)return Or("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_3D,e.components=v,e.width=c,e.height=f,e.depth=g,e.numberOfDimensions=3,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();var y=[l],h=!0,d=r(p,y,h),S=n(d);return e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),a(p)?(e.context.texStorage3D(e.target,1,e.internalFormat,e.width,e.height,e.depth),S[0]!=null&&e.context.texSubImage3D(e.target,0,0,0,0,e.width,e.height,e.depth,e.format,e.openGLDataType,S[0])):e.context.texImage3D(e.target,0,e.internalFormat,e.width,e.height,e.depth,0,e.format,e.openGLDataType,S[0]),e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0},t.create3DFilterableFromRaw=function(c,f,g,v,p,l){var y=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1;return t.create3DFilterableFromDataArray(c,f,g,ge.newInstance({numberOfComponents:v,dataType:p,values:l}),y)},t.create3DFilterableFromDataArray=function(c,f,g,v){for(var p=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=u(v,p),y=l.numComps,h=l.dataType,d=l.data,S=l.scaleOffsets,T=c*f*g,C=[],x=[],O=0;O<y;++O)C[O]=0,x[O]=1;e.volumeInfo={scale:x,offset:C,dataComputedScale:S.scale,dataComputedOffset:S.offset,width:c,height:f,depth:g};var w=structuredClone(S);if(e._openGLRenderWindow.getWebgl2()){if(e.oglNorm16Ext&&!e.useHalfFloat&&h===oe.SHORT){for(var E=0;E<y;++E)e.volumeInfo.scale[E]=32767;return t.create3DFromRaw(c,f,g,y,h,d)}if(e.oglNorm16Ext&&!e.useHalfFloat&&h===oe.UNSIGNED_SHORT){for(var V=0;V<y;++V)e.volumeInfo.scale[V]=65535;return t.create3DFromRaw(c,f,g,y,h,d)}if(h===oe.FLOAT||e.useHalfFloat&&(h===oe.SHORT||h===oe.UNSIGNED_SHORT))return t.create3DFromRaw(c,f,g,y,h,d);if(h===oe.UNSIGNED_CHAR){for(var D=0;D<y;++D)e.volumeInfo.scale[D]=255;return t.create3DFromRaw(c,f,g,y,h,d)}var M=new Float32Array(T*y);e.volumeInfo.offset=w.offset,e.volumeInfo.scale=w.scale;for(var L=0,N=w.scale.map(function(kt){return 1/kt}),B=0;B<T;B++)for(var _=0;_<y;_++)M[L]=(d[L]-w.offset[_])*N[_],L++;return t.create3DFromRaw(c,f,g,y,oe.FLOAT,M)}var A=function(Ke,xt,Zt,Sr,ft){Ke[xt]=Zt},W=oe.UNSIGNED_CHAR;if(h===oe.UNSIGNED_CHAR)for(var z=0;z<y;++z)w.offset[z]=0,w.scale[z]=255;else e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear")?(W=oe.FLOAT,A=function(Ke,xt,Zt,Sr,ft){Ke[xt]=(Zt-Sr)/ft}):(W=oe.UNSIGNED_CHAR,A=function(Ke,xt,Zt,Sr,ft){Ke[xt]=255*(Zt-Sr)/ft});if(t.getOpenGLDataType(W),t.getInternalFormat(W,y),t.getFormat(W,y),!e.internalFormat||!e.format||!e.openGLDataType)return Or("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=y,e.depth=1,e.numberOfDimensions=2;var R=e.context.getParameter(e.context.MAX_TEXTURE_SIZE);R>4096&&(W===oe.FLOAT||y>=3)&&(R=4096);var b=1,F=1;T>R*R&&(b=Math.ceil(Math.sqrt(T/(R*R))),F=b);var G=Math.sqrt(T)/b;G=at(G);var U=Math.floor(G*b/c),H=Math.ceil(g/U),j=at(f*H/F);e.width=G,e.height=j,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.volumeInfo.xreps=U,e.volumeInfo.yreps=H,e.volumeInfo.xstride=b,e.volumeInfo.ystride=F,e.volumeInfo.offset=w.offset,e.volumeInfo.scale=w.scale;var I,re=G*j*y;W===oe.FLOAT?I=new Float32Array(re):I=new Uint8Array(re);for(var ue=0,Le=Math.floor(c/b),le=Math.floor(f/F),J=0;J<H;J++)for(var te=Math.min(U,g-J*U),$=y*(e.width-te*Math.floor(c/b)),Q=0;Q<le;Q++){for(var Z=0;Z<te;Z++)for(var K=y*((J*U+Z)*c*f+F*Q*c),De=0;De<Le;De++)for(var et=0;et<y;et++)A(I,ue,d[K+b*De*y+et],w.offset[et],w.scale[et]),ue++;ue+=$}return e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),a(W)?(e.context.texStorage2D(e.target,1,e.internalFormat,e.width,e.height),I!=null&&e.context.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.openGLDataType,I)):e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,I),t.deactivate(),!0},t.setOpenGLRenderWindow=function(c){e._openGLRenderWindow!==c&&(t.releaseGraphicsResources(),e._openGLRenderWindow=c,e.context=null,c&&(e.context=e._openGLRenderWindow.getContext()))},t.getMaximumTextureSize=function(c){return c&&c.isCurrent()?c.getIntegerv(c.MAX_TEXTURE_SIZE):-1}}var Z2={_openGLRenderWindow:null,_forceInternalFormat:!1,context:null,handle:0,sendParametersTime:null,textureBuildTime:null,numberOfDimensions:0,target:0,format:0,openGLDataType:0,components:0,width:0,height:0,depth:0,autoParameters:!0,wrapS:Et.CLAMP_TO_EDGE,wrapT:Et.CLAMP_TO_EDGE,wrapR:Et.CLAMP_TO_EDGE,minificationFilter:Be.NEAREST,magnificationFilter:Be.NEAREST,minLOD:-1e3,maxLOD:1e3,baseLevel:0,maxLevel:1e3,generateMipmap:!1,useHalfFloat:!0,oglNorm16Ext:null};function Fg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Z2,r),Se.extend(t,e,r),e.sendParametersTime={},Ne(e.sendParametersTime,{mtime:0}),e.textureBuildTime={},Ne(e.textureBuildTime,{mtime:0}),Ra(t,e,["format","openGLDataType"]),be(t,e,["keyMatrixTime","minificationFilter","magnificationFilter","wrapS","wrapT","wrapR","generateMipmap","oglNorm16Ext"]),je(t,e,["width","height","volumeInfo","components","handle","target"]),ba(t,e,["openGLRenderWindow"]),Q2(t,e)}var Ug=ve(Fg,"vtkOpenGLTexture"),jt=X2({newInstance:Ug,extend:Fg},Ds);Ye("vtkTexture",Ug);var I2=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

attribute vec4 vertexMC;

// frag position in VC
//VTK::PositionVC::Dec

// optional normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// Texture coordinates
//VTK::TCoord::Dec

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

// Apple Bug
//VTK::PrimID::Dec

// picking support
//VTK::Picking::Dec

void main()
{
  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  //VTK::PrimID::Impl

  //VTK::PositionVC::Impl

  //VTK::Light::Impl

  //VTK::Picking::Impl
}
`,Ms=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// Template for the polydata mappers fragment shader

uniform int PrimitiveIDOffset;

// VC position of this fragment
//VTK::PositionVC::Dec

// optional color passed in from the vertex shader, vertexColor
//VTK::Color::Dec

// optional surface normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// Texture coordinates
//VTK::TCoord::Dec

// picking support
//VTK::Picking::Dec

// Depth Peeling Support
//VTK::DepthPeeling::Dec

// clipping plane vars
//VTK::Clip::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

// handle coincident offsets
//VTK::Coincident::Dec

//VTK::ZBuffer::Dec

void main()
{
  // VC position of this fragment. This should not branch/return/discard.
  //VTK::PositionVC::Impl

  // Place any calls that require uniform flow (e.g. dFdx) here.
  //VTK::UniformFlow::Impl

  // Set gl_FragDepth here (gl_FragCoord.z by default)
  //VTK::Depth::Impl

  // Early depth peeling abort:
  //VTK::DepthPeeling::PreColor

  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Clip::Impl

  //VTK::Color::Impl

  // Generate the normal if we are not passed in one
  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Light::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }

  //VTK::DepthPeeling::Impl

  //VTK::Picking::Impl

  // handle coincident offsets
  //VTK::Coincident::Impl

  //VTK::ZBuffer::Impl

  //VTK::RenderPassFragmentShader::Impl
}
`;function J2(t,e){t.replaceShaderCoincidentOffset=function(r,n,a){var i=t.getCoincidentParameters(n,a);if(i&&(i.factor!==0||i.offset!==0)){var s=r.Fragment;s=k.substitute(s,"//VTK::Coincident::Dec",["uniform float cfactor;","uniform float coffset;"]).result,e.context.getExtension("EXT_frag_depth")&&(i.factor!==0?(s=k.substitute(s,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,s=k.substitute(s,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):s=k.substitute(s,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + 0.000016*coffset;").result),e._openGLRenderWindow.getWebgl2()&&(i.factor!==0?(s=k.substitute(s,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,s=k.substitute(s,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):s=k.substitute(s,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + 0.000016*coffset;").result),r.Fragment=s}}}function eC(t,e){t.applyShaderReplacements=function(r,n,a){var i=null;if(n&&(i=n.ShaderReplacements),i)for(var s=0;s<i.length;s++){var o=i[s];if(a&&o.replaceFirst||!a&&!o.replaceFirst){var u=o.shaderType,c=r[u],f=k.substitute(c,o.originalValue,o.replacementValue,o.replaceAll);r[u]=f.result}}},t.buildShaders=function(r,n,a){t.getReplacedShaderTemplate(r,n,a),e.lastRenderPassShaderReplacement=e.currentRenderPass?e.currentRenderPass.getShaderReplacement():null,e.lastRenderPassShaderReplacement&&e.lastRenderPassShaderReplacement(r);var i=e.renderable.getViewSpecificProperties().OpenGL;t.applyShaderReplacements(r,i,!0),t.replaceShaderValues(r,n,a),t.applyShaderReplacements(r,i)},t.getReplacedShaderTemplate=function(r,n,a){var i=e.renderable.getViewSpecificProperties().OpenGL;t.getShaderTemplate(r,n,a);var s=r.Vertex;if(i){var o=i.VertexShaderCode;o!==void 0&&o!==""&&(s=o)}r.Vertex=s;var u=r.Fragment;if(i){var c=i.FragmentShaderCode;c!==void 0&&c!==""&&(u=c)}r.Fragment=u;var f=r.Geometry;if(i){var g=i.GeometryShaderCode;g!==void 0&&(f=g)}r.Geometry=f}}var Oa={implementReplaceShaderCoincidentOffset:J2,implementBuildShadersWithReplacements:eC};function cu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function gu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cu(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ui=Cr.FieldAssociations,Ee=Kr.primTypes,mr=Tr.Representation,vu=Tr.Shading,Un=Yt.ScalarMode,pu=jt.Filter,lu=jt.Wrap,nr=P,tC={type:"StartEvent"},rC={type:"EndEvent"},nC=Sn.CoordinateSystem;function aC(t){var e=t.getSelector();return e?e.getCurrentPass():We.MIN_KNOWN_PASS-1}function iC(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper"),t.buildPass=function(n){n&&(e.currentRenderPass=null,e.openGLActor=t.getFirstAncestorOfType("vtkOpenGLActor"),e._openGLRenderer=e.openGLActor.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera()))},t.translucentPass=function(n,a){n&&(e.currentRenderPass=a,t.render())},t.zBufferPass=function(n){n&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.opaqueZBufferPass=function(n){return t.zBufferPass(n)},t.opaquePass=function(n){n&&t.render()},t.render=function(){var n=e._openGLRenderWindow.getContext();if(e.context!==n){e.context=n;for(var a=Ee.Start;a<Ee.End;a++)e.primitives[a].setOpenGLRenderWindow(e._openGLRenderWindow)}var i=e.openGLActor.getRenderable(),s=e._openGLRenderer.getRenderable();t.renderPiece(s,i)},t.getShaderTemplate=function(n,a,i){n.Vertex=I2,n.Fragment=Ms,n.Geometry=""},t.replaceShaderColor=function(n,a,i){var s=n.Vertex,o=n.Geometry,u=n.Fragment,c=e.lastBoundBO.getReferenceByName("lastLightComplexity"),f=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity","uniform vec3 ambientColorUniform;","uniform vec3 diffuseColorUniform;"];c&&(f=f.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));var g=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];c&&(g=g.concat(["  vec3 specularColor;","  float specularPower;"])),g=g.concat(["  ambientColor = ambientColorUniform;","  diffuseColor = diffuseColorUniform;","  opacity = opacityUniform;"]),c&&(g=g.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges&&(f=f.concat(["varying vec4 vertexColorVSOutput;"]),s=k.substitute(s,"//VTK::Color::Dec",["attribute vec4 scalarColor;","varying vec4 vertexColorVSOutput;"]).result,s=k.substitute(s,"//VTK::Color::Impl",["vertexColorVSOutput =  scalarColor;"]).result,o=k.substitute(o,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,o=k.substitute(o,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges?u=k.substitute(u,"//VTK::Color::Impl",g.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])).result:e.renderable.getInterpolateScalarsBeforeMapping()&&e.renderable.getColorCoordinates()&&!e.drawingEdges?u=k.substitute(u,"//VTK::Color::Impl",g.concat(["  vec4 texColor = texture2D(texture1, tcoordVCVSOutput.st);","  diffuseColor = texColor.rgb;","  ambientColor = texColor.rgb;","  opacity = opacity*texColor.a;"])).result:(i.getBackfaceProperty()&&!e.drawingEdges&&(f=f.concat(["uniform float opacityUniformBF; // the fragment opacity","uniform float ambientIntensityBF; // the material ambient","uniform float diffuseIntensityBF; // the material diffuse","uniform vec3 ambientColorUniformBF; // ambient material color","uniform vec3 diffuseColorUniformBF; // diffuse material color"]),c?(f=f.concat(["uniform float specularIntensityBF; // the material specular intensity","uniform vec3 specularColorUniformBF; // intensity weighted color","uniform float specularPowerUniformBF;"]),g=g.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  specularColor = specularIntensityBF * specularColorUniformBF;","  specularPower = specularPowerUniformBF;","  opacity = opacityUniformBF; }"])):g=g.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  opacity = opacityUniformBF; }"])),e.haveCellScalars&&!e.drawingEdges&&(f=f.concat(["uniform samplerBuffer texture1;"])),u=k.substitute(u,"//VTK::Color::Impl",g).result),u=k.substitute(u,"//VTK::Color::Dec",f).result,n.Vertex=s,n.Geometry=o,n.Fragment=u},t.replaceShaderLight=function(n,a,i){var s=n.Fragment,o="",u=e.lastBoundBO.getReferenceByName("lastLightComplexity"),c=e.lastBoundBO.getReferenceByName("lastLightCount"),f=[];switch(u){case 0:s=k.substitute(s,"//VTK::Light::Impl",["  gl_FragData[0] = vec4(ambientColor * ambient + diffuseColor * diffuse, opacity);","  //VTK::Light::Impl"],!1).result;break;case 1:s=k.substitute(s,"//VTK::Light::Impl",["  float df = max(0.0, normalVCVSOutput.z);","  float sf = pow(df, specularPower);","  vec3 diffuseL = df * diffuseColor;","  vec3 specularL = sf * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"],!1).result;break;case 2:for(var g=0;g<c;++g)f=f.concat(["uniform vec3 lightColor".concat(g,";"),"uniform vec3 lightDirectionVC".concat(g,"; // normalized"),"uniform vec3 lightHalfAngleVC".concat(g,"; // normalized")]);s=k.substitute(s,"//VTK::Light::Dec",f).result,f=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  float df;"];for(var v=0;v<c;++v)f=f.concat(["  df = max(0.0, dot(normalVCVSOutput, -lightDirectionVC".concat(v,"));"),"  diffuseL += ((df".concat(o,") * lightColor").concat(v,");"),"  if (dot(normalVCVSOutput, lightDirectionVC".concat(v,") < 0.0)"),"    {","    float sf = pow( max(0.0, dot(lightHalfAngleVC".concat(v,",normalVCVSOutput)), specularPower);"),"    specularL += ((sf".concat(o,") * lightColor").concat(v,");"),"    }"]);f=f.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),s=k.substitute(s,"//VTK::Light::Impl",f,!1).result;break;case 3:for(var p=0;p<c;++p)f=f.concat(["uniform vec3 lightColor".concat(p,";"),"uniform vec3 lightDirectionVC".concat(p,"; // normalized"),"uniform vec3 lightHalfAngleVC".concat(p,"; // normalized"),"uniform vec3 lightPositionVC".concat(p,";"),"uniform vec3 lightAttenuation".concat(p,";"),"uniform float lightConeAngle".concat(p,";"),"uniform float lightExponent".concat(p,";"),"uniform int lightPositional".concat(p,";")]);s=k.substitute(s,"//VTK::Light::Dec",f).result,f=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  vec3 vertLightDirectionVC;","  float attenuation;","  float df;"];for(var l=0;l<c;++l)f=f.concat(["  attenuation = 1.0;","  if (lightPositional".concat(l," == 0)"),"    {","      vertLightDirectionVC = lightDirectionVC".concat(l,";"),"    }","  else","    {","    vertLightDirectionVC = vertexVC.xyz - lightPositionVC".concat(l,";"),"    float distanceVC = length(vertLightDirectionVC);","    vertLightDirectionVC = normalize(vertLightDirectionVC);","    attenuation = 1.0 /","      (lightAttenuation".concat(l,".x"),"       + lightAttenuation".concat(l,".y * distanceVC"),"       + lightAttenuation".concat(l,".z * distanceVC * distanceVC);"),"    // per OpenGL standard cone angle is 90 or less for a spot light","    if (lightConeAngle".concat(l," <= 90.0)"),"      {","      float coneDot = dot(vertLightDirectionVC, lightDirectionVC".concat(l,");"),"      // if inside the cone","      if (coneDot >= cos(radians(lightConeAngle".concat(l,")))"),"        {","        attenuation = attenuation * pow(coneDot, lightExponent".concat(l,");"),"        }","      else","        {","        attenuation = 0.0;","        }","      }","    }","    df = max(0.0, attenuation*dot(normalVCVSOutput, -vertLightDirectionVC));","    diffuseL += ((df".concat(o,") * lightColor").concat(l,");"),"    if (dot(normalVCVSOutput, vertLightDirectionVC) < 0.0)","      {","      float sf = attenuation*pow( max(0.0, dot(lightHalfAngleVC".concat(l,",normalVCVSOutput)), specularPower);"),"    specularL += ((sf".concat(o,") * lightColor").concat(l,");"),"    }"]);f=f.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),s=k.substitute(s,"//VTK::Light::Impl",f,!1).result;break;default:nr("bad light complexity")}n.Fragment=s},t.replaceShaderNormal=function(n,a,i){var s=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(s>0){var o=n.Vertex,u=n.Geometry,c=n.Fragment;e.lastBoundBO.getCABO().getNormalOffset()?(o=k.substitute(o,"//VTK::Normal::Dec",["attribute vec3 normalMC;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,o=k.substitute(o,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * normalMC;"]).result,u=k.substitute(u,"//VTK::Normal::Dec",["in vec3 normalVCVSOutput[];","out vec3 normalVCGSOutput;"]).result,u=k.substitute(u,"//VTK::Normal::Impl",["normalVCGSOutput = normalVCVSOutput[i];"]).result,c=k.substitute(c,"//VTK::Normal::Dec",["varying vec3 normalVCVSOutput;"]).result,c=k.substitute(c,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalVCVSOutput);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.haveCellNormals?(c=k.substitute(c,"//VTK::Normal::Dec",["uniform mat3 normalMatrix;","uniform samplerBuffer textureN;"]).result,c=k.substitute(c,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalMatrix *","    texelFetchBuffer(textureN, gl_PrimitiveID + PrimitiveIDOffset).xyz);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.lastBoundBO.getOpenGLMode(i.getProperty().getRepresentation())===e.context.LINES?(c=k.substitute(c,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,c=k.substitute(c,"//VTK::Normal::Impl",["vec3 normalVCVSOutput;","  if (abs(fdx.x) > 0.0)","    { fdx = normalize(fdx); normalVCVSOutput = normalize(cross(vec3(fdx.y, -fdx.x, 0.0), fdx)); }","  else { fdy = normalize(fdy); normalVCVSOutput = normalize(cross(vec3(fdy.y, -fdy.x, 0.0), fdy));}"]).result):(c=k.substitute(c,"//VTK::Normal::Dec",["uniform int cameraParallel;"]).result,c=k.substitute(c,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,c=k.substitute(c,"//VTK::Normal::Impl",["  fdx = normalize(fdx);","  fdy = normalize(fdy);","  vec3 normalVCVSOutput = normalize(cross(fdx,fdy));","  if (cameraParallel == 1 && normalVCVSOutput.z < 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }","  if (cameraParallel == 0 && dot(normalVCVSOutput,vertexVC.xyz) > 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }"]).result),n.Vertex=o,n.Geometry=u,n.Fragment=c}},t.replaceShaderPositionVC=function(n,a,i){e.lastBoundBO.replaceShaderPositionVC(n,a,i);var s=n.Vertex,o=n.Geometry,u=n.Fragment,c=e.lastBoundBO.getReferenceByName("lastLightComplexity");c>0?(s=k.substitute(s,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,s=k.substitute(s,"//VTK::PositionVC::Impl",["vertexVCVSOutput = MCVCMatrix * vertexMC;","  gl_Position = MCPCMatrix * vertexMC;"]).result,s=k.substitute(s,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result,o=k.substitute(o,"//VTK::PositionVC::Dec",["in vec4 vertexVCVSOutput[];","out vec4 vertexVCGSOutput;"]).result,o=k.substitute(o,"//VTK::PositionVC::Impl",["vertexVCGSOutput = vertexVCVSOutput[i];"]).result,u=k.substitute(u,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,u=k.substitute(u,"//VTK::PositionVC::Impl",["vec4 vertexVC = vertexVCVSOutput;"]).result):(s=k.substitute(s,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,s=k.substitute(s,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result),n.Vertex=s,n.Geometry=o,n.Fragment=u},t.replaceShaderTCoord=function(n,a,i){if(e.lastBoundBO.getCABO().getTCoordOffset()){var s=n.Vertex,o=n.Geometry,u=n.Fragment;if(e.drawingEdges)return;s=k.substitute(s,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result;var c=e.openGLActor.getActiveTextures(),f=2,g=2;if(c&&c.length>0&&(f=c[0].getComponents(),c[0].getTarget()===e.context.TEXTURE_CUBE_MAP&&(g=3)),e.renderable.getColorTextureMap()&&(f=e.renderable.getColorTextureMap().getPointData().getScalars().getNumberOfComponents(),g=2),g===2){if(s=k.substitute(s,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result,o=k.substitute(o,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput[];","out vec2 tcoordVCGSOutput;"]).result,o=k.substitute(o,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,u=k.substitute(u,"//VTK::TCoord::Dec",["varying vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,c&&c.length>=1)switch(f){case 1:u=k.substitute(u,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:u=k.substitute(u,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:u=k.substitute(u,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}}else switch(s=k.substitute(s,"//VTK::TCoord::Dec","attribute vec3 tcoordMC; varying vec3 tcoordVCVSOutput;").result,o=k.substitute(o,"//VTK::TCoord::Dec",["in vec3 tcoordVCVSOutput[];","out vec3 tcoordVCGSOutput;"]).result,o=k.substitute(o,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,u=k.substitute(u,"//VTK::TCoord::Dec",["varying vec3 tcoordVCVSOutput;","uniform samplerCube texture1;"]).result,f){case 1:u=k.substitute(u,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:u=k.substitute(u,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:u=k.substitute(u,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}n.Vertex=s,n.Geometry=o,n.Fragment=u}},t.replaceShaderClip=function(n,a,i){var s=n.Vertex,o=n.Fragment;if(e.renderable.getNumberOfClippingPlanes()){var u=e.renderable.getNumberOfClippingPlanes();s=k.substitute(s,"//VTK::Clip::Dec",["uniform int numClipPlanes;","uniform vec4 clipPlanes[".concat(u,"];"),"varying float clipDistancesVSOutput[".concat(u,"];")]).result,s=k.substitute(s,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < ".concat(u,"; planeNum++)"),"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,o=k.substitute(o,"//VTK::Clip::Dec",["uniform int numClipPlanes;","varying float clipDistancesVSOutput[".concat(u,"];")]).result,o=k.substitute(o,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < ".concat(u,"; planeNum++)"),"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}n.Vertex=s,n.Fragment=o},t.getCoincidentParameters=function(n,a){var i={factor:0,offset:0},s=a.getProperty();if(e.renderable.getResolveCoincidentTopology()||s.getEdgeVisibility()&&s.getRepresentation()===mr.SURFACE){var o=e.lastBoundBO.getPrimitiveType();o===Ee.Points||s.getRepresentation()===mr.POINTS?i=e.renderable.getCoincidentTopologyPointOffsetParameter():o===Ee.Lines||s.getRepresentation()===mr.WIREFRAME?i=e.renderable.getCoincidentTopologyLineOffsetParameters():(o===Ee.Tris||o===Ee.TriStrips)&&(i=e.renderable.getCoincidentTopologyPolygonOffsetParameters()),(o===Ee.TrisEdges||o===Ee.TriStripsEdges)&&(i=e.renderable.getCoincidentTopologyPolygonOffsetParameters(),i.factor/=2,i.offset/=2)}var u=e._openGLRenderer.getSelector();return u&&u.getFieldAssociation()===ui.FIELD_ASSOCIATION_POINTS&&(i.offset-=2),i},t.replaceShaderPicking=function(n,a,i){var s=n.Fragment,o=n.Vertex;if(s=k.substitute(s,"//VTK::Picking::Dec",["uniform int picking;","//VTK::Picking::Dec"]).result,!!e._openGLRenderer.getSelector()){switch((e.lastSelectionState===We.ID_LOW24||e.lastSelectionState===We.ID_HIGH24)&&(o=k.substitute(o,"//VTK::Picking::Dec",[`flat out int vertexIDVSOutput;
`,`uniform int VertexIDOffset;
`]).result,o=k.substitute(o,"//VTK::Picking::Impl",`  vertexIDVSOutput = gl_VertexID + VertexIDOffset;
`).result,s=k.substitute(s,"//VTK::Picking::Dec",`flat in int vertexIDVSOutput;
`).result,s=k.substitute(s,"//VTK::Picking::Impl",["  int idx = vertexIDVSOutput;","//VTK::Picking::Impl"]).result),e.lastSelectionState){case We.ID_LOW24:s=k.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float(idx%256)/255.0, float((idx/256)%256)/255.0, float((idx/65536)%256)/255.0, 1.0);").result;break;case We.ID_HIGH24:s=k.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float(idx)/255.0, 0.0, 0.0, 1.0);").result;break;default:s=k.substitute(s,"//VTK::Picking::Dec","uniform vec3 mapperIndex;").result,s=k.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result}n.Fragment=s,n.Vertex=o}},t.replaceShaderValues=function(n,a,i){if(t.replaceShaderColor(n,a,i),t.replaceShaderNormal(n,a,i),t.replaceShaderLight(n,a,i),t.replaceShaderTCoord(n,a,i),t.replaceShaderPicking(n,a,i),t.replaceShaderClip(n,a,i),t.replaceShaderCoincidentOffset(n,a,i),t.replaceShaderPositionVC(n,a,i),e.haveSeenDepthRequest){var s=n.Fragment;s=k.substitute(s,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,s=k.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result,n.Fragment=s}},t.getNeedToRebuildShaders=function(n,a,i){var s=0,o=0,u=n.getPrimitiveType(),c=e.currentInput,f=!1,g=c.getPointData().getNormals(),v=c.getCellData().getNormals(),p=i.getProperty().getInterpolation()===vu.FLAT,l=i.getProperty().getRepresentation(),y=n.getOpenGLMode(l,u);if((y===e.context.TRIANGLES||v&&!g||!p&&g||!p&&y===e.context.LINES)&&(f=!0),i.getProperty().getLighting()&&f){s=0;for(var h=a.getLightsByReference(),d=0;d<h.length;++d){var S=h[d],T=S.getSwitch();T>0&&(o++,s===0&&(s=1)),s===1&&(o>1||S.getIntensity()!==1||!S.lightTypeIsHeadLight())&&(s=2),s<3&&S.getPositional()&&(s=3)}}var C=!1,x=e.lastBoundBO.getReferenceByName("lastLightComplexity"),O=e.lastBoundBO.getReferenceByName("lastLightCount");return(x!==s||O!==o)&&(e.lastBoundBO.set({lastLightComplexity:s},!0),e.lastBoundBO.set({lastLightCount:o},!0),C=!0),(!e.currentRenderPass&&e.lastRenderPassShaderReplacement||e.currentRenderPass&&e.currentRenderPass.getShaderReplacement()!==e.lastRenderPassShaderReplacement)&&(C=!0),e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||n.getShaderSourceTime().getMTime()<e.renderable.getMTime()||n.getShaderSourceTime().getMTime()<e.currentInput.getMTime()||n.getShaderSourceTime().getMTime()<e.selectionStateChanged.getMTime()||C?(e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,!0):!1},t.invokeShaderCallbacks=function(n,a,i){var s=e.renderable.getViewSpecificProperties().ShadersCallbacks;s&&s.forEach(function(o){o.callback(o.userData,n,a,i)})},t.setMapperShaderParameters=function(n,a,i){if(n.getProgram().isUniformUsed("PrimitiveIDOffset")&&n.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),n.getProgram().isUniformUsed("VertexIDOffset")&&n.getProgram().setUniformi("VertexIDOffset",e.vertexIDOffset),n.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())){var s=e.lastBoundBO.getReferenceByName("lastLightComplexity");n.getProgram().isAttributeUsed("vertexMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"vertexMC",n.getCABO().getVertexOffset(),n.getCABO().getStride(),e.context.FLOAT,3,!1)||nr("Error setting vertexMC in shader VAO.")),n.getProgram().isAttributeUsed("normalMC")&&n.getCABO().getNormalOffset()&&s>0?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"normalMC",n.getCABO().getNormalOffset(),n.getCABO().getStride(),e.context.FLOAT,3,!1)||nr("Error setting normalMC in shader VAO."):n.getVAO().removeAttributeArray("normalMC"),e.renderable.getCustomShaderAttributes().forEach(function(O,w){n.getProgram().isAttributeUsed("".concat(O,"MC"))&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"".concat(O,"MC"),n.getCABO().getCustomData()[w].offset,n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getCustomData()[w].components,!1)||nr("Error setting ".concat(O,"MC in shader VAO.")))}),n.getProgram().isAttributeUsed("tcoordMC")&&n.getCABO().getTCoordOffset()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"tcoordMC",n.getCABO().getTCoordOffset(),n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getTCoordComponents(),!1)||nr("Error setting tcoordMC in shader VAO."):n.getVAO().removeAttributeArray("tcoordMC"),n.getProgram().isAttributeUsed("scalarColor")&&n.getCABO().getColorComponents()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO().getColorBO(),"scalarColor",n.getCABO().getColorOffset(),n.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,4,!0)||nr("Error setting scalarColor in shader VAO."):n.getVAO().removeAttributeArray("scalarColor"),n.getAttributeUpdateTime().modified()}if(e.renderable.getNumberOfClippingPlanes()){var o=e.renderable.getNumberOfClippingPlanes(),u=[],c=n.getCABO().getCoordShiftAndScaleEnabled(),f=c?n.getCABO().getInverseShiftAndScaleMatrix():null,g=f?Fe(e.tmpMat4,i.getMatrix()):i.getMatrix();f&&(ye(g,g),ke(g,g,f),ye(g,g));for(var v=0;v<o;v++){var p=[];e.renderable.getClippingPlaneInDataCoords(g,v,p);for(var l=0;l<4;l++)u.push(p[l])}n.getProgram().setUniformi("numClipPlanes",o),n.getProgram().setUniform4fv("clipPlanes",u)}e.internalColorTexture&&n.getProgram().isUniformUsed("texture1")&&n.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());var y=e.openGLActor.getActiveTextures();if(y)for(var h=0;h<y.length;++h){var d=y[h],S=d.getTextureUnit(),T="texture".concat(S+1);n.getProgram().isUniformUsed(T)&&n.getProgram().setUniformi(T,S)}if(e.haveSeenDepthRequest&&n.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),n.getProgram().isUniformUsed("coffset")){var C=t.getCoincidentParameters(a,i);n.getProgram().setUniformf("coffset",C.offset),n.getProgram().isUniformUsed("cfactor")&&n.getProgram().setUniformf("cfactor",C.factor)}n.setMapperShaderParameters(a,i,e._openGLRenderer.getTiledSizeAndOrigin());var x=e._openGLRenderer.getSelector();n.getProgram().setUniform3fArray("mapperIndex",x?x.getPropColorValue():[0,0,0]),n.getProgram().setUniformi("picking",x?x.getCurrentPass()+1:0)},t.setLightingShaderParameters=function(n,a,i){var s=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(!(s<2)){for(var o=n.getProgram(),u=0,c=a.getLightsByReference(),f=0;f<c.length;++f){var g=c[f],v=g.getSwitch();if(v>0){var p=g.getColorByReference(),l=g.getIntensity();e.lightColor[0]=p[0]*l,e.lightColor[1]=p[1]*l,e.lightColor[2]=p[2]*l;var y=g.getDirection(),h=a.getActiveCamera().getViewMatrix(),d=Y(y);g.lightTypeIsSceneLight()&&(d[0]=h[0]*y[0]+h[1]*y[1]+h[2]*y[2],d[1]=h[4]*y[0]+h[5]*y[1]+h[6]*y[2],d[2]=h[8]*y[0]+h[9]*y[1]+h[10]*y[2],Wr(d)),e.lightDirection[0]=d[0],e.lightDirection[1]=d[1],e.lightDirection[2]=d[2],e.lightHalfAngle[0]=-e.lightDirection[0],e.lightHalfAngle[1]=-e.lightDirection[1],e.lightHalfAngle[2]=-e.lightDirection[2]+1,Wr(e.lightDirection),o.setUniform3fArray("lightColor".concat(u),e.lightColor),o.setUniform3fArray("lightDirectionVC".concat(u),e.lightDirection),o.setUniform3fArray("lightHalfAngleVC".concat(u),e.lightHalfAngle),u++}}if(!(s<3)){var S=a.getActiveCamera(),T=S.getViewMatrix();ye(T,T),u=0;for(var C=0;C<c.length;++C){var x=c[C],O=x.getSwitch();if(O>0){var w=x.getTransformedPosition(),E=new Float64Array(3);ce(E,w,T),o.setUniform3fArray("lightAttenuation".concat(u),x.getAttenuationValuesByReference()),o.setUniformi("lightPositional".concat(u),x.getPositional()),o.setUniformf("lightExponent".concat(u),x.getExponent()),o.setUniformf("lightConeAngle".concat(u),x.getConeAngle()),o.setUniform3fArray("lightPositionVC".concat(u),[E[0],E[1],E[2]]),u++}}}}};function r(n,a,i){return a.identity(i),n.reduce(function(s,o,u){return u===0?o?a.copy(s,o):a.identity(s):o?a.multiply(s,s,o):s},i)}t.setCameraShaderParameters=function(n,a,i){var s=n.getProgram(),o=e.openGLCamera.getKeyMatrices(a),u=a.getActiveCamera(),c=e.openGLCamera.getKeyMatrixTime().getMTime(),f=s.getLastCameraMTime(),g=n.getCABO().getCoordShiftAndScaleEnabled(),v=g?n.getCABO().getInverseShiftAndScaleMatrix():null,p=i.getIsIdentity(),l=p?{mcwc:null,normalMatrix:null}:e.openGLActor.getKeyMatrices();if(i.getCoordinateSystem()===nC.DISPLAY){var y=e._openGLRenderer.getTiledSizeAndOrigin();ae(e.tmpMat4),e.tmpMat4[0]=2/y.usize,e.tmpMat4[12]=-1,e.tmpMat4[5]=2/y.vsize,e.tmpMat4[13]=-1,ke(e.tmpMat4,e.tmpMat4,v),s.setUniformMatrix("MCPCMatrix",e.tmpMat4)}else s.setUniformMatrix("MCPCMatrix",r([o.wcpc,l.mcwc,v],mi,e.tmpMat4));s.isUniformUsed("MCVCMatrix")&&s.setUniformMatrix("MCVCMatrix",r([o.wcvc,l.mcwc,v],mi,e.tmpMat4)),s.isUniformUsed("normalMatrix")&&s.setUniformMatrix3x3("normalMatrix",r([o.normalMatrix,l.normalMatrix],Pl,e.tmpMat3)),f!==c&&(s.isUniformUsed("cameraParallel")&&s.setUniformi("cameraParallel",u.getParallelProjection()),s.setLastCameraMTime(c)),p||s.setLastCameraMTime(0)},t.setPropertyShaderParameters=function(n,a,i){var s=n.getProgram(),o=i.getProperty(),u=o.getOpacity(),c=e.drawingEdges?o.getEdgeColorByReference():o.getAmbientColorByReference(),f=e.drawingEdges?o.getEdgeColorByReference():o.getDiffuseColorByReference(),g=e.drawingEdges?1:o.getAmbient(),v=e.drawingEdges?0:o.getDiffuse(),p=e.drawingEdges?0:o.getSpecular(),l=o.getSpecularPower();s.setUniformf("opacityUniform",u),s.setUniform3fArray("ambientColorUniform",c),s.setUniform3fArray("diffuseColorUniform",f),s.setUniformf("ambient",g),s.setUniformf("diffuse",v);var y=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(!(y<1)){var h=o.getSpecularColorByReference();if(s.setUniform3fArray("specularColorUniform",h),s.setUniformf("specularPowerUniform",l),s.setUniformf("specular",p),s.isUniformUsed("ambientIntensityBF")){if(o=i.getBackfaceProperty(),u=o.getOpacity(),c=o.getAmbientColor(),g=o.getAmbient(),f=o.getDiffuseColor(),v=o.getDiffuse(),h=o.getSpecularColor(),p=o.getSpecular(),s.setUniformf("ambientIntensityBF",g),s.setUniformf("diffuseIntensityBF",v),s.setUniformf("opacityUniformBF",u),s.setUniform3fArray("ambientColorUniformBF",c),s.setUniform3fArray("diffuseColorUniformBF",f),y<1)return;s.setUniformf("specularIntensityBF",p),s.setUniform3fArray("specularColorUniformBF",h),s.setUniformf("specularPowerUniformBF",l)}}},t.updateMaximumPointCellIds=function(n,a){var i,s,o,u,c=e._openGLRenderer.getSelector();if(c){if((i=e.selectionWebGLIdsToVTKIds)!==null&&i!==void 0&&(s=i.points)!==null&&s!==void 0&&s.length){var f=e.selectionWebGLIdsToVTKIds.points.length;c.setMaximumPointId(f-1)}if((o=e.selectionWebGLIdsToVTKIds)!==null&&o!==void 0&&(u=o.cells)!==null&&u!==void 0&&u.length){var g=e.selectionWebGLIdsToVTKIds.cells.length;c.setMaximumCellId(g-1)}var v=c.getFieldAssociation();v===ui.FIELD_ASSOCIATION_POINTS&&(e.pointPicking=!0)}},t.renderPieceStart=function(n,a){e.primitiveIDOffset=0,e.vertexIDOffset=0;var i=aC(e._openGLRenderer);if(e.lastSelectionState!==i&&(e.selectionStateChanged.modified(),e.lastSelectionState=i),e._openGLRenderer.getSelector())switch(i){default:e._openGLRenderer.getSelector().renderProp(a)}t.updateBufferObjects(n,a),e.renderable.getColorTextureMap()&&e.internalColorTexture.activate(),e.lastBoundBO=null},t.renderPieceDraw=function(n,a){for(var i=a.getProperty().getRepresentation(),s=a.getProperty().getEdgeVisibility()&&i===mr.SURFACE,o=e._openGLRenderer.getSelector(),u=o&&o.getFieldAssociation()===ui.FIELD_ASSOCIATION_POINTS&&(e.lastSelectionState===We.ID_LOW24||e.lastSelectionState===We.ID_HIGH24),c=Ee.Start;c<Ee.End;c++){e.primitives[c].setPointPicking(u);var f=e.primitives[c].getCABO();f.getElementCount()&&(e.drawingEdges=s&&(c===Ee.TrisEdges||c===Ee.TriStripsEdges),(!e.drawingEdges||!(e.renderDepth||e.lastSelectionState>=0))&&(e.lastBoundBO=e.primitives[c],e.primitiveIDOffset+=e.primitives[c].drawArrays(n,a,i,t),e.vertexIDOffset+=e.primitives[c].getCABO().getElementCount()))}},t.renderPieceFinish=function(n,a){e.LastBoundBO&&e.LastBoundBO.getVAO().release(),e.renderable.getColorTextureMap()&&e.internalColorTexture.deactivate()},t.renderPiece=function(n,a){if(t.invokeEvent(tC),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(rC),!e.currentInput){nr("No input!");return}if(!(!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues())){var i=e.context,s=a.getProperty().getBackfaceCulling(),o=a.getProperty().getFrontfaceCulling();!s&&!o?e._openGLRenderWindow.disableCullFace():o?(e._openGLRenderWindow.enableCullFace(),i.cullFace(i.FRONT)):(e._openGLRenderWindow.enableCullFace(),i.cullFace(i.BACK)),t.renderPieceStart(n,a),t.renderPieceDraw(n,a),t.renderPieceFinish(n,a)}},t.computeBounds=function(n,a){if(!t.getInput()){La(e.bounds);return}e.bounds=t.getInput().getBounds()},t.updateBufferObjects=function(n,a){t.getNeedToRebuildBufferObjects(n,a)&&t.buildBufferObjects(n,a)},t.getNeedToRebuildBufferObjects=function(n,a){var i=e.VBOBuildTime.getMTime();return i<t.getMTime()||i<e.renderable.getMTime()||i<a.getMTime()||i<e.currentInput.getMTime()},t.buildBufferObjects=function(n,a){var i=e.currentInput;if(i!==null){e.renderable.mapScalars(i,1);var s=e.renderable.getColorMapColors();e.haveCellScalars=!1;var o=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(o===Un.USE_CELL_DATA||o===Un.USE_CELL_FIELD_DATA||o===Un.USE_FIELD_DATA||!i.getPointData().getScalars())&&o!==Un.USE_POINT_FIELD_DATA&&s&&(e.haveCellScalars=!0);var u=a.getProperty().getInterpolation()!==vu.FLAT?i.getPointData().getNormals():null;u===null&&i.getCellData().getNormals()&&(e.haveCellNormals=!0,u=i.getCellData().getNormals());var c=a.getProperty().getRepresentation(),f=i.getPointData().getTCoords();if(e.openGLActor.getActiveTextures()||(f=null),e.renderable.getColorCoordinates()){f=e.renderable.getColorCoordinates(),e.internalColorTexture||(e.internalColorTexture=jt.newInstance({resizable:!0}));var g=e.internalColorTexture;g.setMinificationFilter(pu.NEAREST),g.setMagnificationFilter(pu.NEAREST),g.setWrapS(lu.CLAMP_TO_EDGE),g.setWrapT(lu.CLAMP_TO_EDGE),g.setOpenGLRenderWindow(e._openGLRenderWindow);var v=e.renderable.getColorTextureMap(),p=v.getExtent(),l=v.getPointData().getScalars();g.create2DFromRaw(p[1]-p[0]+1,p[3]-p[2]+1,l.getNumberOfComponents(),l.getDataType(),l.getData()),g.activate(),g.sendParameters(),g.deactivate()}var y="".concat(i.getMTime(),"A").concat(c,"B").concat(i.getMTime())+"C".concat(u?u.getMTime():1,"D").concat(s?s.getMTime():1)+"E".concat(a.getProperty().getEdgeVisibility())+"F".concat(f?f.getMTime():1);if(e.VBOBuildString!==y){var h=i.getPoints(),d={points:h,normals:u,tcoords:f,colors:s,cellOffset:0,vertexOffset:0,haveCellScalars:e.haveCellScalars,haveCellNormals:e.haveCellNormals,customAttributes:e.renderable.getCustomShaderAttributes().map(function(x){return i.getPointData().getArrayByName(x)})};e.renderable.getPopulateSelectionSettings()&&(e.selectionWebGLIdsToVTKIds={points:null,cells:null});for(var S=[{inRep:"verts",cells:i.getVerts()},{inRep:"lines",cells:i.getLines()},{inRep:"polys",cells:i.getPolys()},{inRep:"strips",cells:i.getStrips()},{inRep:"polys",cells:i.getPolys()},{inRep:"strips",cells:i.getStrips()}],T=a.getProperty().getEdgeVisibility()&&c===mr.SURFACE,C=Ee.Start;C<Ee.End;C++)C!==Ee.TrisEdges&&C!==Ee.TriStripsEdges?(d.cellOffset+=e.primitives[C].getCABO().createVBO(S[C].cells,S[C].inRep,c,d,e.selectionWebGLIdsToVTKIds),d.vertexOffset+=e.primitives[C].getCABO().getElementCount()):T?e.primitives[C].getCABO().createVBO(S[C].cells,S[C].inRep,mr.WIREFRAME,gu(gu({},d),{},{tcoords:null,colors:null,haveCellScalars:!1,haveCellNormals:!1})):e.primitives[C].releaseGraphicsResources();e.renderable.getPopulateSelectionSettings()&&(e.renderable.setSelectionWebGLIdsToVTKIds(e.selectionWebGLIdsToVTKIds),t.updateMaximumPointCellIds()),e.VBOBuildTime.modified(),e.VBOBuildString=y}}}}var sC={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null,tmpMat4:null,ambientColor:[],diffuseColor:[],specularColor:[],lightColor:[],lightHalfAngle:[],lightDirection:[],lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastSelectionState:We.MIN_KNOWN_PASS-1,selectionStateChanged:null,selectionWebGLIdsToVTKIds:null,pointPicking:!1};function Gg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,sC,r),Se.extend(t,e,r),Oa.implementReplaceShaderCoincidentOffset(t,e,r),Oa.implementBuildShadersWithReplacements(t,e,r),e.primitives=[],e.primTypes=Ee,e.tmpMat3=dr(new Float64Array(9)),e.tmpMat4=ae(new Float64Array(16));for(var n=Ee.Start;n<Ee.End;n++)e.primitives[n]=Kr.newInstance(),e.primitives[n].setPrimitiveType(n),e.primitives[n].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);be(t,e,["context"]),e.VBOBuildTime={},Ne(e.VBOBuildTime,{mtime:0}),e.selectionStateChanged={},Ne(e.selectionStateChanged,{mtime:0}),iC(t,e)}var _g=ve(Gg,"vtkOpenGLPolyDataMapper"),Wg={newInstance:_g,extend:Gg};Ye("vtkMapper",_g);var oC=Qt.ColorMode,ar=Qt.ScalarMode,fi=Qt.GetArray;function uC(t,e){e.classHierarchy.push("vtkMapper2D"),t.createDefaultLookupTable=function(){e.lookupTable=rn.newInstance()},t.getColorModeAsString=function(){return m.enumToString(oC,e.colorMode)},t.setColorModeToDefault=function(){return t.setColorMode(0)},t.setColorModeToMapScalars=function(){return t.setColorMode(1)},t.setColorModeToDirectScalars=function(){return t.setColorMode(2)},t.getScalarModeAsString=function(){return m.enumToString(ar,e.scalarMode)},t.setScalarModeToDefault=function(){return t.setScalarMode(0)},t.setScalarModeToUsePointData=function(){return t.setScalarMode(1)},t.setScalarModeToUseCellData=function(){return t.setScalarMode(2)},t.setScalarModeToUsePointFieldData=function(){return t.setScalarMode(3)},t.setScalarModeToUseCellFieldData=function(){return t.setScalarMode(4)},t.setScalarModeToUseFieldData=function(){return t.setScalarMode(5)},t.getAbstractScalars=function(r,n,a,i,s){if(!r||!e.scalarVisibility)return{scalars:null,cellFLag:!1};var o=null,u=!1;if(n===ar.DEFAULT)o=r.getPointData().getScalars(),o||(o=r.getCellData().getScalars(),u=!0);else if(n===ar.USE_POINT_DATA)o=r.getPointData().getScalars();else if(n===ar.USE_CELL_DATA)o=r.getCellData().getScalars(),u=!0;else if(n===ar.USE_POINT_FIELD_DATA){var c=r.getPointData();a===fi.BY_ID?o=c.getArrayByIndex(i):o=c.getArrayByName(s)}else if(n===ar.USE_CELL_FIELD_DATA){var f=r.getCellData();u=!0,a===fi.BY_ID?o=f.getArrayByIndex(i):o=f.getArrayByName(s)}else if(n===ar.USE_FIELD_DATA){var g=r.getFieldData();a===fi.BY_ID?o=g.getArrayByIndex(i):o=g.getArrayByName(s)}return{scalars:o,cellFlag:u}},t.getLookupTable=function(){return e.lookupTable||t.createDefaultLookupTable(),e.lookupTable},t.getMTime=function(){var r=e.mtime;if(e.lookupTable!==null){var n=e.lookupTable.getMTime();r=n>r?n:r}return r},t.mapScalars=function(r,n){var a=t.getAbstractScalars(r,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!a){e.colorMapColors=null;return}var i="".concat(t.getMTime()).concat(a.getMTime()).concat(n);if(e.colorBuildString!==i){e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]);var s=t.getLookupTable();s&&(s.build(),e.colorMapColors=s.mapScalars(a,e.colorMode,e.fieldDataTupleId)),e.colorBuildString="".concat(t.getMTime()).concat(a.getMTime()).concat(n)}}}var fC={static:!1,lookupTable:null,scalarVisibility:!1,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,transformCoordinate:null,viewSpecificProperties:null,customShaderAttributes:[]};function zg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fC,r),Qc.extend(t,e,r),m.get(t,e,["colorMapColors"]),m.setGet(t,e,["arrayAccessMode","colorByArrayName","colorMode","lookupTable","renderTime","scalarMode","scalarVisibility","static","transformCoordinate","useLookupTableScalarRange","viewSpecificProperties","customShaderAttributes"]),m.setGetArray(t,e,["scalarRange"],2),e.viewSpecificProperties||(e.viewSpecificProperties={}),uC(t,e)}var cC=m.newInstance(zg,"vtkMapper2D"),gC={newInstance:cC,extend:zg},vC=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

uniform int PrimitiveIDOffset;

// Texture coordinates
//VTK::TCoord::Dec

// Scalar coloring
//VTK::Color::Dec

// Depth Peeling
//VTK::DepthPeeling::Dec

// picking support
//VTK::Picking::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Color::Impl
  //VTK::TCoord::Impl

  //VTK::DepthPeeling::Impl
  //VTK::Picking::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }
}
`,pC=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

// all variables that represent positions or directions have a suffix
// indicating the coordinate system they are in. The possible values are
// MC - Model Coordinates
// WC - WC world coordinates
// VC - View Coordinates
// DC - Display Coordinates

in vec4 vertexWC;

// frag position in VC
//VTK::PositionVC::Dec

// material property values
//VTK::Color::Dec

// Texture coordinates
//VTK::TCoord::Dec

// Apple Bug
//VTK::PrimID::Dec

uniform mat4 WCVCMatrix;  // World to view matrix

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  gl_Position = WCVCMatrix*vertexWC;

  //VTK::TCoord::Impl

  //VTK::Color::Impl

  //VTK::PositionVC::Impl
}
`,Ag={BACKGROUND:0,FOREGROUND:1},Hg={DisplayLocation:Ag},rt=Kr.primTypes,Gn=gC.ScalarMode,_n=P,lC={type:"StartEvent"},hC={type:"EndEvent"};function yC(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper2D"),t.buildPass=function(n){n&&(e.openGLActor2D=t.getFirstAncestorOfType("vtkOpenGLActor2D"),e._openGLRenderer=e.openGLActor2D.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.openGLCamera=e._openGLRenderer.getViewNodeFor(e._openGLRenderer.getRenderable().getActiveCamera()))},t.overlayPass=function(n){n&&t.render()},t.getShaderTemplate=function(n,a,i){n.Vertex=pC,n.Fragment=vC,n.Geometry=""},t.render=function(){var n=e._openGLRenderWindow.getContext();if(e.context!==n){e.context=n;for(var a=rt.Start;a<rt.End;a++)e.primitives[a].setOpenGLRenderWindow(e._openGLRenderWindow)}var i=e.openGLActor2D.getRenderable(),s=e._openGLRenderer.getRenderable();t.renderPiece(s,i)},t.renderPiece=function(n,a){if(t.invokeEvent(lC),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(hC),!e.currentInput){_n("No input!");return}!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues()||(t.renderPieceStart(n,a),t.renderPieceDraw(n,a),t.renderPieceFinish(n,a))},t.renderPieceStart=function(n,a){if(e.primitiveIDOffset=0,e._openGLRenderer.getSelector())switch(e._openGLRenderer.getSelector().getCurrentPass()){default:e._openGLRenderer.getSelector().renderProp(a)}t.updateBufferObjects(n,a),e.lastBoundBO=null},t.getNeedToRebuildShaders=function(n,a,i){return n.getShaderSourceTime().getMTime()<e.renderable.getMTime()||n.getShaderSourceTime().getMTime()<e.currentInput.getMTime()},t.updateBufferObjects=function(n,a){t.getNeedToRebuildBufferObjects(n,a)&&t.buildBufferObjects(n,a)},t.getNeedToRebuildBufferObjects=function(n,a){var i=e.VBOBuildTime.getMTime();return!!(i<t.getMTime()||i<e._openGLRenderWindow.getMTime()||i<e.renderable.getMTime()||i<a.getMTime()||i<e.currentInput.getMTime()||e.renderable.getTransformCoordinate()&&i<n.getMTime())},t.buildBufferObjects=function(n,a){var i=e.currentInput;if(i!==null){e.renderable.mapScalars(i,a.getProperty().getOpacity());var s=e.renderable.getColorMapColors();e.haveCellScalars=!1;var o=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(o===Gn.USE_CELL_DATA||o===Gn.USE_CELL_FIELD_DATA||o===Gn.USE_FIELD_DATA||!i.getPointData().getScalars())&&o!==Gn.USE_POINT_FIELD_DATA&&s&&(e.haveCellScalars=!0);var u=a.getProperty().getRepresentation(),c=i.getPointData().getTCoords();e.openGLActor2D.getActiveTextures()||(c=null);var f=e.renderable.getTransformCoordinate(),g=n.getRenderWindow().getViews()[0],v=g.getViewportSize(n),p="".concat(i.getMTime(),"A").concat(u,"B").concat(i.getMTime())+"C".concat(s?s.getMTime():1)+"D".concat(c?c.getMTime():1)+"E".concat(f?n.getMTime():1)+"F".concat(v);if(e.VBOBuildString!==p){var l=i.getPoints();if(f){var y=Ca.newInstance(),h=l.getNumberOfPoints();y.setNumberOfPoints(h);for(var d=[],S=0;S<h;++S){l.getPoint(S,d),f.setValue(d);var T=f.getComputedDoubleViewportValue(n);y.setPoint(S,T[0],T[1],0)}l=y}var C={points:l,tcoords:c,colors:s,cellOffset:0,haveCellScalars:e.haveCellSCalars,customAttributes:e.renderable.getCustomShaderAttributes().map(function(x){return i.getPointData().getArrayByName(x)})};C.cellOffset+=e.primitives[rt.Points].getCABO().createVBO(i.getVerts(),"verts",u,C),C.cellOffset+=e.primitives[rt.Lines].getCABO().createVBO(i.getLines(),"lines",u,C),C.cellOffset+=e.primitives[rt.Tris].getCABO().createVBO(i.getPolys(),"polys",u,C),C.cellOffset+=e.primitives[rt.TriStrips].getCABO().createVBO(i.getStrips(),"strips",u,C),e.VBOBuildTime.modified(),e.VBOBuildString=p}}},t.renderPieceDraw=function(n,a){var i=a.getProperty().getRepresentation(),s=e.context;s.depthMask(!0);for(var o=rt.Start;o<rt.End;o++){var u=e.primitives[o].getCABO();u.getElementCount()&&(e.lastBoundBO=e.primitives[o],e.primitiveIDOffset+=e.primitives[o].drawArrays(n,a,i,t))}},t.renderPieceFinish=function(n,a){e.lastBoundBO&&e.lastBoundBO.getVAO().release()},t.replaceShaderValues=function(n,a,i){t.replaceShaderColor(n,a,i),t.replaceShaderTCoord(n,a,i),t.replaceShaderPicking(n,a,i),t.replaceShaderPositionVC(n,a,i)},t.replaceShaderColor=function(n,a,i){var s=n.Vertex,o=n.Geometry,u=n.Fragment;e.haveCellScalars&&(u=k.substitute(u,"//VTK::Color::Dec",["uniform samplerBuffer texture1;"]).result,u=k.substitute(u,"//VTK::Color::Impl",["gl_FragData[0] = texelFetchBuffer(texture1, gl_PrimitiveID + PrimitiveIDOffset);"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0?(s=k.substitute(s,"//VTK::Color::Dec",["in vec4 diffuseColor;","out vec4 fcolorVSOutput;"]).result,s=k.substitute(s,"//VTK::Color::Impl",["fcolorVSOutput = diffuseColor;"]).result,o=k.substitute(o,"//VTK::Color::Dec",[`in vec4 fcolorVSOutput[];
`,"out vec4 fcolorGSOutput;"]).result,o=k.substitute(o,"//VTK::Color::Impl",["fcolorGSOutput = fcolorVSOutput[i];"]).result,u=k.substitute(u,"//VTK::Color::Dec",["in vec4 fcolorVSOutput;"]).result,u=k.substitute(u,"//VTK::Color::Impl",["gl_FragData[0] = fcolorVSOutput;"]).result):(u=k.substitute(u,"//VTK::Color::Dec",["uniform vec4 diffuseColor;"]).result,u=k.substitute(u,"//VTK::Color::Impl",["gl_FragData[0] = diffuseColor;"]).result),n.Vertex=s,n.Geometry=o,n.Fragment=u},t.replaceShaderTCoord=function(n,a,i){if(e.lastBoundBO.getCABO().getTCoordOffset()){var s=n.Vertex,o=n.Geometry,u=n.Fragment,c=e.lastBoundBO.getCABO().getTCoordComponents();c===1?(s=k.substitute(s,"//VTK::TCoord::Dec",["in float tcoordMC;","out float tcoordVCVSOutput;"]).result,s=k.substitute(s,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,o=k.substitute(o,"//VTK::TCoord::Dec",[`in float tcoordVCVSOutput[];
`,"out float tcoordVCGSOutput;"]).result,o=k.substitute(o,["//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,u=k.substitute(u,"//VTK::TCoord::Dec",["in float tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,u=k.substitute(u,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, vec2(tcoordVCVSOutput,0));"]).result):c===2&&(s=k.substitute(s,"//VTK::TCoord::Dec",["in vec2 tcoordMC;","out vec2 tcoordVCVSOutput;"]).result,s=k.substitute(s,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,o=k.substitute(o,"//VTK::TCoord::Dec",[`in vec2 tcoordVCVSOutput[];
`,"out vec2 tcoordVCGSOutput;"]).result,o=k.substitute(o,"//VTK::TCoord::Impl",["tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,u=k.substitute(u,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,u=k.substitute(u,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, tcoordVCVSOutput.st);"]).result),e.haveCellScalars&&(o=k.substitute(o,"//VTK::PrimID::Impl",["gl_PrimitiveID = gl_PrimitiveIDIn;"]).result),n.Vertex=s,n.Geometry=o,n.Fragment=u}},t.replaceShaderPicking=function(n,a,i){var s=n.Fragment;s=k.substitute(s,"//VTK::Picking::Dec",["uniform vec3 mapperIndex;","uniform int picking;"]).result,s=k.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result,n.Fragment=s},t.replaceShaderPositionVC=function(n,a,i){e.lastBoundBO.replaceShaderPositionVC(n,a,i)},t.invokeShaderCallbacks=function(n,a,i){var s=e.renderable.getViewSpecificProperties().ShadersCallbacks;s&&s.forEach(function(o){o.callback(o.userData,n,a,i)})},t.setMapperShaderParameters=function(n,a,i){if(n.getProgram().isUniformUsed("PrimitiveIDOffset")&&n.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),n.getProgram().isAttributeUsed("vertexWC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"vertexWC",n.getCABO().getVertexOffset(),n.getCABO().getStride(),e.context.FLOAT,3,!1)||_n("Error setting vertexWC in shader VAO.")),n.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())){e.renderable.getCustomShaderAttributes().forEach(function(v,p){n.getProgram().isAttributeUsed("".concat(v,"MC"))&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"".concat(v,"MC"),n.getCABO().getCustomData()[p].offset,n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getCustomData()[p].components,!1)||_n("Error setting ".concat(v,"MC in shader VAO.")))}),n.getProgram().isAttributeUsed("tcoordMC")&&n.getCABO().getTCoordOffset()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"tcoordMC",n.getCABO().getTCoordOffset(),n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getTCoordComponents(),!1)||_n("Error setting tcoordMC in shader VAO."):n.getVAO().removeAttributeArray("tcoordMC"),e.internalColorTexture&&n.getProgram().isUniformUsed("texture1")&&n.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());var s=e.openGLActor2D.getActiveTextures();if(s)for(var o=0;o<s.length;++o){var u=s[o],c=u.getTextureUnit(),f="texture".concat(c+1);n.getProgram().isUniformUsed(f)&&n.getProgram().setUniformi(f,c)}n.setMapperShaderParameters(a,i,e._openGLRenderer.getTiledSizeAndOrigin());var g=e._openGLRenderer.getSelector();n.getProgram().setUniform3fArray("mapperIndex",g?g.getPropColorValue():[0,0,0]),n.getProgram().setUniformi("picking",g?g.getCurrentPass()+1:0)}},t.setPropertyShaderParameters=function(n,a,i){var s=e.renderable.getColorMapColors();if(!s||s.getNumberOfComponents()===0){var o=n.getProgram(),u=i.getProperty(),c=u.getOpacity(),f=u.getColor(),g=[f[0],f[1],f[2],c];o.setUniform4f("diffuseColor",g)}},t.setLightingShaderParameters=function(n,a,i){};function r(n,a,i){return a.identity(i),n.reduce(function(s,o,u){return u===0?o?a.copy(s,o):a.identity(s):o?a.multiply(s,s,o):s},i)}t.setCameraShaderParameters=function(n,a,i){var s=n.getProgram(),o=n.getCABO().getCoordShiftAndScaleEnabled(),u=o?n.getCABO().getInverseShiftAndScaleMatrix():null,c=a.getRenderWindow().getViews()[0],f=c.getViewportSize(a),g=a.getViewport(),v=i.getActualPositionCoordinate().getComputedDoubleViewportValue(a),p=[0,0,1,1],l=[0,0,1,1];if(l[0]=g[0]>=p[0]?g[0]:p[0],l[1]=g[1]>=p[1]?g[1]:p[1],l[2]=g[2]<=p[2]?g[2]:p[2],l[3]=g[3]<=p[3]?g[3]:p[3],!(l[0]>=l[2])&&!(l[1]>=l[3])){f[0]=Vn(f[0]*(l[2]-l[0])/(g[2]-g[0])),f[1]=Vn(f[1]*(l[3]-l[1])/(g[3]-g[1]));var y=e._openGLRenderer.getParent().getSize(),h=Vn(v[0]-(l[0]-g[0])*y[0]),d=Vn(v[1]-(l[1]-g[1])*y[1]),S=-h,T=-h+f[0],C=-d,x=-d+f[1];S===T&&(T=S+1),C===x&&(x=C+1);var O=ae(new Float64Array(16));O[0]=2/(T-S),O[1*4+1]=2/(x-C),O[0*4+3]=-1*(T+S)/(T-S),O[1*4+3]=-1*(x+C)/(x-C),O[2*4+2]=0,O[2*4+3]=i.getProperty().getDisplayLocation()===Ag.FOREGROUND?-1:1,O[3*4+3]=1,ye(O,O),s.setUniformMatrix("WCVCMatrix",r([O,u],mi,e.tmpMat4))}}}var dC={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null};function TC(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dC,r),Se.extend(t,e,r),Oa.implementReplaceShaderCoincidentOffset(t,e,r),Oa.implementBuildShadersWithReplacements(t,e,r),e.primitives=[],e.primTypes=rt,e.tmpMat4=ae(new Float64Array(16));for(var n=rt.Start;n<rt.End;n++)e.primitives[n]=Kr.newInstance(),e.primitives[n].setPrimitiveType(n),e.primitives[n].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);be(t,e,["context"]),e.VBOBuildTime={},Ne(e.VBOBuildTime,{mtime:0}),yC(t,e)}var CC=ve(TC,"vtkOpenGLPolyDataMapper2D");Ye("vtkMapper2D",CC);function hu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Vt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hu(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var SC=ag.VectorMode;function ci(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font="".concat(e.fontStyle," ").concat(e.fontSize,"px ").concat(e.fontFamily)}function $g(t,e){return function(r){var n=r.getLastSize(),a=Math.pow(n[0]/700,.8),i=Math.pow(n[1]/700,.8),s=Math.min(a,i),o=r.getAxisTextStyle(),u=r.getTickTextStyle();Object.assign(o,e.axisTextStyle),Object.assign(u,e.tickTextStyle),o.fontSize=Math.max(24*s,12),r.getLastAspectRatio()>1?u.fontSize=Math.max(20*s,10):u.fontSize=Math.max(16*s,10);var c=r.updateTextureAtlas();r.setTopTitle(!1);var f=r.getBoxSizeByReference();if(r.getLastAspectRatio()>1)r.setTickLabelPixelOffset(.3*u.fontSize),c.titleWidth<=c.tickWidth+r.getTickLabelPixelOffset()+.8*u.fontSize?(r.setTopTitle(!0),r.setAxisTitlePixelOffset(.2*u.fontSize),f[0]=2*(c.tickWidth+r.getTickLabelPixelOffset()+.8*u.fontSize)/n[0],r.setBoxPosition([.98-f[0],-.92])):(r.setAxisTitlePixelOffset(.2*u.fontSize),f[0]=2*(c.titleHeight+r.getAxisTitlePixelOffset()+c.tickWidth+r.getTickLabelPixelOffset()+.8*u.fontSize)/n[0],r.setBoxPosition([.99-f[0],-.92])),f[1]=Math.max(1.2,Math.min(1.84/i,1.84));else{r.setAxisTitlePixelOffset(1.2*u.fontSize),r.setTickLabelPixelOffset(.1*u.fontSize);var g=2*(.8*u.fontSize+c.titleHeight+r.getAxisTitlePixelOffset())/n[1],v=2*c.tickWidth/n[0];f[0]=Math.min(1.9,Math.max(1.4,1.4*v*(r.getTicks().length+3))),f[1]=g,r.setBoxPosition([-.5*f[0],-.97])}r.recomputeBarSegments(c)}}function Pg(t,e){return function(r){var n=r.getLastTickBounds(),a=ns().domain([n[0],n[1]]),i=a.ticks(5),s=a.tickFormat(5);r.setTicks(i),r.setTickStrings(i.map(s))}}function xC(t,e){e.classHierarchy.push("vtkScalarBarActorHelper"),t.setRenderable=function(a){e.renderable!==a&&(e.renderable=a,e.barActor.setProperty(a.getProperty()),e.barActor.setParentProp(a),e.barActor.setCoordinateSystemToDisplay(),e.tmActor.setProperty(a.getProperty()),e.tmActor.setParentProp(a),e.tmActor.setCoordinateSystemToDisplay(),e.generateTicks=a.generateTicks,e.axisTextStyle=Vt({},a.getAxisTextStyle()),e.tickTextStyle=Vt({},a.getTickTextStyle()),t.modified())},t.updateAPISpecificData=function(a,i,s){(e.lastSize[0]!==a[0]||e.lastSize[1]!==a[1])&&(e.lastSize[0]=a[0],e.lastSize[1]=a[1],e.lastAspectRatio=a[0]/a[1],e.forceUpdate=!0);var o=e.renderable.getScalarsToColors();if(!(!o||!e.renderable.getVisibility())&&(e.barMapper.setLookupTable(o),e.camera=i,e.renderWindow=s,e.forceUpdate||Math.max(o.getMTime(),t.getMTime(),e.renderable.getMTime())>e.lastRebuildTime.getMTime())){var u=o.getMappingRange();if(e.lastTickBounds=Y(u),e.renderable.getGenerateTicks()(t),e.renderable.getAutomated())e.renderable.getAutoLayout()(t);else{e.axisTextStyle=Vt({},e.renderable.getAxisTextStyle()),e.tickTextStyle=Vt({},e.renderable.getTickTextStyle()),e.barPosition=Y(e.renderable.getBarPosition()),e.barSize=Y(e.renderable.getBarSize()),e.boxPosition=Y(e.renderable.getBoxPosition()),e.boxSize=Y(e.renderable.getBoxSize()),e.axisTitlePixelOffset=e.renderable.getAxisTitlePixelOffset(),e.tickLabelPixelOffset=e.renderable.getTickLabelPixelOffset();var c=t.updateTextureAtlas();t.recomputeBarSegments(c)}t.updatePolyDataForLabels(),t.updatePolyDataForBarSegments(),e.lastRebuildTime.modified(),e.forceUpdate=!1}},t.updateTextureAtlas=function(){e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left";var a={},i=new Map,s=0,o=1;ci(e.tmContext,e.axisTextStyle);var u=e.tmContext.measureText(e.renderable.getAxisLabel()),c={height:u.actualBoundingBoxAscent+2,startingHeight:o,width:u.width+2,textStyle:e.axisTextStyle};i.set(e.renderable.getAxisLabel(),c),o+=c.height,s=c.width,a.titleWidth=c.width,a.titleHeight=c.height,a.tickWidth=0,a.tickHeight=0,ci(e.tmContext,e.tickTextStyle);for(var f=[].concat(Y(t.getTickStrings()),["NaN","Below","Above"]),g=0;g<f.length;g++)i.has(f[g])||(u=e.tmContext.measureText(f[g]),c={height:u.actualBoundingBoxAscent+2,startingHeight:o,width:u.width+2,textStyle:e.tickTextStyle},i.set(f[g],c),o+=c.height,s<c.width&&(s=c.width),a.tickWidth<c.width&&(a.tickWidth=c.width),a.tickHeight<c.height&&(a.tickHeight=c.height));return s=at(s),o=at(o),i.forEach(function(v){v.tcoords=[0,(o-v.startingHeight-v.height)/o,v.width/s,(o-v.startingHeight-v.height)/o,v.width/s,(o-v.startingHeight)/o,0,(o-v.startingHeight)/o]}),e.tmCanvas.width=s,e.tmCanvas.height=o,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,s,o),i.forEach(function(v,p){ci(e.tmContext,v.textStyle),e.tmContext.fillText(p,1,v.startingHeight+v.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified(),e._tmAtlas=i,a},t.computeBarSize=function(a){e.vertical=e.boxSize[1]>e.boxSize[0];var i=2*a.tickHeight/e.lastSize[1],s=[1,1];if(e.vertical){var o=2*(a.tickWidth+e.tickLabelPixelOffset)/e.lastSize[0];if(e.topTitle){var u=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0]-o,e.barSize[1]=e.boxSize[1]-u}else{var c=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[0];e.barSize[0]=e.boxSize[0]-c-o,e.barSize[1]=e.boxSize[1]}e.barPosition[0]=e.boxPosition[0]+o,e.barPosition[1]=e.boxPosition[1],s[1]=i}else{var f=(2*a.tickWidth-8)/e.lastSize[0],g=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0],e.barPosition[0]=e.boxPosition[0],e.barSize[1]=e.boxSize[1]-g,e.barPosition[1]=e.boxPosition[1],s[0]=f}return s},t.recomputeBarSegments=function(a){var i,s,o,u,c=t.computeBarSize(a);e.barSegments=[];var f=[0,0],g=e.vertical?1:0,v=e.vertical?.01:.02;function p(h,d){e.barSegments.push({corners:[[].concat(f),[f[0]+c[0],f[1]],[f[0]+c[0],f[1]+c[1]],[f[0],f[1]+c[1]]],scalars:d,title:h}),f[g]+=c[g]+v}e.renderable.getDrawNanAnnotation()&&e.renderable.getScalarsToColors().getNanColor()&&p("NaN",[NaN,NaN,NaN,NaN]),e.renderable.getDrawBelowRangeSwatch()&&(i=(s=e.renderable.getScalarsToColors()).getUseBelowRangeColor)!==null&&i!==void 0&&i.call(s)&&p("Below",[-.1,-.1,-.1,-.1]);var l=(o=(u=e.renderable.getScalarsToColors()).getUseAboveRangeColor)===null||o===void 0?void 0:o.call(u);f[g]+=v;var y=c[g];c[g]=l?1-2*v-c[g]-f[g]:1-v-f[g],p("ticks",e.vertical?[0,0,.995,.995]:[0,.995,.995,0]),e.renderable.getDrawAboveRangeSwatch()&&l&&(c[g]=y,f[g]+=v,p("Above",[1.1,1.1,1.1,1.1]))};var r=new Float64Array(3);t.createPolyDataForOneLabel=function(a,i,s,o,u,c){var f=e._tmAtlas.get(a);if(f){var g=c.ptIdx,v=c.cellIdx;r[0]=(.5*i[0]+.5)*e.lastSize[0],r[1]=(.5*i[1]+.5)*e.lastSize[1],r[2]=i[2],r[0]+=u[0],r[1]+=u[1];var p=[],l=o==="vertical"?[1,0]:[0,1];o==="vertical"?(p[0]=f.width,p[1]=-f.height,s[0]==="middle"?r[1]-=f.width/2:s[0]==="right"&&(r[1]-=f.width),s[1]==="middle"?r[0]+=f.height/2:s[1]==="top"&&(r[0]+=f.height)):(p[0]=f.width,p[1]=f.height,s[0]==="middle"?r[0]-=f.width/2:s[0]==="right"&&(r[0]-=f.width),s[1]==="middle"?r[1]-=f.height/2:s[1]==="top"&&(r[1]-=f.height)),c.points[g*3]=r[0],c.points[g*3+1]=r[1],c.points[g*3+2]=r[2],c.tcoords[g*2]=f.tcoords[0],c.tcoords[g*2+1]=f.tcoords[1],g++,r[l[0]]+=p[0],c.points[g*3]=r[0],c.points[g*3+1]=r[1],c.points[g*3+2]=r[2],c.tcoords[g*2]=f.tcoords[2],c.tcoords[g*2+1]=f.tcoords[3],g++,r[l[1]]+=p[1],c.points[g*3]=r[0],c.points[g*3+1]=r[1],c.points[g*3+2]=r[2],c.tcoords[g*2]=f.tcoords[4],c.tcoords[g*2+1]=f.tcoords[5],g++,r[l[0]]-=p[0],c.points[g*3]=r[0],c.points[g*3+1]=r[1],c.points[g*3+2]=r[2],c.tcoords[g*2]=f.tcoords[6],c.tcoords[g*2+1]=f.tcoords[7],g++,c.polys[v*4]=3,c.polys[v*4+1]=g-4,c.polys[v*4+2]=g-3,c.polys[v*4+3]=g-2,v++,c.polys[v*4]=3,c.polys[v*4+1]=g-4,c.polys[v*4+2]=g-2,c.polys[v*4+3]=g-1,c.ptIdx+=4,c.cellIdx+=2}};var n=new Float64Array(3);t.updatePolyDataForLabels=function(){var a=t.getTickStrings().length+e.barSegments.length,i=a*4,s=a*2,o=new Float64Array(i*3),u=new Uint16Array(s*4),c=new Float32Array(i*2),f={ptIdx:0,cellIdx:0,polys:u,points:o,tcoords:c},g=e.vertical?0:1,v=e.vertical?1:0;n[2]=-.99;var p=e.vertical?["right","middle"]:["middle","bottom"],l=[0,1],y=[0,0];e.vertical?(y[0]=-e.tickLabelPixelOffset,e.topTitle?(n[0]=e.boxPosition[0]+.5*e.boxSize[0],n[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),n,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],f)):(n[0]=e.barPosition[0]+e.barSize[0],n[1]=e.barPosition[1]+.5*e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),n,["middle","top"],"vertical",[e.axisTitlePixelOffset,0],f)),l=[-1,0]):(y[1]=e.tickLabelPixelOffset,n[0]=e.barPosition[0]+.5*e.barSize[0],n[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),n,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],f)),n[g]=e.barPosition[g]+(.5*l[g]+.5)*e.barSize[g],n[v]=e.barPosition[v]+e.barSize[v]*.5;for(var h=null,d=0;d<e.barSegments.length;d++){var S=e.barSegments[d];S.title==="ticks"?h=S:(n[v]=e.barPosition[v]+.5*e.barSize[v]*(S.corners[2][v]+S.corners[0][v]),t.createPolyDataForOneLabel(S.title,n,p,"horizontal",y,f))}for(var T=e.barPosition[v]+e.barSize[v]*h.corners[0][v],C=e.barSize[v]*(h.corners[2][v]-h.corners[0][v]),x=t.getTicks(),O=t.getTickStrings(),w=0;w<x.length;w++){var E=(x[w]-e.lastTickBounds[0])/(e.lastTickBounds[1]-e.lastTickBounds[0]);n[v]=T+C*E,t.createPolyDataForOneLabel(O[w],n,p,"horizontal",y,f)}var V=ge.newInstance({numberOfComponents:2,values:c,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(V),e.tmPolyData.getPoints().setData(o,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(u,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updatePolyDataForBarSegments=function(){var a,i,s=e.renderable.getScalarsToColors(),o=0;e.renderable.getDrawNanAnnotation()&&s.getNanColor()&&(o+=1),e.renderable.getDrawBelowRangeSwatch()&&(a=s.getUseBelowRangeColor)!==null&&a!==void 0&&a.call(s)&&(o+=1),e.renderable.getDrawAboveRangeSwatch()&&(i=s.getUseAboveRangeColor)!==null&&i!==void 0&&i.call(s)&&(o+=1);var u=4*(1+o),c=u,f=1;s.getVectorMode()===SC.COMPONENT&&(f=s.getVectorComponent()+1);for(var g=new Float64Array(u*3),v=new Uint16Array(c*5),p=new Float32Array(u*f),l=0,y=0,h=0;h<e.barSegments.length;h++){for(var d=e.barSegments[h],S=0;S<4;S++){n[0]=e.barPosition[0]+d.corners[S][0]*e.barSize[0],n[1]=e.barPosition[1]+d.corners[S][1]*e.barSize[1],g[l*3]=(.5*n[0]+.5)*e.lastSize[0],g[l*3+1]=(.5*n[1]+.5)*e.lastSize[1],g[l*3+2]=n[2];for(var T=0;T<f;T++)p[l*f+T]=e.lastTickBounds[0]+d.scalars[S]*(e.lastTickBounds[1]-e.lastTickBounds[0]);l++}v[y*5]=4,v[y*5+1]=l-4,v[y*5+2]=l-3,v[y*5+3]=l-2,v[y*5+4]=l-1,y++}var C=ge.newInstance({numberOfComponents:f,values:p,name:"Scalars"});e.polyData.getPointData().setScalars(C),e.polyData.getPoints().setData(g,3),e.polyData.getPoints().modified(),e.polyData.getPolys().setData(v,1),e.polyData.getPolys().modified(),e.polyData.modified()}}var OC=m.newInstance(function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},r),m.obj(t,e),m.setGet(t,e,["axisTitlePixelOffset","tickLabelPixelOffset","renderable","topTitle","ticks","tickStrings"]),m.get(t,e,["lastSize","lastAspectRatio","lastTickBounds","axisTextStyle","tickTextStyle","barActor","tmActor"]),m.getArray(t,e,["boxPosition","boxSize"]),m.setArray(t,e,["boxPosition","boxSize"],2),e.forceUpdate=!1,e.lastRebuildTime={},m.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.barMapper=Yt.newInstance(),e.barMapper.setInterpolateScalarsBeforeMapping(!0),e.barMapper.setUseLookupTableScalarRange(!0),e.polyData=qt.newInstance(),e.barMapper.setInputData(e.polyData),e.barActor=Ar.newInstance(),e.barActor.setMapper(e.barMapper),e.tmPolyData=qt.newInstance(),e.tmMapper=Yt.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmTexture=Ua.newInstance({resizable:!0}),e.tmTexture.setInterpolate(!1),e.tmActor=Ar.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),e.tmActor.addTexture(e.tmTexture),e.barPosition=[0,0],e.barSize=[0,0],e.boxPosition=[.88,-.92],e.boxSize=[.1,1.1],e.lastTickBounds=[],xC(t,e)},"vtkScalarBarActorHelper");function mC(t,e){e.classHierarchy.push("vtkScalarBarActor"),t.setTickTextStyle=function(r){e.tickTextStyle=Vt(Vt({},e.tickTextStyle),r),t.modified()},t.setAxisTextStyle=function(r){e.axisTextStyle=Vt(Vt({},e.axisTextStyle),r),t.modified()},t.resetAutoLayoutToDefault=function(){t.setAutoLayout($g(t,e))},t.resetGenerateTicksToDefault=function(){t.setGenerateTicks(Pg())}}function wC(t){return Vt({automated:!0,autoLayout:null,axisLabel:"Scalar Value",barPosition:[0,0],barSize:[0,0],boxPosition:[.88,-.92],boxSize:[.1,1.1],scalarToColors:null,axisTitlePixelOffset:36,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif"},tickLabelPixelOffset:14,tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif"},generateTicks:null,drawNanAnnotation:!0,drawBelowRangeSwatch:!0,drawAboveRangeSwatch:!0},t)}function jg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wC(r)),e.autoLayout||(e.autoLayout=$g(t,e)),e.generateTicks||(e.generateTicks=Pg()),Ar.extend(t,e,r),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),m.setGet(t,e,["automated","autoLayout","axisTitlePixelOffset","axisLabel","scalarsToColors","tickLabelPixelOffset","generateTicks","drawNanAnnotation","drawBelowRangeSwatch","drawAboveRangeSwatch"]),m.get(t,e,["axisTextStyle","tickTextStyle"]),m.getArray(t,e,["barPosition","barSize","boxPosition","boxSize"]),m.setArray(t,e,["barPosition","barSize","boxPosition","boxSize"],2),mC(t,e)}var EC=m.newInstance(jg,"vtkScalarBarActor"),Kg={newInstance:EC,extend:jg,newScalarBarActorHelper:OC};function DC(t,e){e.classHierarchy.push("vtkOpenGLScalarBarActor"),t.buildPass=function(r){r&&(e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,i=e._openGLRenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e._openGLRenderWindow.getRenderable())}}}var MC={};function VC(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,MC,r),Se.extend(t,e,r),e.scalarBarActorHelper=Kg.newScalarBarActorHelper(),DC(t,e)}var RC=ve(VC,"vtkOpenGLScalarBarActor");Ye("vtkScalarBarActor",RC);var yu=P;function bC(t,e){e.classHierarchy.push("vtkOpenGLSkybox"),t.buildPass=function(r){if(r){e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLTexture.setOpenGLRenderWindow(e._openGLRenderWindow);var n=e._openGLRenderer.getRenderable();e.openGLCamera=e._openGLRenderer.getViewNodeFor(n.getActiveCamera())}},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;n.incrementOpaqueActorCount()}},t.opaquePass=function(r,n){if(r&&!e._openGLRenderer.getSelector()){t.updateBufferObjects(),e.context.depthMask(!0),e._openGLRenderWindow.getShaderCache().readyShaderProgram(e.tris.getProgram()),e.openGLTexture.render(e._openGLRenderWindow);var a=e.openGLTexture.getTextureUnit();e.tris.getProgram().setUniformi("sbtexture",a);var i=e._openGLRenderer.getRenderable(),s=e.openGLCamera.getKeyMatrices(i),o=new Float64Array(16);if(He(o,s.wcpc),e.tris.getProgram().setUniformMatrix("IMCPCMatrix",o),e.lastFormat==="box"){var u=i.getActiveCamera().getPosition();e.tris.getProgram().setUniform3f("camPos",u[0],u[1],u[2])}e.tris.getVAO().bind(),e.context.drawArrays(e.context.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release(),e.openGLTexture.deactivate()}},t.updateBufferObjects=function(){if(!e.tris.getCABO().getElementCount()){for(var r=new Float32Array(12),n=0;n<4;n++)r[n*3]=n%2*2-1,r[n*3+1]=n>1?1:-1,r[n*3+2]=1;var a=ge.newInstance({numberOfComponents:3,values:r});a.setName("points");var i=new Uint16Array(8);i[0]=3,i[1]=0,i[2]=1,i[3]=3,i[4]=3,i[5]=0,i[6]=3,i[7]=2;var s=ge.newInstance({numberOfComponents:1,values:i});e.tris.getCABO().createVBO(s,"polys",Ie.SURFACE,{points:a,cellOffset:0})}e.renderable.getFormat()!==e.lastFormat&&(e.lastFormat=e.renderable.getFormat(),e.lastFormat==="box"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec3 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = wpos.xyz/wpos.w;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec3 TexCoords;
             uniform samplerCube sbtexture;
             uniform vec3 camPos;
             void main () {
               // skybox looks from inside out
               // which means we have to adjust
               // our tcoords. Otherwise text would
               // be flipped
               vec3 tc = normalize(TexCoords - camPos);
               if (abs(tc.z) < max(abs(tc.x),abs(tc.y)))
               {
                 tc = vec3(1.0, 1.0, -1.0) * tc;
               }
               else
               {
                 tc = vec3(-1.0, 1.0, 1.0) * tc;
               }
               gl_FragData[0] = textureCube(sbtexture, tc);
             }`,"")),e.lastFormat==="background"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec2 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = vec2(vertexMC.x, vertexMC.y)*0.5 + 0.5;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec2 TexCoords;
             uniform sampler2D sbtexture;
             void main () {
               gl_FragData[0] = texture2D(sbtexture, TexCoords);
             }`,"")),e.tris.getShaderSourceTime().modified(),e.tris.getVAO().bind(),e.tris.getVAO().addAttributeArray(e.tris.getProgram(),e.tris.getCABO(),"vertexMC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||yu("Error setting vertexMC in shader VAO."));var o=e.renderable.getTextures();o.length||yu("vtkSkybox requires a texture map"),e.openGLTexture.getRenderable()!==o[0]&&(e.openGLTexture.releaseGraphicsResources(e._openGLRenderWindow),e.openGLTexture.setRenderable(o[0]))}}var LC={context:null};function BC(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,LC,r),Se.extend(t,e,r),e.openGLTexture=jt.newInstance(),e.tris=Kr.newInstance(),e.keyMatrixTime={},Ne(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:dr(new Float64Array(9)),mcwc:ae(new Float64Array(16))},be(t,e,["context"]),je(t,e,["activeTextures"]),bC(t,e)}var kC=ve(BC);Ye("vtkSkybox",kC);var NC=Xt;function FC(t,e){e.classHierarchy.push("vtkOpenGLPixelSpaceCallbackMapper"),t.opaquePass=function(r,n){e._openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e._openGLRenderer.getParent();var a=e._openGLRenderer.getAspectRatio(),i=e._openGLRenderer?e._openGLRenderer.getRenderable().getActiveCamera():null,s=e._openGLRenderer.getTiledSizeAndOrigin(),o=null;if(e.renderable.getUseZValues()){var u=n.getZBufferTexture(),c=Math.floor(u.getWidth()),f=Math.floor(u.getHeight()),g=e._openGLRenderWindow.getContext();u.bind();var v=n.getFramebuffer();v?v.saveCurrentBindingsAndBuffers():NC("No framebuffer to save/restore");var p=g.createFramebuffer();g.bindFramebuffer(g.FRAMEBUFFER,p),g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,u.getHandle(),0),g.checkFramebufferStatus(g.FRAMEBUFFER)===g.FRAMEBUFFER_COMPLETE&&(o=new Uint8Array(c*f*4),g.viewport(0,0,c,f),g.readPixels(0,0,c,f,g.RGBA,g.UNSIGNED_BYTE,o)),v&&v.restorePreviousBindingsAndBuffers(),g.deleteFramebuffer(p)}e.renderable.invokeCallback(e.renderable.getInputData(),i,a,s,o)},t.queryPass=function(r,n){r&&e.renderable.getUseZValues()&&n.requestDepth()}}var UC={};function GC(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,UC,r),Se.extend(t,e,r),FC(t,e)}var _C=ve(GC,"vtkOpenGLPixelSpaceCallbackMapper");Ye("vtkPixelSpaceCallbackMapper",_C);var Xg=Object.create(null);function ut(t,e){Xg[t]=e}function WC(t,e){e.classHierarchy.push("vtkWebGPUViewNodeFactory")}var zC={};function Yg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zC,r),e.overrides=Xg,If.extend(t,e,r),WC(t,e)}var AC=m.newInstance(Yg,"vtkWebGPUViewNodeFactory"),HC={newInstance:AC,extend:Yg};function $C(t,e){e.classHierarchy.push("vtkWebGPUCamera"),t.getProjectionMatrix=function(r,n,a,i){if(ae(r),e.renderable.getParallelProjection()){var s=e.renderable.getParallelScale(),o=s*n,u=s,c=(i[0]-1)*o,f=(i[0]+1)*o,g=(i[1]-1)*u,v=(i[1]+1)*u,p=1/(f-c),l=1/(v-g);r[0]=2*p,r[5]=2*l,r[10]=1/(a[1]-a[0]),r[12]=(f+c)*p,r[13]=(v+g)*l,r[14]=a[1]/(a[1]-a[0])}else{var y=Math.tan(Math.PI*e.renderable.getViewAngle()/360),h,d;e.renderable.getUseHorizontalViewAngle()===!0?(h=a[0]*y,d=a[0]*y/n):(h=a[0]*y*n,d=a[0]*y);var S=(i[0]-1)*h,T=(i[0]+1)*h,C=(i[1]-1)*d,x=(i[1]+1)*d;r[0]=2*a[0]/(T-S),r[5]=2*a[0]/(x-C),r[12]=(S+T)/(T-S),r[13]=(C+x)/(x-C),r[10]=0,r[14]=a[0],r[11]=-1,r[15]=0}},t.convertToOpenGLDepth=function(r){if(e.renderable.getParallelProjection())return 1-r;var n=e.renderable.getClippingRangeByReference(),a=-n[0]/r;return a=(n[0]+n[1])/(n[1]-n[0])+2*n[0]*n[1]/(a*(n[1]-n[0])),.5*a+.5},t.getKeyMatrices=function(r){var n=r.getRenderable(),a=r.getParent();if(Math.max(a.getMTime(),t.getMTime(),n.getMTime(),e.renderable.getMTime(),r.getStabilizedTime())>e.keyMatrixTime.getMTime()){var i=e.renderable.getViewMatrix();Fe(e.keyMatrices.normalMatrix,i),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,He(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),ye(e.keyMatrices.wcvc,i);var s=r.getStabilizedCenterByReference();me(e.keyMatrices.scvc,e.keyMatrices.wcvc,s);var o=r.getAspectRatio(),u=e.renderable.getClippingRangeByReference();t.getProjectionMatrix(e.keyMatrices.vcpc,o,u,e.renderable.getWindowCenterByReference()),ke(e.keyMatrices.scpc,e.keyMatrices.vcpc,e.keyMatrices.scvc),He(e.keyMatrices.pcsc,e.keyMatrices.scpc),e.keyMatrixTime.modified()}return e.keyMatrices}}var PC={keyMatrixTime:null,keyMatrices:null};function jC(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,PC,r),Se.extend(t,e,r),e.keyMatrixTime={},m.obj(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(16),vcpc:new Float64Array(16),pcsc:new Float64Array(16),wcvc:new Float64Array(16),scpc:new Float64Array(16),scvc:new Float64Array(16)},m.setGet(t,e,["keyMatrixTime"]),$C(t,e)}var KC=m.newInstance(jC);ut("vtkCamera",KC);function XC(t,e){e.classHierarchy.push("vtkWebGPUBindGroup"),t.setBindables=function(r){if(e.bindables.length===r.length){for(var n=!0,a=0;a<e.bindables.length;a++)e.bindables[a]!==r[a]&&(n=!1);if(n)return}e.bindables=r,t.modified()},t.getBindGroupLayout=function(r){for(var n=[],a=0;a<e.bindables.length;a++){var i=e.bindables[a].getBindGroupLayoutEntry();i.binding=a,n.push(i)}return r.getBindGroupLayout({entries:n})},t.getBindGroup=function(r){for(var n=t.getMTime(),a=0;a<e.bindables.length;a++){var i=e.bindables[a].getBindGroupTime().getMTime();n=i>n?i:n}if(n<e.bindGroupTime.getMTime())return e.bindGroup;for(var s=[],o=0;o<e.bindables.length;o++){var u=e.bindables[o].getBindGroupEntry();u.binding=o,s.push(u)}return e.bindGroup=r.getHandle().createBindGroup({layout:t.getBindGroupLayout(r),entries:s,label:e.label}),e.bindGroupTime.modified(),e.bindGroup},t.getShaderCode=function(r){for(var n=[],a=r.getBindGroupLayoutCount(e.label),i=0;i<e.bindables.length;i++)n.push(e.bindables[i].getShaderCode(i,a));return n.join(`
`)}}var YC={device:null,handle:null,label:null};function qg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,YC,r),m.obj(t,e),e.bindables=[],e.bindGroupTime={},m.obj(e.bindGroupTime,{mtime:0}),m.get(t,e,["bindGroupTime","handle","sizeInBytes","usage"]),m.setGet(t,e,["label","device","arrayInformation"]),XC(t,e)}var qC=m.newInstance(qg),Qg={newInstance:qC,extend:qg};function QC(t,e){e.classHierarchy.push("vtkWebGPUShaderModule"),t.initialize=function(r,n){e.device=r,e.handle=e.device.getHandle().createShaderModule({code:n.getCode()})}}var ZC={device:null,handle:null};function Zg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ZC,r),m.obj(t,e),m.get(t,e,["lastCameraMTime"]),m.setGet(t,e,["device","handle"]),QC(t,e)}var IC=m.newInstance(Zg,"vtkWebGPUShaderModule"),JC={newInstance:IC,extend:Zg};function eS(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=Array.isArray(r)?r.join(`
`):r,i=!1;t.search(e)!==-1&&(i=!0);var s="";n&&(s="g");var o=new RegExp(e,s),u=t.replace(o,a);return{replace:i,result:u}}function tS(t,e){e.classHierarchy.push("vtkWebGPUShaderCache"),t.getShaderModule=function(r){for(var n=r.getType(),a=r.getHash(),i=e._shaderModules.keys(),s=0;s<i.length;s++){var o=i[s];if(o.getHash()===a&&o.getType()===n)return e._shaderModules.get(o)}var u=JC.newInstance();return u.initialize(e.device,r),e._shaderModules.set(r,u),u}}var rS={shaderModules:null,device:null,window:null};function Ig(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rS,r),e._shaderModules=new Map,m.obj(t,e),m.setGet(t,e,["device","window"]),tS(t,e)}var nS=m.newInstance(Ig,"vtkWebGPUShaderCache"),X={newInstance:nS,extend:Ig,substitute:eS};function aS(t,e){e.classHierarchy.push("vtkWebGPUPipeline"),t.getShaderDescriptions=function(){return e.shaderDescriptions},t.initialize=function(r,n){e.pipelineDescription=e.renderEncoder.getPipelineSettings(),e.pipelineDescription.primitive.topology=e.topology,e.pipelineDescription.vertex=e.vertexState,e.pipelineDescription.label=n;for(var a=[],i=0;i<e.layouts.length;i++)a.push(e.layouts[i].layout);e.pipelineLayout=r.getHandle().createPipelineLayout({bindGroupLayouts:a}),e.pipelineDescription.layout=e.pipelineLayout;for(var s=0;s<e.shaderDescriptions.length;s++){var o=e.shaderDescriptions[s],u=r.getShaderModule(o);o.getType()==="vertex"&&(e.pipelineDescription.vertex.module=u.getHandle(),e.pipelineDescription.vertex.entryPoint="main"),o.getType()==="fragment"&&(e.pipelineDescription.fragment.module=u.getHandle(),e.pipelineDescription.fragment.entryPoint="main")}e.handle=r.getHandle().createRenderPipeline(e.pipelineDescription)},t.getShaderDescription=function(r){for(var n=0;n<e.shaderDescriptions.length;n++)if(e.shaderDescriptions[n].getType()===r)return e.shaderDescriptions[n];return null},t.addBindGroupLayout=function(r){r&&e.layouts.push({layout:r.getBindGroupLayout(e.device),label:r.getLabel()})},t.getBindGroupLayout=function(r){return e.layouts[r].layout},t.getBindGroupLayoutCount=function(r){for(var n=0;n<e.layouts.length;n++)if(e.layouts[n].label===r)return n;return 0},t.bindVertexInput=function(r,n){n.bindBuffers(r)}}var iS={handle:null,layouts:null,renderEncoder:null,shaderDescriptions:null,vertexState:null,topology:null,pipelineDescription:null};function Jg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,iS,r),Ne(t,e),e.layouts=[],e.shaderDescriptions=[],je(t,e,["handle","pipelineDescription"]),be(t,e,["device","renderEncoder","topology","vertexState"]),aS(t,e)}var sS=ve(Jg,"vtkWebGPUPipeline"),oS={newInstance:sS,extend:Jg};function uS(t,e){e.classHierarchy.push("vtkWebGPUShaderDescription"),t.hasOutput=function(r){return e.outputNames.includes(r)},t.addOutput=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;e.outputTypes.push(r),e.outputNames.push(n),e.outputInterpolations.push(a)},t.addBuiltinOutput=function(r,n){e.builtinOutputTypes.push(r),e.builtinOutputNames.push(n)},t.addBuiltinInput=function(r,n){e.builtinInputTypes.push(r),e.builtinInputNames.push(n)},t.replaceShaderCode=function(r,n){var a=[],i=[];if(n&&a.push(n.getShaderCode()),r||e.builtinInputNames.length){var s=[];if(s.push("struct ".concat(e.type,`Input
{`)),r)for(var o=r.getOutputNamesByReference(),u=r.getOutputTypesByReference(),c=r.getOutputInterpolationsByReference(),f=0;f<o.length;f++)c[f]!==void 0?s.push("  @location(".concat(f,") @interpolate(").concat(c[f],") ").concat(o[f]," : ").concat(u[f],",")):s.push("  @location(".concat(f,") ").concat(o[f]," : ").concat(u[f],","));for(var g=0;g<e.builtinInputNames.length;g++)s.push("  ".concat(e.builtinInputNames[g]," : ").concat(e.builtinInputTypes[g],","));s.length>1&&(s.push("};"),i=s,a[a.length-1]+=",",a.push("input: ".concat(e.type,"Input")))}if(a.length&&(e.code=X.substitute(e.code,"//VTK::IOStructs::Input",a).result),e.outputNames.length+e.builtinOutputNames.length){for(var v=["struct ".concat(e.type,`Output
{`)],p=0;p<e.outputNames.length;p++)e.outputInterpolations[p]!==void 0?v.push("  @location(".concat(p,") @interpolate(").concat(e.outputInterpolations[p],") ").concat(e.outputNames[p]," : ").concat(e.outputTypes[p],",")):v.push("  @location(".concat(p,") ").concat(e.outputNames[p]," : ").concat(e.outputTypes[p],","));for(var l=0;l<e.builtinOutputNames.length;l++)v.push("  ".concat(e.builtinOutputNames[l]," : ").concat(e.builtinOutputTypes[l],","));v.push("};"),i=i.concat(v),e.code=X.substitute(e.code,"//VTK::IOStructs::Output",["-> ".concat(e.type,"Output")]).result}e.code=X.substitute(e.code,"//VTK::IOStructs::Dec",i).result}}var fS={type:null,hash:null,code:null,outputNames:null,outputTypes:null};function ev(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fS,r),e.outputNames=[],e.outputTypes=[],e.outputInterpolations=[],e.builtinOutputNames=[],e.builtinOutputTypes=[],e.builtinInputNames=[],e.builtinInputTypes=[],m.obj(t,e),m.setGet(t,e,["type","hash","code"]),m.getArray(t,e,["outputTypes","outputNames","outputInterpolations"]),uS(t,e)}var cS=m.newInstance(ev,"vtkWebGPUShaderDescription"),du={newInstance:cS,extend:ev},Tu={r8unorm:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"float"},r8snorm:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"float"},r8uint:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},r8sint:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"sint"},r16uint:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"uint"},r16sint:{numComponents:1,nativeType:Int16Array,stride:2,elementSize:2,sampleType:"sint"},r16float:{numComponents:1,nativeType:Float32Array,stride:2,elementSize:2,sampleType:"float"},rg8unorm:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"float"},rg8snorm:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"float"},rg8uint:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"uint"},rg8sint:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"sint"},r32uint:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:4,sampleType:"uint"},r32sint:{numComponents:1,nativeType:Int32Array,stride:4,elementSize:4,sampleType:"sint"},r32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"unfilterable-float"},rg16uint:{numComponents:2,nativeType:Uint16Array,stride:4,elementSize:2,sampleType:"uint"},rg16sint:{numComponents:2,nativeType:Int16Array,stride:4,elementSize:2,sampleType:"sint"},rg16float:{numComponents:2,nativeType:Float32Array,stride:4,elementSize:2,sampleType:"float"},rgba8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"rgba8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgba8snorm:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"float"},rgba8uint:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"uint"},rgba8sint:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"sint"},bgra8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"bgra8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgb9e5ufloat:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rgb10a2unorm:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rg11b10ufloat:{numComponents:4,nativeType:Float32Array,stride:4,sampleType:"float"},rg32uint:{numComponents:2,nativeType:Uint32Array,stride:8,elementSize:4,sampleType:"uint"},rg32sint:{numComponents:2,nativeType:Int32Array,stride:8,elementSize:4,sampleType:"sint"},rg32float:{numComponents:2,nativeType:Float32Array,stride:8,elementSize:4,sampleType:"unfilterable-float"},rgba16uint:{numComponents:4,nativeType:Uint16Array,stride:8,elementSize:2,sampleType:"uint"},rgba16sint:{numComponents:4,nativeType:Int16Array,stride:8,elementSize:2,sampleType:"sint"},rgba16float:{numComponents:4,nativeType:Float32Array,stride:8,elementSize:2,sampleType:"float"},rgba32uint:{numComponents:4,nativeType:Uint32Array,stride:16,elementSize:4,sampleType:"uint"},rgba32sint:{numComponents:4,nativeType:Int32Array,stride:16,elementSize:4,sampleType:"sint"},rgba32float:{numComponents:4,nativeType:Float32Array,stride:16,elementSize:4,sampleType:"unfilterable-float"},stencil8:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},depth16unorm:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"depth"},depth24plus:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:3,sampleType:"depth"},"depth24plus-stencil8":{numComponents:2,nativeType:Uint32Array,stride:4,sampleType:"mixed"},depth32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"depth"}};function gS(t){return!t||t.length<6?0:t in Tu?Tu[t]:(P("unknown format ".concat(t)),null)}function vS(t){if(!t||t.length<5)return 0;var e=1;t[t.length-2]==="x"&&(e=Number(t[t.length-1]));var r=e===1?t.length-1:t.length-3,n=Number(t[r]);if(Number.isNaN(n))return P("unknown format ".concat(t)),0;var a=5-n/2;return e*a}function pS(t){if(!t||t.length<5)return 0;var e=1;return t[t.length-2]==="x"&&(e=Number(t[t.length-1])),e}function lS(t){if(!t||t.length<5)return 0;var e;if(t[0]==="f")e="Float";else if(t[0]==="s")e="Int";else if(t[0]==="u")e="Uint";else{P("unknown format ".concat(t));return}var r=t.split("x")[0],n=Number(r[r.length-1]);if(Number.isNaN(n)){P("unknown format ".concat(t));return}return e+=8*(5-n/2),e+="Array",e}function hS(t){var e;if(t[0]==="f"||t[1]==="n")e="f32";else if(t[0]==="s"&&t[1]==="i")e="i32";else if(t[0]==="u"&&t[1]==="i")e="u32";else{P("unknown format ".concat(t));return}var r=1;return t[t.length-2]==="x"&&(r=Number(t[t.length-1])),r===4?"vec4<".concat(e,">"):r===3?"vec3<".concat(e,">"):r===2?"vec2<".concat(e,">"):e}function yS(t){if(!t)return 0;var e=1;t.substring(0,3)==="vec"?e=Number(t[3]):t.substring(0,3)==="mat"&&(e=t[3]*t[5]);var r=4;return e*r}function dS(t){if(t){if(t.includes("f32"))return"Float32Array";if(t.includes("i32"))return"Int32Array";if(t.includes("u32"))return"Uint32Array";P("unknown format ".concat(t))}}var Ve={getDetailsFromTextureFormat:gS,getByteStrideFromBufferFormat:vS,getNumberOfComponentsFromBufferFormat:pS,getNativeTypeFromBufferFormat:lS,getShaderTypeFromBufferFormat:hS,getByteStrideFromShaderFormat:yS,getNativeTypeFromShaderFormat:dS};function TS(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(!e.includes(t[r]))return!1;return!0}function CS(t,e){e.classHierarchy.push("vtkWebGPUVertexInput"),t.addBuffer=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"vertex",i=n;Array.isArray(i)||(i=[i]);for(var s=0;s<e.inputs.length;s++)if(TS(e.inputs[s].names,i)){if(e.inputs[s].buffer===r)return;e.inputs[s].buffer=r;return}e.inputs.push({buffer:r,stepMode:a,names:i}),e.inputs=e.inputs.sort(function(o,u){return o.names[0]<u.names[0]?-1:o.names[0]>u.names[0]?1:0})},t.removeBufferIfPresent=function(r){for(var n=0;n<e.inputs.length;n++)e.inputs[n].names.includes(r)&&e.inputs.splice(n,1)},t.getBuffer=function(r){for(var n=0;n<e.inputs.length;n++)if(e.inputs[n].names.includes(r))return e.inputs[n].buffer;return null},t.hasAttribute=function(r){for(var n=0;n<e.inputs.length;n++)if(e.inputs[n].names.includes(r))return!0;return!1},t.getAttributeTime=function(r){for(var n=0;n<e.inputs.length;n++)if(e.inputs[n].names.includes(r))return e.inputs[n].buffer.getSourceTime();return 0},t.getShaderCode=function(){for(var r="",n=0,a=0;a<e.inputs.length;a++)for(var i=0;i<e.inputs[a].names.length;i++){var s=e.inputs[a].buffer.getArrayInformation()[i],o=Ve.getShaderTypeFromBufferFormat(s.format);n>0&&(r+=`,
`),r="".concat(r,"  @location(").concat(n,") ").concat(e.inputs[a].names[i]," : ").concat(o),n++}return r},t.getVertexInputInformation=function(){var r={};if(e.inputs.length){for(var n=[],a=0,i=0;i<e.inputs.length;i++){for(var s=e.inputs[i].buffer,o={arrayStride:s.getStrideInBytes(),stepMode:e.inputs[i].stepMode,attributes:[]},u=s.getArrayInformation(),c=0;c<e.inputs[i].names.length;c++)o.attributes.push({shaderLocation:a,offset:u[c].offset,format:u[c].format}),a++;n.push(o)}r.buffers=n}return r},t.bindBuffers=function(r){for(var n=0;n<e.inputs.length;n++)r.setVertexBuffer(n,e.inputs[n].buffer.getHandle());e.indexBuffer&&r.setIndexBuffer(e.indexBuffer.getHandle(),e.indexBuffer.getArrayInformation()[0].format)},t.getReady=function(){},t.releaseGraphicsResources=function(){e.created&&(e.inputs=[],e.bindingDescriptions=[],e.attributeDescriptions=[])}}var SS={inputs:null,bindingDescriptions:!1,attributeDescriptions:null,indexBuffer:null};function tv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,SS,r),Ne(t,e),e.bindingDescriptions=[],e.attributeDescriptions=[],e.inputs=[],be(t,e,["created","device","handle","indexBuffer"]),CS(t,e)}var xS=ve(tv,"vtkWebGPUVertexInput"),OS={newInstance:xS,extend:tv},mS=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  // var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,wS=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::Light::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  // var computedColor:vec4<f32> = vec4<f32>(1.0,0.5,0.5,1.0);

  //VTK::RenderEncoder::Impl
  return output;
}
`;function ES(t,e){e.classHierarchy.push("vtkWebGPUSimpleMapper"),t.generateShaderDescriptions=function(r,n,a){var i=du.newInstance({type:"vertex",hash:r,code:e.vertexShaderTemplate}),s=du.newInstance({type:"fragment",hash:r,code:e.fragmentShaderTemplate}),o=n.getShaderDescriptions();o.push(i),o.push(s);for(var u=e.vertexShaderTemplate+e.fragmentShaderTemplate,c=new RegExp("//VTK::[^:]*::","g"),f=u.match(c).filter(function(l,y,h){return h.indexOf(l)===y}),g=f.map(function(l){return"replaceShader".concat(l.substring(7,l.length-2))}),v=0;v<g.length;v++){var p=g[v];p!=="replaceShaderIOStructs"&&e.shaderReplacements.has(p)&&e.shaderReplacements.get(p)(r,n,a)}t.replaceShaderIOStructs(r,n,a)},t.replaceShaderIOStructs=function(r,n,a){var i=n.getShaderDescription("vertex");i.replaceShaderCode(null,a);var s=n.getShaderDescription("fragment");s.replaceShaderCode(i)},t.replaceShaderRenderEncoder=function(r,n,a){e.renderEncoder.replaceShaderCode(n)},e.shaderReplacements.set("replaceShaderRenderEncoder",t.replaceShaderRenderEncoder),t.replaceShaderRenderer=function(r,n,a){if(e.WebGPURenderer){var i=e.WebGPURenderer.getBindGroup().getShaderCode(n),s=n.getShaderDescription("vertex"),o=s.getCode();o=X.substitute(o,"//VTK::Renderer::Dec",[i]).result,s.setCode(o);var u=n.getShaderDescription("fragment");o=u.getCode(),o=X.substitute(o,"//VTK::Renderer::Dec",[i]).result,u.setCode(o)}},e.shaderReplacements.set("replaceShaderRenderer",t.replaceShaderRenderer),t.replaceShaderMapper=function(r,n,a){var i=e.bindGroup.getShaderCode(n),s=n.getShaderDescription("vertex"),o=s.getCode();o=X.substitute(o,"//VTK::Mapper::Dec",[i]).result,s.setCode(o);var u=n.getShaderDescription("fragment");u.addBuiltinInput("bool","@builtin(front_facing) frontFacing"),o=u.getCode(),o=X.substitute(o,"//VTK::Mapper::Dec",[i]).result,u.setCode(o)},e.shaderReplacements.set("replaceShaderMapper",t.replaceShaderMapper),t.replaceShaderPosition=function(r,n,a){var i=n.getShaderDescription("vertex");i.addBuiltinOutput("vec4<f32>","@builtin(position) Position");var s=i.getCode();s=X.substitute(s,"//VTK::Position::Impl",["    output.Position = rendererUBO.SCPCMatrix*vertexBC;"]).result,i.setCode(s)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderTCoord=function(r,n,a){var i=n.getShaderDescription("vertex");i.addOutput("vec2<f32>","tcoordVS")},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.addTextureView=function(r){e.textureViews.includes(r)||e.textureViews.push(r)},t.prepareToDraw=function(r){e.renderEncoder=r,t.updateInput(),t.updateBuffers(),t.updateBindings(),t.updatePipeline()},t.updateInput=function(){},t.updateBuffers=function(){},t.updateBindings=function(){e.bindGroup.setBindables(t.getBindables())},t.computePipelineHash=function(){},t.registerDrawCallback=function(r){r.registerDrawCallback(e.pipeline,t.draw)},t.prepareAndDraw=function(r){t.prepareToDraw(r),r.setPipeline(e.pipeline),t.draw(r)},t.draw=function(r){var n=r.getBoundPipeline();r.activateBindGroup(e.bindGroup),e.WebGPURenderer&&e.WebGPURenderer.bindUBO(r),n.bindVertexInput(r,e.vertexInput);var a=e.vertexInput.getIndexBuffer();a?r.drawIndexed(a.getIndexCount(),e.numberOfInstances,0,0,0):r.draw(e.numberOfVertices,e.numberOfInstances,0,0)},t.getBindables=function(){var r=Y(e.additionalBindables);e.UBO&&r.push(e.UBO),e.SSBO&&r.push(e.SSBO);for(var n=0;n<e.textureViews.length;n++){r.push(e.textureViews[n]);var a=e.textureViews[n].getSampler();a&&r.push(a)}return r},t.updatePipeline=function(){t.computePipelineHash(),e.pipeline=e.device.getPipeline(e.pipelineHash),e.pipeline||(e.pipeline=oS.newInstance(),e.pipeline.setDevice(e.device),e.WebGPURenderer&&e.pipeline.addBindGroupLayout(e.WebGPURenderer.getBindGroup()),e.pipeline.addBindGroupLayout(e.bindGroup),t.generateShaderDescriptions(e.pipelineHash,e.pipeline,e.vertexInput),e.pipeline.setTopology(e.topology),e.pipeline.setRenderEncoder(e.renderEncoder),e.pipeline.setVertexState(e.vertexInput.getVertexInputInformation()),e.device.createPipeline(e.pipelineHash,e.pipeline))}}var DS={additionalBindables:void 0,bindGroup:null,device:null,fragmentShaderTemplate:null,numberOfInstances:1,numberOfVertices:0,pipelineHash:null,shaderReplacements:null,SSBO:null,textureViews:null,topology:"triangle-list",UBO:null,vertexShaderTemplate:null,WebGPURenderer:null};function rv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,DS,r),Se.extend(t,e,r),e.textureViews=[],e.vertexInput=OS.newInstance(),e.bindGroup=Qg.newInstance({label:"mapperBG"}),e.additionalBindables=[],e.fragmentShaderTemplate=e.fragmentShaderTemplate||wS,e.vertexShaderTemplate=e.vertexShaderTemplate||mS,e.shaderReplacements=new Map,m.get(t,e,["pipeline","vertexInput"]),m.setGet(t,e,["additionalBindables","device","fragmentShaderTemplate","interpolate","numberOfInstances","numberOfVertices","pipelineHash","shaderReplacements","SSBO","textureViews","topology","UBO","vertexShaderTemplate","WebGPURenderer"]),ES(t,e)}var MS=m.newInstance(rv,"vtkWebGPUSimpleMapper"),Vs={newInstance:MS,extend:rv};function VS(t,e){e.classHierarchy.push("vtkWebGPUFullScreenQuad"),t.replaceShaderPosition=function(r,n,a){var i=n.getShaderDescription("vertex");i.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),i.addOutput("vec4<f32>","vertexVC");var s=i.getCode();s=X.substitute(s,"//VTK::Position::Impl",["output.tcoordVS = vec2<f32>(vertexBC.x * 0.5 + 0.5, 1.0 - vertexBC.y * 0.5 - 0.5);","output.Position = vec4<f32>(vertexBC, 1.0);","output.vertexVC = vec4<f32>(vertexBC, 1);"]).result,i.setCode(s)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.updateBuffers=function(){var r=e.device.getBufferManager().getFullScreenQuadBuffer();e.vertexInput.addBuffer(r,["vertexBC"]),e.numberOfVertices=6}}var RS={};function nv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,RS,r),Vs.extend(t,e,r),VS(t,e)}var bS=m.newInstance(nv,"vtkWebGPUFullScreenQuad"),Hr={newInstance:bS,extend:nv},LS={Verts:0,Lines:1,Triangles:2,Strips:3,LinesFromStrips:4,LinesFromTriangles:5,Points:6,UniformArray:7,PointArray:8,NormalsFromPoints:9,Texture:10,RawVertex:11,Storage:12,Index:13},BS={Start:0,Points:0,Lines:1,Triangles:2,TriangleStrips:3,TriangleEdges:4,TriangleStripEdges:5,End:6},xn={BufferUsage:LS,PrimitiveTypes:BS};function Cu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function kS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cu(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Cu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var gi=["getMappedRange","mapAsync","unmap"];function NS(t,e,r,n){var a=n.byteLength,i=t.createBuffer({size:a,usage:GPUBufferUsage.COPY_SRC,mappedAtCreation:!0}),s=i.getMappedRange(0,a);new Uint8Array(s).set(new Uint8Array(n)),i.unmap();var o=t.createCommandEncoder();o.copyBufferToBuffer(i,0,e,r,a);var u=o.finish(),c=t.queue;c.submit([u]),i.destroy()}function FS(t,e){e.classHierarchy.push("vtkWebGPUBuffer"),t.create=function(a,i){e.handle=e.device.getHandle().createBuffer({size:a,usage:i,label:e.label}),e.sizeInBytes=a,e.usage=i},t.write=function(a){NS(e.device.getHandle(),e.handle,0,a.buffer)},t.createAndWrite=function(a,i){e.handle=e.device.getHandle().createBuffer({size:a.byteLength,usage:i,mappedAtCreation:!0,label:e.label}),e.sizeInBytes=a.byteLength,e.usage=i,new Uint8Array(e.handle.getMappedRange()).set(new Uint8Array(a.buffer)),e.handle.unmap()};for(var r=function(i){t[gi[i]]=function(){var s;return(s=e.handle)[gi[i]].apply(s,arguments)}},n=0;n<gi.length;n++)r(n)}var US={device:null,handle:null,sizeInBytes:0,strideInBytes:0,arrayInformation:null,usage:null,label:null,sourceTime:null};function av(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,US,r),m.obj(t,e),m.get(t,e,["handle","sizeInBytes","usage"]),m.setGet(t,e,["strideInBytes","device","arrayInformation","label","sourceTime"]),FS(t,e)}var GS=m.newInstance(av),$r=kS({newInstance:GS,extend:av},xn);function Su(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function _S(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Su(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Su(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var xu=Tr.Representation,At=xn.PrimitiveTypes,WS=function(){function t(){Da(this,t),this.keys=new Uint32Array(10),this.values=new Uint32Array(10),this.count=0}return Ma(t,[{key:"clear",value:function(){this.count=0}},{key:"has",value:function(r){for(var n=0;n<this.count;n++)if(this.keys[n]===r)return!0}},{key:"get",value:function(r){for(var n=0;n<this.count;n++)if(this.keys[n]===r)return this.values[n]}},{key:"set",value:function(r,n){this.count<9&&(this.keys[this.count]=r,this.values[this.count++]=n)}}]),t}();function zS(t){switch(t){case At.Points:return"points";case At.Lines:return"lines";case At.Triangles:case At.TriangleEdges:return"polys";case At.TriangleStripEdges:case At.TriangleStrips:return"strips";default:return""}}function Wn(t,e,r){var n=t.pointIdToFlatId[e];return n<0&&(n=t.flatId,t.pointIdToFlatId[e]=n,t.flatIdToPointId[t.flatId]=e,t.flatIdToCellId[t.flatId]=r,t.flatId++),n}function AS(t,e,r){for(var n=t.length,a=0;a<n;a++){var i=t[a];if(r.cellProvokedMap.has(i)){r.ibo[r.iboId++]=r.cellProvokedMap.get(i);for(var s=a+1;s<a+n;s++){i=t[s%n];var o=Wn(r,i,e);r.ibo[r.iboId++]=o}return}}for(var u=0;u<n;u++){var c=t[u];if(!r.provokedPointIds[c]){var f=Wn(r,c,e);r.provokedPointIds[c]=1,r.cellProvokedMap.set(c,f),r.flatIdToCellId[f]=e,r.ibo[r.iboId++]=f;for(var g=u+1;g<u+n;g++)c=t[g%n],f=Wn(r,c,e),r.ibo[r.iboId++]=f;return}}var v=t[0],p=r.flatId;r.cellProvokedMap.set(v,p),r.flatIdToPointId[r.flatId]=v,r.flatIdToCellId[r.flatId]=e,r.flatId++,r.ibo[r.iboId++]=p;for(var l=1;l<n;l++)v=t[l],p=Wn(r,v,e),r.ibo[r.iboId++]=p}function HS(t,e,r){var n=t.length;r.iboSize+=n;for(var a=0;a<n;a++){var i=t[a];if(r.cellProvokedMap.has(i))return}for(var s=0;s<n;s++){var o=t[s];if(!r.provokedPointIds[o]){r.provokedPointIds[o]=1,r.cellProvokedMap.set(o,1);return}}r.cellProvokedMap.set(t[0],1),r.extraPoints++}var wt,Ou=new Uint32Array(1),qe=new Uint32Array(2),Ft=new Uint32Array(3),vi={anythingToPoints:function(e,r,n,a,i){for(var s=0;s<e;++s)Ou[0]=r[n+s],wt(Ou,a,i)},linesToWireframe:function(e,r,n,a,i){for(var s=0;s<e-1;++s)qe[0]=r[n+s],qe[1]=r[n+s+1],wt(qe,a,i)},polysToWireframe:function(e,r,n,a,i){if(e>2)for(var s=0;s<e;++s)qe[0]=r[n+s],qe[1]=r[n+(s+1)%e],wt(qe,a,i)},stripsToWireframe:function(e,r,n,a,i){if(e>2){for(var s=0;s<e-1;++s)qe[0]=r[n+s],qe[1]=r[n+s+1],wt(qe,a,i);for(var o=0;o<e-2;o++)qe[0]=r[n+o],qe[1]=r[n+o+2],wt(qe,a,i)}},polysToSurface:function(e,r,n,a,i){for(var s=0;s<e-2;s++)Ft[0]=r[n],Ft[1]=r[n+s+1],Ft[2]=r[n+s+2],wt(Ft,a,i)},stripsToSurface:function(e,r,n,a,i){for(var s=0;s<e-2;s++)Ft[0]=r[n+s],Ft[1]=r[n+s+1+s%2],Ft[2]=r[n+s+1+(s+1)%2],wt(Ft,a,i)}};function $S(t,e){e.classHierarchy.push("vtkWebGPUIndexBuffer"),t.buildIndexBuffer=function(r){var n=r.cells,a=r.primitiveType,i=r.representation,s=r.cellOffset,o=n.getData(),u=o.length,c=zS(a),f=r.numberOfPoints,g={provokedPointIds:new Uint8Array(f),extraPoints:0,iboSize:0,flatId:0,iboId:0,cellProvokedMap:new WS},v=null;i===xu.POINTS||a===At.Points?v=vi.anythingToPoints:i===xu.WIREFRAME||a===At.Lines?v=vi["".concat(c,"ToWireframe")]:v=vi["".concat(c,"ToSurface")],wt=HS;for(var p=s||0,l=0;l<u;)g.cellProvokedMap.clear(),v(o[l],o,l+1,p,g),l+=o[l]+1,p++;f<=65535?g.flatIdToPointId=new Uint16Array(f+g.extraPoints):g.flatIdToPointId=new Uint32Array(f+g.extraPoints),f+g.extraPoints<36863?g.pointIdToFlatId=new Int16Array(f):g.pointIdToFlatId=new Int32Array(f),f+g.extraPoints<=65535?(g.ibo=new Uint16Array(g.iboSize),r.format="uint16"):(g.ibo=new Uint32Array(g.iboSize),r.format="uint32"),p<=65535?g.flatIdToCellId=new Uint16Array(f+g.extraPoints):g.flatIdToCellId=new Uint32Array(f+g.extraPoints),g.pointIdToFlatId.fill(-1),g.provokedPointIds.fill(0),wt=AS,p=s||0;for(var y=0;y<u;)g.cellProvokedMap.clear(),v(o[y],o,y+1,p,g),y+=o[y]+1,p++;delete g.provokedPointIds,delete g.pointIdToFlatId,r.nativeArray=g.ibo,e.flatIdToPointId=g.flatIdToPointId,e.flatIdToCellId=g.flatIdToCellId,e.flatSize=g.flatId,e.indexCount=g.iboId}}var PS={flatIdToPointId:null,flatIdToCellId:null,flatSize:0,indexCount:0};function iv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,PS,r),$r.extend(t,e,r),m.setGet(t,e,["flatIdToPointId","flatIdToCellId","flatSize","indexCount"]),$S(t,e)}var jS=m.newInstance(iv),KS=_S({newInstance:jS,extend:iv},xn);function mu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function wu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mu(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Ut=xn.BufferUsage,XS=P,ir=ge.VtkDataTypes,YS={};function qS(t){var e;switch(t.getDataType()){case ir.UNSIGNED_CHAR:e="uint8";break;case ir.FLOAT:e="float32";break;case ir.UNSIGNED_INT:e="uint32";break;case ir.INT:e="sint32";break;case ir.DOUBLE:e="float32";break;case ir.UNSIGNED_SHORT:e="uint16";break;case ir.SHORT:e="sin16";break;default:e="float32";break}switch(t.getNumberOfComponents()){case 2:e+="x2";break;case 3:e.includes("32")||XS("unsupported x3 type for ".concat(e)),e+="x3";break;case 4:e+="x4";break}return e}function Eu(t,e,r,n,a){var i={},s=t.getFlatSize();if(!s)return i;var o=[0,0,0,0];a.shift&&(a.shift.length?o=a.shift:o.fill(a.shift));var u=[1,1,1,1];a.scale&&(a.scale.length?u=a.scale:u.fill(a.scale));var c=Object.prototype.hasOwnProperty.call(a,"packExtra")?a.packExtra:!1,f,g=0,v=r+(c?1:0),p=dn(n,s*v),l=t.getFlatIdToPointId();a.cellData&&(l=t.getFlatIdToCellId()),r===1?f=function(S){p[g++]=u[0]*e[S]+o[0]}:r===2?f=function(S){p[g++]=u[0]*e[S]+o[0],p[g++]=u[1]*e[S+1]+o[1]}:r===3&&!c?f=function(S){p[g++]=u[0]*e[S]+o[0],p[g++]=u[1]*e[S+1]+o[1],p[g++]=u[2]*e[S+2]+o[2]}:r===3&&c?f=function(S){p[g++]=u[0]*e[S]+o[0],p[g++]=u[1]*e[S+1]+o[1],p[g++]=u[2]*e[S+2]+o[2],p[g++]=u[3]*1+o[3]}:r===4&&(f=function(S){p[g++]=u[0]*e[S]+o[0],p[g++]=u[1]*e[S+1]+o[1],p[g++]=u[2]*e[S+2]+o[2],p[g++]=u[3]*e[S+3]+o[3]});for(var y=0;y<s;y++){var h=r*l[y];f(h)}return i.nativeArray=p,i}function QS(t,e,r,n){var a=[t[n*3]-t[r*3],t[n*3+1]-t[r*3+1],t[n*3+2]-t[r*3+2]],i=[t[e*3]-t[r*3],t[e*3+1]-t[r*3+1],t[e*3+2]-t[r*3+2]],s=[];return hn(a,i,s),Wr(s),s}function ZS(t,e){var r=e.getData(),n=t.getData();if(!n||!r)return null;for(var a=new Int8Array(t.getNumberOfCells()*4),i=n.length,s=0,o=0;o<i;){var u=QS(r,n[o+1],n[o+2],n[o+3]);a[s++]=127*u[0],a[s++]=127*u[1],a[s++]=127*u[2],a[s++]=127,o+=n[o]+1}return a}function IS(t,e){e.classHierarchy.push("vtkWebGPUBufferManager");function r(n){n.dataArray&&!n.nativeArray&&(n.nativeArray=n.dataArray.getData());var a,i;if(n.usage===Ut.Index&&(a=KS.newInstance({label:n.label}),a.setDevice(e.device),i=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST,a.buildIndexBuffer(n),a.createAndWrite(n.nativeArray,i),a.setArrayInformation([{format:n.format}])),a||(a=$r.newInstance({label:n.label}),a.setDevice(e.device)),n.usage===Ut.UniformArray&&(i=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,a.createAndWrite(n.nativeArray,i)),n.usage===Ut.Storage&&(i=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,a.createAndWrite(n.nativeArray,i)),n.usage===Ut.Texture&&(i=GPUBufferUsage.COPY_SRC,a.createAndWrite(n.nativeArray,i)),n.usage===Ut.PointArray){i=GPUBufferUsage.VERTEX;var s=Ve.getNativeTypeFromBufferFormat(n.format),o=Eu(n.indexBuffer,n.dataArray.getData(),n.dataArray.getNumberOfComponents(),s,{packExtra:n.packExtra,shift:n.shift,scale:n.scale,cellData:n.cellData,cellOffset:n.cellOffset});a.createAndWrite(o.nativeArray,i),a.setStrideInBytes(Ve.getByteStrideFromBufferFormat(n.format)),a.setArrayInformation([{offset:0,format:n.format,interpolation:n.cellData?"flat":"perspective"}])}if(n.usage===Ut.NormalsFromPoints){i=GPUBufferUsage.VERTEX;var u=Ve.getNativeTypeFromBufferFormat(n.format),c=ZS(n.cells,n.dataArray),f=Eu(n.indexBuffer,c,4,u,{cellData:!0});a.createAndWrite(f.nativeArray,i),a.setStrideInBytes(Ve.getByteStrideFromBufferFormat(n.format)),a.setArrayInformation([{offset:0,format:n.format,interpolation:"flat"}])}return n.usage===Ut.RawVertex&&(i=GPUBufferUsage.VERTEX,a.createAndWrite(n.nativeArray,i),a.setStrideInBytes(Ve.getByteStrideFromBufferFormat(n.format)),a.setArrayInformation([{offset:0,format:n.format}])),a.setSourceTime(n.time),a}t.hasBuffer=function(n){return e.device.hasCachedObject(n)},t.getBuffer=function(n){return n.hash?e.device.getCachedObject(n.hash,r,n):r(n)},t.getBufferForPointArray=function(n,a){var i=qS(n),s={hash:"".concat(n.getMTime(),"I").concat(a.getMTime()).concat(i),usage:Ut.PointArray,format:i,dataArray:n,indexBuffer:a};return t.getBuffer(s)},t.getFullScreenQuadBuffer=function(){if(e.fullScreenQuadBuffer)return e.fullScreenQuadBuffer;e.fullScreenQuadBuffer=$r.newInstance(),e.fullScreenQuadBuffer.setDevice(e.device);var n=new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0]);return e.fullScreenQuadBuffer.createAndWrite(n,GPUBufferUsage.VERTEX),e.fullScreenQuadBuffer.setStrideInBytes(12),e.fullScreenQuadBuffer.setArrayInformation([{offset:0,format:"float32x3"}]),e.fullScreenQuadBuffer}}var JS={device:null,fullScreenQuadBuffer:null};function sv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,JS,r),Ne(t,e),be(t,e,["device"]),IS(t,e)}var ex=ve(sv),Je=wu(wu({newInstance:ex,extend:sv},YS),xn),tx=Je.BufferUsage,wr=m.vtkErrorMacro;function rx(t,e){e.classHierarchy.push("vtkWebGPUStorageBuffer"),t.addEntry=function(r,n){if(e._bufferEntryNames.has(r)){wr("entry named ".concat(r," already exists"));return}e._bufferEntryNames.set(r,e.bufferEntries.length);var a=Ve.getByteStrideFromShaderFormat(n);e.bufferEntries.push({name:r,type:n,sizeInBytes:a,offset:e.sizeInBytes,nativeType:Ve.getNativeTypeFromShaderFormat(n)}),e.sizeInBytes+=a},t.send=function(r){if(!e._buffer){var n={nativeArray:e.Float32Array,usage:tx.Storage,label:e.label};e._buffer=r.getBufferManager().getBuffer(n),e.bindGroupTime.modified(),e._sendTime.modified();return}r.getHandle().queue.writeBuffer(e._buffer.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes*e.numberOfInstances),e._sendTime.modified()},t.createView=function(r){r in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes*e.numberOfInstances)),e[r]=m.newTypedArray(r,e.arrayBuffer))},t.setValue=function(r,n,a){var i=e._bufferEntryNames.get(r);if(i===void 0){wr("entry named ".concat(r," not found in UBO"));return}var s=e.bufferEntries[i];t.createView(s.nativeType);var o=e[s.nativeType];o[(s.offset+n*e.sizeInBytes)/o.BYTES_PER_ELEMENT]=a},t.setArray=function(r,n,a){var i=e._bufferEntryNames.get(r);if(i===void 0){wr("entry named ".concat(r," not found in UBO"));return}var s=e.bufferEntries[i];t.createView(s.nativeType);for(var o=e[s.nativeType],u=(s.offset+n*e.sizeInBytes)/o.BYTES_PER_ELEMENT,c=0;c<a.length;c++)o[u+c]=a[c]},t.setAllInstancesFromArray=function(r,n){var a=e._bufferEntryNames.get(r);if(a===void 0){wr("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],o=n.length/e.numberOfInstances,u=0;u<e.numberOfInstances;u++)for(var c=(i.offset+u*e.sizeInBytes)/s.BYTES_PER_ELEMENT,f=0;f<o;f++)s[c+f]=n[u*o+f]},t.setAllInstancesFromArrayColorToFloat=function(r,n){var a=e._bufferEntryNames.get(r);if(a===void 0){wr("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],o=n.length/e.numberOfInstances,u=0;u<e.numberOfInstances;u++)for(var c=(i.offset+u*e.sizeInBytes)/s.BYTES_PER_ELEMENT,f=0;f<o;f++)s[c+f]=n[u*o+f]/255},t.setAllInstancesFromArray3x3To4x4=function(r,n){var a=e._bufferEntryNames.get(r);if(a===void 0){wr("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],o=9,u=0;u<e.numberOfInstances;u++)for(var c=(i.offset+u*e.sizeInBytes)/s.BYTES_PER_ELEMENT,f=0;f<3;f++)for(var g=0;g<3;g++)s[c+f*4+g]=n[u*o+f*3+g]},t.getSendTime=function(){return e._sendTime.getMTime()},t.getShaderCode=function(r,n){for(var a=["struct ".concat(e.label,`StructEntry
{`)],i=0;i<e.bufferEntries.length;i++){var s=e.bufferEntries[i];a.push("  ".concat(s.name,": ").concat(s.type,","))}return a.push(`
};
struct `.concat(e.label,`Struct
{
  values: array<`).concat(e.label,`StructEntry>,
};
@binding(`).concat(r,") @group(").concat(n,") var<storage, read> ").concat(e.label,": ").concat(e.label,`Struct;
`)),a.join(`
`)},t.getBindGroupEntry=function(){var r={resource:{buffer:e._buffer.getHandle()}};return r},t.clearData=function(){e.numberOfInstances=0,e.sizeInBytes=0,e.bufferEntries=[],e._bufferEntryNames=new Map,e._buffer=null,delete e.arrayBuffer,delete e.Float32Array}}var nx={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,numberOfInstances:1};function ov(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nx,r),m.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e._sendTime={},m.obj(e._sendTime,{mtime:0}),e.bindGroupTime={},m.obj(e.bindGroupTime,{mtime:0}),e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"read-only-storage"}},m.get(t,e,["bindGroupTime"]),m.setGet(t,e,["device","bindGroupLayoutEntry","label","numberOfInstances","sizeInBytes"]),rx(t,e)}var ax=m.newInstance(ov,"vtkWebGPUStorageBuffer"),$i={newInstance:ax,extend:ov},ix=Je.BufferUsage,pi=m.vtkErrorMacro;function sx(t,e){e.classHierarchy.push("vtkWebGPUUniformBuffer"),t.addEntry=function(r,n){if(e._bufferEntryNames.has(r)){pi("entry named ".concat(r," already exists"));return}e.sortDirty=!0,e._bufferEntryNames.set(r,e.bufferEntries.length),e.bufferEntries.push({name:r,type:n,sizeInBytes:Ve.getByteStrideFromShaderFormat(n),offset:-1,nativeType:Ve.getNativeTypeFromShaderFormat(n),packed:!1})},t.sortBufferEntries=function(){if(e.sortDirty){for(var r=0,n=[],a=4,i=0;i<e.bufferEntries.length;i++){var s=e.bufferEntries[i];s.sizeInBytes%16===0&&(a=Math.max(16,a)),s.sizeInBytes%8===0&&(a=Math.max(8,a))}for(var o=0;o<e.bufferEntries.length;o++){var u=e.bufferEntries[o];u.packed===!1&&u.sizeInBytes%16===0&&(u.packed=!0,u.offset=r,n.push(u),r+=u.sizeInBytes)}for(var c=0;c<e.bufferEntries.length;c++){var f=e.bufferEntries[c];if(f.packed===!1&&f.sizeInBytes===12)for(var g=0;g<e.bufferEntries.length;g++){var v=e.bufferEntries[g];if(v.packed===!1&&v.sizeInBytes===4){f.packed=!0,f.offset=r,n.push(f),r+=f.sizeInBytes,v.packed=!0,v.offset=r,n.push(v),r+=v.sizeInBytes;break}}}for(var p=0;p<e.bufferEntries.length;p++){var l=e.bufferEntries[p];if(!l.packed&&l.sizeInBytes%8===0)for(var y=p+1;y<e.bufferEntries.length;y++){var h=e.bufferEntries[y];if(!h.packed&&h.sizeInBytes%8===0){l.packed=!0,l.offset=r,n.push(l),r+=l.sizeInBytes,h.packed=!0,h.offset=r,n.push(h),r+=h.sizeInBytes;break}}}for(var d=0;d<e.bufferEntries.length;d++){var S=e.bufferEntries[d];if(!S.packed&&S.sizeInBytes%8===0)for(var T=!1,C=0;!T&&C<e.bufferEntries.length;C++){var x=e.bufferEntries[C];if(!x.packed&&x.sizeInBytes===4)for(var O=C+1;O<e.bufferEntries.length;O++){var w=e.bufferEntries[O];if(!w.packed&&w.sizeInBytes===4){S.packed=!0,S.offset=r,n.push(S),r+=S.sizeInBytes,x.packed=!0,x.offset=r,n.push(x),r+=x.sizeInBytes,w.packed=!0,w.offset=r,n.push(w),r+=w.sizeInBytes,T=!0;break}}}}for(var E=0;E<e.bufferEntries.length;E++){var V=e.bufferEntries[E];!V.packed&&V.sizeInBytes>4&&(V.packed=!0,V.offset=r,n.push(V),r+=V.sizeInBytes)}for(var D=0;D<e.bufferEntries.length;D++){var M=e.bufferEntries[D];M.packed||(M.packed=!0,M.offset=r,n.push(M),r+=M.sizeInBytes)}e.bufferEntries=n,e._bufferEntryNames.clear();for(var L=0;L<e.bufferEntries.length;L++)e._bufferEntryNames.set(e.bufferEntries[L].name,L);e.sizeInBytes=r,e.sizeInBytes=a*Math.ceil(e.sizeInBytes/a),e.sortDirty=!1}},t.sendIfNeeded=function(r){if(!e.UBO){var n={nativeArray:e.Float32Array,usage:ix.UniformArray,label:e.label};e.UBO=r.getBufferManager().getBuffer(n),e.bindGroupTime.modified(),e.sendDirty=!1}e.sendDirty&&(r.getHandle().queue.writeBuffer(e.UBO.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes),e.sendDirty=!1),e.sendTime.modified()},t.createView=function(r){r in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes)),e[r]=m.newTypedArray(r,e.arrayBuffer))},t.setValue=function(r,n){t.sortBufferEntries();var a=e._bufferEntryNames.get(r);if(a===void 0){pi("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);var s=e[i.nativeType];i.lastValue!==n&&(s[i.offset/s.BYTES_PER_ELEMENT]=n,e.sendDirty=!0),i.lastValue=n},t.setArray=function(r,n){t.sortBufferEntries();var a=e._bufferEntryNames.get(r);if(a===void 0){pi("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],o=!1,u=0;u<n.length;u++)(!i.lastValue||i.lastValue[u]!==n[u])&&(s[i.offset/s.BYTES_PER_ELEMENT+u]=n[u],o=!0);o&&(e.sendDirty=!0,i.lastValue=Y(n))},t.getBindGroupEntry=function(){var r={resource:{buffer:e.UBO.getHandle()}};return r},t.getSendTime=function(){return e.sendTime.getMTime()},t.getShaderCode=function(r,n){t.sortBufferEntries();for(var a=["struct ".concat(e.label,`Struct
{`)],i=0;i<e.bufferEntries.length;i++){var s=e.bufferEntries[i];a.push("  ".concat(s.name,": ").concat(s.type,","))}return a.push(`};
@binding(`.concat(r,") @group(").concat(n,") var<uniform> ").concat(e.label,": ").concat(e.label,"Struct;")),a.join(`
`)}}var ox={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,bindGroupLayoutEntry:null,bindGroupEntry:null};function uv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ox,r),m.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"uniform"}},e.sendTime={},m.obj(e.sendTime,{mtime:0}),e.bindGroupTime={},m.obj(e.bindGroupTime,{mtime:0}),e.sendDirty=!0,e.sortDirty=!0,m.get(t,e,["binding","bindGroupTime"]),m.setGet(t,e,["bindGroupLayoutEntry","device","label","sizeInBytes"]),sx(t,e)}var ux=m.newInstance(uv,"vtkWebGPUUniformBuffer"),hr={newInstance:ux,extend:uv},fx=Xt,Du=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var computedColor: vec4<f32> = mapperUBO.BackgroundColor;

  //VTK::RenderEncoder::Impl
  return output;
}
`,cx=`
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var tcoord: vec4<f32> = vec4<f32>(input.vertexVC.xy, -1, 1);
  var V: vec4<f32> = normalize(mapperUBO.FSQMatrix * tcoord); // vec2<f32>((input.tcoordVS.x - 0.5) * 2, -(input.tcoordVS.y - 0.5) * 2);
  // textureSampleLevel gets rid of some ugly artifacts
  var background = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, vecToRectCoord(V.xyz), 0);
  var computedColor: vec4<f32> = vec4<f32>(background.rgb, 1);

  //VTK::RenderEncoder::Impl
  return output;
}
`,zn=new Float64Array(16),Mu=new Float64Array(16);function gx(t){return t.getPositional()?t.getConeAngle()>=90?0:2:1}function vx(t,e){e.classHierarchy.push("vtkWebGPURenderer"),t.buildPass=function(r){if(r){if(!e.renderable)return;e.camera=e.renderable.getActiveCamera(),t.updateLights(),t.prepareNodes(),t.addMissingNode(e.camera),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes(),e.webgpuCamera=t.getViewNodeFor(e.camera),t.updateStabilizedMatrix()}},t.updateStabilizedMatrix=function(){var r=e.camera.getClippingRange(),n=e.camera.getPositionByReference(),a=e.camera.getDirectionOfProjectionByReference(),i=[],s=[];_t(s,a,.5*(r[0]+r[1])),Jr(i,n,s),wi(s,i,e.stabilizedCenter);var o=Ff(s);o/(r[1]-r[0])>e.recenterThreshold&&(e.stabilizedCenter=i,e.stabilizedTime.modified())},t.updateLights=function(){for(var r=0,n=e.renderable.getLightsByReference(),a=0;a<n.length;++a)n[a].getSwitch()>0&&r++;return r||(fx("No lights are on, creating one."),e.renderable.createLight()),r},t.updateUBO=function(){var r=e.UBO.getSendTime();if(e._parent.getMTime()>r||t.getMTime()>r||e.camera.getMTime()>r||e.renderable.getMTime()>r){var n,a=e.webgpuCamera.getKeyMatrices(t);e.UBO.setArray("WCVCMatrix",a.wcvc),e.UBO.setArray("SCPCMatrix",a.scpc),e.UBO.setArray("PCSCMatrix",a.pcsc),e.UBO.setArray("SCVCMatrix",a.scvc),e.UBO.setArray("VCPCMatrix",a.vcpc),e.UBO.setArray("WCVCNormals",a.normalMatrix),e.UBO.setValue("LightCount",e.renderable.getLights().length),e.UBO.setValue("MaxEnvironmentMipLevel",(n=e.renderable.getEnvironmentTexture())===null||n===void 0?void 0:n.getMipLevel()),e.UBO.setValue("BackgroundDiffuseStrength",e.renderable.getEnvironmentTextureDiffuseStrength()),e.UBO.setValue("BackgroundSpecularStrength",e.renderable.getEnvironmentTextureSpecularStrength());var i=t.getYInvertedTiledSizeAndOrigin();e.UBO.setArray("viewportSize",[i.usize,i.vsize]),e.UBO.setValue("cameraParallel",e.camera.getParallelProjection());var s=e._parent.getDevice();e.UBO.sendIfNeeded(s)}},t.updateSSBO=function(){for(var r=e.renderable.getLights(),n=e.webgpuCamera.getKeyMatrices(t),a="".concat(e.renderable.getMTime()),i=0;i<r.length;i++)a+=r[i].getMTime();if(a!==e.lightTimeString){for(var s=new Float32Array(r.length*4),o=new Float32Array(r.length*4),u=new Float32Array(r.length*4),c=new Float32Array(r.length*4),f=0;f<r.length;f++){var g=f*4,v=r[f].getPosition();ce(v,v,n.wcvc),s[g]=v[0],s[g+1]=v[1],s[g+2]=v[2],s[g+3]=0,o[g]=-r[f].getDirection()[0],o[g+1]=-r[f].getDirection()[1],o[g+2]=-r[f].getDirection()[2],o[g+3]=0,u[g]=r[f].getColor()[0],u[g+1]=r[f].getColor()[1],u[g+2]=r[f].getColor()[2],u[g+3]=r[f].getIntensity()*5,c[g]=gx(r[f]),c[g+1]=Math.cos(Te(r[f].getConeAngle())),c[g+2]=Math.cos(Te(r[f].getConeAngle()+r[f].getConeFalloff())),c[g+3]=0}e.SSBO.clearData(),e.SSBO.setNumberOfInstances(r.length),e.SSBO.addEntry("LightPos","vec4<f32>"),e.SSBO.addEntry("LightDir","vec4<f32>"),e.SSBO.addEntry("LightColor","vec4<f32>"),e.SSBO.addEntry("LightData","vec4<f32>"),e.SSBO.setAllInstancesFromArray("LightPos",s),e.SSBO.setAllInstancesFromArray("LightDir",o),e.SSBO.setAllInstancesFromArray("LightColor",u),e.SSBO.setAllInstancesFromArray("LightData",c);var p=e._parent.getDevice();e.SSBO.send(p)}e.lightTimeString=a},t.scissorAndViewport=function(r){var n=t.getYInvertedTiledSizeAndOrigin();r.getHandle().setViewport(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize,0,1),r.getHandle().setScissorRect(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize)},t.bindUBO=function(r){r.activateBindGroup(e.bindGroup)},t.opaquePass=function(r){r?(e.renderEncoder.begin(e._parent.getCommandEncoder()),t.updateUBO(),t.updateSSBO()):(t.scissorAndViewport(e.renderEncoder),t.clear(),e.renderEncoder.end())},t.clear=function(){var r;if(!(e.renderable.getTransparent()||e.suppressClear)){var n=e._parent.getDevice();if(!e.clearFSQ){e.clearFSQ=Hr.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(Du);var a=hr.newInstance({label:"mapperUBO"});a.addEntry("FSQMatrix","mat4x4<f32>"),a.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(a),e.backgroundTex=e.renderable.getEnvironmentTexture()}if(e.clearFSQ.getPipelineHash()!=="clearfsqwithtexture"&&e.renderable.getUseEnvironmentTextureAsBackground()&&(r=e.backgroundTex)!==null&&r!==void 0&&r.getImageLoaded()){e.clearFSQ.setFragmentShaderTemplate(cx);var i=hr.newInstance({label:"mapperUBO"});i.addEntry("FSQMatrix","mat4x4<f32>"),i.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(i);var s=n.getTextureManager().getTextureForVTKTexture(e.backgroundTex);if(s.getReady()){var o=s.createView("EnvironmentTexture");e.clearFSQ.setTextureViews([o]),e.backgroundTexLoaded=!0;var u=e.backgroundTex.getInterpolate()?"linear":"nearest";o.addSampler(n,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:u,magFilter:u,mipmapFilter:"linear"})}e.clearFSQ.setPipelineHash("clearfsqwithtexture")}else if(e.clearFSQ.getPipelineHash()==="clearfsqwithtexture"&&!e.renderable.getUseEnvironmentTextureAsBackground()){e.clearFSQ=Hr.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(Du);var c=hr.newInstance({label:"mapperUBO"});c.addEntry("FSQMatrix","mat4x4<f32>"),c.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(c)}var f=e.webgpuCamera.getKeyMatrices(t),g=e.renderable.getBackgroundByReference();e.clearFSQ.getUBO().setArray("BackgroundColor",g),ye(Mu,f.normalMatrix),Oi(zn,f.scvc,f.pcsc),Oi(zn,Mu,zn),e.clearFSQ.getUBO().setArray("FSQMatrix",zn),e.clearFSQ.getUBO().sendIfNeeded(n),e.clearFSQ.prepareAndDraw(e.renderEncoder)}},t.translucentPass=function(r){r?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.volumeDepthRangePass=function(r){r?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.getAspectRatio=function(){var r=e._parent.getSizeByReference(),n=e.renderable.getViewportByReference();return r[0]*(n[2]-n[0])/((n[3]-n[1])*r[1])},t.convertToOpenGLDepth=function(r){return e.webgpuCamera.convertToOpenGLDepth(r)},t.getYInvertedTiledSizeAndOrigin=function(){var r=t.getTiledSizeAndOrigin(),n=e._parent.getSizeByReference();return r.lowerLeftV=n[1]-r.vsize-r.lowerLeftV,r},t.getTiledSizeAndOrigin=function(){var r=e.renderable.getViewportByReference(),n=[0,0,1,1],a=r[0]-n[0],i=r[1]-n[1],s=e._parent.normalizedDisplayToDisplay(a,i),o=Math.round(s[0]),u=Math.round(s[1]),c=r[2]-n[0],f=r[3]-n[1],g=e._parent.normalizedDisplayToDisplay(c,f),v=Math.round(g[0])-o,p=Math.round(g[1])-u;return v<0&&(v=0),p<0&&(p=0),{usize:v,vsize:p,lowerLeftU:o,lowerLeftV:u}},t.getPropFromID=function(r){for(var n=0;n<e.children.length;n++){var a=e.children[n].getPropID?e.children[n].getPropID():-1;if(a===r)return e.children[n]}return null},t.getStabilizedTime=function(){return e.stabilizedTime.getMTime()},t.releaseGraphicsResources=function(){e.selector!==null&&e.selector.releaseGraphicsResources()}}var px={bindGroup:null,selector:null,renderEncoder:null,recenterThreshold:20,suppressClear:!1,stabilizedCenter:[0,0,0]};function lx(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,px,r),Se.extend(t,e,r),e.UBO=hr.newInstance({label:"rendererUBO"}),e.UBO.addEntry("WCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("PCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("VCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("WCVCNormals","mat4x4<f32>"),e.UBO.addEntry("viewportSize","vec2<f32>"),e.UBO.addEntry("LightCount","i32"),e.UBO.addEntry("MaxEnvironmentMipLevel","f32"),e.UBO.addEntry("BackgroundDiffuseStrength","f32"),e.UBO.addEntry("BackgroundSpecularStrength","f32"),e.UBO.addEntry("cameraParallel","u32"),e.SSBO=$i.newInstance({label:"rendererLightSSBO"}),e.lightTimeString="",e.bindGroup=Qg.newInstance({label:"rendererBG"}),e.bindGroup.setBindables([e.UBO,e.SSBO]),e.tmpMat4=ae(new Float64Array(16)),e.stabilizedTime={},Ne(e.stabilizedTime,{mtime:0}),je(t,e,["bindGroup","stabilizedTime"]),Tn(t,e,["stabilizedCenter"]),be(t,e,["renderEncoder","selector","suppressClear","UBO"]),vx(t,e)}var hx=ve(lx,"vtkWebGPURenderer");ut("vtkRenderer",hx);var Vu=Sn.CoordinateSystem;function yx(t,e){e.classHierarchy.push("vtkWebGPUActor"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},t.getBufferShift=function(r){return t.getKeyMatrices(r),e.bufferShift},t.getKeyMatrices=function(r){if(Math.max(e.renderable.getMTime(),r.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.renderable.computeMatrix();var n=e.renderable.getMatrix();e.bufferShift[0]=n[3],e.bufferShift[1]=n[7],e.bufferShift[2]=n[11];var a=r.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===Vu.WORLD&&(e.bufferShift[0]-=a[0],e.bufferShift[1]-=a[1],e.bufferShift[2]-=a[2]),ye(e.keyMatrices.bcwc,n),e.renderable.getIsIdentity()?ae(e.keyMatrices.normalMatrix):(Fe(e.keyMatrices.normalMatrix,e.keyMatrices.bcwc),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,He(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),ye(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),me(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===Vu.WORLD?me(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-a[0],-a[1],-a[2]]):Fe(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}var dx={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function Tx(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dx,r),Se.extend(t,e,r),e.keyMatricesTime={},m.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},m.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],yx(t,e)}var Cx=m.newInstance(Tx);ut("vtkActor",Cx);var Ru=Sn.CoordinateSystem;function Sx(t,e){e.classHierarchy.push("vtkWebGPUActor2D"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},t.getBufferShift=function(r){return t.getKeyMatrices(r),e.bufferShift},t.getKeyMatrices=function(r){if(Math.max(e.renderable.getMTime(),r.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.bufferShift[0]=0,e.bufferShift[1]=0,e.bufferShift[2]=0;var n=r.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===Ru.WORLD&&(e.bufferShift[0]-=n[0],e.bufferShift[1]-=n[1],e.bufferShift[2]-=n[2]),ae(e.keyMatrices.bcwc),ae(e.keyMatrices.normalMatrix),me(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===Ru.WORLD?me(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-n[0],-n[1],-n[2]]):Fe(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}var xx={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function Ox(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xx,r),Se.extend(t,e,r),e.keyMatricesTime={},m.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},m.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],Sx(t,e)}var mx=m.newInstance(Ox);ut("vtkActor2D",mx);function wx(t,e){e.classHierarchy.push("vtkWebGPUCubeAxesActor"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,i=e.WebGPURenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e.WebGPURenderWindow.getRenderable())}}}var Ex={};function Dx(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ex,r),Se.extend(t,e,r),e.CubeAxesActorHelper=Eg.newCubeAxesActorHelper(),wx(t,e)}var Mx=ve(Dx,"vtkWebGPUCubeAxesActor");ut("vtkCubeAxesActor",Mx);function bu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Vx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bu(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Pi=Hg.DisplayLocation;function Rx(t,e){e.classHierarchy.push("vtkProperty2D"),t.setDisplayLocationToBackground=function(){return t.setDisplayLocation(Pi.BACKGROUND)},t.setDisplayLocationToForeground=function(){return t.setDisplayLocation(Pi.FOREGROUND)},t.setRepresentationToWireframe=function(){return t.setRepresentation(Ie.WIREFRAME)},t.setRepresentationToSurface=function(){return t.setRepresentation(Ie.SURFACE)},t.setRepresentationToPoints=function(){return t.setRepresentation(Ie.POINTS)},t.getRepresentationAsString=function(){return m.enumToString(Ie,e.representation)}}var bx={color:[1,1,1],opacity:1,pointSize:1,lineWidth:1,representation:Ie.SURFACE,displayLocation:Pi.FOREGROUND};function fv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,bx,r),m.obj(t,e),m.setGet(t,e,["opacity","lineWidth","pointSize","displayLocation","representation"]),m.setGetArray(t,e,["color"],3),Rx(t,e)}var Lx=m.newInstance(fv,"vtkProperty2D"),Bx=Vx({newInstance:Lx,extend:fv},Hg),Me=Je.BufferUsage,Ue=Je.PrimitiveTypes,An=Tr.Representation,Hn=Yt.ScalarMode,kx=Sn.CoordinateSystem,Nx=Bx.DisplayLocation,Fx=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,Ux=`
struct PBRData {
  diffuse: vec3<f32>,
  specular: vec3<f32>,
}

// Dot product with the max already in it
fn mdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  return max(0.0, dot(a, b));
}
// Dot product with a max in it that does not allow for negative values
// Physically based rendering is accurate as long as normals are accurate,
// however this is pretty often not the case. In order to prevent negative
// values from ruining light calculations and creating zones of zero light,
// this remapping is used, which smoothly clamps the dot product between
// zero and one while still maintaining a good amount of accuracy.
fn cdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  var d: f32 = max(0.0, dot(a, b));
  d = pow((d + 1) / 2.0, 2.6);
  return d;
}

// Lambertian diffuse model
fn lambertDiffuse(base: vec3<f32>, N: vec3<f32>, L: vec3<f32>) -> vec3<f32> {
  var pi: f32 = 3.14159265359; 
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5);
  return (base/pi)*NdotL;
}

// Yasuhiro Fujii improvement on the Oren-Nayar model
// https://mimosa-pudica.net/improved-oren-nayar.html
// p is surface color, o is roughness
fn fujiiOrenNayar(p: vec3<f32>, o: f32, N: vec3<f32>, L: vec3<f32>, V: vec3<f32>) -> vec3<f32> {
  var invpi: f32 = 0.31830988618; // 1/pi

  var o2 = o*o;
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5); // Less physically accurate, but hides the "seams" between lights better

  var NdotV: f32 = mdot(N, V);
  var LdotV: f32 = mdot(L, V);

  var s: f32 = LdotV - NdotL*NdotV;
  var t: f32 = mix(1, max(NdotL, NdotV), step(0, s)); // Mix with step is the equivalent of an if statement
  var A: vec3<f32> = 0.5*(o2 / (o2 + 0.33)) + 0.17*p*(o2 / (o2 + 0.13));
  A = invpi*(1 - A);
  var B: f32 = 0.45*(o2 / (o2 + 0.09));
  B = invpi*B;

  return p*NdotL*(A + B*(s/t));
}

// Fresnel portion of BRDF (IOR only, simplified)
fn schlickFresnelIOR(V: vec3<f32>, N: vec3<f32>, ior: f32, k: f32) -> f32 {
  var NdotV: f32 = mdot(V, N);
  var F0: f32 = (pow((ior - 1.0), 2) + k*k) / (pow((ior + 1.0), 2) + k*k); // This takes into account the roughness, which the other one does not
  return F0 + (1 - F0) * pow((1-NdotV), 5); 
}

// Fresnel portion of BRDF (Color ior, better)
fn schlickFresnelRGB(V: vec3<f32>, N: vec3<f32>, F0: vec3<f32>) -> vec3<f32> {
  var NdotV: f32 = mdot(V, N);
  return F0 + (1 - F0) * pow((1-NdotV), 5); 
}

// Normal portion of BRDF
// https://learnopengl.com/PBR/Theory
// Trowbridge-Reitz GGX functions: normal, halfway, roughness^2
fn trGGX(N: vec3<f32>, H: vec3<f32>, a: f32) -> f32 {
  var pi: f32 = 3.14159265359; 

  var a2: f32 = a*a;
  var NdotH = mdot(N, H);
  var NdotH2 = NdotH*NdotH;
  
  var denom: f32 = NdotH2 * (a2 - 1.0) + 1.0;

  return a2 / max((pi*denom*denom), 0.000001);
}

// A VERY bad approximation of anisotropy. Real anisotropic calculations require tangent and bitangent
fn anisotrophicTrGGX(N: vec3<f32>, H: vec3<f32>, O: vec3<f32>, s: f32, a: f32) -> f32 {
  var Op: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(O) * s, 0.)).xyz;

  var ggx1: f32 = trGGX(N + Op*s, H, a);
  var ggx2: f32 = trGGX(N - Op*s, H, a);
  return (0.5 * ggx1 + 0.5 * ggx2);
}

// Geometry portion of BRDF
fn schlickGGX(N: vec3<f32>, X: vec3<f32>, k: f32) -> f32 {
  var NdotX = cdot(N, X);
  return NdotX / max(0.000001, (NdotX*(1-k) + k));
}

fn smithSurfaceRoughness(N: vec3<f32>, V: vec3<f32>, L: vec3<f32>, k: f32) -> f32 {
  var ggx1: f32 = min(1, schlickGGX(N, V, k));
  var ggx2: f32 = min(1, schlickGGX(N, L, k));
  return ggx1*ggx2;
}

// BRDF Combination
fn cookTorrance(D: f32, F: f32, G: f32, N: vec3<f32>, V: vec3<f32>, L: vec3<f32>) -> f32 {
  var num: f32 = D*F*G;
  var denom: f32 = 4*cdot(V, N)*cdot(L, N);

  return num / max(denom, 0.000001);
}

// Different lighting calculations for different light sources
fn calcDirectionalLight(N: vec3<f32>, V: vec3<f32>, ior: f32, roughness: f32, metallic: f32, direction: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {  
  var L: vec3<f32> = normalize(direction); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2;

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1, G, N, V, L); // Fresnel term is replaced with 1 because it is added later
  var incoming: vec3<f32> = color;
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5);

  var specular: vec3<f32> = brdf*incoming*angle;
  // Oren-Nayar gives a clay-like effect when fully rough which some people may not want, so it might be better to give a separate
  // control property for the diffuse vs specular roughness
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V); 
  // Stores the specular and diffuse separately to allow for finer post processing
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// TODO: find some way to reduce the number of arguments going in here
fn calcPointLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {
  var L: vec3<f32> = normalize(position - fragPos); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(position, fragPos);

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1, G, N, V, L);  
  var incoming: vec3<f32> = color * (1. / (dist*dist));
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources

  var specular: vec3<f32> = brdf*incoming*angle;
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// For a reason unknown to me, spheres dont seem to behave propperly with head-on spot lights
fn calcSpotLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, direction: vec3<f32>, cones: vec2<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {
  var L: vec3<f32> = normalize(position - fragPos);
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(position, fragPos);

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1, G, N, V, L);  
  
  // Cones.x is the inner phi and cones.y is the outer phi
  var theta: f32 = mdot(normalize(direction), L);
  var epsilon: f32 = cones.x - cones.y;
  var intensity: f32 = (theta - cones.y) / epsilon;
  intensity = clamp(intensity, 0.0, 1.0);
  intensity /= dist*dist;

  var incoming: vec3<f32> = color * intensity;

  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources

  var specular: vec3<f32> = brdf*incoming*angle;
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// Environment mapping stuff
// Takes in a vector and converts it to an equivalent coordinate in a rectilinear texture. Should be replaced with cubemaps at some point
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::TCoord::Dec

// optional surface normal declaration
//VTK::Normal::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  // Temporary ambient, diffuse, and opacity
  var ambientColor: vec4<f32> = mapperUBO.AmbientColor;
  var diffuseColor: vec4<f32> = mapperUBO.DiffuseColor;
  var opacity: f32 = mapperUBO.Opacity;

  // This should be declared somewhere else
  var _diffuseMap: vec4<f32> = vec4<f32>(1);
  var _roughnessMap: vec4<f32> = vec4<f32>(1);
  var _metallicMap: vec4<f32> = vec4<f32>(1);
  var _normalMap: vec4<f32> = vec4<f32>(0, 0, 1, 0); // normal map was setting off the normal vector detection in fragment
  var _ambientOcclusionMap: vec4<f32> = vec4<f32>(1);
  var _emissionMap: vec4<f32> = vec4<f32>(0);

  //VTK::Color::Impl

  //VTK::TCoord::Impl

  //VTK::Normal::Impl

  var computedColor: vec4<f32> = vec4<f32>(diffuseColor.rgb, 1.0);

  //VTK::Light::Impl

  //VTK::Select::Impl

  if (computedColor.a == 0.0) { discard; };

  //VTK::Position::Impl

  //VTK::RenderEncoder::Impl

  return output;
}
`;function Lu(t){return t.indexOf("edge")>=0}function Gx(t,e){e.classHierarchy.push("vtkWebGPUCellArrayMapper"),t.buildPass=function(r){r&&(e.is2D?(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.forceZValue=!0):(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.forceZValue=!1),e.coordinateSystem=e.WebGPUActor.getRenderable().getCoordinateSystem(),e.useRendererMatrix=e.coordinateSystem!==kx.DISPLAY,e.WebGPURenderer=e.WebGPUActor.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.device=e.WebGPURenderWindow.getDevice())},t.translucentPass=function(r){r&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.opaquePass=function(r){r&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.updateUBO=function(){var r=e.WebGPUActor.getRenderable(),n=r.getProperty(),a=e.UBO.getSendTime();if(t.getMTime()>a||n.getMTime()>a||e.renderable.getMTime()>a){var i,s=e.WebGPUActor.getKeyMatrices(e.WebGPURenderer);if(e.UBO.setArray("BCWCMatrix",s.bcwc),e.UBO.setArray("BCSCMatrix",s.bcsc),e.UBO.setArray("MCWCNormals",s.normalMatrix),e.is2D){e.UBO.setValue("ZValue",e.WebGPUActor.getRenderable().getProperty().getDisplayLocation()===Nx.FOREGROUND?1:0);var o=n.getColorByReference();e.UBO.setValue("AmbientIntensity",1),e.UBO.setArray("DiffuseColor",[o[0],o[1],o[2],1]),e.UBO.setValue("DiffuseIntensity",0),e.UBO.setValue("SpecularIntensity",0)}else{var u=n.getAmbientColorByReference();e.UBO.setValue("AmbientIntensity",n.getAmbient()),e.UBO.setArray("AmbientColor",[u[0],u[1],u[2],1]),e.UBO.setValue("DiffuseIntensity",n.getDiffuse()),u=n.getDiffuseColorByReference(),e.UBO.setArray("DiffuseColor",[u[0],u[1],u[2],1]),e.UBO.setValue("Roughness",n.getRoughness()),e.UBO.setValue("BaseIOR",n.getBaseIOR()),e.UBO.setValue("Metallic",n.getMetallic()),e.UBO.setValue("NormalStrength",n.getNormalStrength()),e.UBO.setValue("Emission",n.getEmission()),e.UBO.setValue("SpecularIntensity",n.getSpecular()),u=n.getSpecularColorByReference(),e.UBO.setArray("SpecularColor",[u[0],u[1],u[2],1])}var c=(i=n.getEdgeColorByReference)===null||i===void 0?void 0:i.call(n);c&&e.UBO.setArray("EdgeColor",[c[0],c[1],c[2],1]),e.UBO.setValue("LineWidth",n.getLineWidth()),e.UBO.setValue("Opacity",n.getOpacity()),e.UBO.setValue("PropID",e.WebGPUActor.getPropID());var f=e.WebGPURenderWindow.getDevice();e.UBO.sendIfNeeded(f)}},t.haveWideLines=function(){var r=e.WebGPUActor.getRenderable(),n=r.getProperty().getRepresentation();return r.getProperty().getLineWidth()<=1||e.primitiveType===Ue.Verts?!1:e.primitiveType===Ue.Triangles||e.primitiveType===Ue.TriangleStrips?n===An.WIREFRAME:!0},t.replaceShaderPosition=function(r,n,a){var i=n.getShaderDescription("vertex");i.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),i.hasOutput("vertexVC")||i.addOutput("vec4<f32>","vertexVC");var s=i.getCode();e.useRendererMatrix?(s=X.substitute(s,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = rendererUBO.SCPCMatrix*mapperUBO.BCSCMatrix*vertexBC;","    output.vertexVC = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);","//VTK::Position::Impl"]).result,e.forceZValue&&(s=X.substitute(s,"//VTK::Position::Impl",["pCoord = vec4<f32>(pCoord.xyz/pCoord.w, 1.0);","pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)):(s=X.substitute(s,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = mapperUBO.BCSCMatrix*vertexBC;","    pCoord.x = 2.0* pCoord.x / rendererUBO.viewportSize.x - 1.0;","    pCoord.y = 2.0* pCoord.y / rendererUBO.viewportSize.y - 1.0;","    pCoord.z = 0.5 - 0.5 * pCoord.z;","//VTK::Position::Impl"]).result,e.forceZValue&&(s=X.substitute(s,"//VTK::Position::Impl",["    pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)),t.haveWideLines()&&(i.addBuiltinInput("u32","@builtin(instance_index) instanceIndex"),s=X.substitute(s,"//VTK::Position::Impl",["    var tmpPos: vec4<f32> = pCoord;","    var numSteps: f32 = ceil(mapperUBO.LineWidth - 1.0);","    var offset: f32 = (mapperUBO.LineWidth - 1.0) * (f32(input.instanceIndex / 2u) - numSteps/2.0) / numSteps;","    var tmpPos2: vec3<f32> = tmpPos.xyz / tmpPos.w;","    tmpPos2.x = tmpPos2.x + 2.0 * (f32(input.instanceIndex) % 2.0) * offset / rendererUBO.viewportSize.x;","    tmpPos2.y = tmpPos2.y + 2.0 * (f32(input.instanceIndex + 1u) % 2.0) * offset / rendererUBO.viewportSize.y;","    tmpPos2.z = min(1.0, tmpPos2.z + 0.00001);","    pCoord = vec4<f32>(tmpPos2.xyz * tmpPos.w, tmpPos.w);","//VTK::Position::Impl"]).result),s=X.substitute(s,"//VTK::Position::Impl",["    output.Position = pCoord;"]).result,i.setCode(s)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderNormal=function(r,n,a){var i=a.getBuffer("normalMC"),s=e.WebGPUActor.getRenderable();if(i){var o=n.getShaderDescription("vertex");o.hasOutput("normalVC")||o.addOutput("vec3<f32>","normalVC",i.getArrayInformation()[0].interpolation),o.hasOutput("tangentVC")||o.addOutput("vec3<f32>","tangentVC",i.getArrayInformation()[0].interpolation),o.hasOutput("bitangentVC")||o.addOutput("vec3<f32>","bitangentVC",i.getArrayInformation()[0].interpolation);var u=o.getCode();u=X.substitute(u,"//VTK::Normal::Impl",["  output.normalVC = normalize((rendererUBO.WCVCNormals * mapperUBO.MCWCNormals * normalMC).xyz);","  var c1: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 0, 1));","  var c2: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 1, 0));","  var tangent: vec3<f32> = mix(c1, c2, distance(c1, c2));","  output.tangentVC = normalize(tangent);","  output.bitangentVC = normalize(cross(output.normalVC, tangent));"]).result,o.setCode(u);var c=n.getShaderDescription("fragment");u=c.getCode(),s.getProperty().getNormalTexture()?u=X.substitute(u,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  var tangent: vec3<f32> = input.tangentVC;","  var bitangent: vec3<f32> = input.bitangentVC;","  var TCVCMatrix: mat3x3<f32> = mat3x3<f32>(","    tangent.x, bitangent.x, normal.x,","    tangent.y, bitangent.y, normal.y,","    tangent.z, bitangent.z, normal.z,","  );","  var mappedNormal: vec3<f32> = TCVCMatrix * (_normalMap.xyz * 2 - 1);","  normal = mix(normal, mappedNormal, mapperUBO.NormalStrength);","  normal = normalize(normal);"]).result:u=X.substitute(u,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  normal = normalize(normal);"]).result,c.setCode(u)}},e.shaderReplacements.set("replaceShaderNormal",t.replaceShaderNormal),t.replaceShaderLight=function(r,n,a){if(!r.includes("sel")){var i=n.getShaderDescription("vertex");i.hasOutput("vertexVC")||i.addOutput("vec4<f32>","vertexVC");var s=e.WebGPURenderer.getRenderable(),o=n.getShaderDescription("fragment"),u=o.getCode();if(u.includes("var normal:")&&e.useRendererMatrix&&!Lu(r)&&!e.is2D&&!r.includes("sel")){var c,f=["  var pi: f32 = 3.14159265359;","  var fragPos: vec3<f32> = vec3<f32>(input.vertexVC.xyz);","  var V: vec3<f32> = mix(normalize(-fragPos), vec3<f32>(0, 0, 1), f32(rendererUBO.cameraParallel)); // View Vector","  var baseColor: vec3<f32> = _diffuseMap.rgb * diffuseColor.rgb;","  var roughness: f32 = max(0.000001, mapperUBO.Roughness * _roughnessMap.r);","  var metallic: f32 = mapperUBO.Metallic * _metallicMap.r;","  var alpha: f32 = roughness*roughness;","  var ior: f32 = mapperUBO.BaseIOR;","  var k: f32 = alpha*alpha / 2;","  var diffuse: vec3<f32> = vec3<f32>(0.);","  var specular: vec3<f32> = vec3<f32>(0.);","  var emission: vec3<f32> = _emissionMap.rgb * mapperUBO.Emission;","  {","    var i: i32 = 0;","    loop {","      if !(i < rendererUBO.LightCount) { break; }","      switch (i32(rendererLightSSBO.values[i].LightData.x)) {","         // Point Light","         case 0 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var calculated: PBRData = calcPointLight(normal, V, fragPos, ior, roughness, metallic, pos, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","          }","         // Directional light","         case 1 {","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var calculated: PBRData = calcDirectionalLight(normal, V, ior, roughness, metallic, dir, color, baseColor); // diffuseColor.rgb needs to be fixed with a more dynamic diffuse color","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         // Spot Light","         case 2 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var cones: vec2<f32> = vec2<f32>(rendererLightSSBO.values[i].LightData.y, rendererLightSSBO.values[i].LightData.z);","           var calculated: PBRData = calcSpotLight(normal, V, fragPos, ior, roughness, metallic, pos, dir, cones, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         default { continue; }","       }","      continuing { i++; }","    }","  }","  var fresnel: f32 = schlickFresnelIOR(V, normal, ior, k); // Fresnel","  fresnel = min(1, fresnel);","  // This could be controlled with its own variable (that isnt base color) for better artistic control","  var fresnelMetallic: vec3<f32> = schlickFresnelRGB(V, normal, baseColor); // Fresnel for metal, takes color into account","  var kS: vec3<f32> = mix(vec3<f32>(fresnel), fresnelMetallic, metallic);","  kS = min(vec3<f32>(1), kS);","  var kD: vec3<f32> = (1.0 - kS) * (1.0 - metallic);","  var PBR: vec3<f32> = mapperUBO.DiffuseIntensity*kD*diffuse + kS*specular;","  PBR += emission;","  computedColor = vec4<f32>(PBR, mapperUBO.Opacity);"];(c=s.getEnvironmentTexture())!==null&&c!==void 0&&c.getImageLoaded()&&f.push("  // To get diffuse IBL, the texture is sampled with normals in worldspace","  var diffuseIBLCoords: vec3<f32> = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(normal, 1.)).xyz;","  var diffuseCoords: vec2<f32> = vecToRectCoord(diffuseIBLCoords);","  // To get specular IBL, the texture is sampled as the worldspace reflection between the normal and view vectors","  // Reflections are first calculated in viewspace, then converted to worldspace to sample the environment","  var VreflN: vec3<f32> = normalize(reflect(-V, normal));","  var reflectionIBLCoords = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(VreflN, 1.)).xyz;","  var specularCoords: vec2<f32> = vecToRectCoord(reflectionIBLCoords);","  var diffuseIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, diffuseCoords, rendererUBO.MaxEnvironmentMipLevel);","  var level = roughness * rendererUBO.MaxEnvironmentMipLevel;","  var specularIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, specularCoords, level);","  var specularIBLContribution: vec3<f32> = specularIBL.rgb*rendererUBO.BackgroundSpecularStrength;","  computedColor += vec4<f32>(specularIBLContribution*kS, 0);","  var diffuseIBLContribution: vec3<f32> = diffuseIBL.rgb*rendererUBO.BackgroundDiffuseStrength;","  diffuseIBLContribution *= baseColor * _ambientOcclusionMap.rgb;","  computedColor += vec4<f32>(diffuseIBLContribution*kD, 0);"),u=X.substitute(u,"//VTK::Light::Impl",f).result,o.setCode(u)}else u=X.substitute(u,"//VTK::Light::Impl",["  var diffuse: vec3<f32> = diffuseColor.rgb;","  var specular: vec3<f32> = mapperUBO.SpecularColor.rgb * mapperUBO.SpecularColor.a;","  computedColor = vec4<f32>(diffuse * _diffuseMap.rgb, mapperUBO.Opacity);"]).result,o.setCode(u)}},e.shaderReplacements.set("replaceShaderLight",t.replaceShaderLight),t.replaceShaderColor=function(r,n,a){if(Lu(r)){var i=n.getShaderDescription("fragment"),s=i.getCode();s=X.substitute(s,"//VTK::Color::Impl",["ambientColor = mapperUBO.EdgeColor;","diffuseColor = mapperUBO.EdgeColor;"]).result,i.setCode(s);return}var o=a.getBuffer("colorVI");if(o){var u=n.getShaderDescription("vertex");u.addOutput("vec4<f32>","color",o.getArrayInformation()[0].interpolation);var c=u.getCode();c=X.substitute(c,"//VTK::Color::Impl",["  output.color = colorVI;"]).result,u.setCode(c);var f=n.getShaderDescription("fragment");c=f.getCode(),c=X.substitute(c,"//VTK::Color::Impl",["ambientColor = input.color;","diffuseColor = input.color;","opacity = mapperUBO.Opacity * input.color.a;"]).result,f.setCode(c)}},e.shaderReplacements.set("replaceShaderColor",t.replaceShaderColor),t.replaceShaderTCoord=function(r,n,a){var i,s,o,u,c,f,g,v,p,l,y,h,d,S,T,C,x,O;if(a.hasAttribute("tcoord")){var w=n.getShaderDescription("vertex"),E=a.getBuffer("tcoord"),V=Ve.getNumberOfComponentsFromBufferFormat(E.getArrayInformation()[0].format),D=w.getCode();w.addOutput("vec".concat(V,"<f32>"),"tcoordVS"),D=X.substitute(D,"//VTK::TCoord::Impl",["  output.tcoordVS = tcoord;"]).result,w.setCode(D);var M=n.getShaderDescription("fragment");D=M.getCode();var L=e.WebGPUActor.getRenderable(),N=function(z){if(!z)return!1;var R=z.getDimensionality();return R===V},B=[];if((i=(s=L.getProperty()).getDiffuseTexture)!==null&&i!==void 0&&(o=i.call(s))!==null&&o!==void 0&&o.getImageLoaded()||L.getTextures()[0]||e.colorTexture){var _,A;(N((_=(A=L.getProperty()).getDiffuseTexture)===null||_===void 0?void 0:_.call(A))||N(L.getTextures()[0])||N(e.colorTexture))&&B.push("_diffuseMap = textureSample(DiffuseTexture, DiffuseTextureSampler, input.tcoordVS);")}(u=(c=L.getProperty()).getRoughnessTexture)!==null&&u!==void 0&&(f=u.call(c))!==null&&f!==void 0&&f.getImageLoaded()&&N(L.getProperty().getRoughnessTexture())&&B.push("_roughnessMap = textureSample(RoughnessTexture, RoughnessTextureSampler, input.tcoordVS);"),(g=(v=L.getProperty()).getMetallicTexture)!==null&&g!==void 0&&(p=g.call(v))!==null&&p!==void 0&&p.getImageLoaded()&&N(L.getProperty().getMetallicTexture())&&B.push("_metallicMap = textureSample(MetallicTexture, MetallicTextureSampler, input.tcoordVS);"),(l=(y=L.getProperty()).getNormalTexture)!==null&&l!==void 0&&(h=l.call(y))!==null&&h!==void 0&&h.getImageLoaded()&&N(L.getProperty().getNormalTexture())&&B.push("_normalMap = textureSample(NormalTexture, NormalTextureSampler, input.tcoordVS);"),(d=(S=L.getProperty()).getAmbientOcclusionTexture)!==null&&d!==void 0&&(T=d.call(S))!==null&&T!==void 0&&T.getImageLoaded()&&N(L.getProperty().getAmbientOcclusionTexture())&&B.push("_ambientOcclusionMap = textureSample(AmbientOcclusionTexture, AmbientOcclusionTextureSampler, input.tcoordVS);"),(C=(x=L.getProperty()).getEmissionTexture)!==null&&C!==void 0&&(O=C.call(x))!==null&&O!==void 0&&O.getImageLoaded()&&N(L.getProperty().getEmissionTexture())&&B.push("_emissionMap = textureSample(EmissionTexture, EmissionTextureSampler, input.tcoordVS);"),D=X.substitute(D,"//VTK::TCoord::Impl",B).result,M.setCode(D)}},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.replaceShaderSelect=function(r,n,a){if(r.includes("sel")){var i=n.getShaderDescription("fragment"),s=i.getCode();s=X.substitute(s,"//VTK::Select::Impl",["  var compositeID: u32 = 0u;"]).result,i.setCode(s)}},e.shaderReplacements.set("replaceShaderSelect",t.replaceShaderSelect),t.getUsage=function(r,n){return r===An.POINTS||n===Ue.Points?Me.Verts:n===Ue.Lines?Me.Lines:r===An.WIREFRAME?n===Ue.Triangles?Me.LinesFromTriangles:Me.LinesFromStrips:n===Ue.Triangles?Me.Triangles:n===Ue.TriangleStrips?Me.Strips:n===Ue.TriangleEdges?Me.LinesFromTriangles:Me.LinesFromStrips},t.getHashFromUsage=function(r){return"pt".concat(r)},t.getTopologyFromUsage=function(r){switch(r){case Me.Triangles:return"triangle-list";case Me.Verts:return"point-list";case Me.Lines:default:return"line-list"}},t.buildVertexInput=function(){var r,n,a=e.currentInput,i=e.cellArray,s=e.primitiveType,o=e.WebGPUActor.getRenderable(),u=o.getProperty().getRepresentation(),c=e.WebGPURenderWindow.getDevice(),f=!1;s===Ue.TriangleEdges&&(f=!0,u=An.WIREFRAME);var g=e.vertexInput,v=a.getPoints(),p;if(i){var l={hash:"R".concat(u,"P").concat(s).concat(i.getMTime()),usage:Me.Index,cells:i,numberOfPoints:v.getNumberOfPoints(),primitiveType:s,representation:u};p=c.getBufferManager().getBuffer(l),g.setIndexBuffer(p)}else g.setIndexBuffer(null);if(v){var y=e.WebGPUActor.getBufferShift(e.WebGPURenderer),h={hash:"".concat(v.getMTime(),"I").concat(p.getMTime()).concat(y.join(),"float32x4"),usage:Me.PointArray,format:"float32x4",dataArray:v,indexBuffer:p,shift:y,packExtra:!0},d=c.getBufferManager().getBuffer(h);g.addBuffer(d,["vertexBC"])}else g.removeBufferIfPresent("vertexBC");var S=t.getUsage(u,s);if(e._usesCellNormals=!1,!e.is2D&&(S===Me.Triangles||S===Me.Strips)){var T=a.getPointData().getNormals(),C={format:"snorm8x4",indexBuffer:p,packExtra:!0,shift:0,scale:127};if(T){C.hash="".concat(T.getMTime(),"I").concat(p.getMTime(),"snorm8x4"),C.dataArray=T,C.usage=Me.PointArray;var x=c.getBufferManager().getBuffer(C);g.addBuffer(x,["normalMC"])}else if(s===Ue.Triangles){e._usesCellNormals=!0,C.hash="PFN".concat(v.getMTime(),"I").concat(p.getMTime(),"snorm8x4"),C.dataArray=v,C.cells=i,C.usage=Me.NormalsFromPoints;var O=c.getBufferManager().getBuffer(C);g.addBuffer(O,["normalMC"])}else g.removeBufferIfPresent("normalMC")}else g.removeBufferIfPresent("normalMC");var w=!1;if(e.renderable.getScalarVisibility()){var E=e.renderable.getColorMapColors();if(E&&!f){var V=e.renderable.getScalarMode(),D=!1;(V===Hn.USE_CELL_DATA||V===Hn.USE_CELL_FIELD_DATA||V===Hn.USE_FIELD_DATA||!a.getPointData().getScalars())&&V!==Hn.USE_POINT_FIELD_DATA&&E&&(D=!0);var M={usage:Me.PointArray,format:"unorm8x4",hash:"".concat(D).concat(E.getMTime(),"I").concat(p.getMTime(),"unorm8x4"),dataArray:E,indexBuffer:p,cellData:D,cellOffset:0},L=c.getBufferManager().getBuffer(M);g.addBuffer(L,["colorVI"]),w=!0}}w||g.removeBufferIfPresent("colorVI");var N=null;if((r=(n=e.renderable).getInterpolateScalarsBeforeMapping)!==null&&r!==void 0&&r.call(n)&&e.renderable.getColorCoordinates()?N=e.renderable.getColorCoordinates():N=a.getPointData().getTCoords(),N&&!f){var B=c.getBufferManager().getBufferForPointArray(N,g.getIndexBuffer());g.addBuffer(B,["tcoord"])}else g.removeBufferIfPresent("tcoord")},t.updateTextures=function(){var r,n,a,i,s,o,u,c,f,g,v,p,l,y,h,d=[],S=[],T=(r=(n=e.renderable).getColorTextureMap)===null||r===void 0?void 0:r.call(n);T&&(e.colorTexture||(e.colorTexture=Ua.newInstance({label:"polyDataColor"})),e.colorTexture.setInputData(T),S.push(["Diffuse",e.colorTexture]));var C=e.WebGPUActor.getRenderable(),x=e.WebGPURenderer.getRenderable(),O=[];if((a=(i=C.getProperty()).getDiffuseTexture)!==null&&a!==void 0&&a.call(i)){var w=["Diffuse",C.getProperty().getDiffuseTexture()];O.push(w)}if(C.getTextures()[0]){var E=["Diffuse",C.getTextures()[0]];O.push(E)}if(e.colorTexture){var V=["Diffuse",e.colorTexture];O.push(V)}if((s=(o=C.getProperty()).getRoughnessTexture)!==null&&s!==void 0&&s.call(o)){var D=["Roughness",C.getProperty().getRoughnessTexture()];O.push(D)}if((u=(c=C.getProperty()).getMetallicTexture)!==null&&u!==void 0&&u.call(c)){var M=["Metallic",C.getProperty().getMetallicTexture()];O.push(M)}if((f=(g=C.getProperty()).getNormalTexture)!==null&&f!==void 0&&f.call(g)){var L=["Normal",C.getProperty().getNormalTexture()];O.push(L)}if((v=(p=C.getProperty()).getAmbientOcclusionTexture)!==null&&v!==void 0&&v.call(p)){var N=["AmbientOcclusion",C.getProperty().getAmbientOcclusionTexture()];O.push(N)}if((l=(y=C.getProperty()).getEmissionTexture)!==null&&l!==void 0&&l.call(y)){var B=["Emission",C.getProperty().getEmissionTexture()];O.push(B)}if((h=x.getEnvironmentTexture)!==null&&h!==void 0&&h.call(x)){var _=["Environment",x.getEnvironmentTexture()];O.push(_)}for(var A=0;A<O.length;A++)(O[A][1].getInputData()||O[A][1].getJsImageData()||O[A][1].getCanvas())&&S.push(O[A]),O[A][1].getImage()&&O[A][1].getImageLoaded()&&S.push(O[A]);for(var W=0;W<S.length;W++){var z=S[W][1],R=S[W][0],b=e.device.getTextureManager().getTextureForVTKTexture(z);if(b.getReady()){for(var F=!1,G=0;G<e.textures.length;G++)e.textures[G]===b&&(F=!0,d[G]=!0);if(!F){d[e.textures.length]=!0;var U=b.createView("".concat(R,"Texture"));e.textures.push(b),e.textureViews.push(U);var H=z.getInterpolate()?"linear":"nearest",j=null;!j&&z.getEdgeClamp()&&z.getRepeat()&&(j="mirror-repeat"),!j&&z.getEdgeClamp()&&(j="clamp-to-edge"),!j&&z.getRepeat()&&(j="repeat"),R!=="Environment"?U.addSampler(e.device,{addressModeU:j,addressModeV:j,addressModeW:j,minFilter:H,magFilter:H}):U.addSampler(e.device,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:H,magFilter:H,mipmapFilter:"linear"})}}}for(var I=e.textures.length-1;I>=0;I--)d[I]||(e.textures.splice(I,1),e.textureViews.splice(I,1))},t.computePipelineHash=function(){var r="pd".concat(e.useRendererMatrix?"r":"").concat(e.forceZValue?"z":"");if(e.primitiveType===Ue.TriangleEdges||e.primitiveType===Ue.TriangleStripEdges)r+="edge";else{if(e.vertexInput.hasAttribute("normalMC")&&(r+="n"),e.vertexInput.hasAttribute("colorVI")&&(r+="c"),e.vertexInput.hasAttribute("tcoord")){var n=e.vertexInput.getBuffer("tcoord"),a=Ve.getNumberOfComponentsFromBufferFormat(n.getArrayInformation()[0].format);r+="t".concat(a)}e.textures.length&&(r+="tx".concat(e.textures.length))}e._usesCellNormals&&(r+="cn"),e.SSBO&&(r+="ssbo");var i=t.getHashFromUsage(e.usage);r+=i,r+=e.renderEncoder.getPipelineHash(),e.pipelineHash=r},t.updateBuffers=function(){e.primitiveType!==Ue.TriangleEdges&&e.primitiveType!==Ue.TriangleStripEdges&&t.updateTextures();var r=e.WebGPUActor.getRenderable(),n=r.getProperty().getRepresentation();e.usage=t.getUsage(n,e.primitiveType),t.buildVertexInput();var a=e.vertexInput.getBuffer("vertexBC");if(t.setNumberOfVertices(a.getSizeInBytes()/a.getStrideInBytes()),t.setTopology(t.getTopologyFromUsage(e.usage)),t.updateUBO(),t.haveWideLines()){var i=r.getProperty();t.setNumberOfInstances(Math.ceil(i.getLineWidth()*2))}else t.setNumberOfInstances(1)}}var _x={is2D:!1,cellArray:null,currentInput:null,cellOffset:0,primitiveType:0,colorTexture:null,renderEncoder:null,textures:null};function cv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_x,r),Vs.extend(t,e,r),e.fragmentShaderTemplate=Ux,e.vertexShaderTemplate=Fx,e._tmpMat3=dr(new Float64Array(9)),e._tmpMat4=ae(new Float64Array(16)),e.UBO=hr.newInstance({label:"mapperUBO"}),e.UBO.addEntry("BCWCMatrix","mat4x4<f32>"),e.UBO.addEntry("BCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("MCWCNormals","mat4x4<f32>"),e.UBO.addEntry("AmbientColor","vec4<f32>"),e.UBO.addEntry("DiffuseColor","vec4<f32>"),e.UBO.addEntry("EdgeColor","vec4<f32>"),e.UBO.addEntry("SpecularColor","vec4<f32>"),e.UBO.addEntry("AmbientIntensity","f32"),e.UBO.addEntry("DiffuseIntensity","f32"),e.UBO.addEntry("Roughness","f32"),e.UBO.addEntry("Metallic","f32"),e.UBO.addEntry("Ambient","f32"),e.UBO.addEntry("Normal","f32"),e.UBO.addEntry("Emission","f32"),e.UBO.addEntry("NormalStrength","f32"),e.UBO.addEntry("BaseIOR","f32"),e.UBO.addEntry("SpecularIntensity","f32"),e.UBO.addEntry("LineWidth","f32"),e.UBO.addEntry("Opacity","f32"),e.UBO.addEntry("ZValue","f32"),e.UBO.addEntry("PropID","u32"),e.UBO.addEntry("ClipNear","f32"),e.UBO.addEntry("ClipFar","f32"),e.UBO.addEntry("Time","u32"),be(t,e,["cellArray","currentInput","cellOffset","is2D","primitiveType","renderEncoder"]),e.textures=[],Gx(t,e)}var Wx=ve(cv,"vtkWebGPUCellArrayMapper"),_a={newInstance:Wx,extend:cv},$n=Je.PrimitiveTypes;function zx(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper"),t.createCellArrayMapper=function(){return _a.newInstance()},t.buildPass=function(r){if(r){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.renderable.getStatic()||e.renderable.update();var n=e.renderable.getInputData();e.renderable.mapScalars(n,1),t.updateCellArrayMappers(n)}},t.updateCellArrayMappers=function(r){for(var n=[r.getVerts(),r.getLines(),r.getPolys(),r.getStrips()],a=[],i=0,s=$n.Points;s<=$n.Triangles;s++)if(n[s].getNumberOfValues()>0){e.primitives[s]||(e.primitives[s]=t.createCellArrayMapper());var o=e.primitives[s];o.setCellArray(n[s]),o.setCurrentInput(r),o.setCellOffset(i),o.setPrimitiveType(s),o.setRenderable(e.renderable),i+=n[s].getNumberOfCells(),a.push(o)}else e.primitives[s]=null;if(e.WebGPUActor.getRenderable().getProperty().getEdgeVisibility())for(var u=$n.TriangleEdges;u<=$n.TriangleStripEdges;u++)if(n[u-2].getNumberOfValues()>0){e.primitives[u]||(e.primitives[u]=t.createCellArrayMapper());var c=e.primitives[u];c.setCellArray(n[u-2]),c.setCurrentInput(r),c.setCellOffset(e.primitives[u-2].getCellOffset()),c.setPrimitiveType(u),c.setRenderable(e.renderable),a.push(c)}else e.primitives[u]=null;t.prepareNodes(),t.addMissingChildren(a),t.removeUnusedNodes()}}var Ax={primitives:null};function Hx(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ax,r),Se.extend(t,e,r),e.primitives=[],zx(t,e)}var $x=ve(Hx,"vtkWebGPUPolyDataMapper");ut("vtkMapper",$x);function Bu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Px(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Bu(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Bu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ku=Je.PrimitiveTypes;function jx(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper2D"),t.createCellArrayMapper=function(){return _a.newInstance()},t.buildPass=function(r){if(r){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.renderable.getStatic()||e.renderable.update();var n=e.renderable.getInputData();e.renderable.mapScalars(n,1),t.updateCellArrayMappers(n)}},t.updateCellArrayMappers=function(r){for(var n=[r.getVerts(),r.getLines(),r.getPolys(),r.getStrips()],a=[],i=0,s=ku.Points;s<=ku.Triangles;s++)if(n[s].getNumberOfValues()>0){e.primitives[s]||(e.primitives[s]=t.createCellArrayMapper());var o=e.primitives[s];o.setCellArray(n[s]),o.setCurrentInput(r),o.setCellOffset(i),o.setPrimitiveType(s),o.setRenderable(e.renderable),o.setIs2D(!0),i+=n[s].getNumberOfCells(),a.push(o)}else e.primitives[s]=null;t.prepareNodes(),t.addMissingChildren(a),t.removeUnusedNodes()}}function Kx(t){return Px({primitives:[]},t)}function Xx(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Kx(r)),Se.extend(t,e,r),e.primitives=[],jx(t,e)}var Yx=ve(Xx,"vtkWebGPUPolyDataMapper2D");ut("vtkMapper2D",Yx);function qx(t,e){e.classHierarchy.push("vtkWebGPUScalarBarActor"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,i=e.WebGPURenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e.WebGPURenderWindow.getRenderable())}}}var Qx={};function Zx(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Qx,r),Se.extend(t,e,r),e.scalarBarActorHelper=Kg.newScalarBarActorHelper(),qx(t,e)}var Ix=ve(Zx,"vtkWebGPUScalarBarActor");ut("vtkScalarBarActor",Ix);function Jx(t,e){e.classHierarchy.push("vtkWebGPUSampler"),t.create=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.device=r,e.options.addressModeU=n.addressModeU?n.addressModeU:"clamp-to-edge",e.options.addressModeV=n.addressModeV?n.addressModeV:"clamp-to-edge",e.options.addressModeW=n.addressModeW?n.addressModeW:"clamp-to-edge",e.options.magFilter=n.magFilter?n.magFilter:"nearest",e.options.minFilter=n.minFilter?n.minFilter:"nearest",e.options.mipmapFilter=n.mipmapFilter?n.mipmapFilter:"nearest",e.options.label=e.label,e.handle=e.device.getHandle().createSampler(e.options),e.bindGroupTime.modified()},t.getShaderCode=function(r,n){var a="@binding(".concat(r,") @group(").concat(n,") var ").concat(e.label,": sampler;");return a},t.getBindGroupEntry=function(){var r={resource:e.handle};return r}}var eO={device:null,handle:null,label:null,options:null};function gv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,eO,r),m.obj(t,e),e.options={},e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,sampler:{}},e.bindGroupTime={},m.obj(e.bindGroupTime,{mtime:0}),m.get(t,e,["bindGroupTime","handle","options"]),m.setGet(t,e,["bindGroupLayoutEntry","device","label"]),Jx(t,e)}var tO=m.newInstance(gv),Rs={newInstance:tO,extend:gv};function rO(t,e){e.classHierarchy.push("vtkWebGPUTextureView"),t.create=function(r,n){e.texture=r,e.options=n,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=r.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;var a=Ve.getDetailsFromTextureFormat(e.texture.getFormat());e.bindGroupLayoutEntry.texture.sampleType=a.sampleType},t.createFromTextureHandle=function(r,n){e.texture=null,e.options=n,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=r,e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;var a=Ve.getDetailsFromTextureFormat(n.format);e.bindGroupLayoutEntry.texture.sampleType=a.sampleType,e.bindGroupTime.modified()},t.getBindGroupEntry=function(){var r={resource:t.getHandle()};return r},t.getShaderCode=function(r,n){var a="f32";e.bindGroupLayoutEntry.texture.sampleType==="sint"?a="i32":e.bindGroupLayoutEntry.texture.sampleType==="uint"&&(a="u32");var i="@binding(".concat(r,") @group(").concat(n,") var ").concat(e.label,": texture_").concat(e.options.dimension,"<").concat(a,">;");return e.bindGroupLayoutEntry.texture.sampleType==="depth"&&(i="@binding(".concat(r,") @group(").concat(n,") var ").concat(e.label,": texture_depth_").concat(e.options.dimension,";")),i},t.addSampler=function(r,n){var a=Rs.newInstance({label:"".concat(e.label,"Sampler")});a.create(r,n),t.setSampler(a)},t.getBindGroupTime=function(){return e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.bindGroupTime},t.getHandle=function(){return e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.handle}}var nO={texture:null,handle:null,sampler:null,label:null};function vv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nO,r),m.obj(t,e),e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d"}},e.bindGroupTime={},m.obj(e.bindGroupTime,{mtime:0}),m.get(t,e,["bindGroupTime","texture"]),m.setGet(t,e,["bindGroupLayoutEntry","label","sampler"]),rO(t,e)}var aO=m.newInstance(vv),pv={newInstance:aO,extend:vv},Nu=Je.BufferUsage;function iO(t,e){e.classHierarchy.push("vtkWebGPUTexture"),t.create=function(r,n){e.device=r,e.width=n.width,e.height=n.height,e.depth=n.depth?n.depth:1;var a=e.depth===1?"2d":"3d";e.format=n.format?n.format:"rgba8unorm",e.mipLevel=n.mipLevel?n.mipLevel:0,e.usage=n.usage?n.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label,dimension:a,mipLevelCount:e.mipLevel+1})},t.assignFromHandle=function(r,n,a){e.device=r,e.handle=n,e.width=a.width,e.height=a.height,e.depth=a.depth?a.depth:1,e.format=a.format?a.format:"rgba8unorm",e.usage=a.usage?a.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST},t.writeImageData=function(r){var n=[];if(r.canvas){e.device.getHandle().queue.copyExternalImageToTexture({source:r.canvas,flipY:r.flip},{texture:e.handle,premultipliedAlpha:!0},[e.width,e.height,e.depth]),e.ready=!0;return}r.jsImageData&&!r.nativeArray&&(r.width=r.jsImageData.width,r.height=r.jsImageData.height,r.depth=1,r.format="rgba8unorm",r.flip=!0,r.nativeArray=r.jsImageData.data);var a=Ve.getDetailsFromTextureFormat(e.format),i=e.width*a.stride,s=function(O,w,E){var V=O.length/(w*E)*O.BYTES_PER_ELEMENT,D=a.elementSize===2&&a.sampleType==="float";if(D||V%256){for(var M=O,L=V/M.BYTES_PER_ELEMENT,N=a.elementSize,B=256*Math.floor((L*N+255)/256),_=B/N,A=m.newTypedArray(D?"Uint16Array":M.constructor.name,_*w*E),W=0;W<w*E;W++)if(D)for(var z=0;z<L;z++)A[W*_+z]=st.toHalf(M[W*L+z]);else A.set(M.subarray(W*L,(W+1)*L),W*_);return[A,B]}return[O,V]};if(r.nativeArray&&(n=r.nativeArray),r.image){var o=document.createElement("canvas");o.width=r.image.width,o.height=r.image.height;var u=o.getContext("2d");u.translate(0,o.height),u.scale(1,-1),u.drawImage(r.image,0,0,r.image.width,r.image.height,0,0,o.width,o.height);var c=u.getImageData(0,0,r.image.width,r.image.height);n=c.data}var f=e.device.createCommandEncoder();if(t.getDimensionality()!==3){for(var g=Ua.generateMipmaps(n,e.width,e.height,e.mipLevel),v=e.width,p=e.height,l=0;l<=e.mipLevel;l++){var y=s(g[l],p,1);i=y[1];var h={dataArray:r.dataArray?r.dataArray:null,nativeArray:y[0],usage:Nu.Texture},d=e.device.getBufferManager().getBuffer(h);f.copyBufferToTexture({buffer:d.getHandle(),offset:0,bytesPerRow:i,rowsPerImage:p},{texture:e.handle,mipLevel:l},[v,p,1]),v/=2,p/=2}e.device.submitCommandEncoder(f),e.ready=!0}else{var S=s(n,e.height,e.depth);i=S[1];var T={dataArray:r.dataArray?r.dataArray:null,usage:Nu.Texture};T.nativeArray=S[0];var C=e.device.getBufferManager().getBuffer(T);f.copyBufferToTexture({buffer:C.getHandle(),offset:0,bytesPerRow:i,rowsPerImage:e.height},{texture:e.handle},[e.width,e.height,e.depth]),e.device.submitCommandEncoder(f),e.ready=!0}},t.getScale=function(){var r=Ve.getDetailsFromTextureFormat(e.format),n=r.elementSize===2&&r.sampleType==="float";return n?1:255},t.getNumberOfComponents=function(){var r=Ve.getDetailsFromTextureFormat(e.format);return r.numComponents},t.getDimensionality=function(){var r=0;return e.width>1&&r++,e.height>1&&r++,e.depth>1&&r++,r},t.resizeToMatch=function(r){(r.getWidth()!==e.width||r.getHeight()!==e.height||r.getDepth()!==e.depth)&&(e.width=r.getWidth(),e.height=r.getHeight(),e.depth=r.getDepth(),e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.resize=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;(r!==e.width||n!==e.height||a!==e.depth)&&(e.width=r,e.height=n,e.depth=a,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.createView=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};n.dimension||(n.dimension=e.depth===1?"2d":"3d");var a=pv.newInstance({label:r});return a.create(t,n),a}}var sO={device:null,handle:null,buffer:null,ready:!1,label:null};function lv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,sO,r),m.obj(t,e),m.get(t,e,["handle","ready","width","height","depth","format","usage"]),m.setGet(t,e,["device","label"]),iO(t,e)}var oO=m.newInstance(lv),Ct={newInstance:oO,extend:lv};function uO(t,e){e.classHierarchy.push("vtkWebGPUPixelSpaceCallbackMapper"),t.opaquePass=function(r,n){e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent();var a=e.WebGPURenderer.getAspectRatio(),i=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,s=e.WebGPURenderer.getTiledSizeAndOrigin(),o=null;e.renderable.getUseZValues(),e.renderable.invokeCallback(e.renderable.getInputData(),i,a,s,o)}}var fO={};function cO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fO,r),Se.extend(t,e,r),uO(t,e)}var gO=m.newInstance(cO,"vtkWebGPUPixelSpaceCallbackMapper");ut("vtkPixelSpaceCallbackMapper",gO);var vO=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkSphereMapperVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// this shader implements imposters in OpenGL for Spheres

attribute vec4 vertexMC;
attribute vec2 offsetMC;

// optional normal declaration
//VTK::Normal::Dec

//VTK::Picking::Dec

// Texture coordinates
//VTK::TCoord::Dec

uniform mat3 normalMatrix; // transform model coordinate directions to view coordinates

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

varying vec4 vertexVCVSOutput;
varying float radiusVCVSOutput;
varying vec3 centerVCVSOutput;

uniform int cameraParallel;
uniform float scaleFactor;

void main()
{
  //VTK::Picking::Impl

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  // compute the projected vertex position
  vec2 scaledOffsetMC = scaleFactor * offsetMC;
  vertexVCVSOutput = MCVCMatrix * vertexMC;
  centerVCVSOutput = vertexVCVSOutput.xyz;
  radiusVCVSOutput = length(scaledOffsetMC)*0.5;

  // make the triangle face the camera
  if (cameraParallel == 0)
    {
    vec3 dir = normalize(-vertexVCVSOutput.xyz);
    vec3 base2 = normalize(cross(dir,vec3(1.0,0.0,0.0)));
    vec3 base1 = cross(base2,dir);
    vertexVCVSOutput.xyz = vertexVCVSOutput.xyz + scaledOffsetMC.x*base1 + scaledOffsetMC.y*base2;
    }
  else
    {
    // add in the offset
    vertexVCVSOutput.xy = vertexVCVSOutput.xy + scaledOffsetMC;
    }

  gl_Position = VCPCMatrix * vertexVCVSOutput;
}
`;function Fu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function pO(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Fu(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Fu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var lO=P;function hO(t,e){e.classHierarchy.push("vtkOpenGLSphereMapper");var r=pO({},t);t.getShaderTemplate=function(n,a,i){n.Vertex=vO,n.Fragment=Ms,n.Geometry=""},t.replaceShaderValues=function(n,a,i){var s=n.Vertex,o=n.Fragment;s=k.substitute(s,"//VTK::Camera::Dec",[`uniform mat4 VCPCMatrix;
`,"uniform mat4 MCVCMatrix;"]).result,o=k.substitute(o,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,o=k.substitute(o,"//VTK::PositionVC::Impl",[`vec4 vertexVC = vertexVCVSOutput;
`]).result;var u=[`uniform float invertedDepth;
`,`uniform int cameraParallel;
`,`varying float radiusVCVSOutput;
`,`varying vec3 centerVCVSOutput;
`,`uniform mat4 VCPCMatrix;
`];o=k.substitute(o,"//VTK::Normal::Dec",u).result;var c="";e.context.getExtension("EXT_frag_depth")&&(c=`gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;
`),e._openGLRenderWindow.getWebgl2()&&(c=`gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;
`),o=k.substitute(o,"//VTK::Depth::Impl",[`  vec3 EyePos;
`,`  vec3 EyeDir;
`,`  if (cameraParallel != 0) {
`,`    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);
`,`    EyeDir = vec3(0.0,0.0,-1.0); }
`,`  else {
`,`    EyeDir = vertexVC.xyz;
`,`    EyePos = vec3(0.0,0.0,0.0);
`,`    float lengthED = length(EyeDir);
`,`    EyeDir = normalize(EyeDir);
`,`    if (lengthED > radiusVCVSOutput*3.0) {
`,`      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }
`,`    }
`,`  EyePos = EyePos - centerVCVSOutput;
`,`  EyePos = EyePos/radiusVCVSOutput;
`,`  float b = 2.0*dot(EyePos,EyeDir);
`,`  float c = dot(EyePos,EyePos) - 1.0;
`,`  float d = b*b - 4.0*c;
`,`  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);
`,`  if (d < 0.0) { discard; }
`,`  else {
`,`    float t = (-b - invertedDepth*sqrt(d))*0.5;
`,`    normalVCVSOutput = invertedDepth*normalize(EyePos + t*EyeDir);
`,`    vertexVC.xyz = normalVCVSOutput*radiusVCVSOutput + centerVCVSOutput;
`,`    }
`,`  vec4 pos = VCPCMatrix * vertexVC;
`,c]).result,o=k.substitute(o,"//VTK::Normal::Impl","").result,e.haveSeenDepthRequest&&(o=k.substitute(o,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),n.Vertex=s,n.Fragment=o,r.replaceShaderValues(n,a,i)},t.setMapperShaderParameters=function(n,a,i){if(n.getCABO().getElementCount()&&(e.VBOBuildTime>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())&&n.getProgram().isAttributeUsed("offsetMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"offsetMC",12,n.getCABO().getStride(),e.context.FLOAT,2,!1)||lO("Error setting 'offsetMC' in shader VAO.")),n.getProgram().isUniformUsed("invertedDepth")&&n.getProgram().setUniformf("invertedDepth",e.invert?-1:1),n.getProgram().isUniformUsed("scaleFactor")){var s=e.currentInput,o=s.getPointData();e.renderable.getScaleArray()!=null&&o.hasArray(e.renderable.getScaleArray())?n.getProgram().setUniformf("scaleFactor",e.renderable.getScaleFactor()):n.getProgram().setUniformf("scaleFactor",1)}r.setMapperShaderParameters(n,a,i)},t.setCameraShaderParameters=function(n,a,i){var s=n.getProgram(),o=a.getActiveCamera(),u=e.openGLCamera.getKeyMatrices(a);if(s.isUniformUsed("VCPCMatrix")&&s.setUniformMatrix("VCPCMatrix",u.vcpc),s.isUniformUsed("MCVCMatrix"))if(i.getIsIdentity())s.setUniformMatrix("MCVCMatrix",u.wcvc);else{var c=e.openGLActor.getKeyMatrices(),f=new Float64Array(16);ke(f,u.wcvc,c.mcwc),s.setUniformMatrix("MCVCMatrix",f)}s.isUniformUsed("cameraParallel")&&n.getProgram().setUniformi("cameraParallel",o.getParallelProjection())},t.getOpenGLMode=function(n,a){return e.context.TRIANGLES},t.buildBufferObjects=function(n,a){var i=e.currentInput;if(i!==null){e.renderable.mapScalars(i,1);var s=e.renderable.getColorMapColors(),o=e.primitives[e.primTypes.Tris].getCABO(),u=i.getPointData(),c=i.getPoints(),f=c.getNumberOfPoints(),g=c.getData(),v=5,p=null;e.renderable.getScaleArray()!=null&&u.hasArray(e.renderable.getScaleArray())&&(p=u.getArray(e.renderable.getScaleArray()).getData());var l=null,y=0,h=null;s?(y=s.getNumberOfComponents(),o.setColorOffset(0),o.setColorBOStride(4),l=s.getData(),h=new Uint8Array(3*f*4),o.getColorBO()||o.setColorBO(Ga.newInstance()),o.getColorBO().setOpenGLRenderWindow(e._openGLRenderWindow)):o.getColorBO()&&o.setColorBO(null),o.setColorComponents(y);var d=new Float32Array(v*f*3);o.setStride(v*4);for(var S=Math.cos(Te(30)),T=0,C=0,x=0,O=0,w=0;w<f;++w){var E=e.renderable.getRadius();p&&(E=p[w]),T=w*3,d[x++]=g[T++],d[x++]=g[T++],d[x++]=g[T++],d[x++]=-2*E*S,d[x++]=-E,l&&(C=w*y,h[O++]=l[C],h[O++]=l[C+1],h[O++]=l[C+2],h[O++]=l[C+3]),T=w*3,d[x++]=g[T++],d[x++]=g[T++],d[x++]=g[T++],d[x++]=2*E*S,d[x++]=-E,l&&(h[O++]=l[C],h[O++]=l[C+1],h[O++]=l[C+2],h[O++]=l[C+3]),T=w*3,d[x++]=g[T++],d[x++]=g[T++],d[x++]=g[T++],d[x++]=0,d[x++]=2*E,l&&(h[O++]=l[C],h[O++]=l[C+1],h[O++]=l[C+2],h[O++]=l[C+3])}o.setElementCount(x/v),o.upload(d,bt.ARRAY_BUFFER),s&&o.getColorBO().upload(h,bt.ARRAY_BUFFER),e.VBOBuildTime.modified()}}}var yO={};function dO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,yO,r),Wg.extend(t,e,r),hO(t,e)}var TO=ve(dO,"vtkOpenGLSphereMapper");Ye("vtkSphereMapper",TO);var CO=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkStickMapperVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// this shader implements imposters in OpenGL for Sticks

attribute vec4 vertexMC;
attribute vec3 orientMC;
attribute vec4 offsetMC;
attribute float radiusMC;

// optional normal declaration
//VTK::Normal::Dec

//VTK::Picking::Dec

// Texture coordinates
//VTK::TCoord::Dec

uniform mat3 normalMatrix; // transform model coordinate directions to view coordinates

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

varying vec4 vertexVCVSOutput;
varying float radiusVCVSOutput;
varying float lengthVCVSOutput;
varying vec3 centerVCVSOutput;
varying vec3 orientVCVSOutput;

uniform int cameraParallel;

void main()
{
  //VTK::Picking::Impl

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  vertexVCVSOutput = MCVCMatrix * vertexMC;
  centerVCVSOutput = vertexVCVSOutput.xyz;
  radiusVCVSOutput = radiusMC;
  lengthVCVSOutput = length(orientMC);
  orientVCVSOutput = normalMatrix * normalize(orientMC);

  // make sure it is pointing out of the screen
  if (orientVCVSOutput.z < 0.0)
    {
    orientVCVSOutput = -orientVCVSOutput;
    }

  // make the basis
  vec3 xbase;
  vec3 ybase;
  vec3 dir = vec3(0.0,0.0,1.0);
  if (cameraParallel == 0)
    {
    dir = normalize(-vertexVCVSOutput.xyz);
    }
  if (abs(dot(dir,orientVCVSOutput)) == 1.0)
    {
    xbase = normalize(cross(vec3(0.0,1.0,0.0),orientVCVSOutput));
    ybase = cross(xbase,orientVCVSOutput);
    }
  else
    {
    xbase = normalize(cross(orientVCVSOutput,dir));
    ybase = cross(orientVCVSOutput,xbase);
    }

  vec3 offsets = offsetMC.xyz*2.0-1.0;
  vertexVCVSOutput.xyz = vertexVCVSOutput.xyz +
    radiusVCVSOutput*offsets.x*xbase +
    radiusVCVSOutput*offsets.y*ybase +
    0.5*lengthVCVSOutput*offsets.z*orientVCVSOutput;

  gl_Position = VCPCMatrix * vertexVCVSOutput;
}
`;function Uu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function SO(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Uu(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Uu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Pn=P;function xO(t,e){e.classHierarchy.push("vtkOpenGLStickMapper");var r=SO({},t);t.getShaderTemplate=function(n,a,i){n.Vertex=CO,n.Fragment=Ms,n.Geometry=""},t.replaceShaderValues=function(n,a,i){var s=n.Vertex,o=n.Fragment;s=k.substitute(s,"//VTK::Camera::Dec",[`uniform mat4 VCPCMatrix;
`,"uniform mat4 MCVCMatrix;"]).result,o=k.substitute(o,"//VTK::PositionVC::Dec","varying vec4 vertexVCVSOutput;").result,o=k.substitute(o,"//VTK::PositionVC::Impl",`  vec4 vertexVC = vertexVCVSOutput;
`).result;var u=[`uniform int cameraParallel;
`,`varying float radiusVCVSOutput;
`,`varying vec3 orientVCVSOutput;
`,`varying float lengthVCVSOutput;
`,`varying vec3 centerVCVSOutput;
`,`uniform mat4 VCPCMatrix;
`];o=k.substitute(o,"//VTK::Normal::Dec",u).result;var c="";e.context.getExtension("EXT_frag_depth")&&(c=`  gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;
`),e._openGLRenderWindow.getWebgl2()&&(c=`gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;
`),o=k.substitute(o,"//VTK::Depth::Impl",[`  vec3 EyePos;
`,`  vec3 EyeDir;
`,`  if (cameraParallel != 0) {
`,`    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);
`,`    EyeDir = vec3(0.0,0.0,-1.0); }
`,`  else {
`,`    EyeDir = vertexVC.xyz;
`,`    EyePos = vec3(0.0,0.0,0.0);
`,`    float lengthED = length(EyeDir);
`,`    EyeDir = normalize(EyeDir);
`,`    if (lengthED > radiusVCVSOutput*3.0) {
`,`      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }
`,`    }
`,`  EyePos = EyePos - centerVCVSOutput;
`,`  vec3 base1;
`,`  if (abs(orientVCVSOutput.z) < 0.99) {
`,`    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,0.0,1.0))); }
`,`  else {
`,`    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,1.0,0.0))); }
`,`  vec3 base2 = cross(orientVCVSOutput,base1);
`,`  EyePos = vec3(dot(EyePos,base1),dot(EyePos,base2),dot(EyePos,orientVCVSOutput));
`,`  EyeDir = vec3(dot(EyeDir,base1),dot(EyeDir,base2),dot(EyeDir,orientVCVSOutput));
`,`  EyePos = EyePos/radiusVCVSOutput;
`,`  float a = EyeDir.x*EyeDir.x + EyeDir.y*EyeDir.y;
`,`  float b = 2.0*(EyePos.x*EyeDir.x + EyePos.y*EyeDir.y);
`,`  float c = EyePos.x*EyePos.x + EyePos.y*EyePos.y - 1.0;
`,`  float d = b*b - 4.0*a*c;
`,`  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);
`,`  if (d < 0.0) { discard; }
`,`  else {
`,`    float t =  (-b - sqrt(d))/(2.0*a);
`,`    float tz = EyePos.z + t*EyeDir.z;
`,`    vec3 iPoint = EyePos + t*EyeDir;
`,`    if (abs(iPoint.z)*radiusVCVSOutput > lengthVCVSOutput*0.5) {
`,`      float t2 = (-b + sqrt(d))/(2.0*a);
`,`      float tz2 = EyePos.z + t2*EyeDir.z;
`,`      if (tz2*radiusVCVSOutput > lengthVCVSOutput*0.5 || tz*radiusVCVSOutput < -0.5*lengthVCVSOutput) { discard; }
`,`      else {
`,`        normalVCVSOutput = orientVCVSOutput;
`,`        float t3 = (lengthVCVSOutput*0.5/radiusVCVSOutput - EyePos.z)/EyeDir.z;
`,`        iPoint = EyePos + t3*EyeDir;
`,`        vertexVC.xyz = radiusVCVSOutput*(iPoint.x*base1 + iPoint.y*base2 + iPoint.z*orientVCVSOutput) + centerVCVSOutput;
`,`        }
`,`      }
`,`    else {
`,`      normalVCVSOutput = iPoint.x*base1 + iPoint.y*base2;
`,`      vertexVC.xyz = radiusVCVSOutput*(normalVCVSOutput + iPoint.z*orientVCVSOutput) + centerVCVSOutput;
`,`      }
`,`    }
`,`  vec4 pos = VCPCMatrix * vertexVC;
`,c]).result,o=k.substitute(o,"//VTK::Normal::Impl","").result,e.haveSeenDepthRequest&&(o=k.substitute(o,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),n.Vertex=s,n.Fragment=o,r.replaceShaderValues(n,a,i)},t.setMapperShaderParameters=function(n,a,i){n.getCABO().getElementCount()&&(e.VBOBuildTime>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())&&(n.getProgram().isAttributeUsed("orientMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"orientMC",12,n.getCABO().getStride(),e.context.FLOAT,3,!1)||Pn("Error setting 'orientMC' in shader VAO.")),n.getProgram().isAttributeUsed("offsetMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO().getColorBO(),"offsetMC",0,n.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,3,!0)||Pn("Error setting 'offsetMC' in shader VAO.")),n.getProgram().isAttributeUsed("radiusMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"radiusMC",24,n.getCABO().getStride(),e.context.FLOAT,1,!1)||Pn("Error setting 'radiusMC' in shader VAO."))),r.setMapperShaderParameters(n,a,i)},t.setCameraShaderParameters=function(n,a,i){var s=n.getProgram(),o=a.getActiveCamera(),u=e.openGLCamera.getKeyMatrices(a);if(s.isUniformUsed("VCPCMatrix")&&s.setUniformMatrix("VCPCMatrix",u.vcpc),i.getIsIdentity())s.isUniformUsed("MCVCMatrix")&&s.setUniformMatrix("MCVCMatrix",u.wcvc),s.isUniformUsed("normalMatrix")&&s.setUniformMatrix3x3("normalMatrix",u.normalMatrix);else{var c=e.openGLActor.getKeyMatrices();if(s.isUniformUsed("MCVCMatrix")){var f=new Float64Array(16);ke(f,u.wcvc,c.mcwc),s.setUniformMatrix("MCVCMatrix",f)}if(s.isUniformUsed("normalMatrix")){var g=new Float64Array(9);Yi(g,u.normalMatrix,c.normalMatrix),s.setUniformMatrix3x3("normalMatrix",g)}}s.isUniformUsed("cameraParallel")&&n.getProgram().setUniformi("cameraParallel",o.getParallelProjection())},t.getOpenGLMode=function(n,a){return e.context.TRIANGLES},t.buildBufferObjects=function(n,a){var i=e.currentInput;if(i!==null){e.renderable.mapScalars(i,1);var s=e.renderable.getColorMapColors(),o=e.primitives[e.primTypes.Tris].getCABO(),u=i.getPointData(),c=i.getPoints(),f=c.getNumberOfPoints(),g=c.getData(),v=3;v+=4;var p=null,l=0;o.setColorBOStride(4),o.getColorBO()||o.setColorBO(Ga.newInstance()),o.getColorBO().setOpenGLRenderWindow(e._openGLRenderWindow),s&&(l=s.getNumberOfComponents(),o.setColorOffset(4),p=s.getData(),o.setColorBOStride(8)),o.setColorComponents(l),o.setStride(v*4);var y=new Float32Array(v*f*12),h=new Uint8Array(12*f*(p?8:4)),d=null,S=null;e.renderable.getScaleArray()!=null&&u.hasArray(e.renderable.getScaleArray())&&(d=u.getArray(e.renderable.getScaleArray()).getData()),e.renderable.getOrientationArray()!=null&&u.hasArray(e.renderable.getOrientationArray())?S=u.getArray(e.renderable.getOrientationArray()).getData():Pn([`Error setting orientationArray.
`,"You have to specify the stick orientation"]);for(var T=[0,1,3,0,3,2,2,3,5,2,5,4],C=0,x=0,O=0,w=0,E=0;E<f;++E){var V=e.renderable.getLength(),D=e.renderable.getRadius();d&&(V=d[E*2],D=d[E*2+1]);for(var M=0;M<T.length;++M)C=E*3,y[O++]=g[C++],y[O++]=g[C++],y[O++]=g[C++],C=E*3,y[O++]=S[C++]*V,y[O++]=S[C++]*V,y[O++]=S[C++]*V,y[O++]=D,h[w++]=255*(T[M]%2),h[w++]=T[M]>=4?255:0,h[w++]=T[M]>=2?255:0,h[w++]=255,x=E*l,p&&(h[w++]=p[x],h[w++]=p[x+1],h[w++]=p[x+2],h[w++]=p[x+3])}o.setElementCount(O/v),o.upload(y,bt.ARRAY_BUFFER),o.getColorBO().upload(h,bt.ARRAY_BUFFER),e.VBOBuildTime.modified()}}}var OO={};function mO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,OO,r),Wg.extend(t,e,r),xO(t,e)}var wO=ve(mO,"vtkOpenGLStickMapper");Ye("vtkStickMapper",wO);var li=Je.BufferUsage,EO=P,DO=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::Color::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  var vertexVC: vec4<f32> = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);

  //VTK::Color::Impl

  // compute the projected vertex position
  output.centerVC = vertexVC.xyz;
  output.radiusVC = length(offsetMC)*0.5;

  // make the triangle face the camera
  if (rendererUBO.cameraParallel == 0u)
    {
    var dir: vec3<f32> = normalize(-vertexVC.xyz);
    var base2: vec3<f32> = normalize(cross(dir,vec3<f32>(1.0,0.0,0.0)));
    var base1: vec3<f32> = cross(base2,dir);
    dir = vertexVC.xyz + offsetMC.x*base1 + offsetMC.y*base2;
    vertexVC = vec4<f32>(dir, 1.0);
    }
  else
    {
    // add in the offset
    var tmp2: vec2<f32> = vertexVC.xy + offsetMC;
    vertexVC = vec4<f32>(tmp2, vertexVC.zw);
    }

  output.vertexVC = vec4<f32>(vertexVC.xyz, 0.0);

  //VTK::Position::Impl

  return output;
}
`;function MO(t,e){e.classHierarchy.push("vtkWebGPUSphereMapper");var r=t.buildPass;t.buildPass=function(n){if(n){e.renderable.getStatic()||e.renderable.update();var a=e.renderable.getInputData();t.setCellArray(a.getVerts()),t.setCurrentInput(a)}r(n)},t.replaceShaderNormal=function(n,a,i){var s=a.getShaderDescription("vertex");s.hasOutput("vertexVC")||s.addOutput("vec4<f32>","vertexVC"),s.addOutput("vec3<f32>","centerVC"),s.addOutput("f32","radiusVC");var o=a.getShaderDescription("fragment");o.addBuiltinOutput("f32","@builtin(frag_depth) fragDepth");var u=`
    // compute the eye position and unit direction
    var vertexVC: vec4<f32>;
    var EyePos: vec3<f32>;
    var EyeDir: vec3<f32>;
    var invertedDepth: f32 = 1.0;
    if (rendererUBO.cameraParallel != 0u) {
      EyePos = vec3<f32>(input.vertexVC.x, input.vertexVC.y, input.vertexVC.z + 3.0*input.radiusVC);
      EyeDir = vec3<f32>(0.0, 0.0, -1.0);
    }
    else {
      EyeDir = input.vertexVC.xyz;
      EyePos = vec3<f32>(0.0,0.0,0.0);
      var lengthED: f32 = length(EyeDir);
      EyeDir = normalize(EyeDir);
      // we adjust the EyePos to be closer if it is too far away
      // to prevent floating point precision noise
      if (lengthED > input.radiusVC*3.0) {
        EyePos = input.vertexVC.xyz - EyeDir*3.0*input.radiusVC;
      }
    }

    // translate to Sphere center
    EyePos = EyePos - input.centerVC;
    // scale to radius 1.0
    EyePos = EyePos * (1.0 / input.radiusVC);
    // find the intersection
    var b: f32 = 2.0*dot(EyePos,EyeDir);
    var c: f32 = dot(EyePos,EyePos) - 1.0;
    var d: f32 = b*b - 4.0*c;
    var normal: vec3<f32> = vec3<f32>(0.0,0.0,1.0);
    if (d < 0.0) { discard; }
    else {
      var t: f32 = (-b - invertedDepth*sqrt(d))*0.5;

      // compute the normal, for unit sphere this is just
      // the intersection point
      normal = invertedDepth*normalize(EyePos + t*EyeDir);
      // compute the intersection point in VC
      vertexVC = vec4<f32>(normal * input.radiusVC + input.centerVC, 1.0);
    }
    // compute the pixel's depth
    var pos: vec4<f32> = rendererUBO.VCPCMatrix * vertexVC;
    output.fragDepth = pos.z / pos.w;
    `,c=o.getCode();c=X.substitute(c,"//VTK::Normal::Impl",[u]).result,o.setCode(c)},t.replaceShaderPosition=function(n,a,i){var s=a.getShaderDescription("vertex");s.addBuiltinOutput("vec4<f32>","@builtin(position) Position");var o=s.getCode();o=X.substitute(o,"//VTK::Position::Impl",["  output.Position = rendererUBO.VCPCMatrix*vertexVC;"]).result,s.setCode(o)},t.computePipelineHash=function(){e.pipelineHash="spm",e.vertexInput.hasAttribute("colorVI")&&(e.pipelineHash+="c"),e.pipelineHash+=e.renderEncoder.getPipelineHash()},t.updateBuffers=function(){var n=e.currentInput;e.renderable.mapScalars(n,1);var a=n.getPoints(),i=a.getNumberOfPoints(),s=a.getData();t.setNumberOfInstances(1),t.setNumberOfVertices(3*i);var o=e.vertexInput,u="spm".concat(a.getMTime(),"float32x3");if(!e.device.getBufferManager().hasBuffer(u)){for(var c={hash:u,usage:li.RawVertex,format:"float32x3"},f=new Float32Array(3*i*3),g=0,v=0,p=0;p<i;++p)g=p*3,f[v++]=s[g],f[v++]=s[g+1],f[v++]=s[g+2],f[v++]=s[g],f[v++]=s[g+1],f[v++]=s[g+2],f[v++]=s[g],f[v++]=s[g+1],f[v++]=s[g+2];c.nativeArray=f;var l=e.device.getBufferManager().getBuffer(c);o.addBuffer(l,["vertexBC"])}var y=n.getPointData(),h=null;e.renderable.getScaleArray()!=null&&y.hasArray(e.renderable.getScaleArray())&&(h=y.getArray(e.renderable.getScaleArray()).getData());var d=e.renderable.getRadius();if(h||d!==e._lastRadius){if(u="spm".concat(h?y.getArray(e.renderable.getScaleArray()).getMTime():d,"float32x2"),!e.device.getBufferManager().hasBuffer(u)){for(var S={hash:u,usage:li.RawVertex,format:"float32x2"},T=new Float32Array(3*i*2),C=Math.cos(Te(30)),x=0,O=0;O<i;++O){var w=e.renderable.getRadius();h&&(w=h[O]*e.renderable.getScaleFactor()),T[x++]=-2*w*C,T[x++]=-w,T[x++]=2*w*C,T[x++]=-w,T[x++]=0,T[x++]=2*w}S.nativeArray=T;var E=e.device.getBufferManager().getBuffer(S);o.addBuffer(E,["offsetMC"])}e._lastRadius=d}var V=!1;if(e.renderable.getScalarVisibility()){var D=e.renderable.getColorMapColors();if(D){if(u="spm".concat(D.getMTime(),"unorm8x4"),!e.device.getBufferManager().hasBuffer(u)){var M={hash:u,usage:li.RawVertex,format:"unorm8x4"},L=D.getNumberOfComponents();L!==4&&EO("this should be 4");for(var N=new Uint8Array(3*i*4),B=0,_=D.getData(),A=0;A<i;++A)for(var W=A*L,z=0;z<3;z++)N[B++]=_[W],N[B++]=_[W+1],N[B++]=_[W+2],N[B++]=_[W+3];M.nativeArray=N;var R=e.device.getBufferManager().getBuffer(M);o.addBuffer(R,["colorVI"])}V=!0}}V||o.removeBufferIfPresent("colorVI"),t.setTopology("triangle-list"),t.updateUBO()}}var VO={};function RO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,VO,r),_a.extend(t,e,r),t.setVertexShaderTemplate(DO),MO(t,e);var n=e.shaderReplacements;n.set("replaceShaderPosition",t.replaceShaderPosition),n.set("replaceShaderNormal",t.replaceShaderNormal)}var bO=ve(RO,"vtkWebGPUSphereMapper");ut("vtkSphereMapper",bO);var jn=Je.BufferUsage,Gu=P,LO=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::Color::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var offsetsArray: array<vec3<f32>, 12> = array<vec3<f32>, 12>(
    vec3<f32>(-1.0, -1.0, -1.0),
    vec3<f32>(1.0, -1.0, -1.0),
    vec3<f32>(1.0, -1.0, 1.0),

    vec3<f32>(-1.0, -1.0, -1.0),
    vec3<f32>(1.0, -1.0, 1.0),
    vec3<f32>(-1.0, -1.0, 1.0),

    vec3<f32>(-1.0, -1.0, 1.0),
    vec3<f32>(1.0, -1.0, 1.0),
    vec3<f32>(1.0, 1.0, 1.0),

    vec3<f32>(-1.0, -1.0, 1.0),
    vec3<f32>(1.0, 1.0, 1.0),
    vec3<f32>(-1.0, 1.0, 1.0)
  );

  var output : vertexOutput;

  var vertexVC: vec4<f32> = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);

  //VTK::Color::Impl

  // compute the projected vertex position
  output.centerVC = vertexVC.xyz;
  output.radiusVC = radiusMC;
  output.lengthVC = length(orientMC);
  output.orientVC = (rendererUBO.WCVCNormals * vec4<f32>(normalize(orientMC), 0.0)).xyz;

  // make sure it is pointing out of the screen
  if (output.orientVC.z < 0.0)
    {
    output.orientVC = -output.orientVC;
    }

  // make the basis
  var xbase: vec3<f32>;
  var ybase: vec3<f32>;
  var dir: vec3<f32> = vec3<f32>(0.0,0.0,1.0);
  if (rendererUBO.cameraParallel == 0u)
    {
    dir = normalize(-vertexVC.xyz);
    }
  if (abs(dot(dir,output.orientVC)) == 1.0)
    {
    xbase = normalize(cross(vec3<f32>(0.0,1.0,0.0),output.orientVC));
    ybase = cross(xbase,output.orientVC);
    }
  else
    {
    xbase = normalize(cross(output.orientVC,dir));
    ybase = cross(output.orientVC,xbase);
    }


  var vertIdx: u32 = input.vertexIndex % 12u;
  var offsets: vec3<f32> = offsetsArray[vertIdx];

  vertexVC = vec4<f32>(vertexVC.xyz +
    output.radiusVC * offsets.x * xbase +
    output.radiusVC * offsets.y * ybase +
    0.5 * output.lengthVC * offsets.z * output.orientVC, 1.0);

  output.vertexVC = vertexVC;

  //VTK::Position::Impl

  return output;
}
`;function BO(t,e){e.classHierarchy.push("vtkWebGPUStickMapper");var r=t.buildPass;t.buildPass=function(n){if(n){e.renderable.getStatic()||e.renderable.update();var a=e.renderable.getInputData();t.setCellArray(a.getVerts()),t.setCurrentInput(a)}r(n)},t.replaceShaderNormal=function(n,a,i){var s=a.getShaderDescription("vertex");s.hasOutput("vertexVC")||s.addOutput("vec4<f32>","vertexVC"),s.addOutput("vec3<f32>","centerVC"),s.addOutput("vec3<f32>","orientVC"),s.addOutput("f32","radiusVC"),s.addOutput("f32","lengthVC"),s.addBuiltinInput("u32","@builtin(vertex_index) vertexIndex");var o=a.getShaderDescription("fragment");o.addBuiltinOutput("f32","@builtin(frag_depth) fragDepth");var u=`
    // compute the eye position and unit direction
    var vertexVC: vec4<f32>;
    var EyePos: vec3<f32>;
    var EyeDir: vec3<f32>;

    if (rendererUBO.cameraParallel != 0u)
    {
      EyePos = vec3<f32>(input.vertexVC.x, input.vertexVC.y, input.vertexVC.z + 3.0*input.radiusVC);
      EyeDir = vec3<f32>(0.0, 0.0, -1.0);
    }
    else
    {
      EyeDir = input.vertexVC.xyz;
      EyePos = vec3<f32>(0.0,0.0,0.0);
      var lengthED: f32 = length(EyeDir);
      EyeDir = normalize(EyeDir);
      // we adjust the EyePos to be closer if it is too far away
      // to prevent floating point precision noise
      if (lengthED > input.radiusVC*3.0)
      {
        EyePos = input.vertexVC.xyz - EyeDir*3.0*input.radiusVC;
      }
    }
    // translate to Sphere center
    EyePos = EyePos - input.centerVC;

    // rotate to new basis
    // base1, base2, orientVC
    var base1: vec3<f32>;
    if (abs(input.orientVC.z) < 0.99)
    {
      base1 = normalize(cross(input.orientVC,vec3<f32>(0.0,0.0,1.0)));
    }
    else
    {
      base1 = normalize(cross(input.orientVC,vec3<f32>(0.0,1.0,0.0)));
    }
    var base2: vec3<f32> = cross(input.orientVC,base1);
    EyePos = vec3<f32>(dot(EyePos,base1),dot(EyePos,base2),dot(EyePos,input.orientVC));
    EyeDir = vec3<f32>(dot(EyeDir,base1),dot(EyeDir,base2),dot(EyeDir,input.orientVC));

    // scale to radius 1.0
    EyePos = EyePos * (1.0 / input.radiusVC);

    // find the intersection
    var a: f32 = EyeDir.x*EyeDir.x + EyeDir.y*EyeDir.y;
    var b: f32 = 2.0*(EyePos.x*EyeDir.x + EyePos.y*EyeDir.y);
    var c: f32 = EyePos.x*EyePos.x + EyePos.y*EyePos.y - 1.0;
    var d: f32 = b*b - 4.0*a*c;
    var normal: vec3<f32> = vec3<f32>(0.0,0.0,1.0);
    if (d < 0.0) { discard; }
    else
    {
      var t: f32 = (-b - sqrt(d))*(0.5 / a);
      var tz: f32 = EyePos.z + t*EyeDir.z;
      var iPoint: vec3<f32> = EyePos + t*EyeDir;
      if (abs(iPoint.z)*input.radiusVC > input.lengthVC*0.5)
      {
        // test for end cap
        var t2: f32 = (-b + sqrt(d))*(0.5 / a);
        var tz2: f32 = EyePos.z + t2*EyeDir.z;
        if (tz2*input.radiusVC > input.lengthVC*0.5 || tz*input.radiusVC < -0.5*input.lengthVC) { discard; }
        else
        {
          normal = input.orientVC;
          var t3: f32 = (input.lengthVC*0.5/input.radiusVC - EyePos.z)/EyeDir.z;
          iPoint = EyePos + t3*EyeDir;
          vertexVC = vec4<f32>(input.radiusVC*(iPoint.x*base1 + iPoint.y*base2 + iPoint.z*input.orientVC) + input.centerVC, 1.0);
        }
      }
      else
      {
        // The normal is the iPoint.xy rotated back into VC
        normal = iPoint.x*base1 + iPoint.y*base2;
        // rescale rerotate and translate
        vertexVC = vec4<f32>(input.radiusVC*(normal + iPoint.z*input.orientVC) + input.centerVC, 1.0);
      }
    }
    // compute the pixel's depth
    var pos: vec4<f32> = rendererUBO.VCPCMatrix * vertexVC;
    output.fragDepth = pos.z / pos.w;
  `,c=o.getCode();c=X.substitute(c,"//VTK::Normal::Impl",[u]).result,o.setCode(c)},t.replaceShaderPosition=function(n,a,i){var s=a.getShaderDescription("vertex");s.addBuiltinOutput("vec4<f32>","@builtin(position) Position");var o=s.getCode();o=X.substitute(o,"//VTK::Position::Impl",["  output.Position = rendererUBO.VCPCMatrix*vertexVC;"]).result,s.setCode(o)},t.computePipelineHash=function(){e.pipelineHash="stm",e.vertexInput.hasAttribute("colorVI")&&(e.pipelineHash+="c"),e.pipelineHash+=e.renderEncoder.getPipelineHash()},t.updateBuffers=function(){var n=e.currentInput;e.renderable.mapScalars(n,1);var a=e.device,i=n.getPoints(),s=n.getPointData(),o=i.getNumberOfPoints(),u=i.getData();t.setNumberOfInstances(o),t.setNumberOfVertices(12);var c=e.vertexInput,f="stm".concat(i.getMTime(),"float32x3");if(!a.getBufferManager().hasBuffer(f)){for(var g={hash:f,usage:jn.RawVertex,format:"float32x3"},v=new Float32Array(o*3),p=0,l=0,y=0;y<o;++y)p=y*3,v[l++]=u[p],v[l++]=u[p+1],v[l++]=u[p+2];g.nativeArray=v;var h=a.getBufferManager().getBuffer(g);c.addBuffer(h,["vertexBC"],"instance")}var d=null;e.renderable.getScaleArray()!=null&&s.hasArray(e.renderable.getScaleArray())&&(d=s.getArray(e.renderable.getScaleArray()).getData());var S=e.renderable.getRadius();if(d||S!==e._lastRadius){if(f="stm".concat(d?s.getArray(e.renderable.getScaleArray()).getMTime():S,"float32"),!a.getBufferManager().hasBuffer(f)){for(var T={hash:f,usage:jn.RawVertex,format:"float32"},C=new Float32Array(o),x=0,O=0;O<o;++O){var w=e.renderable.getRadius();d&&(w=d[O*2+1]),C[x++]=w}T.nativeArray=C;var E=a.getBufferManager().getBuffer(T);c.addBuffer(E,["radiusMC"],"instance")}e._lastRadius=S}var V=null;if(e.renderable.getOrientationArray()!=null&&s.hasArray(e.renderable.getOrientationArray())?V=s.getArray(e.renderable.getOrientationArray()).getData():Gu([`Error setting orientationArray.
`,"You have to specify the stick orientation"]),f="stm".concat(s.getArray(e.renderable.getOrientationArray()).getMTime(),"float32x3"),!a.getBufferManager().hasBuffer(f)){for(var D={hash:f,usage:jn.RawVertex,format:"float32x3"},M=new Float32Array(o*3),L=0,N=0,B=0;B<o;++B){L=B*3;var _=e.renderable.getLength();d&&(_=d[B*2]),M[N++]=V[L]*_,M[N++]=V[L+1]*_,M[N++]=V[L+2]*_}D.nativeArray=M;var A=a.getBufferManager().getBuffer(D);c.addBuffer(A,["orientMC"],"instance")}var W=!1;if(e.renderable.getScalarVisibility()){var z=e.renderable.getColorMapColors();if(z){if(f="stm".concat(z.getMTime(),"unorm8x4"),!a.getBufferManager().hasBuffer(f)){var R={usage:jn.RawVertex,format:"unorm8x4"},b=z.getNumberOfComponents();b!==4&&Gu("this should be 4");for(var F=new Uint8Array(o*4),G=0,U=z.getData(),H=0;H<o;++H){var j=H*b;F[G++]=U[j],F[G++]=U[j+1],F[G++]=U[j+2],F[G++]=U[j+3]}R.nativeArray=F;var I=a.getBufferManager().getBuffer(R);c.addBuffer(I,["colorVI"],"instance")}W=!0}}W||c.removeBufferIfPresent("colorVI"),t.setTopology("triangle-list"),t.updateUBO()}}var kO={};function NO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,kO,r),_a.extend(t,e,r),t.setVertexShaderTemplate(LO),BO(t,e);var n=e.shaderReplacements;n.set("replaceShaderPosition",t.replaceShaderPosition),n.set("replaceShaderNormal",t.replaceShaderNormal)}var FO=ve(NO,"vtkWebGPUStickMapper");ut("vtkStickMapper",FO);var Kn=m.vtkDebugMacro;function UO(t,e){e.classHierarchy.push("vtkCamera");var r=new Float64Array(3),n=new Float64Array([0,0,-1]),a=new Float64Array([0,1,0]),i=ae(new Float64Array(16)),s=ae(new Float64Array(16)),o=new Float64Array(3),u=new Float64Array(3),c=new Float64Array(3),f=ae(new Float64Array(16)),g=ae(new Float64Array(16)),v=new Float64Array(3),p=new Float64Array(3);function l(){e.viewPlaneNormal[0]=-e.directionOfProjection[0],e.viewPlaneNormal[1]=-e.directionOfProjection[1],e.viewPlaneNormal[2]=-e.directionOfProjection[2]}t.orthogonalizeViewUp=function(){var y=t.getViewMatrix();e.viewUp[0]=y[4],e.viewUp[1]=y[5],e.viewUp[2]=y[6],t.modified()},t.setPosition=function(y,h,d){y===e.position[0]&&h===e.position[1]&&d===e.position[2]||(e.position[0]=y,e.position[1]=h,e.position[2]=d,t.computeDistance(),t.modified())},t.setFocalPoint=function(y,h,d){y===e.focalPoint[0]&&h===e.focalPoint[1]&&d===e.focalPoint[2]||(e.focalPoint[0]=y,e.focalPoint[1]=h,e.focalPoint[2]=d,t.computeDistance(),t.modified())},t.setDistance=function(y){if(e.distance!==y){e.distance=y,e.distance<1e-20&&(e.distance=1e-20,Kn("Distance is set to minimum."));var h=e.directionOfProjection;e.focalPoint[0]=e.position[0]+h[0]*e.distance,e.focalPoint[1]=e.position[1]+h[1]*e.distance,e.focalPoint[2]=e.position[2]+h[2]*e.distance,t.modified()}},t.computeDistance=function(){var y=e.focalPoint[0]-e.position[0],h=e.focalPoint[1]-e.position[1],d=e.focalPoint[2]-e.position[2];if(e.distance=Math.sqrt(y*y+h*h+d*d),e.distance<1e-20){e.distance=1e-20,Kn("Distance is set to minimum.");var S=e.directionOfProjection;e.focalPoint[0]=e.position[0]+S[0]*e.distance,e.focalPoint[1]=e.position[1]+S[1]*e.distance,e.focalPoint[2]=e.position[2]+S[2]*e.distance}e.directionOfProjection[0]=y/e.distance,e.directionOfProjection[1]=h/e.distance,e.directionOfProjection[2]=d/e.distance,l()},t.dolly=function(y){if(!(y<=0)){var h=e.distance/y;t.setPosition(e.focalPoint[0]-h*e.directionOfProjection[0],e.focalPoint[1]-h*e.directionOfProjection[1],e.focalPoint[2]-h*e.directionOfProjection[2])}},t.roll=function(y){var h=e.position,d=e.focalPoint,S=e.viewUp,T=new Float64Array([S[0],S[1],S[2],0]);ae(f);var C=new Float64Array([d[0]-h[0],d[1]-h[1],d[2]-h[2]]);vt(f,f,Te(y),C),mn(T,T,f),e.viewUp[0]=T[0],e.viewUp[1]=T[1],e.viewUp[2]=T[2],t.modified()},t.azimuth=function(y){var h=e.focalPoint;ae(g),me(g,g,h),vt(g,g,Te(y),e.viewUp),me(g,g,[-h[0],-h[1],-h[2]]),ce(v,e.position,g),t.setPosition(v[0],v[1],v[2])},t.yaw=function(y){var h=e.position;ae(g),me(g,g,h),vt(g,g,Te(y),e.viewUp),me(g,g,[-h[0],-h[1],-h[2]]),ce(p,e.focalPoint,g),t.setFocalPoint(p[0],p[1],p[2])},t.elevation=function(y){var h=e.focalPoint,d=t.getViewMatrix(),S=[-d[0],-d[1],-d[2]];ae(g),me(g,g,h),vt(g,g,Te(y),S),me(g,g,[-h[0],-h[1],-h[2]]),ce(v,e.position,g),t.setPosition(v[0],v[1],v[2])},t.pitch=function(y){var h=e.position,d=t.getViewMatrix(),S=[d[0],d[1],d[2]];ae(g),me(g,g,h),vt(g,g,Te(y),S),me(g,g,[-h[0],-h[1],-h[2]]),ce(p,e.focalPoint,g),t.setFocalPoint.apply(t,Y(p))},t.zoom=function(y){y<=0||(e.parallelProjection?e.parallelScale/=y:e.viewAngle/=y,t.modified())},t.translate=function(y,h,d){var S=[y,h,d];Ni(e.position,S,e.position),Ni(e.focalPoint,S,e.focalPoint),t.computeDistance(),t.modified()},t.applyTransform=function(y){var h=[].concat(Y(e.viewUp),[1]),d=[],S=[],T=[];h[0]+=e.position[0],h[1]+=e.position[1],h[2]+=e.position[2],mn(d,[].concat(Y(e.position),[1]),y),mn(S,[].concat(Y(e.focalPoint),[1]),y),mn(T,h,y),T[0]-=d[0],T[1]-=d[1],T[2]-=d[2],t.setPosition.apply(t,Y(d.slice(0,3))),t.setFocalPoint.apply(t,Y(S.slice(0,3))),t.setViewUp.apply(t,Y(T.slice(0,3)))},t.getThickness=function(){return e.clippingRange[1]-e.clippingRange[0]},t.setThickness=function(y){var h=y;h<1e-20&&(h=1e-20,Kn("Thickness is set to minimum.")),t.setClippingRange(e.clippingRange[0],e.clippingRange[0]+h)},t.setThicknessFromFocalPoint=function(y){var h=y;h<1e-20&&(h=1e-20,Kn("Thickness is set to minimum.")),t.setClippingRange(e.distance-h/2,e.distance+h/2)},t.setRoll=function(y){},t.getRoll=function(){},t.setObliqueAngles=function(y,h){},t.getOrientation=function(){},t.getOrientationWXYZ=function(){},t.getFrustumPlanes=function(y){},t.getCameraLightTransformMatrix=function(y){return Fe(y,e.cameraLightTransform),y},t.computeCameraLightTransform=function(){Fe(i,t.getViewMatrix()),He(i,i),mf(s,[e.distance,e.distance,e.distance]),ke(i,i,s),ae(e.cameraLightTransform),me(e.cameraLightTransform,i,[0,0,-1])},t.deepCopy=function(y){},t.physicalOrientationToWorldDirection=function(y){var h=Is(y[0],y[1],y[2],y[3]),d=yr(),S=Is(0,0,1,0);return m0(d,h),Zs(S,h,S),Zs(S,S,d),[S[0],S[1],S[2]]},t.getPhysicalToWorldMatrix=function(y){t.getWorldToPhysicalMatrix(y),He(y,y)},t.getWorldToPhysicalMatrix=function(y){ae(y);var h=[3];hn(e.physicalViewNorth,e.physicalViewUp,h),y[0]=h[0],y[1]=h[1],y[2]=h[2],y[4]=e.physicalViewUp[0],y[5]=e.physicalViewUp[1],y[6]=e.physicalViewUp[2],y[8]=-e.physicalViewNorth[0],y[9]=-e.physicalViewNorth[1],y[10]=-e.physicalViewNorth[2],ye(y,y),sa(o,1/e.physicalScale,1/e.physicalScale,1/e.physicalScale),Gr(y,y,o),me(y,y,e.physicalTranslation)},t.computeViewParametersFromViewMatrix=function(y){He(i,y),ce(o,r,i),t.computeDistance();var h=e.distance;t.setPosition(o[0],o[1],o[2]),ce(u,n,i),$t(u,u,o),fn(u,u),t.setDirectionOfProjection(u[0],u[1],u[2]),ce(c,a,i),$t(c,c,o),fn(c,c),t.setViewUp(c[0],c[1],c[2]),t.setDistance(h)},t.computeViewParametersFromPhysicalMatrix=function(y){t.getWorldToPhysicalMatrix(i),ke(i,y,i),t.computeViewParametersFromViewMatrix(i)},t.setViewMatrix=function(y){e.viewMatrix=y,e.viewMatrix&&(Fe(i,e.viewMatrix),t.computeViewParametersFromViewMatrix(i),ye(e.viewMatrix,e.viewMatrix))},t.getViewMatrix=function(){if(e.viewMatrix)return e.viewMatrix;Lf(i,e.position,e.focalPoint,e.viewUp),ye(i,i);var y=new Float64Array(16);return Fe(y,i),y},t.setProjectionMatrix=function(y){e.projectionMatrix=y},t.getProjectionMatrix=function(y,h,d){var S=new Float64Array(16);if(ae(S),e.projectionMatrix){var T=1/e.physicalScale;return sa(o,T,T,T),Fe(S,e.projectionMatrix),Gr(S,S,o),ye(S,S),S}ae(i);var C=e.clippingRange[1]-e.clippingRange[0],x=[e.clippingRange[0]+(h+1)*C/2,e.clippingRange[0]+(d+1)*C/2];if(e.parallelProjection){var O=e.parallelScale*y,w=e.parallelScale,E=(e.windowCenter[0]-1)*O,V=(e.windowCenter[0]+1)*O,D=(e.windowCenter[1]-1)*w,M=(e.windowCenter[1]+1)*w;bf(i,E,V,D,M,x[0],x[1]),ye(i,i)}else{if(e.useOffAxisProjection)throw new Error("Off-Axis projection is not supported at this time");var L=Math.tan(Te(e.viewAngle)/2),N,B;e.useHorizontalViewAngle===!0?(N=e.clippingRange[0]*L,B=e.clippingRange[0]*L/y):(N=e.clippingRange[0]*L*y,B=e.clippingRange[0]*L);var _=(e.windowCenter[0]-1)*N,A=(e.windowCenter[0]+1)*N,W=(e.windowCenter[1]-1)*B,z=(e.windowCenter[1]+1)*B,R=x[0],b=x[1];i[0]=2*R/(A-_),i[5]=2*R/(z-W),i[2]=(_+A)/(A-_),i[6]=(W+z)/(z-W),i[10]=-(R+b)/(b-R),i[14]=-1,i[11]=-2*R*b/(b-R),i[15]=0}return Fe(S,i),S},t.getCompositeProjectionMatrix=function(y,h,d){var S=t.getViewMatrix(),T=t.getProjectionMatrix(y,h,d);return ke(T,S,T),T},t.setDirectionOfProjection=function(y,h,d){if(!(e.directionOfProjection[0]===y&&e.directionOfProjection[1]===h&&e.directionOfProjection[2]===d)){e.directionOfProjection[0]=y,e.directionOfProjection[1]=h,e.directionOfProjection[2]=d;var S=e.directionOfProjection;e.focalPoint[0]=e.position[0]+S[0]*e.distance,e.focalPoint[1]=e.position[1]+S[1]*e.distance,e.focalPoint[2]=e.position[2]+S[2]*e.distance,l()}},t.setDeviceAngles=function(y,h,d,S){var T=[3];hn(e.physicalViewNorth,e.physicalViewUp,T);var C=ae(new Float64Array(16));vt(C,C,Te(y),e.physicalViewUp),vt(C,C,Te(h),T),vt(C,C,Te(d),e.physicalViewNorth),vt(C,C,Te(-S),e.physicalViewUp);var x=new Float64Array([-e.physicalViewUp[0],-e.physicalViewUp[1],-e.physicalViewUp[2]]),O=new Float64Array(e.physicalViewNorth);ce(x,x,C),ce(O,O,C),t.setDirectionOfProjection(x[0],x[1],x[2]),t.setViewUp(O[0],O[1],O[2]),t.modified()},t.setOrientationWXYZ=function(y,h,d,S){var T=ae(new Float64Array(16));if(y!==0&&(h!==0||d!==0||S!==0)){var C=Te(y),x=yr();Zi(x,[h,d,S],C),Qi(T,x)}var O=new Float64Array(3);ce(O,[0,0,-1],T);var w=new Float64Array(3);ce(w,[0,1,0],T),t.setDirectionOfProjection.apply(t,Y(O)),t.setViewUp.apply(t,Y(w)),t.modified()},t.computeClippingRange=function(y){var h=null,d=null;h=e.viewPlaneNormal,d=e.position;for(var S=-h[0],T=-h[1],C=-h[2],x=-(S*d[0]+T*d[1]+C*d[2]),O=[S*y[0]+T*y[2]+C*y[4]+x,1e-18],w=0;w<2;w++)for(var E=0;E<2;E++)for(var V=0;V<2;V++){var D=S*y[V]+T*y[2+E]+C*y[4+w]+x;O[0]=D<O[0]?D:O[0],O[1]=D>O[1]?D:O[1]}return O}}var GO={position:[0,0,1],focalPoint:[0,0,0],viewUp:[0,1,0],directionOfProjection:[0,0,-1],parallelProjection:!1,useHorizontalViewAngle:!1,viewAngle:30,parallelScale:1,clippingRange:[.01,1000.01],windowCenter:[0,0],viewPlaneNormal:[0,0,1],useOffAxisProjection:!1,screenBottomLeft:[-.5,-.5,-.5],screenBottomRight:[.5,-.5,-.5],screenTopRight:[.5,.5,-.5],freezeFocalPoint:!1,projectionMatrix:null,viewMatrix:null,cameraLightTransform:qi(),physicalTranslation:[0,0,0],physicalScale:1,physicalViewUp:[0,1,0],physicalViewNorth:[0,0,-1]};function hv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,GO,r),m.obj(t,e),m.get(t,e,["distance"]),m.setGet(t,e,["parallelProjection","useHorizontalViewAngle","viewAngle","parallelScale","useOffAxisProjection","freezeFocalPoint","physicalScale"]),m.getArray(t,e,["directionOfProjection","viewPlaneNormal","position","focalPoint"]),m.setGetArray(t,e,["clippingRange","windowCenter"],2),m.setGetArray(t,e,["viewUp","screenBottomLeft","screenBottomRight","screenTopRight","physicalTranslation","physicalViewUp","physicalViewNorth"],3),UO(t,e)}var _O=m.newInstance(hv,"vtkCamera"),WO={newInstance:_O,extend:hv},zO=["HeadLight","CameraLight","SceneLight"];function AO(t,e){e.classHierarchy.push("vtkLight");var r=new Float64Array(3);t.getTransformedPosition=function(){return e.transformMatrix?ce(r,e.position,e.transformMatrix):sa(r,e.position[0],e.position[1],e.position[2]),r},t.getTransformedFocalPoint=function(){return e.transformMatrix?ce(r,e.focalPoint,e.transformMatrix):sa(r,e.focalPoint[0],e.focalPoint[1],e.focalPoint[2]),r},t.getDirection=function(){return e.directionMTime<e.mtime&&(wi(e.direction,e.focalPoint,e.position),Wr(e.direction),e.directionMTime=e.mtime),e.direction},t.setDirection=function(n){var a=new Float64Array(3);wi(a,e.position,n),e.focalPoint=a},t.setDirectionAngle=function(n,a){var i=Te(n),s=Te(a);t.setPosition(Math.cos(i)*Math.sin(s),Math.sin(i),Math.cos(i)*Math.cos(s)),t.setFocalPoint(0,0,0),t.setPositional(0)},t.setLightTypeToHeadLight=function(){t.setLightType("HeadLight")},t.setLightTypeToCameraLight=function(){t.setLightType("CameraLight")},t.setLightTypeToSceneLight=function(){t.setTransformMatrix(null),t.setLightType("SceneLight")},t.lightTypeIsHeadLight=function(){return e.lightType==="HeadLight"},t.lightTypeIsSceneLight=function(){return e.lightType==="SceneLight"},t.lightTypeIsCameraLight=function(){return e.lightType==="CameraLight"}}var HO={switch:!0,intensity:1,color:[1,1,1],position:[0,0,1],focalPoint:[0,0,0],positional:!1,exponent:1,coneAngle:30,coneFalloff:5,attenuationValues:[1,0,0],transformMatrix:null,lightType:"SceneLight",shadowAttenuation:1,direction:[0,0,0],directionMTime:0};function yv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,HO,r),m.obj(t,e),m.setGet(t,e,["intensity","switch","positional","exponent","coneAngle","coneFalloff","transformMatrix","lightType","shadowAttenuation","attenuationValues"]),m.setGetArray(t,e,["color","position","focalPoint","attenuationValues"],3),AO(t,e)}var $O=m.newInstance(yv,"vtkLight"),PO={newInstance:$O,extend:yv,LIGHT_TYPES:zO},na=m.vtkErrorMacro;function jO(t){return function(){return na("vtkViewport::".concat(t," - NOT IMPLEMENTED"))}}function KO(t,e){e.classHierarchy.push("vtkViewport"),t.getViewProps=function(){return e.props},t.hasViewProp=function(n){return e.props.includes(n)},t.addViewProp=function(n){n&&!t.hasViewProp(n)&&e.props.push(n)},t.removeViewProp=function(n){var a=e.props.filter(function(i){return i!==n});e.props.length!==a.length&&(e.props=a)},t.removeAllViewProps=function(){e.props=[]};function r(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];a.push(n);var i=n.getNestedProps();if(i&&i.length)for(var s=0;s<i.length;s++)r(i[s],a);return a}t.getViewPropsWithNestedProps=function(){for(var n=[],a=0;a<e.props.length;a++)r(e.props[a],n);return n},t.addActor2D=t.addViewProp,t.removeActor2D=function(n){t.removeViewProp(n)},t.getActors2D=function(){return e.actors2D=[],e.props.forEach(function(n){e.actors2D=e.actors2D.concat(n.getActors2D())}),e.actors2D},t.displayToView=function(){return na("call displayToView on your view instead")},t.viewToDisplay=function(){return na("callviewtodisplay on your view instead")},t.getSize=function(){return na("call getSize on your View instead")},t.normalizedDisplayToProjection=function(n,a,i){var s=t.normalizedDisplayToNormalizedViewport(n,a,i);return t.normalizedViewportToProjection(s[0],s[1],s[2])},t.normalizedDisplayToNormalizedViewport=function(n,a,i){var s=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[(n-e.viewport[0])/s[0],(a-e.viewport[1])/s[1],i]},t.normalizedViewportToProjection=function(n,a,i){return[n*2-1,a*2-1,i*2-1]},t.projectionToNormalizedDisplay=function(n,a,i){var s=t.projectionToNormalizedViewport(n,a,i);return t.normalizedViewportToNormalizedDisplay(s[0],s[1],s[2])},t.normalizedViewportToNormalizedDisplay=function(n,a,i){var s=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[n*s[0]+e.viewport[0],a*s[1]+e.viewport[1],i]},t.projectionToNormalizedViewport=function(n,a,i){return[(n+1)*.5,(a+1)*.5,(i+1)*.5]},t.PickPropFrom=jO("PickPropFrom")}var XO={background:[0,0,0],background2:[.2,.2,.2],gradientBackground:!1,viewport:[0,0,1,1],aspect:[1,1],pixelAspect:[1,1],props:[],actors2D:[]};function dv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,XO,r),m.obj(t,e),m.event(t,e,"event"),m.setGetArray(t,e,["viewport"],4),m.setGetArray(t,e,["background","background2"],3),KO(t,e)}var YO=m.newInstance(dv,"vtkViewport"),qO={newInstance:YO,extend:dv},Zr=Xt,zt=P,QO=Va;function _u(t){return function(){return zt("vtkRenderer::".concat(t," - NOT IMPLEMENTED"))}}function ZO(t,e){e.classHierarchy.push("vtkRenderer");var r={type:"ComputeVisiblePropBoundsEvent",renderer:t},n={type:"ResetCameraClippingRangeEvent",renderer:t},a={type:"ResetCameraEvent",renderer:t};t.updateCamera=function(){return e.activeCamera||(Zr("No cameras are on, creating one."),t.getActiveCameraAndResetIfCreated()),e.activeCamera.render(t),!0},t.updateLightsGeometryToFollowCamera=function(){var i=t.getActiveCameraAndResetIfCreated();e.lights.forEach(function(s){s.lightTypeIsSceneLight()||(s.lightTypeIsHeadLight()?(s.setPositionFrom(i.getPositionByReference()),s.setFocalPointFrom(i.getFocalPointByReference()),s.modified(i.getMTime())):s.lightTypeIsCameraLight()?s.setTransformMatrix(i.getCameraLightTransformMatrix(qi())):zt("light has unknown light type",s.get()))})},t.updateLightGeometry=function(){return e.lightFollowCamera?t.updateLightsGeometryToFollowCamera():!0},t.allocateTime=_u("allocateTime"),t.updateGeometry=_u("updateGeometry"),t.getVTKWindow=function(){return e._renderWindow},t.setLayer=function(i){Zr(t.getClassName(),t,"setting Layer to ",i),e.layer!==i&&(e.layer=i,t.modified()),t.setPreserveColorBuffer(!!i)},t.setActiveCamera=function(i){return e.activeCamera===i?!1:(e.activeCamera=i,t.modified(),t.invokeEvent({type:"ActiveCameraEvent",camera:i}),!0)},t.makeCamera=function(){var i=WO.newInstance();return t.invokeEvent({type:"CreateCameraEvent",camera:i}),i},t.getActiveCamera=function(){return e.activeCamera||(e.activeCamera=t.makeCamera()),e.activeCamera},t.getActiveCameraAndResetIfCreated=function(){return e.activeCamera||(t.getActiveCamera(),t.resetCamera()),e.activeCamera},t.getActors=function(){return e.actors=[],e.props.forEach(function(i){e.actors=e.actors.concat(i.getActors())}),e.actors},t.addActor=t.addViewProp,t.removeActor=function(i){e.actors=e.actors.filter(function(s){return s!==i}),t.removeViewProp(i),t.modified()},t.removeAllActors=function(){var i=t.getActors();i.forEach(function(s){t.removeViewProp(s)}),e.actors=[],t.modified()},t.getVolumes=function(){return e.volumes=[],e.props.forEach(function(i){e.volumes=e.volumes.concat(i.getVolumes())}),e.volumes},t.addVolume=t.addViewProp,t.removeVolume=function(i){e.volumes=e.volumes.filter(function(s){return s!==i}),t.removeViewProp(i),t.modified()},t.removeAllVolumes=function(){var i=t.getVolumes();i.forEach(function(s){t.removeViewProp(s)}),e.volumes=[],t.modified()},t.hasLight=function(i){return e.lights.includes(i)},t.addLight=function(i){i&&!t.hasLight(i)&&(e.lights.push(i),t.modified())},t.removeLight=function(i){e.lights=e.lights.filter(function(s){return s!==i}),t.modified()},t.removeAllLights=function(){e.lights=[],t.modified()},t.setLightCollection=function(i){e.lights=i,t.modified()},t.makeLight=PO.newInstance,t.createLight=function(){e.automaticLightCreation&&(e._createdLight&&(t.removeLight(e._createdLight),e._createdLight.delete(),e._createdLight=null),e._createdLight=t.makeLight(),t.addLight(e._createdLight),e._createdLight.setLightTypeToHeadLight(),e._createdLight.setPosition(t.getActiveCamera().getPosition()),e._createdLight.setFocalPoint(t.getActiveCamera().getFocalPoint()))},t.normalizedDisplayToWorld=function(i,s,o,u){var c=t.normalizedDisplayToProjection(i,s,o);return c=t.projectionToView(c[0],c[1],c[2],u),t.viewToWorld(c[0],c[1],c[2])},t.worldToNormalizedDisplay=function(i,s,o,u){var c=t.worldToView(i,s,o);return c=t.viewToProjection(c[0],c[1],c[2],u),t.projectionToNormalizedDisplay(c[0],c[1],c[2])},t.viewToWorld=function(i,s,o){if(e.activeCamera===null)return zt("ViewToWorld: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];var u=e.activeCamera.getViewMatrix();He(u,u),ye(u,u);var c=new Float64Array([i,s,o]);return ce(c,c,u),c},t.projectionToView=function(i,s,o,u){if(e.activeCamera===null)return zt("ProjectionToView: no active camera, cannot compute projection to view, returning 0,0,0"),[0,0,0];var c=e.activeCamera.getProjectionMatrix(u,-1,1);He(c,c),ye(c,c);var f=new Float64Array([i,s,o]);return ce(f,f,c),f},t.worldToView=function(i,s,o){if(e.activeCamera===null)return zt("WorldToView: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];var u=e.activeCamera.getViewMatrix();ye(u,u);var c=new Float64Array([i,s,o]);return ce(c,c,u),c},t.viewToProjection=function(i,s,o,u){if(e.activeCamera===null)return zt("ViewToProjection: no active camera, cannot compute view to projection, returning 0,0,0"),[0,0,0];var c=e.activeCamera.getProjectionMatrix(u,-1,1);ye(c,c);var f=new Float64Array([i,s,o]);return ce(f,f,c),f},t.computeVisiblePropBounds=function(){e.allBounds[0]=Ce.INIT_BOUNDS[0],e.allBounds[1]=Ce.INIT_BOUNDS[1],e.allBounds[2]=Ce.INIT_BOUNDS[2],e.allBounds[3]=Ce.INIT_BOUNDS[3],e.allBounds[4]=Ce.INIT_BOUNDS[4],e.allBounds[5]=Ce.INIT_BOUNDS[5];var i=!0;t.invokeEvent(r);for(var s=0;s<e.props.length;++s){var o=e.props[s];if(o.getVisibility()&&o.getUseBounds()){var u=o.getBounds();u&&Za(u)&&(i=!1,u[0]<e.allBounds[0]&&(e.allBounds[0]=u[0]),u[1]>e.allBounds[1]&&(e.allBounds[1]=u[1]),u[2]<e.allBounds[2]&&(e.allBounds[2]=u[2]),u[3]>e.allBounds[3]&&(e.allBounds[3]=u[3]),u[4]<e.allBounds[4]&&(e.allBounds[4]=u[4]),u[5]>e.allBounds[5]&&(e.allBounds[5]=u[5]))}}return i&&(La(e.allBounds),Zr("Can't compute bounds, no 3D props are visible")),e.allBounds},t.resetCamera=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,s=i||t.computeVisiblePropBounds(),o=[0,0,0];if(!Za(s))return Zr("Cannot reset camera!"),!1;var u=null;if(t.getActiveCamera())u=e.activeCamera.getViewPlaneNormal();else return zt("Trying to reset non-existent camera"),!1;e.activeCamera.setViewAngle(30),o[0]=(s[0]+s[1])/2,o[1]=(s[2]+s[3])/2,o[2]=(s[4]+s[5])/2;var c=s[1]-s[0],f=s[3]-s[2],g=s[5]-s[4];c*=c,f*=f,g*=g;var v=c+f+g;v=v===0?1:v,v=Math.sqrt(v)*.5;var p=Te(e.activeCamera.getViewAngle()),l=v,y=v/Math.sin(p*.5),h=e.activeCamera.getViewUp();return Math.abs(ie(h,u))>.999&&(QO("Resetting view-up since view plane normal is parallel"),e.activeCamera.setViewUp(-h[2],h[0],h[1])),e.activeCamera.setFocalPoint(o[0],o[1],o[2]),e.activeCamera.setPosition(o[0]+y*u[0],o[1]+y*u[1],o[2]+y*u[2]),t.resetCameraClippingRange(s),e.activeCamera.setParallelScale(l),e.activeCamera.setPhysicalScale(v),e.activeCamera.setPhysicalTranslation(-o[0],-o[1],-o[2]),t.invokeEvent(a),!0},t.resetCameraClippingRange=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,s=i||t.computeVisiblePropBounds();if(!Za(s))return Zr("Cannot reset camera clipping range!"),!1;if(t.getActiveCameraAndResetIfCreated(),!e.activeCamera)return zt("Trying to reset clipping range of non-existent camera"),!1;var o=e.activeCamera.computeClippingRange(s),u=0;if(e.activeCamera.getParallelProjection())u=.2*e.activeCamera.getParallelScale();else{var c=Te(e.activeCamera.getViewAngle());u=.2*Math.tan(c/2)*o[1]}return o[1]-o[0]<u&&(u=u-o[1]+o[0],o[1]+=u/2,o[0]-=u/2),o[0]<0&&(o[0]=0),o[0]=.99*o[0]-(o[1]-o[0])*e.clippingRangeExpansion,o[1]=1.01*o[1]+(o[1]-o[0])*e.clippingRangeExpansion,o[0]=o[0]>=o[1]?.01*o[1]:o[0],e.nearClippingPlaneTolerance||(e.nearClippingPlaneTolerance=.01),o[0]<e.nearClippingPlaneTolerance*o[1]&&(o[0]=e.nearClippingPlaneTolerance*o[1]),e.activeCamera.setClippingRange(o[0],o[1]),t.invokeEvent(n),!1},t.setRenderWindow=function(i){i!==e._renderWindow&&(e._vtkWindow=i,e._renderWindow=i)},t.visibleActorCount=function(){return e.props.filter(function(i){return i.getVisibility()}).length},t.visibleVolumeCount=t.visibleActorCount,t.getMTime=function(){var i=e.mtime,s=e.activeCamera?e.activeCamera.getMTime():0;s>i&&(i=s);var o=e._createdLight?e._createdLight.getMTime():0;return o>i&&(i=o),i},t.getTransparent=function(){return!!e.preserveColorBuffer},t.isActiveCameraCreated=function(){return!!e.activeCamera}}var IO={pickedProp:null,activeCamera:null,allBounds:[],ambient:[1,1,1],allocatedRenderTime:100,timeFactor:1,automaticLightCreation:!0,twoSidedLighting:!0,lastRenderTimeInSeconds:-1,renderWindow:null,lights:[],actors:[],volumes:[],lightFollowCamera:!0,numberOfPropsRendered:0,propArray:null,pathArray:null,layer:0,preserveColorBuffer:!1,preserveDepthBuffer:!1,computeVisiblePropBounds:gc(),interactive:!0,nearClippingPlaneTolerance:0,clippingRangeExpansion:.05,erase:!0,draw:!0,useShadows:!1,useDepthPeeling:!1,occlusionRatio:0,maximumNumberOfPeels:4,selector:null,delegate:null,texturedBackground:!1,backgroundTexture:null,environmentTexture:null,environmentTextureDiffuseStrength:1,environmentTextureSpecularStrength:1,useEnvironmentTextureAsBackground:!1,pass:0};function Tv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};for(Object.assign(e,IO,r),qO.extend(t,e,r),e.background||(e.background=[0,0,0,1]);e.background.length<3;)e.background.push(0);e.background.length===3&&e.background.push(1),je(t,e,["_renderWindow","allocatedRenderTime","timeFactor","lastRenderTimeInSeconds","numberOfPropsRendered","lastRenderingUsedDepthPeeling","selector"]),be(t,e,["twoSidedLighting","lightFollowCamera","automaticLightCreation","erase","draw","nearClippingPlaneTolerance","clippingRangeExpansion","backingStore","interactive","layer","preserveColorBuffer","preserveDepthBuffer","useDepthPeeling","occlusionRatio","maximumNumberOfPeels","delegate","backgroundTexture","texturedBackground","environmentTexture","environmentTextureDiffuseStrength","environmentTextureSpecularStrength","useEnvironmentTextureAsBackground","useShadows","pass"]),Tn(t,e,["actors","volumes","lights"]),Kf(t,e,["background"],4,1),ba(t,e,["renderWindow"]),ZO(t,e)}var JO=ve(Tv,"vtkRenderer"),em={newInstance:JO,extend:Tv},tm=navigator.gpu?"WebGPU":"WebGL",ma=Object.create(null);function bs(t,e){ma[t]=e}function rm(){return Object.keys(ma)}function Cv(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ma[t]&&ma[t](e)}function nm(t,e){e.classHierarchy.push("vtkRenderWindow"),t.addRenderer=function(r){t.hasRenderer(r)||(r.setRenderWindow(t),e.renderers.push(r),t.modified())},t.removeRenderer=function(r){e.renderers=e.renderers.filter(function(n){return n!==r}),t.modified()},t.hasRenderer=function(r){return e.renderers.indexOf(r)!==-1},t.newAPISpecificView=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Cv(r||e.defaultViewAPI,n)},t.addView=function(r){t.hasView(r)||(r.setRenderable(t),e._views.push(r),t.modified())},t.removeView=function(r){e._views=e._views.filter(function(n){return n!==r}),t.modified()},t.hasView=function(r){return e._views.indexOf(r)!==-1},t.preRender=function(){e.renderers.forEach(function(r){r.isActiveCameraCreated()||r.resetCamera()})},t.render=function(){t.preRender(),e.interactor?e.interactor.render():e._views.forEach(function(r){return r.traverseAllPasses()})},t.getStatistics=function(){var r={propCount:0,invisiblePropCount:0};return e.renderers.forEach(function(n){var a=n.getViewProps();a.forEach(function(i){if(i.getVisibility()){r.propCount+=1;var s=i.getMapper&&i.getMapper();if(s&&s.getPrimitiveCount){var o=s.getPrimitiveCount();Object.keys(o).forEach(function(u){r[u]||(r[u]=0),r[u]+=o[u]})}}else r.invisiblePropCount+=1})}),r.str=Object.keys(r).map(function(n){return"".concat(n,": ").concat(r[n])}).join(`
`),r},t.captureImages=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return m.setImmediate(t.render),e._views.map(function(a){return a.captureNextImage?a.captureNextImage(r,n):void 0}).filter(function(a){return!!a})}}var am={defaultViewAPI:tm,renderers:[],views:[],interactor:null,neverRendered:!0,numberOfLayers:1};function Sv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,am,r),m.obj(t,e),m.setGet(t,e,["interactor","numberOfLayers","_views","defaultViewAPI"]),m.get(t,e,["neverRendered"]),m.getArray(t,e,["renderers"]),m.moveToProtected(t,e,["views"]),m.event(t,e,"completion"),nm(t,e)}var im=m.newInstance(Sv,"vtkRenderWindow"),sm={newInstance:im,extend:Sv,registerViewConstructor:bs,listViewAPIs:rm,newAPISpecificView:Cv},ji={Unknown:0,LeftController:1,RightController:2},an={Unknown:0,Trigger:1,TrackPad:2,Grip:3,Thumbstick:4,A:5,B:6,ApplicationMenu:7},om={Unknown:0,TouchpadX:1,TouchpadY:2,ThumbstickX:3,ThumbstickY:4},Ls={Device:ji,Input:an,Axis:om};function Wu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function pe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Wu(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Wu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Xn=Ls.Device,or=Ls.Input,Yn=m.vtkWarningMacro,qn=m.vtkErrorMacro,um=m.normalizeWheel,fm=m.vtkOnceErrorMacro,Er=new MouseEvent(""),hi={"xr-standard":[or.Trigger,or.Grip,or.TrackPad,or.Thumbstick,or.A,or.B]},Bs=["StartAnimation","Animation","EndAnimation","PointerEnter","PointerLeave","MouseEnter","MouseLeave","StartMouseMove","MouseMove","EndMouseMove","LeftButtonPress","LeftButtonRelease","MiddleButtonPress","MiddleButtonRelease","RightButtonPress","RightButtonRelease","KeyPress","KeyDown","KeyUp","StartMouseWheel","MouseWheel","EndMouseWheel","StartPinch","Pinch","EndPinch","StartPan","Pan","EndPan","StartRotate","Rotate","EndRotate","Button3D","Move3D","StartPointerLock","EndPointerLock","StartInteraction","Interaction","EndInteraction","AnimationFrameRateUpdate"];function Ir(t){t.cancelable&&t.preventDefault()}function Qn(t){var e=Object.create(null);return t.forEach(function(r){var n=r.pointerId,a=r.position;e[n]=a}),e}function cm(t,e){e.classHierarchy.push("vtkRenderWindowInteractor");var r=new Set,n=new Map,a=1;t.start=function(){!e.initialized&&(t.initialize(),!e.initialized)||t.startEventLoop()},t.setRenderWindow=function(v){qn("you want to call setView(view) instead of setRenderWindow on a vtk.js interactor")},t.setInteractorStyle=function(v){e.interactorStyle!==v&&(e.interactorStyle!=null&&e.interactorStyle.setInteractor(null),e.interactorStyle=v,e.interactorStyle!=null&&e.interactorStyle.getInteractor()!==t&&e.interactorStyle.setInteractor(t))},t.initialize=function(){e.initialized=!0,t.enable(),t.render()},t.enable=function(){return t.setEnabled(!0)},t.disable=function(){return t.setEnabled(!1)},t.startEventLoop=function(){return Yn("empty event loop")};function i(v,p){e._forcedRenderer||(e.currentRenderer=t.findPokedRenderer(v,p))}t.getCurrentRenderer=function(){return e.currentRenderer||i(0,0),e.currentRenderer};function s(v){var p=e._view.getCanvas(),l=p.getBoundingClientRect(),y=p.width/l.width,h=p.height/l.height,d={x:y*(v.clientX-l.left),y:h*(l.height-v.clientY+l.top),z:0};return(n.size<=1||!e.currentRenderer)&&i(d.x,d.y),d}function o(v){return{controlKey:v.ctrlKey,altKey:v.altKey,shiftKey:v.shiftKey}}function u(v){var p=o(v),l=pe({key:v.key,keyCode:v.charCode},p);return l}function c(v){return v.pointerType||""}t.bindEvents=function(v){e.container=v,v.addEventListener("contextmenu",Ir),v.addEventListener("wheel",t.handleWheel),v.addEventListener("DOMMouseScroll",t.handleWheel),v.addEventListener("pointerenter",t.handlePointerEnter),v.addEventListener("pointerleave",t.handlePointerLeave),v.addEventListener("pointermove",t.handlePointerMove,{passive:!1}),v.addEventListener("pointerdown",t.handlePointerDown,{passive:!1}),v.addEventListener("pointerup",t.handlePointerUp),v.addEventListener("pointercancel",t.handlePointerCancel),document.addEventListener("keypress",t.handleKeyPress),document.addEventListener("keydown",t.handleKeyDown),document.addEventListener("keyup",t.handleKeyUp),document.addEventListener("pointerlockchange",t.handlePointerLockChange),v.style.touchAction="none",v.style.userSelect="none",v.style.webkitTapHighlightColor="rgba(0,0,0,0)"},t.unbindEvents=function(){var v=e.container;v.removeEventListener("contextmenu",Ir),v.removeEventListener("wheel",t.handleWheel),v.removeEventListener("DOMMouseScroll",t.handleWheel),v.removeEventListener("pointerenter",t.handlePointerEnter),v.removeEventListener("pointerleave",t.handlePointerLeave),v.removeEventListener("pointermove",t.handlePointerMove,{passive:!1}),v.removeEventListener("pointerdown",t.handlePointerDown,{passive:!1}),v.removeEventListener("pointerup",t.handlePointerUp),v.removeEventListener("pointercancel",t.handlePointerCancel),document.removeEventListener("keypress",t.handleKeyPress),document.removeEventListener("keydown",t.handleKeyDown),document.removeEventListener("keyup",t.handleKeyUp),document.removeEventListener("pointerlockchange",t.handlePointerLockChange),e.container=null,n.clear()},t.handleKeyPress=function(v){var p=u(v);t.keyPressEvent(p)},t.handleKeyDown=function(v){var p=u(v);t.keyDownEvent(p)},t.handleKeyUp=function(v){var p=u(v);t.keyUpEvent(p)},t.handlePointerEnter=function(v){var p=pe(pe({},o(v)),{},{position:s(v),deviceType:c(v)});t.pointerEnterEvent(p),p.deviceType==="mouse"&&t.mouseEnterEvent(p)},t.handlePointerLeave=function(v){var p=pe(pe({},o(v)),{},{position:s(v),deviceType:c(v)});t.pointerLeaveEvent(p),p.deviceType==="mouse"&&t.mouseLeaveEvent(p)},t.handlePointerDown=function(v){if(!(v.button>2||t.isPointerLocked()))switch(e.preventDefaultOnPointerDown&&Ir(v),v.target.hasPointerCapture(v.pointerId)&&v.target.releasePointerCapture(v.pointerId),e.container.setPointerCapture(v.pointerId),n.has(v.pointerId)&&Yn("[RenderWindowInteractor] duplicate pointerId detected"),n.set(v.pointerId,{pointerId:v.pointerId,position:s(v)}),v.pointerType){case"pen":case"touch":t.handleTouchStart(v);break;case"mouse":default:t.handleMouseDown(v);break}},t.handlePointerUp=function(v){if(n.has(v.pointerId))switch(e.preventDefaultOnPointerUp&&Ir(v),n.delete(v.pointerId),e.container.releasePointerCapture(v.pointerId),v.pointerType){case"pen":case"touch":t.handleTouchEnd(v);break;case"mouse":default:t.handleMouseUp(v);break}},t.handlePointerCancel=function(v){if(n.has(v.pointerId))switch(n.delete(v.pointerId),v.pointerType){case"pen":case"touch":t.handleTouchEnd(v);break;case"mouse":default:t.handleMouseUp(v);break}},t.handlePointerMove=function(v){if(n.has(v.pointerId)){var p=n.get(v.pointerId);p.position=s(v)}switch(v.pointerType){case"pen":case"touch":t.handleTouchMove(v);break;case"mouse":default:t.handleMouseMove(v);break}},t.handleMouseDown=function(v){var p=pe(pe({},o(v)),{},{position:s(v),deviceType:c(v)});switch(v.button){case 0:t.leftButtonPressEvent(p);break;case 1:t.middleButtonPressEvent(p);break;case 2:t.rightButtonPressEvent(p);break;default:qn("Unknown mouse button pressed: ".concat(v.button));break}},t.requestPointerLock=function(){e.container&&e.container.requestPointerLock()},t.exitPointerLock=function(){return document.exitPointerLock()},t.isPointerLocked=function(){return!!e.container&&document.pointerLockElement===e.container},t.handlePointerLockChange=function(){t.isPointerLocked()?t.startPointerLockEvent():t.endPointerLockEvent()};function f(){e._view&&e.enabled&&e.enableRender&&(e.inRender=!0,e._view.traverseAllPasses(),e.inRender=!1),t.invokeRenderEvent()}t.requestAnimation=function(v){if(v===void 0){qn("undefined requester, can not start animating");return}if(r.has(v)){Yn("requester is already registered for animating");return}r.add(v),!e.animationRequest&&r.size===1&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.extendAnimation=function(v){var p=Date.now()+v;e._animationExtendedEnd=Math.max(e._animationExtendedEnd,p),!e.animationRequest&&r.size===0&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.isAnimating=function(){return e.xrAnimation||e.animationRequest!==null},t.cancelAnimation=function(v){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r.has(v)){if(!p){var l=v&&v.getClassName?v.getClassName():v;Yn("".concat(l," did not request an animation"))}return}r.delete(v),e.animationRequest&&r.size===0&&Date.now()>e._animationExtendedEnd&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.switchToXRAnimation=function(){e.animationRequest&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null),e.xrAnimation=!0},t.returnFromXRAnimation=function(){e.xrAnimation=!1,r.size!==0&&(e.recentAnimationFrameRate=10,e.animationRequest=requestAnimationFrame(t.handleAnimation))},t.updateXRGamepads=function(v,p,l){v.inputSources.forEach(function(y){var h=y.gripSpace==null?null:p.getPose(y.gripSpace,l),d=y.gamepad,S=y.handedness;if(d){d.index in e.lastGamepadValues||(e.lastGamepadValues[d.index]={left:{buttons:{}},right:{buttons:{}},none:{buttons:{}}});for(var T=0;T<d.buttons.length;++T)T in e.lastGamepadValues[d.index][S].buttons||(e.lastGamepadValues[d.index][S].buttons[T]=!1),e.lastGamepadValues[d.index][S].buttons[T]!==d.buttons[T].pressed&&h!=null&&(t.button3DEvent({gamepad:d,position:h.transform.position,orientation:h.transform.orientation,pressed:d.buttons[T].pressed,device:y.handedness==="left"?Xn.LeftController:Xn.RightController,input:hi[d.mapping]&&hi[d.mapping][T]?hi[d.mapping][T]:or.Trigger}),e.lastGamepadValues[d.index][S].buttons[T]=d.buttons[T].pressed),e.lastGamepadValues[d.index][S].buttons[T]&&h!=null&&t.move3DEvent({gamepad:d,position:h.transform.position,orientation:h.transform.orientation,device:y.handedness==="left"?Xn.LeftController:Xn.RightController})}})},t.handleMouseMove=function(v){var p=pe(pe({},o(v)),{},{position:s(v),deviceType:c(v)});e.moveTimeoutID===0?t.startMouseMoveEvent(p):(t.mouseMoveEvent(p),clearTimeout(e.moveTimeoutID)),e.moveTimeoutID=setTimeout(function(){t.endMouseMoveEvent(),e.moveTimeoutID=0},200)},t.handleAnimation=function(){var v=Date.now();e._animationFrameCount++,v-e._animationStartTime>1e3&&e._animationFrameCount>1&&(e.recentAnimationFrameRate=1e3*(e._animationFrameCount-1)/(v-e._animationStartTime),e.lastFrameTime=1/e.recentAnimationFrameRate,t.animationFrameRateUpdateEvent(),e._animationStartTime=v,e._animationFrameCount=1),t.animationEvent(),f(),r.size>0||Date.now()<e._animationExtendedEnd?e.animationRequest=requestAnimationFrame(t.handleAnimation):(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.handleWheel=function(v){Ir(v);var p=pe(pe(pe({},um(v)),o(v)),{},{position:s(v),deviceType:c(v)});e.wheelTimeoutID===0&&(Math.abs(p.spinY)>=.3?a=Math.abs(p.spinY):a=1),p.spinY/=a,e.wheelTimeoutID===0?(t.startMouseWheelEvent(p),t.mouseWheelEvent(p)):(t.mouseWheelEvent(p),clearTimeout(e.wheelTimeoutID)),e.mouseScrollDebounceByPass?(t.extendAnimation(600),t.endMouseWheelEvent(),e.wheelTimeoutID=0):e.wheelTimeoutID=setTimeout(function(){t.extendAnimation(600),t.endMouseWheelEvent(),e.wheelTimeoutID=0},200)},t.handleMouseUp=function(v){var p=pe(pe({},o(v)),{},{position:s(v),deviceType:c(v)});switch(v.button){case 0:t.leftButtonReleaseEvent(p);break;case 1:t.middleButtonReleaseEvent(p);break;case 2:t.rightButtonReleaseEvent(p);break;default:qn("Unknown mouse button released: ".concat(v.button));break}},t.handleTouchStart=function(v){var p=Y(n.values());if(e.recognizeGestures&&p.length>1){var l=Qn(n);if(p.length===2){var y=pe(pe({},o(Er)),{},{position:p[0].position,deviceType:c(v)});t.leftButtonReleaseEvent(y)}t.recognizeGesture("TouchStart",l)}else if(p.length===1){var h=pe(pe({},o(Er)),{},{position:s(v),deviceType:c(v)});t.leftButtonPressEvent(h)}},t.handleTouchMove=function(v){var p=Y(n.values());if(e.recognizeGestures&&p.length>1){var l=Qn(n);t.recognizeGesture("TouchMove",l)}else if(p.length===1){var y=pe(pe({},o(Er)),{},{position:p[0].position,deviceType:c(v)});t.mouseMoveEvent(y)}},t.handleTouchEnd=function(v){var p=Y(n.values());if(e.recognizeGestures)if(p.length===0){var l=pe(pe({},o(Er)),{},{position:s(v),deviceType:c(v)});t.leftButtonReleaseEvent(l)}else if(p.length===1){var y=Qn(n);t.recognizeGesture("TouchEnd",y);var h=pe(pe({},o(Er)),{},{position:p[0].position,deviceType:c(v)});t.leftButtonPressEvent(h)}else{var d=Qn(n);t.recognizeGesture("TouchMove",d)}else if(p.length===1){var S=pe(pe({},o(Er)),{},{position:p[0].position,deviceType:c(v)});t.leftButtonReleaseEvent(S)}},t.setView=function(v){e._view!==v&&(e._view=v,e._view.getRenderable().setInteractor(t),t.modified())},t.getFirstRenderer=function(){var v,p,l;return(v=e._view)===null||v===void 0||(p=v.getRenderable())===null||p===void 0||(l=p.getRenderersByReference())===null||l===void 0?void 0:l[0]},t.findPokedRenderer=function(){var v,p,l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!e._view)return null;var h=(v=e._view)===null||v===void 0||(p=v.getRenderable())===null||p===void 0?void 0:p.getRenderers();if(!h||h.length===0)return null;h.sort(function(O,w){return O.getLayer()-w.getLayer()});for(var d=null,S=null,T=null,C=h.length;C--;){var x=h[C];if(e._view.isInViewport(l,y,x)&&x.getInteractive()){T=x;break}d===null&&x.getInteractive()&&(d=x),S===null&&e._view.isInViewport(l,y,x)&&(S=x)}return T===null&&(T=d),T===null&&(T=S),T==null&&(T=h[0]),T},t.render=function(){!t.isAnimating()&&!e.inRender&&f()},Bs.forEach(function(v){var p=v.charAt(0).toLowerCase()+v.slice(1);t["".concat(p,"Event")]=function(l){if(e.enabled){var y=t.getCurrentRenderer();if(!y){fm(`
          Can not forward events without a current renderer on the interactor.
        `);return}var h=pe({type:v,pokedRenderer:e.currentRenderer,firstRenderer:t.getFirstRenderer()},l);t["invoke".concat(v)](h)}}}),t.recognizeGesture=function(v,p){if(!(Object.keys(p).length>2)){if(e.startingEventPositions||(e.startingEventPositions={}),v==="TouchStart"){Object.keys(p).forEach(function(W){e.startingEventPositions[W]=p[W]}),e.currentGesture="Start";return}if(v==="TouchEnd"){e.currentGesture==="Pinch"&&(t.render(),t.endPinchEvent()),e.currentGesture==="Rotate"&&(t.render(),t.endRotateEvent()),e.currentGesture==="Pan"&&(t.render(),t.endPanEvent()),e.currentGesture="Start",e.startingEventPositions={};return}var l=0,y=[],h=[];Object.keys(p).forEach(function(W){y[l]=p[W],h[l]=e.startingEventPositions[W],l++});var d=Math.sqrt((h[0].x-h[1].x)*(h[0].x-h[1].x)+(h[0].y-h[1].y)*(h[0].y-h[1].y)),S=Math.sqrt((y[0].x-y[1].x)*(y[0].x-y[1].x)+(y[0].y-y[1].y)*(y[0].y-y[1].y)),T=ln(Math.atan2(h[1].y-h[0].y,h[1].x-h[0].x)),C=ln(Math.atan2(y[1].y-y[0].y,y[1].x-y[0].x)),x=C-T;C=C+180>=360?C-180:C+180,T=T+180>=360?T-180:T+180,Math.abs(C-T)<Math.abs(x)&&(x=C-T);var O=[];if(O[0]=(y[0].x-h[0].x+y[1].x-h[1].x)/2,O[1]=(y[0].y-h[0].y+y[1].y-h[1].y)/2,v==="TouchMove")if(e.currentGesture==="Start"){var w=.01*Math.sqrt(e.container.clientWidth*e.container.clientWidth+e.container.clientHeight*e.container.clientHeight);w<15&&(w=15);var E=Math.abs(S-d),V=S*3.1415926*Math.abs(x)/360,D=Math.sqrt(O[0]*O[0]+O[1]*O[1]);if(E>w&&E>V&&E>D){e.currentGesture="Pinch";var M={scale:1,touches:p};t.startPinchEvent(M)}else if(V>w&&V>D){e.currentGesture="Rotate";var L={rotation:0,touches:p};t.startRotateEvent(L)}else if(D>w){e.currentGesture="Pan";var N={translation:[0,0],touches:p};t.startPanEvent(N)}}else{if(e.currentGesture==="Rotate"){var B={rotation:x,touches:p};t.rotateEvent(B)}if(e.currentGesture==="Pinch"){var _={scale:S/d,touches:p};t.pinchEvent(_)}if(e.currentGesture==="Pan"){var A={translation:O,touches:p};t.panEvent(A)}}}},t.handleVisibilityChange=function(){e._animationStartTime=Date.now(),e._animationFrameCount=0},t.setCurrentRenderer=function(v){e._forcedRenderer=!!v,e.currentRenderer=v};var g=t.delete;t.delete=function(){for(;r.size;)t.cancelAnimation(r.values().next().value);typeof document.hidden<"u"&&document.removeEventListener("visibilitychange",t.handleVisibilityChange),e.container&&t.unbindEvents(),g()},typeof document.hidden<"u"&&document.addEventListener("visibilitychange",t.handleVisibilityChange,!1)}var gm={renderWindow:null,interactorStyle:null,picker:null,pickingManager:null,initialized:!1,enabled:!1,enableRender:!0,currentRenderer:null,lightFollowCamera:!0,desiredUpdateRate:30,stillUpdateRate:2,container:null,recognizeGestures:!0,currentGesture:"Start",animationRequest:null,lastFrameTime:.1,recentAnimationFrameRate:10,wheelTimeoutID:0,moveTimeoutID:0,lastGamepadValues:{},preventDefaultOnPointerDown:!1,preventDefaultOnPointerUp:!1,mouseScrollDebounceByPass:!1};function xv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gm,r),m.obj(t,e),e._animationExtendedEnd=0,m.event(t,e,"RenderEvent"),Bs.forEach(function(n){return m.event(t,e,n)}),m.get(t,e,["initialized","container","interactorStyle","lastFrameTime","recentAnimationFrameRate","_view"]),m.setGet(t,e,["lightFollowCamera","enabled","enableRender","recognizeGestures","desiredUpdateRate","stillUpdateRate","picker","preventDefaultOnPointerDown","preventDefaultOnPointerUp","mouseScrollDebounceByPass"]),m.moveToProtected(t,e,["view"]),cm(t,e)}var vm=m.newInstance(xv,"vtkRenderWindowInteractor"),Ov=pe({newInstance:vm,extend:xv,handledEvents:Bs},Ls);function zu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function mv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zu(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var pm=m.vtkErrorMacro,lm=m.VOID;function hm(t,e,r,n){var a=t.getRenderWindow().getViews()[0];return a.worldToDisplay(e,r,n,t)}function ym(t,e,r,n){var a=t.getRenderWindow().getViews()[0];return a.displayToWorld(e,r,n,t)}var dm={computeWorldToDisplay:hm,computeDisplayToWorld:ym};function Tm(t,e){e.classHierarchy.push("vtkInteractorObserver");var r=mv({},t);function n(){for(;e.subscribedEvents.length;)e.subscribedEvents.pop().unsubscribe()}function a(){Ov.handledEvents.forEach(function(i){t["handle".concat(i)]&&e.subscribedEvents.push(e._interactor["on".concat(i)](function(s){return e.processEvents?t["handle".concat(i)](s):lm},e.priority))})}t.setInteractor=function(i){i!==e._interactor&&(n(),e._interactor=i,i&&e.enabled&&a(),t.modified())},t.setEnabled=function(i){i!==e.enabled&&(n(),i&&(e._interactor?a():pm(`
          The interactor must be set before subscribing to events
        `)),e.enabled=i,t.modified())},t.computeDisplayToWorld=function(i,s,o,u){return i?e._interactor.getView().displayToWorld(s,o,u,i):null},t.computeWorldToDisplay=function(i,s,o,u){return i?e._interactor.getView().worldToDisplay(s,o,u,i):null},t.setPriority=function(i){var s=r.setPriority(i);s&&e._interactor&&(n(),a())}}var Cm={enabled:!0,priority:0,processEvents:!0,subscribedEvents:[]};function wv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Cm,r),m.obj(t,e),m.event(t,e,"InteractionEvent"),m.event(t,e,"StartInteractionEvent"),m.event(t,e,"EndInteractionEvent"),m.get(t,e,["_interactor","enabled"]),m.setGet(t,e,["priority","processEvents"]),m.moveToProtected(t,e,["interactor"]),Tm(t,e)}var Sm=m.newInstance(wv,"vtkInteractorObserver"),xm=mv({newInstance:Sm,extend:wv},dm),Om={IS_START:0,IS_NONE:0,IS_ROTATE:1,IS_PAN:2,IS_SPIN:3,IS_DOLLY:4,IS_CAMERA_POSE:11,IS_WINDOW_LEVEL:1024,IS_SLICE:1025},ks={States:Om};function Au(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function mm(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Au(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Au(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ht=ks.States,yi={Rotate:ht.IS_ROTATE,Pan:ht.IS_PAN,Spin:ht.IS_SPIN,Dolly:ht.IS_DOLLY,CameraPose:ht.IS_CAMERA_POSE,WindowLevel:ht.IS_WINDOW_LEVEL,Slice:ht.IS_SLICE};function wm(t,e){e.classHierarchy.push("vtkInteractorStyle"),Object.keys(yi).forEach(function(r){m.event(t,e,"Start".concat(r,"Event")),t["start".concat(r)]=function(){e.state===ht.IS_NONE&&(e.state=yi[r],e._interactor.requestAnimation(t),t.invokeStartInteractionEvent({type:"StartInteractionEvent"}),t["invokeStart".concat(r,"Event")]({type:"Start".concat(r,"Event")}))},m.event(t,e,"End".concat(r,"Event")),t["end".concat(r)]=function(){e.state===yi[r]&&(e.state=ht.IS_NONE,e._interactor.cancelAnimation(t),t.invokeEndInteractionEvent({type:"EndInteractionEvent"}),t["invokeEnd".concat(r,"Event")]({type:"End".concat(r,"Event")}),e._interactor.render())}}),t.handleKeyPress=function(r){var n=e._interactor,a=null;switch(r.key){case"r":case"R":r.pokedRenderer.resetCamera(),n.render();break;case"w":case"W":a=r.pokedRenderer.getActors(),a.forEach(function(i){var s=i.getProperty();s.setRepresentationToWireframe&&s.setRepresentationToWireframe()}),n.render();break;case"s":case"S":a=r.pokedRenderer.getActors(),a.forEach(function(i){var s=i.getProperty();s.setRepresentationToSurface&&s.setRepresentationToSurface()}),n.render();break;case"v":case"V":a=r.pokedRenderer.getActors(),a.forEach(function(i){var s=i.getProperty();s.setRepresentationToPoints&&s.setRepresentationToPoints()}),n.render();break}}}var Em={state:ht.IS_NONE,handleObservers:1,autoAdjustCameraClippingRange:1};function Ev(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Em,r),xm.extend(t,e,r),wm(t,e)}var Dm=m.newInstance(Ev,"vtkInteractorStyle"),Mm=mm({newInstance:Dm,extend:Ev},ks),gt=ks.States;function Vm(t,e){e.classHierarchy.push("vtkInteractorStyleTrackballCamera"),t.handleMouseMove=function(r){var n=r.position,a=r.pokedRenderer;switch(e.state){case gt.IS_ROTATE:t.handleMouseRotate(a,n),t.invokeInteractionEvent({type:"InteractionEvent"});break;case gt.IS_PAN:t.handleMousePan(a,n),t.invokeInteractionEvent({type:"InteractionEvent"});break;case gt.IS_DOLLY:t.handleMouseDolly(a,n),t.invokeInteractionEvent({type:"InteractionEvent"});break;case gt.IS_SPIN:t.handleMouseSpin(a,n),t.invokeInteractionEvent({type:"InteractionEvent"});break}e.previousPosition=n},t.handleButton3D=function(r){if(r&&r.pressed&&r.device===ji.RightController&&(r.input===an.Trigger||r.input===an.TrackPad)){t.startCameraPose();return}r&&!r.pressed&&r.device===ji.RightController&&(r.input===an.Trigger||r.input===an.TrackPad)&&e.state===gt.IS_CAMERA_POSE&&t.endCameraPose()},t.handleMove3D=function(r){switch(e.state){case gt.IS_CAMERA_POSE:t.updateCameraPose(r);break}},t.updateCameraPose=function(r){var n=r.pokedRenderer.getActiveCamera(),a=n.getPhysicalTranslation(),i=.5,s=i*.05*n.getPhysicalScale(),o=n.physicalOrientationToWorldDirection([r.orientation.x,r.orientation.y,r.orientation.z,r.orientation.w]);n.setPhysicalTranslation(a[0]+o[0]*s,a[1]+o[1]*s,a[2]+o[2]*s)},t.handleLeftButtonPress=function(r){var n=r.position;e.previousPosition=n,r.shiftKey?r.controlKey||r.altKey?t.startDolly():t.startPan():r.controlKey||r.altKey?t.startSpin():t.startRotate()},t.handleLeftButtonRelease=function(){switch(e.state){case gt.IS_DOLLY:t.endDolly();break;case gt.IS_PAN:t.endPan();break;case gt.IS_SPIN:t.endSpin();break;case gt.IS_ROTATE:t.endRotate();break}},t.handleStartMouseWheel=function(){t.startDolly()},t.handleEndMouseWheel=function(){t.endDolly()},t.handleStartPinch=function(r){e.previousScale=r.scale,t.startDolly()},t.handleEndPinch=function(){t.endDolly()},t.handleStartRotate=function(r){e.previousRotation=r.rotation,t.startRotate()},t.handleEndRotate=function(){t.endRotate()},t.handleStartPan=function(r){e.previousTranslation=r.translation,t.startPan()},t.handleEndPan=function(){t.endPan()},t.handlePinch=function(r){t.dollyByFactor(r.pokedRenderer,r.scale/e.previousScale),e.previousScale=r.scale},t.handlePan=function(r){var n=r.pokedRenderer.getActiveCamera(),a=n.getFocalPoint();a=t.computeWorldToDisplay(r.pokedRenderer,a[0],a[1],a[2]);var i=a[2],s=r.translation,o=e.previousTranslation,u=t.computeDisplayToWorld(r.pokedRenderer,a[0]+s[0]-o[0],a[1]+s[1]-o[1],i),c=t.computeDisplayToWorld(r.pokedRenderer,a[0],a[1],i),f=[];f[0]=c[0]-u[0],f[1]=c[1]-u[1],f[2]=c[2]-u[2],a=n.getFocalPoint();var g=n.getPosition();n.setFocalPoint(f[0]+a[0],f[1]+a[1],f[2]+a[2]),n.setPosition(f[0]+g[0],f[1]+g[1],f[2]+g[2]),e._interactor.getLightFollowCamera()&&r.pokedRenderer.updateLightsGeometryToFollowCamera(),n.orthogonalizeViewUp(),e.previousTranslation=r.translation},t.handleRotate=function(r){var n=r.pokedRenderer.getActiveCamera();n.roll(r.rotation-e.previousRotation),n.orthogonalizeViewUp(),e.previousRotation=r.rotation},t.handleMouseRotate=function(r,n){if(e.previousPosition){var a=e._interactor,i=n.x-e.previousPosition.x,s=n.y-e.previousPosition.y,o=a.getView().getViewportSize(r),u=-.1,c=-.1;o[0]&&o[1]&&(u=-20/o[1],c=-20/o[0]);var f=i*c*e.motionFactor,g=s*u*e.motionFactor,v=r.getActiveCamera();!Number.isNaN(f)&&!Number.isNaN(g)&&(v.azimuth(f),v.elevation(g),v.orthogonalizeViewUp()),e.autoAdjustCameraClippingRange&&r.resetCameraClippingRange(),a.getLightFollowCamera()&&r.updateLightsGeometryToFollowCamera()}},t.handleMouseSpin=function(r,n){if(e.previousPosition){var a=e._interactor,i=r.getActiveCamera(),s=a.getView().getViewportCenter(r),o=ln(Math.atan2(e.previousPosition.y-s[1],e.previousPosition.x-s[0])),u=ln(Math.atan2(n.y-s[1],n.x-s[0]))-o;Number.isNaN(u)||(i.roll(u),i.orthogonalizeViewUp())}},t.handleMousePan=function(r,n){if(e.previousPosition){var a=r.getActiveCamera(),i=a.getFocalPoint();i=t.computeWorldToDisplay(r,i[0],i[1],i[2]);var s=i[2],o=t.computeDisplayToWorld(r,n.x,n.y,s),u=t.computeDisplayToWorld(r,e.previousPosition.x,e.previousPosition.y,s),c=[];c[0]=u[0]-o[0],c[1]=u[1]-o[1],c[2]=u[2]-o[2],i=a.getFocalPoint();var f=a.getPosition();a.setFocalPoint(c[0]+i[0],c[1]+i[1],c[2]+i[2]),a.setPosition(c[0]+f[0],c[1]+f[1],c[2]+f[2]),e._interactor.getLightFollowCamera()&&r.updateLightsGeometryToFollowCamera()}},t.handleMouseDolly=function(r,n){if(e.previousPosition){var a=n.y-e.previousPosition.y,i=e._interactor,s=i.getView().getViewportCenter(r),o=e.motionFactor*a/s[1];t.dollyByFactor(r,Math.pow(1.1,o))}},t.handleMouseWheel=function(r){var n=1-r.spinY/e.zoomFactor;t.dollyByFactor(r.pokedRenderer,n)},t.dollyByFactor=function(r,n){if(!Number.isNaN(n)){var a=r.getActiveCamera();a.getParallelProjection()?a.setParallelScale(a.getParallelScale()/n):(a.dolly(n),e.autoAdjustCameraClippingRange&&r.resetCameraClippingRange()),e._interactor.getLightFollowCamera()&&r.updateLightsGeometryToFollowCamera()}}}var Rm={motionFactor:10,zoomFactor:10};function Dv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Rm,r),Mm.extend(t,e,r),m.setGet(t,e,["motionFactor","zoomFactor"]),Vm(t,e)}var bm=m.newInstance(Dv,"vtkInteractorStyleTrackballCamera"),Lm={newInstance:bm,extend:Dv};function Bm(t){return t}function Ns(t){if(t===null||t==="null")return null;if(t==="true")return!0;if(t==="false")return!1;if(!(t===void 0||t==="undefined"))return t[0]==="["&&t[t.length-1]==="]"?t.substring(1,t.length-1).split(",").map(function(e){return Ns(e.trim())}):t===""||Number.isNaN(Number(t))?t:Number(t)}function km(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window.location.search,r={},n=t?Ns:Bm,a=(e||"").replace(/#.*/,"").replace("?","").split("&");return a.forEach(function(i){var s=i.split("=").map(function(f){return decodeURIComponent(f)}),o=$e(s,2),u=o[0],c=o[1];u&&(r[u]=c?n(c):!0)}),r}var Nm={toNativeType:Ns,extractURLParameters:km};function Hu(t,e,r,n,a,i,s){try{var o=t[i](s),u=o.value}catch(c){r(c);return}o.done?e(u):Promise.resolve(u).then(n,a)}function St(t){return function(){var e=this,r=arguments;return new Promise(function(n,a){var i=t.apply(e,r);function s(u){Hu(i,n,a,s,o,"next",u)}function o(u){Hu(i,n,a,s,o,"throw",u)}s(void 0)})}}var Mv={exports:{}};(function(t){var e=function(r){var n=Object.prototype,a=n.hasOwnProperty,i=Object.defineProperty||function(R,b,F){R[b]=F.value},s,o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",f=o.toStringTag||"@@toStringTag";function g(R,b,F){return Object.defineProperty(R,b,{value:F,enumerable:!0,configurable:!0,writable:!0}),R[b]}try{g({},"")}catch{g=function(b,F,G){return b[F]=G}}function v(R,b,F,G){var U=b&&b.prototype instanceof T?b:T,H=Object.create(U.prototype),j=new A(G||[]);return i(H,"_invoke",{value:L(R,F,j)}),H}r.wrap=v;function p(R,b,F){try{return{type:"normal",arg:R.call(b,F)}}catch(G){return{type:"throw",arg:G}}}var l="suspendedStart",y="suspendedYield",h="executing",d="completed",S={};function T(){}function C(){}function x(){}var O={};g(O,u,function(){return this});var w=Object.getPrototypeOf,E=w&&w(w(W([])));E&&E!==n&&a.call(E,u)&&(O=E);var V=x.prototype=T.prototype=Object.create(O);C.prototype=x,i(V,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:C,configurable:!0}),C.displayName=g(x,f,"GeneratorFunction");function D(R){["next","throw","return"].forEach(function(b){g(R,b,function(F){return this._invoke(b,F)})})}r.isGeneratorFunction=function(R){var b=typeof R=="function"&&R.constructor;return b?b===C||(b.displayName||b.name)==="GeneratorFunction":!1},r.mark=function(R){return Object.setPrototypeOf?Object.setPrototypeOf(R,x):(R.__proto__=x,g(R,f,"GeneratorFunction")),R.prototype=Object.create(V),R},r.awrap=function(R){return{__await:R}};function M(R,b){function F(H,j,I,re){var ue=p(R[H],R,j);if(ue.type==="throw")re(ue.arg);else{var Le=ue.arg,le=Le.value;return le&&typeof le=="object"&&a.call(le,"__await")?b.resolve(le.__await).then(function(J){F("next",J,I,re)},function(J){F("throw",J,I,re)}):b.resolve(le).then(function(J){Le.value=J,I(Le)},function(J){return F("throw",J,I,re)})}}var G;function U(H,j){function I(){return new b(function(re,ue){F(H,j,re,ue)})}return G=G?G.then(I,I):I()}i(this,"_invoke",{value:U})}D(M.prototype),g(M.prototype,c,function(){return this}),r.AsyncIterator=M,r.async=function(R,b,F,G,U){U===void 0&&(U=Promise);var H=new M(v(R,b,F,G),U);return r.isGeneratorFunction(b)?H:H.next().then(function(j){return j.done?j.value:H.next()})};function L(R,b,F){var G=l;return function(H,j){if(G===h)throw new Error("Generator is already running");if(G===d){if(H==="throw")throw j;return z()}for(F.method=H,F.arg=j;;){var I=F.delegate;if(I){var re=N(I,F);if(re){if(re===S)continue;return re}}if(F.method==="next")F.sent=F._sent=F.arg;else if(F.method==="throw"){if(G===l)throw G=d,F.arg;F.dispatchException(F.arg)}else F.method==="return"&&F.abrupt("return",F.arg);G=h;var ue=p(R,b,F);if(ue.type==="normal"){if(G=F.done?d:y,ue.arg===S)continue;return{value:ue.arg,done:F.done}}else ue.type==="throw"&&(G=d,F.method="throw",F.arg=ue.arg)}}}function N(R,b){var F=b.method,G=R.iterator[F];if(G===s)return b.delegate=null,F==="throw"&&R.iterator.return&&(b.method="return",b.arg=s,N(R,b),b.method==="throw")||F!=="return"&&(b.method="throw",b.arg=new TypeError("The iterator does not provide a '"+F+"' method")),S;var U=p(G,R.iterator,b.arg);if(U.type==="throw")return b.method="throw",b.arg=U.arg,b.delegate=null,S;var H=U.arg;if(!H)return b.method="throw",b.arg=new TypeError("iterator result is not an object"),b.delegate=null,S;if(H.done)b[R.resultName]=H.value,b.next=R.nextLoc,b.method!=="return"&&(b.method="next",b.arg=s);else return H;return b.delegate=null,S}D(V),g(V,f,"Generator"),g(V,u,function(){return this}),g(V,"toString",function(){return"[object Generator]"});function B(R){var b={tryLoc:R[0]};1 in R&&(b.catchLoc=R[1]),2 in R&&(b.finallyLoc=R[2],b.afterLoc=R[3]),this.tryEntries.push(b)}function _(R){var b=R.completion||{};b.type="normal",delete b.arg,R.completion=b}function A(R){this.tryEntries=[{tryLoc:"root"}],R.forEach(B,this),this.reset(!0)}r.keys=function(R){var b=Object(R),F=[];for(var G in b)F.push(G);return F.reverse(),function U(){for(;F.length;){var H=F.pop();if(H in b)return U.value=H,U.done=!1,U}return U.done=!0,U}};function W(R){if(R){var b=R[u];if(b)return b.call(R);if(typeof R.next=="function")return R;if(!isNaN(R.length)){var F=-1,G=function U(){for(;++F<R.length;)if(a.call(R,F))return U.value=R[F],U.done=!1,U;return U.value=s,U.done=!0,U};return G.next=G}}return{next:z}}r.values=W;function z(){return{value:s,done:!0}}return A.prototype={constructor:A,reset:function(R){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(_),!R)for(var b in this)b.charAt(0)==="t"&&a.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=s)},stop:function(){this.done=!0;var R=this.tryEntries[0],b=R.completion;if(b.type==="throw")throw b.arg;return this.rval},dispatchException:function(R){if(this.done)throw R;var b=this;function F(re,ue){return H.type="throw",H.arg=R,b.next=re,ue&&(b.method="next",b.arg=s),!!ue}for(var G=this.tryEntries.length-1;G>=0;--G){var U=this.tryEntries[G],H=U.completion;if(U.tryLoc==="root")return F("end");if(U.tryLoc<=this.prev){var j=a.call(U,"catchLoc"),I=a.call(U,"finallyLoc");if(j&&I){if(this.prev<U.catchLoc)return F(U.catchLoc,!0);if(this.prev<U.finallyLoc)return F(U.finallyLoc)}else if(j){if(this.prev<U.catchLoc)return F(U.catchLoc,!0)}else if(I){if(this.prev<U.finallyLoc)return F(U.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(R,b){for(var F=this.tryEntries.length-1;F>=0;--F){var G=this.tryEntries[F];if(G.tryLoc<=this.prev&&a.call(G,"finallyLoc")&&this.prev<G.finallyLoc){var U=G;break}}U&&(R==="break"||R==="continue")&&U.tryLoc<=b&&b<=U.finallyLoc&&(U=null);var H=U?U.completion:{};return H.type=R,H.arg=b,U?(this.method="next",this.next=U.finallyLoc,S):this.complete(H)},complete:function(R,b){if(R.type==="throw")throw R.arg;return R.type==="break"||R.type==="continue"?this.next=R.arg:R.type==="return"?(this.rval=this.arg=R.arg,this.method="return",this.next="end"):R.type==="normal"&&b&&(this.next=b),S},finish:function(R){for(var b=this.tryEntries.length-1;b>=0;--b){var F=this.tryEntries[b];if(F.finallyLoc===R)return this.complete(F.completion,F.afterLoc),_(F),S}},catch:function(R){for(var b=this.tryEntries.length-1;b>=0;--b){var F=this.tryEntries[b];if(F.tryLoc===R){var G=F.completion;if(G.type==="throw"){var U=G.arg;_(F)}return U}}throw new Error("illegal catch attempt")},delegateYield:function(R,b,F){return this.delegate={iterator:W(R),resultName:b,nextLoc:F},this.method==="next"&&(this.arg=s),S}},r}(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(Mv);var Fm=Mv.exports,Um=Fm;const we=Ea(Um);function Gm(t,e){e.classHierarchy.push("vtkFramebuffer"),t.getBothMode=function(){return e.context.FRAMEBUFFER},t.saveCurrentBindingsAndBuffers=function(r){var n=typeof r<"u"?r:t.getBothMode();t.saveCurrentBindings(n),t.saveCurrentBuffers(n)},t.saveCurrentBindings=function(r){if(!e.context){P("you must set the OpenGLRenderWindow before calling saveCurrentBindings");return}var n=e.context;e.previousDrawBinding=n.getParameter(e.context.FRAMEBUFFER_BINDING),e.previousActiveFramebuffer=e._openGLRenderWindow.getActiveFramebuffer()},t.saveCurrentBuffers=function(r){},t.restorePreviousBindingsAndBuffers=function(r){var n=typeof r<"u"?r:t.getBothMode();t.restorePreviousBindings(n),t.restorePreviousBuffers(n)},t.restorePreviousBindings=function(r){if(!e.context){P("you must set the OpenGLRenderWindow before calling restorePreviousBindings");return}var n=e.context;n.bindFramebuffer(n.FRAMEBUFFER,e.previousDrawBinding),e._openGLRenderWindow.setActiveFramebuffer(e.previousActiveFramebuffer)},t.restorePreviousBuffers=function(r){},t.bind=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=r;n===null&&(n=e.context.FRAMEBUFFER),e.context.bindFramebuffer(n,e.glFramebuffer);for(var a=0;a<e.colorBuffers.length;a++)e.colorBuffers[a].bind();e._openGLRenderWindow.setActiveFramebuffer(t)},t.create=function(r,n){if(!e.context){P("you must set the OpenGLRenderWindow before calling create");return}e.glFramebuffer=e.context.createFramebuffer(),e.glFramebuffer.width=r,e.glFramebuffer.height=n},t.setColorBuffer=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=e.context;if(!a){P("you must set the OpenGLRenderWindow before calling setColorBuffer");return}var i=a.COLOR_ATTACHMENT0;if(n>0)if(e._openGLRenderWindow.getWebgl2())i+=n;else{P("Using multiple framebuffer attachments requires WebGL 2");return}e.colorBuffers[n]=r,a.framebufferTexture2D(a.FRAMEBUFFER,i,a.TEXTURE_2D,r.getHandle(),0)},t.removeColorBuffer=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=e.context;if(!n){P("you must set the OpenGLRenderWindow before calling removeColorBuffer");return}var a=n.COLOR_ATTACHMENT0;if(r>0)if(e._openGLRenderWindow.getWebgl2())a+=r;else{P("Using multiple framebuffer attachments requires WebGL 2");return}n.framebufferTexture2D(n.FRAMEBUFFER,a,n.TEXTURE_2D,null,0),e.colorBuffers=e.colorBuffers.splice(r,1)},t.setDepthBuffer=function(r){if(!e.context){P("you must set the OpenGLRenderWindow before calling setDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){var n=e.context;n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,r.getHandle(),0)}else P("Attaching depth buffer textures to fbo requires WebGL 2")},t.removeDepthBuffer=function(){if(!e.context){P("you must set the OpenGLRenderWindow before calling removeDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){var r=e.context;r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,null,0)}else P("Attaching depth buffer textures to framebuffers requires WebGL 2")},t.getGLFramebuffer=function(){return e.glFramebuffer},t.setOpenGLRenderWindow=function(r){e._openGLRenderWindow!==r&&(t.releaseGraphicsResources(),e._openGLRenderWindow=r,e.context=null,r&&(e.context=e._openGLRenderWindow.getContext()))},t.releaseGraphicsResources=function(){e.glFramebuffer&&e.context.deleteFramebuffer(e.glFramebuffer)},t.getSize=function(){var r=[0,0];return e.glFramebuffer!==null&&(r[0]=e.glFramebuffer.width,r[1]=e.glFramebuffer.height),r},t.populateFramebuffer=function(){if(!e.context){P("you must set the OpenGLRenderWindow before calling populateFrameBuffer");return}t.bind();var r=e.context,n=jt.newInstance();n.setOpenGLRenderWindow(e._openGLRenderWindow),n.setMinificationFilter(Hi.LINEAR),n.setMagnificationFilter(Hi.LINEAR),n.create2DFromRaw(e.glFramebuffer.width,e.glFramebuffer.height,4,dt.UNSIGNED_CHAR,null),t.setColorBuffer(n),e.depthTexture=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,e.depthTexture),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,e.glFramebuffer.width,e.glFramebuffer.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e.depthTexture)},t.getColorTexture=function(){return e.colorBuffers[0]}}var _m={glFramebuffer:null,colorBuffers:null,depthTexture:null,previousDrawBinding:0,previousReadBinding:0,previousDrawBuffer:0,previousReadBuffer:0,previousActiveFramebuffer:null};function Vv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_m,r),Ne(t,e),e.colorBuffers&&P("you cannot initialize colorBuffers through the constructor. You should call setColorBuffer() instead."),e.colorBuffers=[],Tn(t,e,["colorBuffers"]),Gm(t,e)}var Wm=ve(Vv,"vtkFramebuffer"),Fs={newInstance:Wm,extend:Vv};function zm(t,e){e.classHierarchy.push("vtkRenderPass"),t.getOperation=function(){return e.currentOperation},t.setCurrentOperation=function(r){e.currentOperation=r,e.currentTraverseOperation="traverse".concat(m.capitalize(e.currentOperation))},t.getTraverseOperation=function(){return e.currentTraverseOperation},t.traverse=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;e.deleted||(e._currentParent=n,e.preDelegateOperations.forEach(function(a){t.setCurrentOperation(a),r.traverse(t)}),e.delegates.forEach(function(a){a.traverse(r,t)}),e.postDelegateOperations.forEach(function(a){t.setCurrentOperation(a),r.traverse(t)}))}}var Am={delegates:[],currentOperation:null,preDelegateOperations:[],postDelegateOperations:[],currentParent:null};function Rv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Am,r),m.obj(t,e),m.get(t,e,["currentOperation"]),m.setGet(t,e,["delegates","_currentParent","preDelegateOperations","postDelegateOperations"]),m.moveToProtected(t,e,["currentParent"]),zm(t,e)}var Hm=m.newInstance(Rv,"vtkRenderPass"),Bt={newInstance:Hm,extend:Rv},$m=Tr.Representation,$u=m.vtkErrorMacro;function Pm(t){var e=k.substitute(t.Fragment,"//VTK::RenderPassFragmentShader::Impl",`
      float weight = gl_FragData[0].a * pow(max(1.1 - gl_FragCoord.z, 0.0), 2.0);
      gl_FragData[0] = vec4(gl_FragData[0].rgb*weight, gl_FragData[0].a);
      gl_FragData[1].r = weight;
    `,!1);t.Fragment=e.result}var jm=`//VTK::System::Dec

in vec2 tcoord;

uniform sampler2D translucentRTexture;
uniform sampler2D translucentRGBATexture;

// the output of this shader
//VTK::Output::Dec

void main()
{
  vec4 t1Color = texture(translucentRGBATexture, tcoord);
  float t2Color = texture(translucentRTexture, tcoord).r;
  gl_FragData[0] = vec4(t1Color.rgb/max(t2Color,0.01), 1.0 - t1Color.a);
}
`;function Km(t,e){e.classHierarchy.push("vtkOpenGLOrderIndependentTranslucentPass"),t.createVertexBuffer=function(){var r=new Float32Array([-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),n=new Float32Array([0,0,1,0,0,1,1,1]),a=new Uint16Array([4,0,1,3,2]),i=ge.newInstance({numberOfComponents:3,values:r});i.setName("points");var s=ge.newInstance({numberOfComponents:2,values:n});s.setName("tcoords");var o=ge.newInstance({numberOfComponents:1,values:a});e.tris.getCABO().createVBO(o,"polys",$m.SURFACE,{points:i,tcoords:s,cellOffset:0}),e.VBOBuildTime.modified()},t.createFramebuffer=function(r){var n,a=r.getSize(),i=r.getContext();e.framebuffer=Fs.newInstance(),e.framebuffer.setOpenGLRenderWindow(r),(n=e.framebuffer).create.apply(n,Y(a)),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind(),e.translucentRGBATexture=jt.newInstance(),e.translucentRGBATexture.setInternalFormat(i.RGBA16F),e.translucentRGBATexture.setFormat(i.RGBA),e.translucentRGBATexture.setOpenGLDataType(i.HALF_FLOAT),e.translucentRGBATexture.setOpenGLRenderWindow(r),e.translucentRGBATexture.create2DFromRaw(a[0],a[1],4,"Float32Array",null),e.translucentRTexture=jt.newInstance(),e.translucentRTexture.setInternalFormat(i.R16F),e.translucentRTexture.setFormat(i.RED),e.translucentRTexture.setOpenGLDataType(i.HALF_FLOAT),e.translucentRTexture.setOpenGLRenderWindow(r),e.translucentRTexture.create2DFromRaw(a[0],a[1],1,"Float32Array",null),e.translucentZTexture=jt.newInstance(),e.translucentZTexture.setOpenGLRenderWindow(r),e.translucentZTexture.createDepthFromRaw(a[0],a[1],"Float32Array",null),e.framebuffer.setColorBuffer(e.translucentRGBATexture,0),e.framebuffer.setColorBuffer(e.translucentRTexture,1),e.framebuffer.setDepthBuffer(e.translucentZTexture)},t.createCopyShader=function(r){e.copyShader=r.getShaderCache().readyShaderProgramArray(["//VTK::System::Dec","attribute vec4 vertexDC;","attribute vec2 tcoordTC;","varying vec2 tcoord;","void main() { tcoord = tcoordTC; gl_Position = vertexDC; }"].join(`
`),jm,"")},t.createVBO=function(r){var n=r.getContext();e.tris.setOpenGLRenderWindow(r),t.createVertexBuffer();var a=e.copyShader;e.tris.getCABO().bind(),e.copyVAO.addAttributeArray(a,e.tris.getCABO(),"vertexDC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),n.FLOAT,3,n.FALSE)||$u("Error setting vertexDC in copy shader VAO."),e.copyVAO.addAttributeArray(a,e.tris.getCABO(),"tcoordTC",e.tris.getCABO().getTCoordOffset(),e.tris.getCABO().getStride(),n.FLOAT,2,n.FALSE)||$u("Error setting vertexDC in copy shader VAO.")},t.traverse=function(r,n,a){if(!e.deleted){var i=r.getSize(),s=r.getContext();if(e._supported=!1,n.getSelector()||!s||!r.getWebgl2()||!s.getExtension("EXT_color_buffer_half_float")&&!s.getExtension("EXT_color_buffer_float")){t.setCurrentOperation("translucentPass"),n.traverse(t);return}if(e._supported=!0,e.framebuffer===null)t.createFramebuffer(r);else{var o=e.framebuffer.getSize();o===null||o[0]!==i[0]||o[1]!==i[1]?(e.framebuffer.releaseGraphicsResources(),e.translucentRGBATexture.releaseGraphicsResources(r),e.translucentRTexture.releaseGraphicsResources(r),e.translucentZTexture.releaseGraphicsResources(r),t.createFramebuffer(r)):(e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind())}s.drawBuffers([s.COLOR_ATTACHMENT0]),s.clearBufferfv(s.COLOR,0,[0,0,0,0]),s.clearBufferfv(s.DEPTH,0,[1]),s.colorMask(!1,!1,!1,!1),a.getOpaqueActorCount()>0&&(a.setCurrentOperation("opaqueZBufferPass"),n.traverse(a)),s.colorMask(!0,!0,!0,!0),s.drawBuffers([s.COLOR_ATTACHMENT0,s.COLOR_ATTACHMENT1]),s.viewport(0,0,i[0],i[1]),s.scissor(0,0,i[0],i[1]),s.clearBufferfv(s.COLOR,0,[0,0,0,1]),s.clearBufferfv(s.COLOR,1,[0,0,0,0]),s.enable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFuncSeparate(s.ONE,s.ONE,s.ZERO,s.ONE_MINUS_SRC_ALPHA),t.setCurrentOperation("translucentPass"),n.traverse(t),s.drawBuffers([s.NONE]),e.framebuffer.restorePreviousBindingsAndBuffers(),e.copyShader===null?t.createCopyShader(r):r.getShaderCache().readyShaderProgram(e.copyShader),e.copyVAO||(e.copyVAO=Bg.newInstance(),e.copyVAO.setOpenGLRenderWindow(r)),e.copyVAO.bind(),e.VBOBuildTime.getMTime()<t.getMTime()&&t.createVBO(r),s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA),s.depthMask(!1),s.depthFunc(s.ALWAYS),s.viewport(0,0,i[0],i[1]),s.scissor(0,0,i[0],i[1]),e.translucentRGBATexture.activate(),e.copyShader.setUniformi("translucentRGBATexture",e.translucentRGBATexture.getTextureUnit()),e.translucentRTexture.activate(),e.copyShader.setUniformi("translucentRTexture",e.translucentRTexture.getTextureUnit()),s.drawArrays(s.TRIANGLES,0,e.tris.getCABO().getElementCount()),s.depthMask(!0),s.depthFunc(s.LEQUAL),e.translucentRGBATexture.deactivate(),e.translucentRTexture.deactivate()}},t.getShaderReplacement=function(){return e._supported?Pm:null},t.releaseGraphicsResources=function(r){e.framebuffer&&(e.framebuffer.releaseGraphicsResources(r),e.framebuffer=null),e.translucentRGBATexture&&(e.translucentRGBATexture.releaseGraphicsResources(r),e.translucentRGBATexture=null),e.translucentRTexture&&(e.translucentRTexture.releaseGraphicsResources(r),e.translucentRTexture=null),e.translucentZTexture&&(e.translucentZTexture.releaseGraphicsResources(r),e.translucentZTexture=null),e.copyVAO&&(e.copyVAO.releaseGraphicsResources(r),e.copyVAO=null),e.copyShader&&(e.copyShader.releaseGraphicsResources(r),e.copyShader=null),e.tris&&(e.tris.releaseGraphicsResources(r),e.tris=null),t.modified()}}var Xm={framebuffer:null,copyShader:null,tris:null};function bv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Xm,r),Bt.extend(t,e,r),e.VBOBuildTime={},m.obj(e.VBOBuildTime,{mtime:0}),e.tris=Kr.newInstance(),m.get(t,e,["framebuffer"]),Km(t,e)}var Ym=m.newInstance(bv,"vtkOpenGLOrderIndependentTranslucentPass"),qm={newInstance:Ym,extend:bv};function Qm(t,e){e.classHierarchy.push("vtkForwardPass"),t.traverse=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!e.deleted){e._currentParent=n,t.setCurrentOperation("buildPass"),r.traverse(t);for(var a=r.getRenderable().getNumberOfLayers(),i=r.getChildren(),s=0;s<a;s++)for(var o=0;o<i.length;o++){var u=i[o],c=r.getRenderable().getRenderers()[o];if(c.getDraw()&&c.getLayer()===s){if(e.opaqueActorCount=0,e.translucentActorCount=0,e.volumeCount=0,e.overlayActorCount=0,t.setCurrentOperation("queryPass"),u.traverse(t),(e.opaqueActorCount>0||e.translucentActorCount>0)&&e.volumeCount>0||e.depthRequested){var f=r.getFramebufferSize();e.framebuffer===null&&(e.framebuffer=Fs.newInstance()),e.framebuffer.setOpenGLRenderWindow(r),e.framebuffer.saveCurrentBindingsAndBuffers();var g=e.framebuffer.getSize();(g===null||g[0]!==f[0]||g[1]!==f[1])&&(e.framebuffer.create(f[0],f[1]),e.framebuffer.populateFramebuffer()),e.framebuffer.bind(),t.setCurrentOperation("zBufferPass"),u.traverse(t),e.framebuffer.restorePreviousBindingsAndBuffers(),e.depthRequested=!1}t.setCurrentOperation("cameraPass"),u.traverse(t),e.opaqueActorCount>0&&(t.setCurrentOperation("opaquePass"),u.traverse(t)),e.translucentActorCount>0&&(e.translucentPass||(e.translucentPass=qm.newInstance()),e.translucentPass.traverse(r,u,t)),e.volumeCount>0&&(t.setCurrentOperation("volumePass"),u.traverse(t)),e.overlayActorCount>0&&(t.setCurrentOperation("overlayPass"),u.traverse(t))}}}},t.getZBufferTexture=function(){return e.framebuffer?e.framebuffer.getColorTexture():null},t.requestDepth=function(){e.depthRequested=!0},t.incrementOpaqueActorCount=function(){return e.opaqueActorCount++},t.incrementTranslucentActorCount=function(){return e.translucentActorCount++},t.incrementVolumeCount=function(){return e.volumeCount++},t.incrementOverlayActorCount=function(){return e.overlayActorCount++}}var Zm={opaqueActorCount:0,translucentActorCount:0,volumeCount:0,overlayActorCount:0,framebuffer:null,depthRequested:!1};function Lv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Zm,r),Bt.extend(t,e,r),m.get(t,e,["framebuffer","opaqueActorCount","translucentActorCount","volumeCount"]),Qm(t,e)}var Im=m.newInstance(Lv,"vtkForwardPass"),Jm={newInstance:Im,extend:Lv},ew=Cr.FieldAssociations;function tw(t,e){e.classHierarchy.push("vtkHardwareSelector"),t.getSourceDataAsync=function(){var r=St(we.mark(function n(a,i,s,o,u){return we.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:case"end":return f.stop()}},n)}));return function(n,a,i,s,o){return r.apply(this,arguments)}}(),t.selectAsync=function(){var r=St(we.mark(function n(a,i,s,o,u){var c;return we.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,t.getSourceDataAsync(a,i,s,o,u);case 2:if(c=g.sent,!c){g.next=5;break}return g.abrupt("return",c.generateSelection(i,s,o,u));case 5:return g.abrupt("return",[]);case 6:case"end":return g.stop()}},n)}));return function(n,a,i,s,o){return r.apply(this,arguments)}}()}var rw={fieldAssociation:ew.FIELD_ASSOCIATION_CELLS,captureZValues:!1};function Bv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rw,r),m.obj(t,e),m.setGet(t,e,["fieldAssociation","captureZValues"]),tw(t,e)}var nw=m.newInstance(Bv,"vtkHardwareSelector"),kv={newInstance:nw,extend:Bv},aw={GLOBALIDS:0,PEDIGREEIDS:1,VALUES:2,INDICES:3,FRUSTUM:4,LOCATIONS:5,THRESHOLDS:6,BLOCKS:7,QUERY:8},iw={CELL:0,POINT:1,FIELD:2,VERTEX:3,EDGE:4,ROW:5},sw={SelectionContent:aw,SelectionField:iw};function Pu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ow(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Pu(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Pu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function uw(t,e){e.classHierarchy.push("vtkSelectionNode"),t.getBounds=function(){return e.points.getBounds()}}var fw={contentType:-1,fieldType:-1,properties:null,selectionList:[]};function Nv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fw,r),m.obj(t,e),e.properties={},m.setGet(t,e,["contentType","fieldType","properties","selectionList"]),uw(t,e)}var cw=m.newInstance(Nv,"vtkSelectionNode"),Xr=ow({newInstance:cw,extend:Nv},sw);function ju(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function gw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ju(Object(r),!0).forEach(function(n){ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ju(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Oe=ug.PassTypes,vw=Xr.SelectionContent,Ku=Xr.SelectionField,un=Cr.FieldAssociations,Fv=m.vtkErrorMacro,Ht=1;function Uv(t){return"".concat(t.propID," ").concat(t.compositeID)}function Gv(t,e,r,n){if(!r)return 0;var a=(e*(n[2]-n[0]+1)+t)*4;return r[a+3]}function Mt(t,e,r,n){if(!r)return 0;var a=(e*(n[2]-n[0]+1)+t)*4,i=r[a],s=r[a+1],o=r[a+2];return(o*256+s)*256+i}function _v(t,e){var r=e;return r<<=24,r|=t,r}function br(t,e,r,n){var a=r<0?0:r;if(a===0){if(n[0]=e[0],n[1]=e[1],e[0]<t.area[0]||e[0]>t.area[2]||e[1]<t.area[1]||e[1]>t.area[3])return null;var i=[e[0]-t.area[0],e[1]-t.area[1]],s=Mt(i[0],i[1],t.pixBuffer[Oe.ACTOR_PASS],t.area);if(s<=0||s-Ht>=t.props.length)return null;var o={};o.valid=!0,o.propID=s-Ht,o.prop=t.props[o.propID];var u=Mt(i[0],i[1],t.pixBuffer[Oe.COMPOSITE_INDEX_PASS],t.area);if((u<0||u>16777215)&&(u=0),o.compositeID=u-Ht,t.captureZValues){var c=(i[1]*(t.area[2]-t.area[0]+1)+i[0])*4;o.zValue=(256*t.zBuffer[c]+t.zBuffer[c+1])/65535,o.displayPosition=e}if(t.pixBuffer[Oe.ID_LOW24]&&Gv(i[0],i[1],t.pixBuffer[Oe.ID_LOW24],t.area)===0)return o;var f=Mt(i[0],i[1],t.pixBuffer[Oe.ID_LOW24],t.area),g=Mt(i[0],i[1],t.pixBuffer[Oe.ID_HIGH24],t.area);return o.attributeID=_v(f,g),o}var v=[e[0],e[1]],p=[0,0],l=br(t,e,0,n);if(l&&l.valid)return l;for(var y=1;y<a;++y){for(var h=v[1]>y?v[1]-y:0;h<=v[1]+y;++h)if(p[1]=h,v[0]>=y&&(p[0]=v[0]-y,l=br(t,p,0,n),l&&l.valid)||(p[0]=v[0]+y,l=br(t,p,0,n),l&&l.valid))return l;for(var d=v[0]>=y?v[0]-(y-1):0;d<=v[0]+(y-1);++d)if(p[0]=d,v[1]>=y&&(p[1]=v[1]-y,l=br(t,p,0,n),l&&l.valid)||(p[1]=v[1]+y,l=br(t,p,0,n),l&&l.valid))return l}return n[0]=e[0],n[1]=e[1],null}function Wv(t,e,r,n,a){var i=[],s=0;return e.forEach(function(o,u){var c=Xr.newInstance();switch(c.setContentType(vw.INDICES),t){case un.FIELD_ASSOCIATION_CELLS:c.setFieldType(Ku.CELL);break;case un.FIELD_ASSOCIATION_POINTS:c.setFieldType(Ku.POINT);break;default:Fv("Unknown field association")}c.getProperties().propID=o.info.propID,c.getProperties().prop=o.info.prop,c.getProperties().compositeID=o.info.compositeID,c.getProperties().attributeID=o.info.attributeID,c.getProperties().pixelCount=o.pixelCount,r&&(c.getProperties().displayPosition=[o.info.displayPosition[0],o.info.displayPosition[1],o.info.zValue],c.getProperties().worldPosition=a.displayToWorld(o.info.displayPosition[0],o.info.displayPosition[1],o.info.zValue,n)),c.setSelectionList(o.attributeIDs),i[s]=c,s++}),i}function pw(t,e,r,n,a){for(var i=Math.floor(e),s=Math.floor(r),o=Math.floor(n),u=Math.floor(a),c=new Map,f=[0,0],g=s;g<=u;g++)for(var v=i;v<=o;v++){var p=[v,g],l=br(t,p,0,f);if(l&&l.valid){var y=Uv(l);if(!c.has(y))c.set(y,{info:l,pixelCount:1,attributeIDs:[l.attributeID]});else{var h=c.get(y);h.pixelCount++,t.captureZValues&&l.zValue<h.info.zValue&&(h.info=l),h.attributeIDs.indexOf(l.attributeID)===-1&&h.attributeIDs.push(l.attributeID)}}}return Wv(t.fieldAssociation,c,t.captureZValues,t.renderer,t.openGLRenderWindow)}function lw(t,e){e.classHierarchy.push("vtkOpenGLHardwareSelector"),t.releasePixBuffers=function(){e.rawPixBuffer=[],e.pixBuffer=[],e.zBuffer=null},t.beginSelection=function(){e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer),e.maxAttributeId=0;var n=e._openGLRenderWindow.getSize();if(!e.framebuffer)e.framebuffer=Fs.newInstance(),e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.create(n[0],n[1]),e.framebuffer.populateFramebuffer();else{e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers();var a=e.framebuffer.getSize();a[0]!==n[0]||a[1]!==n[1]?(e.framebuffer.create(n[0],n[1]),e.framebuffer.populateFramebuffer()):e.framebuffer.bind()}if(e._openGLRenderer.clear(),e._openGLRenderer.setSelector(t),e.hitProps={},e.propPixels={},e.props=[],t.releasePixBuffers(),e.fieldAssociation===un.FIELD_ASSOCIATION_POINTS){var i=e._openGLRenderWindow.getContext(),s=i.isEnabled(i.BLEND);i.disable(i.BLEND),e._openGLRenderWindow.traverseAllPasses(),s&&i.enable(i.BLEND)}},t.endSelection=function(){e.hitProps={},e._openGLRenderer.setSelector(null),e.framebuffer.restorePreviousBindingsAndBuffers()},t.preCapturePass=function(){var n=e._openGLRenderWindow.getContext();e.originalBlending=n.isEnabled(n.BLEND),n.disable(n.BLEND)},t.postCapturePass=function(){var n=e._openGLRenderWindow.getContext();e.originalBlending&&n.enable(n.BLEND)},t.select=function(){var n=null;return t.captureBuffers()&&(n=t.generateSelection(e.area[0],e.area[1],e.area[2],e.area[3]),t.releasePixBuffers()),n},t.getSourceDataAsync=function(){var n=St(we.mark(function a(i,s,o,u,c){var f,g;return we.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(e._renderer=i,s===void 0?(f=e._openGLRenderWindow.getSize(),t.setArea(0,0,f[0]-1,f[1]-1)):t.setArea(s,o,u,c),t.captureBuffers()){p.next=4;break}return p.abrupt("return",!1);case 4:return g={area:Y(e.area),pixBuffer:Y(e.pixBuffer),captureZValues:e.captureZValues,zBuffer:e.zBuffer,props:Y(e.props),fieldAssociation:e.fieldAssociation,renderer:i,openGLRenderWindow:e._openGLRenderWindow},g.generateSelection=function(){for(var l=arguments.length,y=new Array(l),h=0;h<l;h++)y[h]=arguments[h];return pw.apply(void 0,[g].concat(y))},p.abrupt("return",g);case 7:case"end":return p.stop()}},a)}));return function(a,i,s,o,u){return n.apply(this,arguments)}}(),t.captureBuffers=function(){if(!e._renderer||!e._openGLRenderWindow)return Fv("Renderer and view must be set before calling Select."),!1;e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer),e._openGLRenderWindow.getRenderable().preRender(),t.invokeEvent({type:"StartEvent"}),e.originalBackground=e._renderer.getBackgroundByReference(),e._renderer.setBackground(0,0,0,0);var n=e._openGLRenderWindow.getRenderPasses();for(t.beginSelection(),e.currentPass=Oe.MIN_KNOWN_PASS;e.currentPass<=Oe.MAX_KNOWN_PASS;e.currentPass++)t.passRequired(e.currentPass)&&(t.preCapturePass(e.currentPass),e.captureZValues&&e.currentPass===Oe.ACTOR_PASS&&typeof n[0].requestDepth=="function"&&typeof n[0].getFramebuffer=="function"&&n[0].requestDepth(),e._openGLRenderWindow.traverseAllPasses(),t.postCapturePass(e.currentPass),t.savePixelBuffer(e.currentPass),t.processPixelBuffers());return t.endSelection(),e._renderer.setBackground(e.originalBackground),t.invokeEvent({type:"EndEvent"}),!0},t.processPixelBuffers=function(){e.props.forEach(function(n,a){t.isPropHit(a)&&n.processSelectorPixelBuffers(t,e.propPixels[a])})},t.passRequired=function(n){if(n===Oe.ID_HIGH24){if(e.fieldAssociation===un.FIELD_ASSOCIATION_POINTS)return e.maximumPointId>16777215;if(e.fieldAssociation===un.FIELD_ASSOCIATION_CELLS)return e.maximumCellId>16777215}return!0},t.savePixelBuffer=function(n){if(e.pixBuffer[n]=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),!e.rawPixBuffer[n]){var a=(e.area[2]-e.area[0]+1)*(e.area[3]-e.area[1]+1)*4;e.rawPixBuffer[n]=new Uint8Array(a),e.rawPixBuffer[n].set(e.pixBuffer[n])}if(n===Oe.ACTOR_PASS){if(e.captureZValues){var i=e._openGLRenderWindow.getRenderPasses();if(typeof i[0].requestDepth=="function"&&typeof i[0].getFramebuffer=="function"){var s=i[0].getFramebuffer();s.saveCurrentBindingsAndBuffers(),s.bind(),e.zBuffer=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),s.restorePreviousBindingsAndBuffers()}}t.buildPropHitList(e.rawPixBuffer[n])}},t.buildPropHitList=function(n){for(var a=0,i=0;i<=e.area[3]-e.area[1];i++)for(var s=0;s<=e.area[2]-e.area[0];s++){var o=Mt(s,i,n,e.area);o>0&&(o--,o in e.hitProps||(e.hitProps[o]=!0,e.propPixels[o]=[]),e.propPixels[o].push(a*4)),++a}},t.renderProp=function(n){e.currentPass===Oe.ACTOR_PASS&&(t.setPropColorValueFromInt(e.props.length+Ht),e.props.push(n))},t.renderCompositeIndex=function(n){e.currentPass===Oe.COMPOSITE_INDEX_PASS&&t.setPropColorValueFromInt(n+Ht)},t.renderAttributeId=function(n){n<0||(e.maxAttributeId=n>e.maxAttributeId?n:e.maxAttributeId)},t.passTypeToString=function(n){return m.enumToString(Oe,n)},t.isPropHit=function(n){return!!e.hitProps[n]},t.setPropColorValueFromInt=function(n){e.propColorValue[0]=n%256/255,e.propColorValue[1]=Math.floor(n/256)%256/255,e.propColorValue[2]=Math.floor(n/65536)%256/255},t.getPixelInformation=function(n,a,i){var s=a<0?0:a;if(s===0){if(i[0]=n[0],i[1]=n[1],n[0]<e.area[0]||n[0]>e.area[2]||n[1]<e.area[1]||n[1]>e.area[3])return null;var o=[n[0]-e.area[0],n[1]-e.area[1]],u=Mt(o[0],o[1],e.pixBuffer[Oe.ACTOR_PASS],e.area);if(u<=0||u-Ht>=e.props.length)return null;var c={};c.valid=!0,c.propID=u-Ht,c.prop=e.props[c.propID];var f=Mt(o[0],o[1],e.pixBuffer[Oe.COMPOSITE_INDEX_PASS],e.area);if((f<0||f>16777215)&&(f=0),c.compositeID=f-Ht,e.captureZValues){var g=(o[1]*(e.area[2]-e.area[0]+1)+o[0])*4;c.zValue=(256*e.zBuffer[g]+e.zBuffer[g+1])/65535,c.displayPosition=n}if(e.pixBuffer[Oe.ID_LOW24]&&Gv(o[0],o[1],e.pixBuffer[Oe.ID_LOW24],e.area)===0)return c;var v=Mt(o[0],o[1],e.pixBuffer[Oe.ID_LOW24],e.area),p=Mt(o[0],o[1],e.pixBuffer[Oe.ID_HIGH24],e.area);return c.attributeID=_v(v,p),c}var l=[n[0],n[1]],y=[0,0],h=t.getPixelInformation(n,0,i);if(h&&h.valid)return h;for(var d=1;d<s;++d){for(var S=l[1]>d?l[1]-d:0;S<=l[1]+d;++S)if(y[1]=S,l[0]>=d&&(y[0]=l[0]-d,h=t.getPixelInformation(y,0,i),h&&h.valid)||(y[0]=l[0]+d,h=t.getPixelInformation(y,0,i),h&&h.valid))return h;for(var T=l[0]>=d?l[0]-(d-1):0;T<=l[0]+(d-1);++T)if(y[0]=T,l[1]>=d&&(y[1]=l[1]-d,h=t.getPixelInformation(y,0,i),h&&h.valid)||(y[1]=l[1]+d,h=t.getPixelInformation(y,0,i),h&&h.valid))return h}return i[0]=n[0],i[1]=n[1],null},t.generateSelection=function(n,a,i,s){for(var o=Math.floor(n),u=Math.floor(a),c=Math.floor(i),f=Math.floor(s),g=new Map,v=[0,0],p=u;p<=f;p++)for(var l=o;l<=c;l++){var y=[l,p],h=t.getPixelInformation(y,0,v);if(h&&h.valid){var d=Uv(h);if(!g.has(d))g.set(d,{info:h,pixelCount:1,attributeIDs:[h.attributeID]});else{var S=g.get(d);S.pixelCount++,e.captureZValues&&h.zValue<S.info.zValue&&(S.info=h),S.attributeIDs.indexOf(h.attributeID)===-1&&S.attributeIDs.push(h.attributeID)}}}return Wv(e.fieldAssociation,g,e.captureZValues,e._renderer,e._openGLRenderWindow)},t.getRawPixelBuffer=function(n){return e.rawPixBuffer[n]},t.getPixelBuffer=function(n){return e.pixBuffer[n]},t.attach=function(n,a){e._openGLRenderWindow=n,e._renderer=a};var r=t.setArea;t.setArea=function(){return r.apply(void 0,arguments)?(e.area[0]=Math.floor(e.area[0]),e.area[1]=Math.floor(e.area[1]),e.area[2]=Math.floor(e.area[2]),e.area[3]=Math.floor(e.area[3]),!0):!1}}var hw={area:void 0,currentPass:-1,propColorValue:null,props:null,maximumPointId:0,maximumCellId:0,idOffset:1};function zv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,hw,r),kv.extend(t,e,r),e.propColorValue=[0,0,0],e.props=[],e.area||(e.area=[0,0,0,0]),m.setGetArray(t,e,["area"],4),m.setGet(t,e,["_renderer","currentPass","_openGLRenderWindow","maximumPointId","maximumCellId"]),m.setGetArray(t,e,["propColorValue"],3),m.moveToProtected(t,e,["renderer","openGLRenderWindow"]),m.event(t,e,"event"),lw(t,e)}var yw=m.newInstance(zv,"vtkOpenGLHardwareSelector"),Av=gw({newInstance:yw,extend:zv},ug),Hv={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(r){var n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function a(d,S){var T=d[0],C=d[1],x=d[2],O=d[3];T+=(C&x|~C&O)+S[0]-680876936|0,T=(T<<7|T>>>25)+C|0,O+=(T&C|~T&x)+S[1]-389564586|0,O=(O<<12|O>>>20)+T|0,x+=(O&T|~O&C)+S[2]+606105819|0,x=(x<<17|x>>>15)+O|0,C+=(x&O|~x&T)+S[3]-1044525330|0,C=(C<<22|C>>>10)+x|0,T+=(C&x|~C&O)+S[4]-176418897|0,T=(T<<7|T>>>25)+C|0,O+=(T&C|~T&x)+S[5]+1200080426|0,O=(O<<12|O>>>20)+T|0,x+=(O&T|~O&C)+S[6]-1473231341|0,x=(x<<17|x>>>15)+O|0,C+=(x&O|~x&T)+S[7]-45705983|0,C=(C<<22|C>>>10)+x|0,T+=(C&x|~C&O)+S[8]+1770035416|0,T=(T<<7|T>>>25)+C|0,O+=(T&C|~T&x)+S[9]-1958414417|0,O=(O<<12|O>>>20)+T|0,x+=(O&T|~O&C)+S[10]-42063|0,x=(x<<17|x>>>15)+O|0,C+=(x&O|~x&T)+S[11]-1990404162|0,C=(C<<22|C>>>10)+x|0,T+=(C&x|~C&O)+S[12]+1804603682|0,T=(T<<7|T>>>25)+C|0,O+=(T&C|~T&x)+S[13]-40341101|0,O=(O<<12|O>>>20)+T|0,x+=(O&T|~O&C)+S[14]-1502002290|0,x=(x<<17|x>>>15)+O|0,C+=(x&O|~x&T)+S[15]+1236535329|0,C=(C<<22|C>>>10)+x|0,T+=(C&O|x&~O)+S[1]-165796510|0,T=(T<<5|T>>>27)+C|0,O+=(T&x|C&~x)+S[6]-1069501632|0,O=(O<<9|O>>>23)+T|0,x+=(O&C|T&~C)+S[11]+643717713|0,x=(x<<14|x>>>18)+O|0,C+=(x&T|O&~T)+S[0]-373897302|0,C=(C<<20|C>>>12)+x|0,T+=(C&O|x&~O)+S[5]-701558691|0,T=(T<<5|T>>>27)+C|0,O+=(T&x|C&~x)+S[10]+38016083|0,O=(O<<9|O>>>23)+T|0,x+=(O&C|T&~C)+S[15]-660478335|0,x=(x<<14|x>>>18)+O|0,C+=(x&T|O&~T)+S[4]-405537848|0,C=(C<<20|C>>>12)+x|0,T+=(C&O|x&~O)+S[9]+568446438|0,T=(T<<5|T>>>27)+C|0,O+=(T&x|C&~x)+S[14]-1019803690|0,O=(O<<9|O>>>23)+T|0,x+=(O&C|T&~C)+S[3]-187363961|0,x=(x<<14|x>>>18)+O|0,C+=(x&T|O&~T)+S[8]+1163531501|0,C=(C<<20|C>>>12)+x|0,T+=(C&O|x&~O)+S[13]-1444681467|0,T=(T<<5|T>>>27)+C|0,O+=(T&x|C&~x)+S[2]-51403784|0,O=(O<<9|O>>>23)+T|0,x+=(O&C|T&~C)+S[7]+1735328473|0,x=(x<<14|x>>>18)+O|0,C+=(x&T|O&~T)+S[12]-1926607734|0,C=(C<<20|C>>>12)+x|0,T+=(C^x^O)+S[5]-378558|0,T=(T<<4|T>>>28)+C|0,O+=(T^C^x)+S[8]-2022574463|0,O=(O<<11|O>>>21)+T|0,x+=(O^T^C)+S[11]+1839030562|0,x=(x<<16|x>>>16)+O|0,C+=(x^O^T)+S[14]-35309556|0,C=(C<<23|C>>>9)+x|0,T+=(C^x^O)+S[1]-1530992060|0,T=(T<<4|T>>>28)+C|0,O+=(T^C^x)+S[4]+1272893353|0,O=(O<<11|O>>>21)+T|0,x+=(O^T^C)+S[7]-155497632|0,x=(x<<16|x>>>16)+O|0,C+=(x^O^T)+S[10]-1094730640|0,C=(C<<23|C>>>9)+x|0,T+=(C^x^O)+S[13]+681279174|0,T=(T<<4|T>>>28)+C|0,O+=(T^C^x)+S[0]-358537222|0,O=(O<<11|O>>>21)+T|0,x+=(O^T^C)+S[3]-722521979|0,x=(x<<16|x>>>16)+O|0,C+=(x^O^T)+S[6]+76029189|0,C=(C<<23|C>>>9)+x|0,T+=(C^x^O)+S[9]-640364487|0,T=(T<<4|T>>>28)+C|0,O+=(T^C^x)+S[12]-421815835|0,O=(O<<11|O>>>21)+T|0,x+=(O^T^C)+S[15]+530742520|0,x=(x<<16|x>>>16)+O|0,C+=(x^O^T)+S[2]-995338651|0,C=(C<<23|C>>>9)+x|0,T+=(x^(C|~O))+S[0]-198630844|0,T=(T<<6|T>>>26)+C|0,O+=(C^(T|~x))+S[7]+1126891415|0,O=(O<<10|O>>>22)+T|0,x+=(T^(O|~C))+S[14]-1416354905|0,x=(x<<15|x>>>17)+O|0,C+=(O^(x|~T))+S[5]-57434055|0,C=(C<<21|C>>>11)+x|0,T+=(x^(C|~O))+S[12]+1700485571|0,T=(T<<6|T>>>26)+C|0,O+=(C^(T|~x))+S[3]-1894986606|0,O=(O<<10|O>>>22)+T|0,x+=(T^(O|~C))+S[10]-1051523|0,x=(x<<15|x>>>17)+O|0,C+=(O^(x|~T))+S[1]-2054922799|0,C=(C<<21|C>>>11)+x|0,T+=(x^(C|~O))+S[8]+1873313359|0,T=(T<<6|T>>>26)+C|0,O+=(C^(T|~x))+S[15]-30611744|0,O=(O<<10|O>>>22)+T|0,x+=(T^(O|~C))+S[6]-1560198380|0,x=(x<<15|x>>>17)+O|0,C+=(O^(x|~T))+S[13]+1309151649|0,C=(C<<21|C>>>11)+x|0,T+=(x^(C|~O))+S[4]-145523070|0,T=(T<<6|T>>>26)+C|0,O+=(C^(T|~x))+S[11]-1120210379|0,O=(O<<10|O>>>22)+T|0,x+=(T^(O|~C))+S[2]+718787259|0,x=(x<<15|x>>>17)+O|0,C+=(O^(x|~T))+S[9]-343485551|0,C=(C<<21|C>>>11)+x|0,d[0]=T+d[0]|0,d[1]=C+d[1]|0,d[2]=x+d[2]|0,d[3]=O+d[3]|0}function i(d){var S=[],T;for(T=0;T<64;T+=4)S[T>>2]=d.charCodeAt(T)+(d.charCodeAt(T+1)<<8)+(d.charCodeAt(T+2)<<16)+(d.charCodeAt(T+3)<<24);return S}function s(d){var S=[],T;for(T=0;T<64;T+=4)S[T>>2]=d[T]+(d[T+1]<<8)+(d[T+2]<<16)+(d[T+3]<<24);return S}function o(d){var S=d.length,T=[1732584193,-271733879,-1732584194,271733878],C,x,O,w,E,V;for(C=64;C<=S;C+=64)a(T,i(d.substring(C-64,C)));for(d=d.substring(C-64),x=d.length,O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],C=0;C<x;C+=1)O[C>>2]|=d.charCodeAt(C)<<(C%4<<3);if(O[C>>2]|=128<<(C%4<<3),C>55)for(a(T,O),C=0;C<16;C+=1)O[C]=0;return w=S*8,w=w.toString(16).match(/(.*?)(.{0,8})$/),E=parseInt(w[2],16),V=parseInt(w[1],16)||0,O[14]=E,O[15]=V,a(T,O),T}function u(d){var S=d.length,T=[1732584193,-271733879,-1732584194,271733878],C,x,O,w,E,V;for(C=64;C<=S;C+=64)a(T,s(d.subarray(C-64,C)));for(d=C-64<S?d.subarray(C-64):new Uint8Array(0),x=d.length,O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],C=0;C<x;C+=1)O[C>>2]|=d[C]<<(C%4<<3);if(O[C>>2]|=128<<(C%4<<3),C>55)for(a(T,O),C=0;C<16;C+=1)O[C]=0;return w=S*8,w=w.toString(16).match(/(.*?)(.{0,8})$/),E=parseInt(w[2],16),V=parseInt(w[1],16)||0,O[14]=E,O[15]=V,a(T,O),T}function c(d){var S="",T;for(T=0;T<4;T+=1)S+=n[d>>T*8+4&15]+n[d>>T*8&15];return S}function f(d){var S;for(S=0;S<d.length;S+=1)d[S]=c(d[S]);return d.join("")}f(o("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function d(S,T){return S=S|0||0,S<0?Math.max(S+T,0):Math.min(S,T)}ArrayBuffer.prototype.slice=function(S,T){var C=this.byteLength,x=d(S,C),O=C,w,E,V,D;return T!==r&&(O=d(T,C)),x>O?new ArrayBuffer(0):(w=O-x,E=new ArrayBuffer(w),V=new Uint8Array(E),D=new Uint8Array(this,x,w),V.set(D),E)}}();function g(d){return/[\u0080-\uFFFF]/.test(d)&&(d=unescape(encodeURIComponent(d))),d}function v(d,S){var T=d.length,C=new ArrayBuffer(T),x=new Uint8Array(C),O;for(O=0;O<T;O+=1)x[O]=d.charCodeAt(O);return S?x:C}function p(d){return String.fromCharCode.apply(null,new Uint8Array(d))}function l(d,S,T){var C=new Uint8Array(d.byteLength+S.byteLength);return C.set(new Uint8Array(d)),C.set(new Uint8Array(S),d.byteLength),T?C:C.buffer}function y(d){var S=[],T=d.length,C;for(C=0;C<T-1;C+=2)S.push(parseInt(d.substr(C,2),16));return String.fromCharCode.apply(String,S)}function h(){this.reset()}return h.prototype.append=function(d){return this.appendBinary(g(d)),this},h.prototype.appendBinary=function(d){this._buff+=d,this._length+=d.length;var S=this._buff.length,T;for(T=64;T<=S;T+=64)a(this._hash,i(this._buff.substring(T-64,T)));return this._buff=this._buff.substring(T-64),this},h.prototype.end=function(d){var S=this._buff,T=S.length,C,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],O;for(C=0;C<T;C+=1)x[C>>2]|=S.charCodeAt(C)<<(C%4<<3);return this._finish(x,T),O=f(this._hash),d&&(O=y(O)),this.reset(),O},h.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},h.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},h.prototype.setState=function(d){return this._buff=d.buff,this._length=d.length,this._hash=d.hash,this},h.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},h.prototype._finish=function(d,S){var T=S,C,x,O;if(d[T>>2]|=128<<(T%4<<3),T>55)for(a(this._hash,d),T=0;T<16;T+=1)d[T]=0;C=this._length*8,C=C.toString(16).match(/(.*?)(.{0,8})$/),x=parseInt(C[2],16),O=parseInt(C[1],16)||0,d[14]=x,d[15]=O,a(this._hash,d)},h.hash=function(d,S){return h.hashBinary(g(d),S)},h.hashBinary=function(d,S){var T=o(d),C=f(T);return S?y(C):C},h.ArrayBuffer=function(){this.reset()},h.ArrayBuffer.prototype.append=function(d){var S=l(this._buff.buffer,d,!0),T=S.length,C;for(this._length+=d.byteLength,C=64;C<=T;C+=64)a(this._hash,s(S.subarray(C-64,C)));return this._buff=C-64<T?new Uint8Array(S.buffer.slice(C-64)):new Uint8Array(0),this},h.ArrayBuffer.prototype.end=function(d){var S=this._buff,T=S.length,C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x,O;for(x=0;x<T;x+=1)C[x>>2]|=S[x]<<(x%4<<3);return this._finish(C,T),O=f(this._hash),d&&(O=y(O)),this.reset(),O},h.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},h.ArrayBuffer.prototype.getState=function(){var d=h.prototype.getState.call(this);return d.buff=p(d.buff),d},h.ArrayBuffer.prototype.setState=function(d){return d.buff=v(d.buff,!0),h.prototype.setState.call(this,d)},h.ArrayBuffer.prototype.destroy=h.prototype.destroy,h.ArrayBuffer.prototype._finish=h.prototype._finish,h.ArrayBuffer.hash=function(d,S){var T=u(new Uint8Array(d)),C=f(T);return S?y(C):C},h})})(Hv);var dw=Hv.exports;const Tw=Ea(dw);var Cw=["lastShaderBound","context","_openGLRenderWindow"];function Sw(t,e){e.classHierarchy.push("vtkShaderCache"),t.replaceShaderValues=function(r,n,a){var i=n;a.length>0&&(i=k.substitute(i,"VSOut","GSOut").result);var s=e._openGLRenderWindow.getWebgl2(),o=`
`,u=`#version 100
`;s?u=`#version 300 es
#define attribute in
#define textureCube texture
#define texture2D texture
#define textureCubeLod textureLod
#define texture2DLod textureLod
`:(e.context.getExtension("OES_standard_derivatives"),e.context.getExtension("EXT_frag_depth")&&(o=`#extension GL_EXT_frag_depth : enable
`),e.context.getExtension("EXT_shader_texture_lod")&&(o+=`#extension GL_EXT_shader_texture_lod : enable
#define textureCubeLod textureCubeLodEXT
#define texture2DLod texture2DLodEXT`)),i=k.substitute(i,"//VTK::System::Dec",["".concat(u,`
`),s?"":`#extension GL_OES_standard_derivatives : enable
`,o,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;var c=k.substitute(r,"//VTK::System::Dec",["".concat(u,`
`),"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;if(s){c=k.substitute(c,"varying","out").result,i=k.substitute(i,"varying","in").result;for(var f="",g=0;i.includes("gl_FragData[".concat(g,"]"));)i=k.substitute(i,"gl_FragData\\[".concat(g,"\\]"),"fragOutput".concat(g)).result,f+="layout(location = ".concat(g,") out vec4 fragOutput").concat(g,`;
`),g++;i=k.substitute(i,"//VTK::Output::Dec",f).result}var v=k.substitute(a,"//VTK::System::Dec",u).result;return{VSSource:c,FSSource:i,GSSource:v}},t.readyShaderProgramArray=function(r,n,a){var i=t.replaceShaderValues(r,n,a),s=t.getShaderProgram(i.VSSource,i.FSSource,i.GSSource);return t.readyShaderProgram(s)},t.readyShaderProgram=function(r){return!r||!r.getCompiled()&&!r.compileShader()||!t.bindShader(r)?null:r},t.getShaderProgram=function(r,n,a){var i="".concat(r).concat(n).concat(a),s=Tw.hash(i);if(!(s in e.shaderPrograms)){var o=k.newInstance();return o.setContext(e.context),o.getVertexShader().setSource(r),o.getFragmentShader().setSource(n),a&&o.getGeometryShader().setSource(a),o.setMd5Hash(s),e.shaderPrograms[s]=o,o}return e.shaderPrograms[s]},t.releaseGraphicsResources=function(r){t.releaseCurrentShader(),Object.keys(e.shaderPrograms).map(function(n){return e.shaderPrograms[n]}).forEach(function(n){return n.releaseGraphicsResources(r)})},t.releaseGraphicsResources=function(){e.astShaderBound&&(e.lastShaderBound.release(),e.lastShaderBound=null)},t.bindShader=function(r){return e.lastShaderBound===r||(e.lastShaderBound&&e.lastShaderBound.release(),r.bind(),e.lastShaderBound=r),1}}var xw={lastShaderBound:null,shaderPrograms:null,context:null};function $v(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xw,r),e.shaderPrograms={},m.obj(t,e),m.setGet(t,e,Cw),m.moveToProtected(t,e,["openGLRenderWindow"]),Sw(t,e)}var Ow=m.newInstance($v,"vtkShaderCache"),mw={newInstance:Ow,extend:$v},ww=m.vtkErrorMacro;function Ew(t,e){e.classHierarchy.push("vtkOpenGLTextureUnitManager"),t.deleteTable=function(){for(var r=0;r<e.numberOfTextureUnits;++r)e.textureUnits[r]===!0&&ww("some texture units  were not properly released");e.textureUnits=[],e.numberOfTextureUnits=0},t.setContext=function(r){if(e.context!==r){if(e.context!==0&&t.deleteTable(),e.context=r,e.context){e.numberOfTextureUnits=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS);for(var n=0;n<e.numberOfTextureUnits;++n)e.textureUnits[n]=!1}t.modified()}},t.allocate=function(){for(var r=0;r<e.numberOfTextureUnits;r++)if(!t.isAllocated(r))return e.textureUnits[r]=!0,r;return-1},t.allocateUnit=function(r){return t.isAllocated(r)?-1:(e.textureUnits[r]=!0,r)},t.isAllocated=function(r){return e.textureUnits[r]},t.free=function(r){e.textureUnits[r]=!1}}var Dw={context:null,numberOfTextureUnits:0,textureUnits:0};function Pv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Dw,r),m.obj(t,e),e.textureUnits=[],m.get(t,e,["numberOfTextureUnits"]),m.setGet(t,e,["context"]),Ew(t,e)}var Mw=m.newInstance(Pv,"vtkOpenGLTextureUnitManager"),Vw={newInstance:Mw,extend:Pv};function Rw(t,e){e.classHierarchy.push("vtkRenderWindowViewNode"),t.getViewNodeFactory=function(){return null},t.getAspectRatio=function(){return e.size[0]/e.size[1]},t.getAspectRatioForRenderer=function(r){var n=r.getViewportByReference();return e.size[0]*(n[2]-n[0])/((n[3]-n[1])*e.size[1])},t.isInViewport=function(r,n,a){var i=a.getViewportByReference(),s=t.getFramebufferSize();return i[0]*s[0]<=r&&i[2]*s[0]>=r&&i[1]*s[1]<=n&&i[3]*s[1]>=n},t.getViewportSize=function(r){var n=r.getViewportByReference(),a=t.getFramebufferSize();return[(n[2]-n[0])*a[0],(n[3]-n[1])*a[1]]},t.getViewportCenter=function(r){var n=t.getViewportSize(r);return[n[0]*.5,n[1]*.5]},t.displayToNormalizedDisplay=function(r,n,a){var i=t.getFramebufferSize();return[r/i[0],n/i[1],a]},t.normalizedDisplayToDisplay=function(r,n,a){var i=t.getFramebufferSize();return[r*i[0],n*i[1],a]},t.worldToView=function(r,n,a,i){return i.worldToView(r,n,a)},t.viewToWorld=function(r,n,a,i){return i.viewToWorld(r,n,a)},t.worldToDisplay=function(r,n,a,i){var s=i.worldToView(r,n,a),o=t.getViewportSize(i),u=i.viewToProjection(s[0],s[1],s[2],o[0]/o[1]),c=i.projectionToNormalizedDisplay(u[0],u[1],u[2]);return t.normalizedDisplayToDisplay(c[0],c[1],c[2])},t.displayToWorld=function(r,n,a,i){var s=t.displayToNormalizedDisplay(r,n,a),o=i.normalizedDisplayToProjection(s[0],s[1],s[2]),u=t.getViewportSize(i),c=i.projectionToView(o[0],o[1],o[2],u[0]/u[1]);return i.viewToWorld(c[0],c[1],c[2])},t.normalizedDisplayToViewport=function(r,n,a,i){var s=i.getViewportByReference();s=t.normalizedDisplayToDisplay(s[0],s[1],0);var o=t.normalizedDisplayToDisplay(r,n,a);return[o[0]-s[0]-.5,o[1]-s[1]-.5,a]},t.viewportToNormalizedViewport=function(r,n,a,i){var s=t.getViewportSize(i);return s&&s[0]!==0&&s[1]!==0?[r/(s[0]-1),n/(s[1]-1),a]:[r,n,a]},t.normalizedViewportToViewport=function(r,n,a,i){var s=t.getViewportSize(i);return[r*(s[0]-1),n*(s[1]-1),a]},t.displayToLocalDisplay=function(r,n,a){var i=t.getFramebufferSize();return[r,i[1]-n-1,a]},t.viewportToNormalizedDisplay=function(r,n,a,i){var s=i.getViewportByReference();s=t.normalizedDisplayToDisplay(s[0],s[1],0);var o=r+s[0]+.5,u=n+s[1]+.5;return t.displayToNormalizedDisplay(o,u,a)},t.getComputedDevicePixelRatio=function(){return e.size[0]/t.getContainerSize()[0]},t.getContainerSize=function(){m.vtkErrorMacro("not implemented")},t.getPixelData=function(r,n,a,i){m.vtkErrorMacro("not implemented")},t.createSelector=function(){m.vtkErrorMacro("not implemented")}}var bw={size:void 0,selector:void 0};function jv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,bw,r),e.size||(e.size=[300,300]),m.getArray(t,e,["size"],2),m.get(t,e,["selector"]),Se.extend(t,e,r),Rw(t,e)}var Lw=m.newInstance(jv,"vtkRenderWindowViewNode"),Kv={newInstance:Lw,extend:jv},Bw={HmdVR:0,MobileAR:1,LookingGlassVR:2},kw={XrSessionTypes:Bw},Xv="__getUnderlyingContext";function Nw(){var t=new Map,e={apply:function(i,s,o){return t.has(o[0])?t.get(o[0]):i.apply(s,o)}};function r(a){return{apply:function(s,o,u){return t.set(a,u[0]),s.apply(o,u)}}}var n=Object.create(null);return n.getParameter=function(a,i,s,o){return new Proxy(o.bind(a),e)},n.depthMask=function(a,i,s,o){return new Proxy(o.bind(a),r(a.DEPTH_WRITEMASK))},{get:function(i,s,o){if(s===Xv)return function(){return i};var u=Reflect.get(i,s,i);u instanceof Function&&(u=u.bind(i));var c=n[s];return c?c(i,s,o,u):u}}}var Xu=m.vtkDebugMacro,Yu=m.vtkErrorMacro,Dr=kw.XrSessionTypes,Fw={position:"absolute",top:0,left:0,width:"100%",height:"100%"},Mr={vr:{rescaleFactor:1,translateZ:-.7},ar:{rescaleFactor:.25,translateZ:-.5}};function Ge(t,e,r){var n=t.createFramebuffer(),a=t.createTexture();t.bindTexture(t.TEXTURE_2D,a),t.texImage2D(t.TEXTURE_2D,0,e,2,2,0,e,r,null),t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER);return t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),i===t.FRAMEBUFFER_COMPLETE}var wa=0,Yv=[];function Uw(){wa++,Yv.forEach(function(t){return t(wa)})}function Gw(){wa--,Yv.forEach(function(t){return t(wa)})}function qu(t){t.preventDefault()}function _w(t,e){e.classHierarchy.push("vtkOpenGLRenderWindow");var r=Nw();t.getViewNodeFactory=function(){return e.myFactory},e.canvas.addEventListener("webglcontextlost",qu,!1),e.canvas.addEventListener("webglcontextrestored",t.restoreContext,!1);var n=navigator.xr!==void 0&&navigator.xr.isSessionSupported("immersive-vr"),a=[0,0];function i(){e.renderable&&(e.size[0]!==a[0]||e.size[1]!==a[1])&&(a[0]=e.size[0],a[1]=e.size[1],e.canvas.setAttribute("width",e.size[0]),e.canvas.setAttribute("height",e.size[1])),e.viewStream&&e.viewStream.setSize(e.size[0],e.size[1]),e.canvas.style.display=e.useOffScreen?"none":"block",e.el&&(e.el.style.cursor=e.cursorVisibility?e.cursor:"none"),e.containerSize=null}t.onModified(i),t.buildPass=function(f){if(f){if(!e.renderable)return;t.prepareNodes(),t.addMissingNodes(e.renderable.getRenderersByReference()),t.removeUnusedNodes(),t.initialize(),e.children.forEach(function(g){g.setOpenGLRenderWindow(t)})}},t.initialize=function(){if(!e.initialized){e.context=t.get3DContext(),e.textureUnitManager=Vw.newInstance(),e.textureUnitManager.setContext(e.context),e.shaderCache.setContext(e.context);var f=e.context;f.blendFuncSeparate(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA,f.ONE,f.ONE_MINUS_SRC_ALPHA),f.depthFunc(f.LEQUAL),f.enable(f.BLEND),e.initialized=!0}},t.makeCurrent=function(){e.context.makeCurrent()},t.setContainer=function(f){e.el&&e.el!==f&&(e.canvas.parentNode!==e.el&&Yu("Error: canvas parent node does not match container"),e.el.removeChild(e.canvas),e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)),e.el!==f&&(e.el=f,e.el&&(e.el.appendChild(e.canvas),e.useBackgroundImage&&e.el.appendChild(e.bgImage)),t.modified())},t.getContainer=function(){return e.el},t.getContainerSize=function(){if(!e.containerSize&&e.el){var f=e.el.getBoundingClientRect(),g=f.width,v=f.height;e.containerSize=[g,v]}return e.containerSize||e.size},t.getFramebufferSize=function(){return e.activeFramebuffer?e.activeFramebuffer.getSize():e.size},t.getPixelData=function(f,g,v,p){var l=new Uint8Array((v-f+1)*(p-g+1)*4);return e.context.readPixels(f,g,v-f+1,p-g+1,e.context.RGBA,e.context.UNSIGNED_BYTE,l),l},t.get3DContext=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{preserveDrawingBuffer:!1,depth:!0,alpha:!0,powerPreference:"high-performance"},g=null;n&&t.invokeHaveVRDisplay();var v=typeof WebGL2RenderingContext<"u";return e.webgl2=!1,e.defaultToWebgl2&&v&&(g=e.canvas.getContext("webgl2",f),g&&(e.webgl2=!0,Xu("using webgl2"))),g||(Xu("using webgl1"),g=e.canvas.getContext("webgl",f)||e.canvas.getContext("experimental-webgl",f)),new Proxy(g,r)},t.startXR=function(f){if(navigator.xr===void 0)throw new Error("WebXR is not available");e.xrSessionType=f!==void 0?f:Dr.HmdVR;var g=f===Dr.MobileAR,v=g?"immersive-ar":"immersive-vr";if(!navigator.xr.isSessionSupported(v))throw g?new Error("Device does not support AR session"):new Error("VR display is not available");if(e.xrSession===null)navigator.xr.requestSession(v).then(t.enterXR,function(){throw new Error("Failed to create XR session!")});else throw new Error("XR Session already exists!")},t.enterXR=function(){var f=St(we.mark(function g(v){var p,l;return we.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(e.xrSession=v,e.oldCanvasSize=e.size.slice(),e.xrSession===null){h.next=15;break}return p=t.get3DContext(),h.next=6,p.makeXRCompatible();case 6:l=new global.XRWebGLLayer(e.xrSession,p[Xv]()),t.setSize(l.framebufferWidth,l.framebufferHeight),e.xrSession.updateRenderState({baseLayer:l}),e.xrSession.requestReferenceSpace("local").then(function(d){e.xrReferenceSpace=d}),t.resetXRScene(),e.renderable.getInteractor().switchToXRAnimation(),e.xrSceneFrame=e.xrSession.requestAnimationFrame(t.xrRender),h.next=16;break;case 15:throw new Error("Failed to enter VR with a null xrSession.");case 16:case"end":return h.stop()}},g)}));return function(g){return f.apply(this,arguments)}}(),t.resetXRScene=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Mr.vr.rescaleFactor,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mr.vr.translateZ,v=f,p=g,l=e.xrSessionType===Dr.MobileAR;l&&v===Mr.vr.rescaleFactor&&(v=Mr.ar.rescaleFactor),l&&p===Mr.vr.translateZ&&(p=Mr.ar.translateZ);var y=e.renderable.getRenderers()[0];y.resetCamera();var h=y.getActiveCamera(),d=h.getPhysicalScale(),S=h.getPhysicalTranslation();d/=v,p*=d,S[2]+=p,h.setPhysicalScale(d),h.setPhysicalTranslation(S),h.setClippingRange(.1*d,100*d)},t.stopXR=St(we.mark(function f(){var g,v;return we.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(navigator.xr!==void 0){l.next=2;break}return l.abrupt("return");case 2:if(e.xrSession===null){l.next=10;break}return e.xrSession.cancelAnimationFrame(e.xrSceneFrame),e.renderable.getInteractor().returnFromXRAnimation(),g=t.get3DContext(),g.bindFramebuffer(g.FRAMEBUFFER,null),l.next=9,e.xrSession.end().catch(function(y){if(!(y instanceof DOMException))throw y});case 9:e.xrSession=null;case 10:e.oldCanvasSize!==void 0&&t.setSize.apply(t,Y(e.oldCanvasSize)),v=e.renderable.getRenderers()[0],v.getActiveCamera().setProjectionMatrix(null),v.resetCamera(),v.setViewport(0,0,1,1),t.traverseAllPasses();case 16:case"end":return l.stop()}},f)})),t.xrRender=function(){var f=St(we.mark(function g(v,p){var l,y,h,d,S;return we.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:l=p.session,e.renderable.getInteractor().updateXRGamepads(l,p,e.xrReferenceSpace),e.xrSceneFrame=e.xrSession.requestAnimationFrame(t.xrRender),y=p.getViewerPose(e.xrReferenceSpace),y&&(h=t.get3DContext(),e.xrSessionType===Dr.MobileAR&&e.oldCanvasSize!==void 0&&(h.canvas.width=e.oldCanvasSize[0],h.canvas.height=e.oldCanvasSize[1]),d=l.renderState.baseLayer,h.bindFramebuffer(h.FRAMEBUFFER,d.framebuffer),h.clear(h.COLOR_BUFFER_BIT),h.clear(h.DEPTH_BUFFER_BIT),t.setSize(d.framebufferWidth,d.framebufferHeight),S=e.renderable.getRenderers()[0],y.views.forEach(function(x,O){var w=d.getViewport(x);if(e.xrSessionType===Dr.HmdVR)if(x.eye==="left")S.setViewport(0,0,.5,1);else if(x.eye==="right")S.setViewport(.5,0,1,1);else return;else if(e.xrSessionType===Dr.LookingGlassVR){var E=w.x/d.framebufferWidth,V=w.y/d.framebufferHeight,D=(w.x+w.width)/d.framebufferWidth,M=(w.y+w.height)/d.framebufferHeight;S.setViewport(E,V,D,M)}else S.setViewport(0,0,1,1);S.getActiveCamera().computeViewParametersFromPhysicalMatrix(x.transform.inverse.matrix),S.getActiveCamera().setProjectionMatrix(x.projectionMatrix),t.traverseAllPasses()}),h.scissor(0,0,d.framebufferWidth,d.framebufferHeight),h.disable(h.SCISSOR_TEST));case 5:case"end":return C.stop()}},g)}));return function(g,v){return f.apply(this,arguments)}}(),t.restoreContext=function(){var f=Bt.newInstance();f.setCurrentOperation("Release"),f.traverse(t,null)},t.activateTexture=function(f){var g=e._textureResourceIds.get(f);if(g!==void 0){e.context.activeTexture(e.context.TEXTURE0+g);return}var v=t.getTextureUnitManager().allocate();if(v<0){Yu("Hardware does not support the number of textures defined.");return}e._textureResourceIds.set(f,v),e.context.activeTexture(e.context.TEXTURE0+v)},t.deactivateTexture=function(f){var g=e._textureResourceIds.get(f);g!==void 0&&(t.getTextureUnitManager().free(g),e._textureResourceIds.delete(f))},t.getTextureUnitForTexture=function(f){var g=e._textureResourceIds.get(f);return g!==void 0?g:-1},t.getDefaultTextureInternalFormat=function(f,g){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e.webgl2)switch(f){case dt.UNSIGNED_CHAR:switch(g){case 1:return e.context.R8;case 2:return e.context.RG8;case 3:return e.context.RGB8;case 4:default:return e.context.RGBA8}case(v&&!p&&dt.UNSIGNED_SHORT):switch(g){case 1:return v.R16_EXT;case 2:return v.RG16_EXT;case 3:return v.RGB16_EXT;case 4:default:return v.RGBA16_EXT}case(v&&!p&&dt.SHORT):switch(g){case 1:return v.R16_SNORM_EXT;case 2:return v.RG16_SNORM_EXT;case 3:return v.RGB16_SNORM_EXT;case 4:default:return v.RGBA16_SNORM_EXT}case dt.FLOAT:default:switch(g){case 1:return e.context.R16F;case 2:return e.context.RG16F;case 3:return e.context.RGB16F;case 4:default:return e.context.RGBA16F}}switch(g){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:default:return e.context.RGBA}},t.setBackgroundImage=function(f){e.bgImage.src=f.src},t.setUseBackgroundImage=function(f){e.useBackgroundImage=f,e.useBackgroundImage&&!e.el.contains(e.bgImage)?e.el.appendChild(e.bgImage):!e.useBackgroundImage&&e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)};function s(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.imageFormat,g=document.createElement("canvas"),v=g.getContext("2d");g.width=e.canvas.width,g.height=e.canvas.height,v.drawImage(e.canvas,0,0);var p=e.canvas.getBoundingClientRect(),l=e.renderable,y=l.getRenderers();y.forEach(function(d){var S=d.getViewProps();S.forEach(function(T){if(T.getContainer)for(var C=T.getContainer(),x=C.getElementsByTagName("canvas"),O=0;O<x.length;O++){var w=x[O],E=w.getBoundingClientRect(),V=E.x-p.x,D=E.y-p.y;v.drawImage(w,V,D)}})});var h=g.toDataURL(f);g.remove(),t.invokeImageReady(h)}t.captureNextImage=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},v=g.resetCamera,p=v===void 0?!1:v,l=g.size,y=l===void 0?null:l,h=g.scale,d=h===void 0?1:h;if(e.deleted)return null;e.imageFormat=f;var S=e.notifyStartCaptureImage;return e.notifyStartCaptureImage=!0,e._screenshot={size:y||d!==1?y||e.size.map(function(T){return T*d}):null},new Promise(function(T,C){var x=t.onImageReady(function(O){if(e._screenshot.size===null)e.notifyStartCaptureImage=S,x.unsubscribe(),e._screenshot.placeHolder&&(e.size=e._screenshot.originalSize,t.modified(),e._screenshot.cameras&&e._screenshot.cameras.forEach(function(V){var D=V.restoreParamsFn,M=V.arg;return D(M)}),t.traverseAllPasses(),e.el.removeChild(e._screenshot.placeHolder),e._screenshot.placeHolder.remove(),e._screenshot=null),T(O);else{var w=document.createElement("img");if(w.style=Fw,w.src=O,e._screenshot.placeHolder=e.el.appendChild(w),e.canvas.style.display="none",e._screenshot.originalSize=e.size,e.size=e._screenshot.size,e._screenshot.size=null,t.modified(),p){var E=p!==!0;e._screenshot.cameras=e.renderable.getRenderers().map(function(V){var D=V.getActiveCamera(),M=D.get("focalPoint","position","parallelScale");return{resetCameraArgs:E?{renderer:V}:void 0,resetCameraFn:E?p:V.resetCamera,restoreParamsFn:D.set,arg:JSON.parse(JSON.stringify(M))}}),e._screenshot.cameras.forEach(function(V){var D=V.resetCameraFn,M=V.resetCameraArgs;return D(M)})}t.traverseAllPasses()}})})};var o;t.getHardwareMaximumLineWidth=function(){if(o!=null)return o;var f=t.get3DContext(),g=f.getParameter(f.ALIASED_LINE_WIDTH_RANGE);return o=g[1],g[1]},t.getGLInformations=function(){for(var f=t.get3DContext(),g=f.getExtension("OES_texture_float"),v=f.getExtension("OES_texture_half_float"),p=f.getExtension("WEBGL_debug_renderer_info"),l=f.getExtension("WEBGL_draw_buffers"),y=f.getExtension("EXT_texture_filter_anisotropic")||f.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),h=[["Max Vertex Attributes","MAX_VERTEX_ATTRIBS",f.getParameter(f.MAX_VERTEX_ATTRIBS)],["Max Varying Vectors","MAX_VARYING_VECTORS",f.getParameter(f.MAX_VARYING_VECTORS)],["Max Vertex Uniform Vectors","MAX_VERTEX_UNIFORM_VECTORS",f.getParameter(f.MAX_VERTEX_UNIFORM_VECTORS)],["Max Fragment Uniform Vectors","MAX_FRAGMENT_UNIFORM_VECTORS",f.getParameter(f.MAX_FRAGMENT_UNIFORM_VECTORS)],["Max Fragment Texture Image Units","MAX_TEXTURE_IMAGE_UNITS",f.getParameter(f.MAX_TEXTURE_IMAGE_UNITS)],["Max Vertex Texture Image Units","MAX_VERTEX_TEXTURE_IMAGE_UNITS",f.getParameter(f.MAX_VERTEX_TEXTURE_IMAGE_UNITS)],["Max Combined Texture Image Units","MAX_COMBINED_TEXTURE_IMAGE_UNITS",f.getParameter(f.MAX_COMBINED_TEXTURE_IMAGE_UNITS)],["Max 2D Texture Size","MAX_TEXTURE_SIZE",f.getParameter(f.MAX_TEXTURE_SIZE)],["Max Cube Texture Size","MAX_CUBE_MAP_TEXTURE_SIZE",f.getParameter(f.MAX_CUBE_MAP_TEXTURE_SIZE)],["Max Texture Anisotropy","MAX_TEXTURE_MAX_ANISOTROPY_EXT",y&&f.getParameter(y.MAX_TEXTURE_MAX_ANISOTROPY_EXT)],["Point Size Range","ALIASED_POINT_SIZE_RANGE",f.getParameter(f.ALIASED_POINT_SIZE_RANGE).join(" - ")],["Line Width Range","ALIASED_LINE_WIDTH_RANGE",f.getParameter(f.ALIASED_LINE_WIDTH_RANGE).join(" - ")],["Max Viewport Dimensions","MAX_VIEWPORT_DIMS",f.getParameter(f.MAX_VIEWPORT_DIMS).join(" - ")],["Max Renderbuffer Size","MAX_RENDERBUFFER_SIZE",f.getParameter(f.MAX_RENDERBUFFER_SIZE)],["Framebuffer Red Bits","RED_BITS",f.getParameter(f.RED_BITS)],["Framebuffer Green Bits","GREEN_BITS",f.getParameter(f.GREEN_BITS)],["Framebuffer Blue Bits","BLUE_BITS",f.getParameter(f.BLUE_BITS)],["Framebuffer Alpha Bits","ALPHA_BITS",f.getParameter(f.ALPHA_BITS)],["Framebuffer Depth Bits","DEPTH_BITS",f.getParameter(f.DEPTH_BITS)],["Framebuffer Stencil Bits","STENCIL_BITS",f.getParameter(f.STENCIL_BITS)],["Framebuffer Subpixel Bits","SUBPIXEL_BITS",f.getParameter(f.SUBPIXEL_BITS)],["MSAA Samples","SAMPLES",f.getParameter(f.SAMPLES)],["MSAA Sample Buffers","SAMPLE_BUFFERS",f.getParameter(f.SAMPLE_BUFFERS)],["Supported Formats for UByte Render Targets     ","UNSIGNED_BYTE RENDER TARGET FORMATS",[g&&Ge(f,f.RGBA,f.UNSIGNED_BYTE)?"RGBA":"",g&&Ge(f,f.RGB,f.UNSIGNED_BYTE)?"RGB":"",g&&Ge(f,f.LUMINANCE,f.UNSIGNED_BYTE)?"LUMINANCE":"",g&&Ge(f,f.ALPHA,f.UNSIGNED_BYTE)?"ALPHA":"",g&&Ge(f,f.LUMINANCE_ALPHA,f.UNSIGNED_BYTE)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Half Float Render Targets","HALF FLOAT RENDER TARGET FORMATS",[v&&Ge(f,f.RGBA,v.HALF_FLOAT_OES)?"RGBA":"",v&&Ge(f,f.RGB,v.HALF_FLOAT_OES)?"RGB":"",v&&Ge(f,f.LUMINANCE,v.HALF_FLOAT_OES)?"LUMINANCE":"",v&&Ge(f,f.ALPHA,v.HALF_FLOAT_OES)?"ALPHA":"",v&&Ge(f,f.LUMINANCE_ALPHA,v.HALF_FLOAT_OES)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Full Float Render Targets","FLOAT RENDER TARGET FORMATS",[g&&Ge(f,f.RGBA,f.FLOAT)?"RGBA":"",g&&Ge(f,f.RGB,f.FLOAT)?"RGB":"",g&&Ge(f,f.LUMINANCE,f.FLOAT)?"LUMINANCE":"",g&&Ge(f,f.ALPHA,f.FLOAT)?"ALPHA":"",g&&Ge(f,f.LUMINANCE_ALPHA,f.FLOAT)?"LUMINANCE_ALPHA":""].join(" ")],["Max Multiple Render Targets Buffers","MAX_DRAW_BUFFERS_WEBGL",l?f.getParameter(l.MAX_DRAW_BUFFERS_WEBGL):0],["High Float Precision in Vertex Shader","HIGH_FLOAT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Vertex Shader","MEDIUM_FLOAT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Vertex Shader","LOW_FLOAT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Float Precision in Fragment Shader","HIGH_FLOAT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Fragment Shader","MEDIUM_FLOAT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Fragment Shader","LOW_FLOAT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_FLOAT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Int Precision in Vertex Shader","HIGH_INT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Vertex Shader","MEDIUM_INT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Vertex Shader","LOW_INT VERTEX_SHADER",[f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.LOW_INT).rangeMax,"</sup>)"].join("")],["High Int Precision in Fragment Shader","HIGH_INT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Fragment Shader","MEDIUM_INT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Fragment Shader","LOW_INT FRAGMENT_SHADER",[f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_INT).precision," (-2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_INT).rangeMin,"</sup> - 2<sup>",f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.LOW_INT).rangeMax,"</sup>)"].join("")],["Supported Extensions","EXTENSIONS",f.getSupportedExtensions().join("<br/>					    ")],["WebGL Renderer","RENDERER",f.getParameter(f.RENDERER)],["WebGL Vendor","VENDOR",f.getParameter(f.VENDOR)],["WebGL Version","VERSION",f.getParameter(f.VERSION)],["Shading Language Version","SHADING_LANGUAGE_VERSION",f.getParameter(f.SHADING_LANGUAGE_VERSION)],["Unmasked Renderer","UNMASKED_RENDERER",p&&f.getParameter(p.UNMASKED_RENDERER_WEBGL)],["Unmasked Vendor","UNMASKED_VENDOR",p&&f.getParameter(p.UNMASKED_VENDOR_WEBGL)],["WebGL Version","WEBGL_VERSION",e.webgl2?2:1]],d={};h.length;){var S=h.pop(),T=$e(S,3),C=T[0],x=T[1],O=T[2];x&&(d[x]={label:C,value:O})}return d},t.traverseAllPasses=function(){if(e.renderPasses)for(var f=0;f<e.renderPasses.length;++f)e.renderPasses[f].traverse(t,null);e.notifyStartCaptureImage&&s()},t.disableCullFace=function(){e.cullFaceEnabled&&(e.context.disable(e.context.CULL_FACE),e.cullFaceEnabled=!1)},t.enableCullFace=function(){e.cullFaceEnabled||(e.context.enable(e.context.CULL_FACE),e.cullFaceEnabled=!0)},t.setViewStream=function(f){if(e.viewStream===f)return!1;if(e.subscription&&(e.subscription.unsubscribe(),e.subscription=null),e.viewStream=f,e.viewStream){var g=e.renderable.getRenderers()[0];g.getBackgroundByReference()[3]=0,t.setUseBackgroundImage(!0),e.subscription=e.viewStream.onImageReady(function(v){return t.setBackgroundImage(v.image)}),e.viewStream.setSize(e.size[0],e.size[1]),e.viewStream.invalidateCache(),e.viewStream.render(),t.modified()}return!0},t.createSelector=function(){var f=Av.newInstance();return f.setOpenGLRenderWindow(t),f};function u(){e.canvas.removeEventListener("webglcontextlost",qu),e.canvas.removeEventListener("webglcontextrestored",t.restoreContext)}t.delete=m.chain(u,t.delete,t.setViewStream,Gw),t.setActiveFramebuffer=function(f){e.activeFramebuffer=f};var c=t.setSize;t.setSize=function(f,g){var v=c(f,g);return v&&t.invokeWindowResizeEvent({width:f,height:g}),v}}var Ww={cullFaceEnabled:!1,shaderCache:null,initialized:!1,context:null,canvas:null,cursorVisibility:!0,cursor:"pointer",textureUnitManager:null,textureResourceIds:null,containerSize:null,renderPasses:[],notifyStartCaptureImage:!1,webgl2:!1,defaultToWebgl2:!0,activeFramebuffer:null,xrSession:null,xrReferenceSpace:null,xrSupported:!0,imageFormat:"image/png",useOffScreen:!1,useBackgroundImage:!1};function zw(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ww,r),Kv.extend(t,e,r),e.canvas=document.createElement("canvas"),e.canvas.style.width="100%",Uw(),e.selector||(e.selector=Av.newInstance(),e.selector.setOpenGLRenderWindow(t)),e.bgImage=new Image,e.bgImage.style.position="absolute",e.bgImage.style.left="0",e.bgImage.style.top="0",e.bgImage.style.width="100%",e.bgImage.style.height="100%",e.bgImage.style.zIndex="-1",e._textureResourceIds=new Map,e.myFactory=Sh.newInstance(),e.myFactory.registerOverride("vtkRenderWindow",qv),e.shaderCache=mw.newInstance(),e.shaderCache.setOpenGLRenderWindow(t),e.renderPasses[0]=Jm.newInstance(),m.event(t,e,"imageReady"),m.event(t,e,"haveVRDisplay"),m.get(t,e,["shaderCache","textureUnitManager","webgl2","vrDisplay","useBackgroundImage","xrSupported","activeFramebuffer"]),m.setGet(t,e,["initialized","context","canvas","renderPasses","notifyStartCaptureImage","defaultToWebgl2","cursor","useOffScreen"]),m.setGetArray(t,e,["size"],2),m.event(t,e,"windowResizeEvent"),_w(t,e)}var qv=m.newInstance(zw,"vtkOpenGLRenderWindow");bs("WebGL",qv);var di=["setBindGroup","setIndexBuffer","setVertexBuffer","draw","drawIndexed"];function Aw(t,e){e.classHierarchy.push("vtkWebGPURenderEncoder"),t.begin=function(a){e.drawCallbacks=[],e.handle=a.beginRenderPass(e.description),e.label&&e.handle.pushDebugGroup(e.label)},t.end=function(){for(var a=0;a<e.drawCallbacks.length;a++){var i=e.drawCallbacks[a],s=i.pipeline;t.setPipeline(s);for(var o=0;o<i.callbacks.length;o++)i.callbacks[o](t)}e.label&&e.handle.popDebugGroup(),e.handle.end(),e.boundPipeline=null},t.setPipeline=function(a){if(e.boundPipeline!==a){e.handle.setPipeline(a.getHandle());var i=a.getPipelineDescription();if(e.colorTextureViews.length!==i.fragment.targets.length)console.log("mismatched attachment counts on pipeline ".concat(i.fragment.targets.length," while encoder has ").concat(e.colorTextureViews.length)),console.trace();else for(var s=0;s<e.colorTextureViews.length;s++){var o,u=(o=e.colorTextureViews[s].getTexture())===null||o===void 0?void 0:o.getFormat();u&&u!==i.fragment.targets[s].format&&(console.log("mismatched attachments for attachment ".concat(s," on pipeline ").concat(i.fragment.targets[s].format," while encoder has ").concat(u)),console.trace())}if(!e.depthTextureView!=!("depthStencil"in i))console.log("mismatched depth attachments"),console.trace();else if(e.depthTextureView){var c,f=(c=e.depthTextureView.getTexture())===null||c===void 0?void 0:c.getFormat();f&&f!==i.depthStencil.format&&(console.log("mismatched depth attachments on pipeline ".concat(i.depthStencil.format," while encoder has ").concat(f)),console.trace())}e.boundPipeline=a}},t.replaceShaderCode=function(a){e.replaceShaderCodeFunction(a)},t.setColorTextureView=function(a,i){e.colorTextureViews[a]!==i&&(e.colorTextureViews[a]=i)},t.activateBindGroup=function(a){var i=e.boundPipeline.getDevice(),s=e.boundPipeline.getBindGroupLayoutCount(a.getLabel());e.handle.setBindGroup(s,a.getBindGroup(i));var o=i.getBindGroupLayoutDescription(a.getBindGroupLayout(i)),u=i.getBindGroupLayoutDescription(e.boundPipeline.getBindGroupLayout(s));o!==u&&(console.log("renderEncoder ".concat(e.pipelineHash,` mismatched bind group layouts bind group has
`).concat(o,`
 versus pipeline
`).concat(u,`
`)),console.trace())},t.attachTextureViews=function(){for(var a=0;a<e.colorTextureViews.length;a++)e.description.colorAttachments[a]?e.description.colorAttachments[a].view=e.colorTextureViews[a].getHandle():e.description.colorAttachments[a]={view:e.colorTextureViews[a].getHandle()};e.depthTextureView&&(e.description.depthStencilAttachment.view=e.depthTextureView.getHandle())},t.registerDrawCallback=function(a,i){for(var s=0;s<e.drawCallbacks.length;s++)if(e.drawCallbacks[s].pipeline===a){e.drawCallbacks[s].callbacks.push(i);return}e.drawCallbacks.push({pipeline:a,callbacks:[i]})};for(var r=function(i){t[di[i]]=function(){var s;return(s=e.handle)[di[i]].apply(s,arguments)}},n=0;n<di.length;n++)r(n)}var Hw={description:null,handle:null,boundPipeline:null,pipelineHash:null,pipelineSettings:null,replaceShaderCodeFunction:null,depthTextureView:null,label:null};function Qv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Hw,r),Ne(t,e),e.description={colorAttachments:[{view:void 0,loadOp:"load",storeOp:"store"}],depthStencilAttachment:{view:void 0,depthLoadOp:"clear",depthClearValue:0,depthStoreOp:"store"}},e.replaceShaderCodeFunction=function(n){var a=n.getShaderDescription("fragment");a.addOutput("vec4<f32>","outColor");var i=a.getCode();i=X.substitute(i,"//VTK::RenderEncoder::Impl",["output.outColor = computedColor;"]).result,a.setCode(i)},e.pipelineSettings={primitive:{cullMode:"none"},depthStencil:{depthWriteEnabled:!0,depthCompare:"greater-equal",format:"depth32float"},fragment:{targets:[{format:"rgba16float",blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcfactor:"one",dstFactor:"one-minus-src-alpha"}}}]}},e.colorTextureViews=[],je(t,e,["boundPipeline","colorTextureViews"]),be(t,e,["depthTextureView","description","handle","label","pipelineHash","pipelineSettings","replaceShaderCodeFunction"]),Aw(t,e)}var $w=ve(Qv,"vtkWebGPURenderEncoder"),Rt={newInstance:$w,extend:Qv};function Pw(t,e){e.classHierarchy.push("vtkWebGPUOpaquePass"),t.traverse=function(r,n){if(!e.deleted){e._currentParent=n;var a=n.getDevice();if(e.renderEncoder)e.colorTexture.resize(n.getCanvas().width,n.getCanvas().height),e.depthTexture.resize(n.getCanvas().width,n.getCanvas().height);else{t.createRenderEncoder(),e.colorTexture=Ct.newInstance({label:"opaquePassColor"}),e.colorTexture.create(a,{width:n.getCanvas().width,height:n.getCanvas().height,format:"rgba16float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC});var i=e.colorTexture.createView("opaquePassColorTexture");e.renderEncoder.setColorTextureView(0,i),e.depthFormat="depth32float",e.depthTexture=Ct.newInstance({label:"opaquePassDepth"}),e.depthTexture.create(a,{width:n.getCanvas().width,height:n.getCanvas().height,format:e.depthFormat,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC});var s=e.depthTexture.createView("opaquePassDepthTexture");e.renderEncoder.setDepthTextureView(s)}e.renderEncoder.attachTextureViews(),t.setCurrentOperation("opaquePass"),r.setRenderEncoder(e.renderEncoder),r.traverse(t)}},t.getColorTextureView=function(){return e.renderEncoder.getColorTextureViews()[0]},t.getDepthTextureView=function(){return e.renderEncoder.getDepthTextureView()},t.createRenderEncoder=function(){e.renderEncoder=Rt.newInstance({label:"OpaquePass"}),e.renderEncoder.setPipelineHash("op")}}var jw={renderEncoder:null,colorTexture:null,depthTexture:null};function Zv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,jw,r),Bt.extend(t,e,r),m.get(t,e,["colorTexture","depthTexture"]),Pw(t,e)}var Kw=m.newInstance(Zv,"vtkWebGPUOpaquePass"),Xw={newInstance:Kw,extend:Zv},Yw=`
//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var tcoord: vec2<i32> = vec2<i32>(i32(input.fragPos.x), i32(input.fragPos.y));
  var reveal: f32 = textureLoad(oitpAccumTexture, tcoord, 0).r;
  if (reveal == 1.0) { discard; }
  var tcolor: vec4<f32> = textureLoad(oitpColorTexture, tcoord, 0);
  var total: f32 = max(tcolor.a, 0.01);
  var computedColor: vec4<f32> = vec4<f32>(tcolor.r/total, tcolor.g/total, tcolor.b/total, 1.0 - reveal);

  //VTK::RenderEncoder::Impl
  return output;
}
`;function qw(t,e){e.classHierarchy.push("vtkWebGPUOrderIndependentTranslucentPass"),t.traverse=function(r,n){if(!e.deleted){e._currentParent=n;var a=n.getDevice();if(e.translucentRenderEncoder)e.translucentColorTexture.resizeToMatch(e.colorTextureView.getTexture()),e.translucentAccumulateTexture.resizeToMatch(e.colorTextureView.getTexture());else{t.createRenderEncoder(),t.createFinalEncoder(),e.translucentColorTexture=Ct.newInstance({label:"translucentPassColor"}),e.translucentColorTexture.create(a,{width:n.getCanvas().width,height:n.getCanvas().height,format:"rgba16float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING});var i=e.translucentColorTexture.createView("oitpColorTexture");e.translucentRenderEncoder.setColorTextureView(0,i),e.translucentAccumulateTexture=Ct.newInstance({label:"translucentPassAccumulate"}),e.translucentAccumulateTexture.create(a,{width:n.getCanvas().width,height:n.getCanvas().height,format:"r16float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING});var s=e.translucentAccumulateTexture.createView("oitpAccumTexture");e.translucentRenderEncoder.setColorTextureView(1,s),e.fullScreenQuad=Hr.newInstance(),e.fullScreenQuad.setDevice(n.getDevice()),e.fullScreenQuad.setPipelineHash("oitpfsq"),e.fullScreenQuad.setTextureViews(e.translucentRenderEncoder.getColorTextureViews()),e.fullScreenQuad.setFragmentShaderTemplate(Yw)}e.translucentRenderEncoder.setDepthTextureView(e.depthTextureView),e.translucentRenderEncoder.attachTextureViews(),t.setCurrentOperation("translucentPass"),r.setRenderEncoder(e.translucentRenderEncoder),r.traverse(t),t.finalPass(n,r)}},t.finalPass=function(r,n){e.translucentFinalEncoder.setColorTextureView(0,e.colorTextureView),e.translucentFinalEncoder.attachTextureViews(),e.translucentFinalEncoder.begin(r.getCommandEncoder()),n.scissorAndViewport(e.translucentFinalEncoder),e.fullScreenQuad.prepareAndDraw(e.translucentFinalEncoder),e.translucentFinalEncoder.end()},t.getTextures=function(){return[e.translucentColorTexture,e.translucentAccumulateTexture]},t.createRenderEncoder=function(){e.translucentRenderEncoder=Rt.newInstance({label:"translucentRender"});var r=e.translucentRenderEncoder.getDescription();r.colorAttachments=[{view:void 0,clearValue:[0,0,0,0],loadOp:"clear",storeOp:"store"},{view:void 0,clearValue:[1,0,0,0],loadOp:"clear",storeOp:"store"}],r.depthStencilAttachment={view:void 0,depthLoadOp:"load",depthStoreOp:"store"},e.translucentRenderEncoder.setReplaceShaderCodeFunction(function(n){var a=n.getShaderDescription("fragment");a.addOutput("vec4<f32>","outColor"),a.addOutput("f32","outAccum"),a.addBuiltinInput("vec4<f32>","@builtin(position) fragPos");var i=a.getCode();i=X.substitute(i,"//VTK::RenderEncoder::Impl",["var w: f32 = computedColor.a * pow(0.1 + input.fragPos.z, 2.0);","output.outColor = vec4<f32>(computedColor.rgb*w, w);","output.outAccum = computedColor.a;"]).result,a.setCode(i)}),e.translucentRenderEncoder.setPipelineHash("oitpr"),e.translucentRenderEncoder.setPipelineSettings({primitive:{cullMode:"none"},depthStencil:{depthWriteEnabled:!1,depthCompare:"greater",format:"depth32float"},fragment:{targets:[{format:"rgba16float",blend:{color:{srcFactor:"one",dstFactor:"one"},alpha:{srcfactor:"one",dstFactor:"one"}}},{format:"r16float",blend:{color:{srcFactor:"zero",dstFactor:"one-minus-src"},alpha:{srcfactor:"one",dstFactor:"one-minus-src-alpha"}}}]}})},t.createFinalEncoder=function(){e.translucentFinalEncoder=Rt.newInstance({label:"translucentFinal"}),e.translucentFinalEncoder.setDescription({colorAttachments:[{view:null,loadOp:"load",storeOp:"store"}]}),e.translucentFinalEncoder.setReplaceShaderCodeFunction(function(r){var n=r.getShaderDescription("fragment");n.addOutput("vec4<f32>","outColor"),n.addBuiltinInput("vec4<f32>","@builtin(position) fragPos");var a=n.getCode();a=X.substitute(a,"//VTK::RenderEncoder::Impl",["output.outColor = vec4<f32>(computedColor.rgb, computedColor.a);"]).result,n.setCode(a)}),e.translucentFinalEncoder.setPipelineHash("oitpf"),e.translucentFinalEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:"rgba16float",blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcfactor:"one",dstFactor:"one-minus-src-alpha"}}}]}})}}var Qw={colorTextureView:null,depthTextureView:null};function Iv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Qw,r),Bt.extend(t,e,r),m.setGet(t,e,["colorTextureView","depthTextureView"]),qw(t,e)}var Zw=m.newInstance(Iv,"vtkWebGPUOrderIndependentTranslucentPass"),Iw={newInstance:Zw,extend:Iv},Vr={COMPOSITE_BLEND:0,MAXIMUM_INTENSITY_BLEND:1,MINIMUM_INTENSITY_BLEND:2,AVERAGE_INTENSITY_BLEND:3,ADDITIVE_INTENSITY_BLEND:4,RADON_TRANSFORM_BLEND:5},Jw=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::Volume::TraverseDec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

fn getTextureValue(vTex: texture_3d<f32>, tpos: vec4<f32>) -> f32
{
  // todo multicomponent support
  return textureSampleLevel(vTex, clampSampler, tpos.xyz, 0.0).r;
}

fn getGradient(vTex: texture_3d<f32>, tpos: vec4<f32>, vNum: i32, scalar: f32) -> vec4<f32>
{
  var result: vec4<f32>;

  var tstep: vec4<f32> = volumeSSBO.values[vNum].tstep;
  result.x = getTextureValue(vTex, tpos + vec4<f32>(tstep.x, 0.0, 0.0, 1.0)) - scalar;
  result.y = getTextureValue(vTex, tpos + vec4<f32>(0.0, tstep.y, 0.0, 1.0)) - scalar;
  result.z = getTextureValue(vTex, tpos + vec4<f32>(0.0, 0.0, tstep.z, 1.0)) - scalar;
  result.w = 0.0;

  // divide by spacing as that is our delta
  result = result / volumeSSBO.values[vNum].spacing;
  // now we have a gradient in unit tcoords

  var grad: f32 = length(result.xyz);
  if (grad > 0.0)
  {
    // rotate to View Coords, needed for lighting and shading
    var nMat: mat4x4<f32> = rendererUBO.SCVCMatrix * volumeSSBO.values[vNum].planeNormals;
    result = nMat * result;
    result = result / length(result);
  }

  // store gradient magnitude in .w
  result.w = grad;

  return result;
}

fn processVolume(vTex: texture_3d<f32>, vNum: i32, cNum: i32, posSC: vec4<f32>, tfunRows: f32) -> vec4<f32>
{
  var outColor: vec4<f32> = vec4<f32>(0.0, 0.0, 0.0, 0.0);

  // convert to tcoords and reject if outside the volume
  var tpos: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*posSC;
  if (tpos.x < 0.0 || tpos.y < 0.0 || tpos.z < 0.0 ||
      tpos.x > 1.0 || tpos.y > 1.0 || tpos.z > 1.0) { return outColor; }

  var scalar: f32 = getTextureValue(vTex, tpos);

  var coord: vec2<f32> =
    vec2<f32>(scalar * componentSSBO.values[cNum].cScale + componentSSBO.values[cNum].cShift,
      (0.5 + 2.0 * f32(vNum)) / tfunRows);
  var color: vec4<f32> = textureSampleLevel(tfunTexture, clampSampler, coord, 0.0);

  var gofactor: f32 = 1.0;
  var normal: vec4<f32> = vec4<f32>(0.0,0.0,0.0,0.0);
  if (componentSSBO.values[cNum].gomin <  1.0 || volumeSSBO.values[vNum].shade[0] > 0.0)
  {
    normal = getGradient(vTex, tpos, vNum, scalar);
    if (componentSSBO.values[cNum].gomin <  1.0)
    {
      gofactor = clamp(normal.a*componentSSBO.values[cNum].goScale + componentSSBO.values[cNum].goShift,
      componentSSBO.values[cNum].gomin, componentSSBO.values[cNum].gomax);
    }
  }

  coord.x = (scalar * componentSSBO.values[cNum].oScale + componentSSBO.values[cNum].oShift);
  var opacity: f32 = textureSampleLevel(ofunTexture, clampSampler, coord, 0.0).r;

  if (volumeSSBO.values[vNum].shade[0] > 0.0)
  {
    color = color*abs(normal.z);
  }

  outColor = vec4<f32>(color.rgb, gofactor * opacity);

  return outColor;
}

// adjust the start and end point of a raycast such that it intersects the unit cube.
// This function is used to take a raycast starting point and step vector
// and numSteps and return the startijng and ending steps for intersecting the
// unit cube. Recall for a 3D texture, the unit cube is the range of texture coordsinates
// that have valid values. So this funtion can be used to take a ray in texture coordinates
// and bound it to intersecting the texture.
//
fn adjustBounds(tpos: vec4<f32>, tstep: vec4<f32>, numSteps: f32) -> vec2<f32>
{
  var result: vec2<f32> = vec2<f32>(0.0, numSteps);
  var tpos2: vec4<f32> = tpos + tstep*numSteps;

  // move tpos to the start of the volume
  var adjust: f32 =
    min(
      max(tpos.x/tstep.x, (tpos.x - 1.0)/tstep.x),
      min(
        max((tpos.y - 1.0)/tstep.y, tpos.y/tstep.y),
        max((tpos.z - 1.0)/tstep.z, tpos.z/tstep.z)));
  if (adjust < 0.0)
  {
    result.x = result.x - adjust;
  }

  // adjust length to the end
  adjust =
    max(
      min(tpos2.x/tstep.x, (tpos2.x - 1.0)/tstep.x),
      max(
        min((tpos2.y - 1.0)/tstep.y, tpos2.y/tstep.y),
        min((tpos2.z - 1.0)/tstep.z, tpos2.z/tstep.z)));
  if (adjust > 0.0)
  {
    result.y = result.y - adjust;
  }

  return result;
}

fn getSimpleColor(scalar: f32, vNum: i32, cNum: i32) -> vec4<f32>
{
  // how many rows (tfuns) do we have in our tfunTexture
  var tfunRows: f32 = f32(textureDimensions(tfunTexture).y);

  var coord: vec2<f32> =
    vec2<f32>(scalar * componentSSBO.values[cNum].cScale + componentSSBO.values[cNum].cShift,
      (0.5 + 2.0 * f32(vNum)) / tfunRows);
  var color: vec4<f32> = textureSampleLevel(tfunTexture, clampSampler, coord, 0.0);
  coord.x = (scalar * componentSSBO.values[cNum].oScale + componentSSBO.values[cNum].oShift);
  var opacity: f32 = textureSampleLevel(ofunTexture, clampSampler, coord, 0.0).r;
  return vec4<f32>(color.rgb, opacity);
}

fn traverseMax(vTex: texture_3d<f32>, vNum: i32, cNum: i32, rayLengthSC: f32, minPosSC: vec4<f32>, rayStepSC: vec4<f32>)
{
  // convert to tcoords and reject if outside the volume
  var numSteps: f32 = rayLengthSC/mapperUBO.SampleDistance;
  var tpos: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*minPosSC;
  var tpos2: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*(minPosSC + rayStepSC);
  var tstep: vec4<f32> = tpos2 - tpos;

  var rayBounds: vec2<f32> = adjustBounds(tpos, tstep, numSteps);

  // did we hit anything
  if (rayBounds.x >= rayBounds.y)
  {
    traverseVals[vNum] = vec4<f32>(0.0,0.0,0.0,0.0);
    return;
  }

  tpos = tpos + tstep*rayBounds.x;
  var curDist: f32 = rayBounds.x;
  var maxVal: f32 = -1.0e37;
  loop
  {
    var scalar: f32 = getTextureValue(vTex, tpos);
    if (scalar > maxVal)
    {
      maxVal = scalar;
    }

    // increment position
    curDist = curDist + 1.0;
    tpos = tpos + tstep;

    // check if we have reached a terminating condition
    if (curDist > rayBounds.y) { break; }
  }

  // process to get the color and opacity
  traverseVals[vNum] = getSimpleColor(maxVal, vNum, cNum);
}

fn traverseMin(vTex: texture_3d<f32>, vNum: i32, cNum: i32, rayLengthSC: f32, minPosSC: vec4<f32>, rayStepSC: vec4<f32>)
{
  // convert to tcoords and reject if outside the volume
  var numSteps: f32 = rayLengthSC/mapperUBO.SampleDistance;
  var tpos: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*minPosSC;
  var tpos2: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*(minPosSC + rayStepSC);
  var tstep: vec4<f32> = tpos2 - tpos;

  var rayBounds: vec2<f32> = adjustBounds(tpos, tstep, numSteps);

  // did we hit anything
  if (rayBounds.x >= rayBounds.y)
  {
    traverseVals[vNum] = vec4<f32>(0.0,0.0,0.0,0.0);
    return;
  }

  tpos = tpos + tstep*rayBounds.x;
  var curDist: f32 = rayBounds.x;
  var minVal: f32 = 1.0e37;
  loop
  {
    var scalar: f32 = getTextureValue(vTex, tpos);
    if (scalar < minVal)
    {
      minVal = scalar;
    }

    // increment position
    curDist = curDist + 1.0;
    tpos = tpos + tstep;

    // check if we have reached a terminating condition
    if (curDist > rayBounds.y) { break; }
  }

  // process to get the color and opacity
  traverseVals[vNum] = getSimpleColor(minVal, vNum, cNum);
}

fn traverseAverage(vTex: texture_3d<f32>, vNum: i32, cNum: i32, rayLengthSC: f32, minPosSC: vec4<f32>, rayStepSC: vec4<f32>)
{
  // convert to tcoords and reject if outside the volume
  var numSteps: f32 = rayLengthSC/mapperUBO.SampleDistance;
  var tpos: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*minPosSC;
  var tpos2: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*(minPosSC + rayStepSC);
  var tstep: vec4<f32> = tpos2 - tpos;

  var rayBounds: vec2<f32> = adjustBounds(tpos, tstep, numSteps);

  // did we hit anything
  if (rayBounds.x >= rayBounds.y)
  {
    traverseVals[vNum] = vec4<f32>(0.0,0.0,0.0,0.0);
    return;
  }

  let ipRange: vec4<f32> = volumeSSBO.values[vNum].ipScalarRange;
  tpos = tpos + tstep*rayBounds.x;
  var curDist: f32 = rayBounds.x;
  var avgVal: f32 = 0.0;
  var sampleCount: f32 = 0.0;
  loop
  {
    var sample: f32 = getTextureValue(vTex, tpos);
    // right now leave filtering off until WebGL changes get merged
    // if (ipRange.z == 0.0 || sample >= ipRange.x && sample <= ipRange.y)
    // {
      avgVal = avgVal + sample;
      sampleCount = sampleCount + 1.0;
    // }

    // increment position
    curDist = curDist + 1.0;
    tpos = tpos + tstep;

    // check if we have reached a terminating condition
    if (curDist > rayBounds.y) { break; }
  }

  if (sampleCount <= 0.0)
  {
    traverseVals[vNum] = vec4<f32>(0.0,0.0,0.0,0.0);
  }

  // process to get the color and opacity
  traverseVals[vNum] = getSimpleColor(avgVal/sampleCount, vNum, cNum);
}

fn traverseAdditive(vTex: texture_3d<f32>, vNum: i32, cNum: i32, rayLengthSC: f32, minPosSC: vec4<f32>, rayStepSC: vec4<f32>)
{
  // convert to tcoords and reject if outside the volume
  var numSteps: f32 = rayLengthSC/mapperUBO.SampleDistance;
  var tpos: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*minPosSC;
  var tpos2: vec4<f32> = volumeSSBO.values[vNum].SCTCMatrix*(minPosSC + rayStepSC);
  var tstep: vec4<f32> = tpos2 - tpos;

  var rayBounds: vec2<f32> = adjustBounds(tpos, tstep, numSteps);

  // did we hit anything
  if (rayBounds.x >= rayBounds.y)
  {
    traverseVals[vNum] = vec4<f32>(0.0,0.0,0.0,0.0);
    return;
  }

  let ipRange: vec4<f32> = volumeSSBO.values[vNum].ipScalarRange;
  tpos = tpos + tstep*rayBounds.x;
  var curDist: f32 = rayBounds.x;
  var sumVal: f32 = 0.0;
  loop
  {
    var sample: f32 = getTextureValue(vTex, tpos);
    // right now leave filtering off until WebGL changes get merged
    // if (ipRange.z == 0.0 || sample >= ipRange.x && sample <= ipRange.y)
    // {
      sumVal = sumVal + sample;
    // }

    // increment position
    curDist = curDist + 1.0;
    tpos = tpos + tstep;

    // check if we have reached a terminating condition
    if (curDist > rayBounds.y) { break; }
  }

  // process to get the color and opacity
  traverseVals[vNum] = getSimpleColor(sumVal, vNum, cNum);
}

fn composite(rayLengthSC: f32, minPosSC: vec4<f32>, rayStepSC: vec4<f32>) -> vec4<f32>
{
  // initial ray position is at the beginning
  var rayPosSC: vec4<f32> = minPosSC;

  // how many rows (tfuns) do we have in our tfunTexture
  var tfunRows: f32 = f32(textureDimensions(tfunTexture).y);

  var curDist: f32 = 0.0;
  var computedColor: vec4<f32> = vec4<f32>(0.0, 0.0, 0.0, 0.0);
  var sampleColor: vec4<f32>;
//VTK::Volume::TraverseCalls

  loop
  {
    // for each volume, sample and accumulate color
//VTK::Volume::CompositeCalls

    // increment position
    curDist = curDist + mapperUBO.SampleDistance;
    rayPosSC = rayPosSC + rayStepSC;

    // check if we have reached a terminating condition
    if (curDist > rayLengthSC) { break; }
    if (computedColor.a > 0.98) { break; }
  }
  return computedColor;
}

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var rayMax: f32 = textureSampleLevel(maxTexture, clampSampler, input.tcoordVS, 0.0).r;
  var rayMin: f32 = textureSampleLevel(minTexture, clampSampler, input.tcoordVS, 0.0).r;

  // discard empty rays
  if (rayMax <= rayMin) { discard; }
  else
  {
    // compute start and end ray positions in view coordinates
    var minPosSC: vec4<f32> = rendererUBO.PCSCMatrix*vec4<f32>(2.0 * input.tcoordVS.x - 1.0, 1.0 - 2.0 * input.tcoordVS.y, rayMax, 1.0);
    minPosSC = minPosSC * (1.0 / minPosSC.w);
    var maxPosSC: vec4<f32> = rendererUBO.PCSCMatrix*vec4<f32>(2.0 * input.tcoordVS.x - 1.0, 1.0 - 2.0 * input.tcoordVS.y, rayMin, 1.0);
    maxPosSC = maxPosSC * (1.0 / maxPosSC.w);

    var rayLengthSC: f32 = distance(minPosSC.xyz, maxPosSC.xyz);
    var rayStepSC: vec4<f32> = (maxPosSC - minPosSC)*(mapperUBO.SampleDistance/rayLengthSC);
    rayStepSC.w = 0.0;

    var computedColor: vec4<f32>;

//VTK::Volume::Loop

//VTK::RenderEncoder::Impl
  }

  return output;
}
`,_e=new Float64Array(16),Gt=new Float64Array(16);function eE(t,e){e.classHierarchy.push("vtkWebGPUVolumePassFSQ"),t.replaceShaderPosition=function(a,i,s){var o=i.getShaderDescription("vertex");o.addBuiltinOutput("vec4<f32>","@builtin(position) Position");var u=o.getCode();u=X.substitute(u,"//VTK::Position::Impl",["output.tcoordVS = vec2<f32>(vertexBC.x * 0.5 + 0.5, 1.0 - vertexBC.y * 0.5 - 0.5);","output.Position = vec4<f32>(vertexBC, 1.0);"]).result,o.setCode(u);var c=i.getShaderDescription("fragment");c.addBuiltinInput("vec4<f32>","@builtin(position) fragPos")},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderVolume=function(a,i,s){for(var o=i.getShaderDescription("fragment"),u=o.getCode(),c=[],f=[],g=0;g<e.volumes.length;g++){var v=e.volumes[g].getRenderable().getMapper().getBlendMode();v===Vr.COMPOSITE_BLEND?(c.push("    sampleColor = processVolume(volTexture".concat(g,", ").concat(g,", ").concat(e.rowStarts[g],", rayPosSC, tfunRows);")),c.push(`    computedColor = vec4<f32>(
          sampleColor.a * sampleColor.rgb * (1.0 - computedColor.a) + computedColor.rgb,
          (1.0 - computedColor.a)*sampleColor.a + computedColor.a);`)):(f.push("  sampleColor = traverseVals[".concat(g,"];")),f.push(`  computedColor = vec4<f32>(
          sampleColor.a * sampleColor.rgb * (1.0 - computedColor.a) + computedColor.rgb,
          (1.0 - computedColor.a)*sampleColor.a + computedColor.a);`))}u=X.substitute(u,"//VTK::Volume::CompositeCalls",c).result,u=X.substitute(u,"//VTK::Volume::TraverseCalls",f).result,u=X.substitute(u,"//VTK::Volume::TraverseDec",["var<private> traverseVals: array<vec4<f32>,".concat(e.volumes.length,">;")]).result;for(var p=!1,l=0;l<e.volumes.length;l++){var y=e.volumes[l].getRenderable().getMapper().getBlendMode();y===Vr.COMPOSITE_BLEND?p=!0:y===Vr.MAXIMUM_INTENSITY_BLEND?u=X.substitute(u,"//VTK::Volume::Loop",["    traverseMax(volTexture".concat(l,", ").concat(l,", ").concat(l,", rayLengthSC, minPosSC, rayStepSC);"),"    computedColor = traverseVals[".concat(l,"];"),"//VTK::Volume::Loop"]).result:y===Vr.MINIMUM_INTENSITY_BLEND?u=X.substitute(u,"//VTK::Volume::Loop",["    traverseMin(volTexture".concat(l,", ").concat(l,", ").concat(l,", rayLengthSC, minPosSC, rayStepSC);"),"    computedColor = traverseVals[".concat(l,"];"),"//VTK::Volume::Loop"]).result:y===Vr.AVERAGE_INTENSITY_BLEND?u=X.substitute(u,"//VTK::Volume::Loop",["    traverseAverage(volTexture".concat(l,", ").concat(l,", ").concat(l,", rayLengthSC, minPosSC, rayStepSC);"),"    computedColor = traverseVals[".concat(l,"];"),"//VTK::Volume::Loop"]).result:y===Vr.ADDITIVE_INTENSITY_BLEND&&(u=X.substitute(u,"//VTK::Volume::Loop",["    traverseAdditive(volTexture".concat(l,", ").concat(l,", ").concat(l,", rayLengthSC, minPosSC, rayStepSC);"),"    computedColor = traverseVals[".concat(l,"];"),"//VTK::Volume::Loop"]).result)}p&&(u=X.substitute(u,"//VTK::Volume::Loop",["    computedColor = composite(rayLengthSC, minPosSC, rayStepSC);"]).result),o.setCode(u)},e.shaderReplacements.set("replaceShaderVolume",t.replaceShaderVolume),t.updateLUTImage=function(a){for(var i=t.getMTime(),s=0;s<e.volumes.length;s++){var o=e.volumes[s].getRenderable(),u=o.getMapper().getInputData();i=Math.max(i,o.getMTime(),u.getMTime())}if(!(i<e.lutBuildTime.getMTime())){e.numRows=0,e.rowStarts=[];for(var c=0;c<e.volumes.length;c++){e.rowStarts.push(e.numRows);var f=e.volumes[c],g=f.getRenderable(),v=g.getMapper(),p=g.getProperty(),l=v.getInputData(),y=l.getPointData()&&l.getPointData().getScalars(),h=y.getNumberOfComponents(),d=p.getIndependentComponents(),S=d?h:1;e.numRows+=S}for(var T=new Uint8Array(e.numRows*2*e.rowLength*4),C=new Float32Array(e.numRows*2*e.rowLength),x=0,O=new Float32Array(e.rowLength*3),w=e.rowLength,E=0;E<e.volumes.length;E++)for(var V=e.volumes[E],D=V.getRenderable(),M=D.getMapper(),L=D.getProperty(),N=M.getInputData(),B=N.getPointData()&&N.getPointData().getScalars(),_=B.getNumberOfComponents(),A=L.getIndependentComponents(),W=A?_:1,z=0;z<W;++z){var R=L.getRGBTransferFunction(z),b=R.getRange();R.getTable(b[0],b[1],w,O,1);for(var F=x*w*4,G=0;G<w;++G){T[F+G*4]=255*O[G*3],T[F+G*4+1]=255*O[G*3+1],T[F+G*4+2]=255*O[G*3+2],T[F+G*4+3]=255;for(var U=0;U<4;U++)T[F+(w+G)*4+U]=T[F+G*4+U]}var H=L.getScalarOpacity(z),j=e.sampleDist/L.getScalarOpacityUnitDistance(z),I=H.getRange();H.getTable(I[0],I[1],w,O,1),F=x*w;for(var re=0;re<w;++re)C[F+re]=1-Math.pow(1-O[re],j),C[F+re+w]=C[F+re];x+=2}{var ue={nativeArray:T,width:e.rowLength,height:e.numRows*2,depth:1,format:"rgba8unorm"},Le=a.getTextureManager().getTexture(ue),le=Le.createView("tfunTexture");e.textureViews[2]=le}{var J={nativeArray:C,width:e.rowLength,height:e.numRows*2,depth:1,format:"r16float"},te=a.getTextureManager().getTexture(J),$=te.createView("ofunTexture");e.textureViews[3]=$}e.lutBuildTime.modified()}},t.updateSSBO=function(a){for(var i=Math.max(t.getMTime(),e.WebGPURenderer.getStabilizedTime()),s=0;s<e.volumes.length;s++){var o=e.volumes[s].getRenderable(),u=o.getMapper(),c=u.getInputData();i=Math.max(i,o.getMTime(),c.getMTime(),u.getMTime())}if(!(i<e.SSBO.getSendTime())){var f=e.WebGPURenderer.getStabilizedCenterByReference();e.SSBO.clearData(),e.SSBO.setNumberOfInstances(e.volumes.length);for(var g=new Float64Array(e.volumes.length*16),v=new Float64Array(e.volumes.length*16),p=new Float64Array(e.volumes.length*4),l=new Float64Array(e.volumes.length*4),y=new Float64Array(e.volumes.length*4),h=new Float64Array(e.volumes.length*4),d=0;d<e.volumes.length;d++){var S=e.volumes[d],T=S.getRenderable(),C=T.getMapper(),x=C.getInputData();ae(_e),me(_e,_e,f);var O=T.getMatrix();ye(Gt,O),He(Gt,Gt),ke(_e,Gt,_e);var w=x.getWorldToIndex();ke(_e,w,_e);var E=x.getDimensions();ae(Gt),Gr(Gt,Gt,[1/E[0],1/E[1],1/E[2]]),ke(_e,Gt,_e);for(var V=0;V<16;V++)g[d*16+V]=_e[V];He(_e,_e);for(var D=0;D<4;D++)v[d*16+D*4]=_e[D*4],v[d*16+D*4+1]=_e[D*4+1],v[d*16+D*4+2]=_e[D*4+2],v[d*16+D*4+3]=0;p[d*4]=1/E[0],p[d*4+1]=1/E[1],p[d*4+2]=1/E[2],p[d*4+3]=1,l[d*4]=T.getProperty().getShade()?1:0;var M=x.getSpacing();y[d*4]=M[0],y[d*4+1]=M[1],y[d*4+2]=M[2],y[d*4+3]=1;var L=e.textureViews[d+4].getTexture().getScale(),N=C.getIpScalarRange();h[d*4]=N[0]/L,h[d*4+1]=N[1]/L,h[d*4+2]=C.getFilterMode()}e.SSBO.addEntry("SCTCMatrix","mat4x4<f32>"),e.SSBO.addEntry("planeNormals","mat4x4<f32>"),e.SSBO.addEntry("shade","vec4<f32>"),e.SSBO.addEntry("tstep","vec4<f32>"),e.SSBO.addEntry("spacing","vec4<f32>"),e.SSBO.addEntry("ipScalarRange","vec4<f32>"),e.SSBO.setAllInstancesFromArray("SCTCMatrix",g),e.SSBO.setAllInstancesFromArray("planeNormals",v),e.SSBO.setAllInstancesFromArray("shade",l),e.SSBO.setAllInstancesFromArray("tstep",p),e.SSBO.setAllInstancesFromArray("spacing",y),e.SSBO.setAllInstancesFromArray("ipScalarRange",h),e.SSBO.send(a),e.componentSSBO.clearData(),e.componentSSBO.setNumberOfInstances(e.numRows);for(var B=new Float64Array(e.numRows),_=new Float64Array(e.numRows),A=new Float64Array(e.numRows),W=new Float64Array(e.numRows),z=new Float64Array(e.numRows),R=new Float64Array(e.numRows),b=new Float64Array(e.numRows),F=new Float64Array(e.numRows),G=0,U=0;U<e.volumes.length;U++){var H=e.volumes[U],j=H.getRenderable(),I=j.getMapper(),re=j.getProperty(),ue=I.getInputData(),Le=ue.getPointData()&&ue.getPointData().getScalars(),le=Le.getNumberOfComponents(),J=re.getIndependentComponents(),te=e.textureViews[U+4].getTexture().getFormat(),$=Ve.getDetailsFromTextureFormat(te),Q=$.elementSize===2&&$.sampleType==="float",Z={scale:[255],offset:[0]};Q&&(Z.scale[0]=1);for(var K=0;K<le;K++){var De=J?K:0,et=Z.scale[K],kt=re.getScalarOpacity(De),Ke=kt.getRange(),xt=et/(Ke[1]-Ke[0]),Zt=(Z.offset[K]-Ke[0])/(Ke[1]-Ke[0]);W[G]=Zt,A[G]=xt;var Sr=re.getRGBTransferFunction(De),ft=Sr.getRange();_[G]=(Z.offset[K]-ft[0])/(ft[1]-ft[0]),B[G]=et/(ft[1]-ft[0]);var Cp=re.getUseGradientOpacity(De);if(Cp){var On=re.getGradientOpacityMinimumOpacity(De),za=re.getGradientOpacityMaximumOpacity(De);z[G]=On,R[G]=za;var Yr=[re.getGradientOpacityMinimumValue(De),re.getGradientOpacityMaximumValue(De)];F[G]=et*(za-On)/(Yr[1]-Yr[0]),b[G]=-Yr[0]*(za-On)/(Yr[1]-Yr[0])+On}else z[G]=1,R[G]=1,F[G]=0,b[G]=1;G++}}e.componentSSBO.addEntry("cScale","f32"),e.componentSSBO.addEntry("cShift","f32"),e.componentSSBO.addEntry("oScale","f32"),e.componentSSBO.addEntry("oShift","f32"),e.componentSSBO.addEntry("goShift","f32"),e.componentSSBO.addEntry("goScale","f32"),e.componentSSBO.addEntry("gomin","f32"),e.componentSSBO.addEntry("gomax","f32"),e.componentSSBO.setAllInstancesFromArray("cScale",B),e.componentSSBO.setAllInstancesFromArray("cShift",_),e.componentSSBO.setAllInstancesFromArray("oScale",A),e.componentSSBO.setAllInstancesFromArray("oShift",W),e.componentSSBO.setAllInstancesFromArray("goScale",F),e.componentSSBO.setAllInstancesFromArray("goShift",b),e.componentSSBO.setAllInstancesFromArray("gomin",z),e.componentSSBO.setAllInstancesFromArray("gomax",R),e.componentSSBO.send(a)}};var r=t.updateBuffers;t.updateBuffers=function(){r();for(var a=e.volumes[0].getRenderable().getMapper().getSampleDistance(),i=0;i<e.volumes.length;i++){var s=e.volumes[i],o=s.getRenderable().getMapper(),u=o.getSampleDistance();u<a&&(a=u)}e.sampleDist!==a&&(e.sampleDist=a,e.UBO.setValue("SampleDistance",a),e.UBO.sendIfNeeded(e.device));for(var c=0;c<e.volumes.length;c++){var f=e.volumes[c],g=f.getRenderable(),v=g.getMapper(),p=v.getInputData(),l=e.device.getTextureManager().getTextureForImageData(p);if(!e.textureViews[c+4]||e.textureViews[c+4].getTexture()!==l){var y=l.createView("volTexture".concat(c));e.textureViews[c+4]=y}}if(e.volumes.length<e.lastVolumeLength)for(var h=e.volumes.length;h<e.lastVolumeLength;h++)e.textureViews.pop();e.lastVolumeLength=e.volumes.length,t.updateLUTImage(e.device),t.updateSSBO(e.device),e.clampSampler||(e.clampSampler=Rs.newInstance({label:"clampSampler"}),e.clampSampler.create(e.device,{minFilter:"linear",magFilter:"linear"}))},t.computePipelineHash=function(){e.pipelineHash="volfsq";for(var a=0;a<e.volumes.length;a++){var i=e.volumes[a].getRenderable().getMapper().getBlendMode();e.pipelineHash+="".concat(i)}},t.setVolumes=function(a){if(!e.volumes||e.volumes.length!==a.length){e.volumes=Y(a),t.modified();return}for(var i=0;i<a.length;i++)if(a[i]!==e.volumes[i]){e.volumes=Y(a),t.modified();return}};var n=t.getBindables;t.getBindables=function(){var a=n();return a.push(e.componentSSBO),a.push(e.clampSampler),a}}var tE={volumes:null,rowLength:1024,lastVolumeLength:0};function Jv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,tE,r),Hr.extend(t,e,r),e.fragmentShaderTemplate=Jw,e.UBO=hr.newInstance({label:"mapperUBO"}),e.UBO.addEntry("SampleDistance","f32"),e.SSBO=$i.newInstance({label:"volumeSSBO"}),e.componentSSBO=$i.newInstance({label:"componentSSBO"}),e.lutBuildTime={},m.obj(e.lutBuildTime,{mtime:0}),eE(t,e)}var rE=m.newInstance(Jv,"vtkWebGPUVolumePassFSQ"),nE={newInstance:rE,extend:Jv},aE=Tr.Representation,Qu=Je.BufferUsage,iE=Je.PrimitiveTypes,Ti=[[0,4,6],[0,6,2],[1,3,7],[1,7,5],[0,5,4],[0,1,5],[2,6,7],[2,7,3],[0,3,1],[0,2,3],[4,5,7],[4,7,6]],sE=`
//VTK::Renderer::Dec

//VTK::Select::Dec

//VTK::VolumePass::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  //VTK::Select::Impl

  //VTK::TCoord::Impl

  //VTK::VolumePass::Impl

  // use the maximum (closest) of the current value and the zbuffer
  // the blend func will then take the min to find the farthest stop value
  var stopval: f32 = max(input.fragPos.z, textureLoad(opaquePassDepthTexture, vec2<i32>(i32(input.fragPos.x), i32(input.fragPos.y)), 0));

  //VTK::RenderEncoder::Impl
  return output;
}
`,oE=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var computedColor: vec4<f32> = textureSample(volumePassColorTexture,
    volumePassColorTextureSampler, mapperUBO.tscale*input.tcoordVS);

  //VTK::RenderEncoder::Impl
  return output;
}
`;function uE(t,e){e.classHierarchy.push("vtkWebGPUVolumePass"),t.initialize=function(r){e._clearEncoder||t.createClearEncoder(r),e._mergeEncoder||t.createMergeEncoder(r),e._copyEncoder||t.createCopyEncoder(r),e._depthRangeEncoder||t.createDepthRangeEncoder(r),e.fullScreenQuad||(e.fullScreenQuad=nE.newInstance(),e.fullScreenQuad.setDevice(r.getDevice()),e.fullScreenQuad.setTextureViews(Y(e._depthRangeEncoder.getColorTextureViews()))),e._volumeCopyQuad||(e._volumeCopyQuad=Hr.newInstance(),e._volumeCopyQuad.setPipelineHash("volpassfsq"),e._volumeCopyQuad.setDevice(r.getDevice()),e._volumeCopyQuad.setFragmentShaderTemplate(oE),e._copyUBO=hr.newInstance({label:"mapperUBO"}),e._copyUBO.addEntry("tscale","vec2<f32>"),e._volumeCopyQuad.setUBO(e._copyUBO),e._volumeCopyQuad.setTextureViews([e._colorTextureView]))},t.traverse=function(r,n){if(!e.deleted){e._currentParent=n,t.initialize(n),t.computeTiming(n),t.renderDepthBounds(r,n),e._firstGroup=!0;var a=n.getDevice(),i=a.getHandle().limits.maxSampledTexturesPerShaderStage-4;if(e.volumes.length>i){for(var s=r.getRenderable().getActiveCamera().getPosition(),o=[],u=0;u<e.volumes.length;u++){var c=e.volumes[u].getRenderable().getBounds(),f=[.5*(c[1]+c[0]),.5*(c[3]+c[2]),.5*(c[5]+c[4])];o[u]=lt(f,s)}var g=Y(Array(e.volumes.length).keys());g.sort(function(d,S){return o[S]-o[d]});for(var v=[],p=g.length%i,l=0;l<g.length;l++)v.push(e.volumes[g[l]]),v.length>=p&&(t.rayCastPass(n,r,v),v=[],p=i,e._firstGroup=!1)}else t.rayCastPass(n,r,e.volumes);if(e._volumeCopyQuad.setWebGPURenderer(r),e._useSmallViewport){var y=e._colorTextureView.getTexture().getWidth(),h=e._colorTextureView.getTexture().getHeight();e._copyUBO.setArray("tscale",[e._smallViewportWidth/y,e._smallViewportHeight/h])}else e._copyUBO.setArray("tscale",[1,1]);e._copyUBO.sendIfNeeded(a),e._copyEncoder.setColorTextureView(0,e.colorTextureView),e._copyEncoder.attachTextureViews(),e._copyEncoder.begin(n.getCommandEncoder()),r.scissorAndViewport(e._copyEncoder),e._volumeCopyQuad.prepareAndDraw(e._copyEncoder),e._copyEncoder.end()}},t.delete=m.chain(function(){e._animationRateSubscription&&(e._animationRateSubscription.unsubscribe(),e._animationRateSubscription=null)},t.delete),t.computeTiming=function(r){e._useSmallViewport=!1;var n=r.getRenderable().getInteractor();n.isAnimating()&&e._lastScale>1.5&&(e._smallViewportHeight||(e._smallViewportWidth=Math.ceil(r.getCanvas().width/Math.sqrt(e._lastScale)),e._smallViewportHeight=Math.ceil(r.getCanvas().height/Math.sqrt(e._lastScale))),e._useSmallViewport=!0),e._colorTexture.resize(r.getCanvas().width,r.getCanvas().height),e._animationRateSubscription||(e._animationRateSubscription=n.onAnimationFrameRateUpdate(function(){var a=e.volumes[0].getRenderable().getMapper();if(a.getAutoAdjustSampleDistances()){var i=n.getRecentAnimationFrameRate(),s=e._lastScale*n.getDesiredUpdateRate()/i;e._lastScale=s,e._lastScale>400&&(e._lastScale=400)}else e._lastScale=a.getImageSampleDistance()*a.getImageSampleDistance();e._lastScale<1.5?e._lastScale=1.5:(e._smallViewportWidth=Math.ceil(r.getCanvas().width/Math.sqrt(e._lastScale)),e._smallViewportHeight=Math.ceil(r.getCanvas().height/Math.sqrt(e._lastScale)))}))},t.rayCastPass=function(r,n,a){var i=e._firstGroup?e._clearEncoder:e._mergeEncoder;i.attachTextureViews(),i.begin(r.getCommandEncoder());var s=e._colorTextureView.getTexture().getWidth(),o=e._colorTextureView.getTexture().getHeight();e._useSmallViewport&&(s=e._smallViewportWidth,o=e._smallViewportHeight),i.getHandle().setViewport(0,0,s,o,0,1),i.getHandle().setScissorRect(0,0,s,o),e.fullScreenQuad.setWebGPURenderer(n),e.fullScreenQuad.setVolumes(a),e.fullScreenQuad.prepareAndDraw(i),i.end()},t.renderDepthBounds=function(r,n){t.updateDepthPolyData(r);var a=e._boundsPoly,i=a.getPoints(),s=a.getPolys(),o={hash:"vp".concat(s.getMTime()),usage:Qu.Index,cells:s,numberOfPoints:i.getNumberOfPoints(),primitiveType:iE.Triangles,representation:aE.SURFACE},u=n.getDevice().getBufferManager().getBuffer(o);e._mapper.getVertexInput().setIndexBuffer(u),o={usage:Qu.PointArray,format:"float32x4",hash:"vp".concat(i.getMTime()).concat(s.getMTime()),dataArray:i,indexBuffer:u,packExtra:!0};var c=n.getDevice().getBufferManager().getBuffer(o);e._mapper.getVertexInput().addBuffer(c,["vertexBC"]),e._mapper.setNumberOfVertices(c.getSizeInBytes()/c.getStrideInBytes()),t.drawDepthRange(r,n)},t.updateDepthPolyData=function(r){for(var n=!1,a=0;a<e.volumes.length;a++){var i=e.volumes[a].getMTime();(!e._lastMTimes[a]||i!==e._lastMTimes[a])&&(n=!0,e._lastMTimes[a]=i)}var s=r.getStabilizedTime();if((e._lastMTimes.length<=e.volumes.length||s!==e._lastMTimes[e.volumes.length])&&(n=!0,e._lastMTimes[e.volumes.length]=s),!!n){for(var o=r.getStabilizedCenterByReference(),u=e.volumes.length*8,c=new Float64Array(u*3),f=e.volumes.length*12,g=new Uint16Array(f*4),v=0;v<e.volumes.length;v++){e.volumes[v].getBoundingCubePoints(c,v*24);for(var p=v*12*4,l=v*8,y=0;y<12;y++)g[p++]=3,g[p++]=l+Ti[y][0],g[p++]=l+Ti[y][1],g[p++]=l+Ti[y][2]}for(var h=0;h<c.length;h+=3)c[h]-=o[0],c[h+1]-=o[1],c[h+2]-=o[2];e._boundsPoly.getPoints().setData(c,3),e._boundsPoly.getPoints().modified(),e._boundsPoly.getPolys().setData(g,1),e._boundsPoly.getPolys().modified(),e._boundsPoly.modified()}},t.drawDepthRange=function(r,n){e._depthRangeTexture.resizeToMatch(e.colorTextureView.getTexture()),e._depthRangeTexture2.resizeToMatch(e.colorTextureView.getTexture()),e._depthRangeEncoder.attachTextureViews(),t.setCurrentOperation("volumeDepthRangePass"),r.setRenderEncoder(e._depthRangeEncoder),r.volumeDepthRangePass(!0),e._mapper.setWebGPURenderer(r),e._mapper.prepareToDraw(e._depthRangeEncoder),e._mapper.registerDrawCallback(e._depthRangeEncoder),r.volumeDepthRangePass(!1)},t.createDepthRangeEncoder=function(r){var n=r.getDevice();e._depthRangeEncoder=Rt.newInstance({label:"VolumePass DepthRange"}),e._depthRangeEncoder.setPipelineHash("volr"),e._depthRangeEncoder.setReplaceShaderCodeFunction(function(s){var o=s.getShaderDescription("fragment");o.addOutput("vec4<f32>","outColor1"),o.addOutput("vec4<f32>","outColor2");var u=o.getCode();u=X.substitute(u,"//VTK::RenderEncoder::Impl",["output.outColor1 = vec4<f32>(input.fragPos.z, 0.0, 0.0, 0.0);","output.outColor2 = vec4<f32>(stopval, 0.0, 0.0, 0.0);"]).result,o.setCode(u)}),e._depthRangeEncoder.setDescription({colorAttachments:[{view:null,clearValue:[0,0,0,0],loadOp:"clear",storeOp:"store"},{view:null,clearValue:[1,1,1,1],loadOp:"clear",storeOp:"store"}]}),e._depthRangeEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:"r16float",blend:{color:{srcFactor:"one",dstFactor:"one",operation:"max"},alpha:{srcfactor:"one",dstFactor:"one",operation:"max"}}},{format:"r16float",blend:{color:{srcFactor:"one",dstFactor:"one",operation:"min"},alpha:{srcfactor:"one",dstFactor:"one",operation:"min"}}}]}}),e._depthRangeTexture=Ct.newInstance({label:"volumePassMaxDepth"}),e._depthRangeTexture.create(n,{width:r.getCanvas().width,height:r.getCanvas().height,format:"r16float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING});var a=e._depthRangeTexture.createView("maxTexture");e._depthRangeEncoder.setColorTextureView(0,a),e._depthRangeTexture2=Ct.newInstance({label:"volumePassDepthMin"}),e._depthRangeTexture2.create(n,{width:r.getCanvas().width,height:r.getCanvas().height,format:"r16float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING});var i=e._depthRangeTexture2.createView("minTexture");e._depthRangeEncoder.setColorTextureView(1,i),e._mapper.setDevice(r.getDevice()),e._mapper.setTextureViews([e.depthTextureView])},t.createClearEncoder=function(r){e._colorTexture=Ct.newInstance({label:"volumePassColor"}),e._colorTexture.create(r.getDevice(),{width:r.getCanvas().width,height:r.getCanvas().height,format:"bgra8unorm",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC}),e._colorTextureView=e._colorTexture.createView("volumePassColorTexture"),e._colorTextureView.addSampler(r.getDevice(),{minFilter:"linear",magFilter:"linear"}),e._clearEncoder=Rt.newInstance({label:"VolumePass Clear"}),e._clearEncoder.setColorTextureView(0,e._colorTextureView),e._clearEncoder.setDescription({colorAttachments:[{view:null,clearValue:[0,0,0,0],loadOp:"clear",storeOp:"store"}]}),e._clearEncoder.setPipelineHash("volpf"),e._clearEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:"bgra8unorm",blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcfactor:"one",dstFactor:"one-minus-src-alpha"}}}]}})},t.createCopyEncoder=function(r){e._copyEncoder=Rt.newInstance({label:"volumePassCopy"}),e._copyEncoder.setDescription({colorAttachments:[{view:null,loadOp:"load",storeOp:"store"}]}),e._copyEncoder.setPipelineHash("volcopypf"),e._copyEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:"rgba16float",blend:{color:{srcFactor:"one",dstFactor:"one-minus-src-alpha"},alpha:{srcfactor:"one",dstFactor:"one-minus-src-alpha"}}}]}})},t.createMergeEncoder=function(r){e._mergeEncoder=Rt.newInstance({label:"volumePassMerge"}),e._mergeEncoder.setColorTextureView(0,e._colorTextureView),e._mergeEncoder.setDescription({colorAttachments:[{view:null,loadOp:"load",storeOp:"store"}]}),e._mergeEncoder.setReplaceShaderCodeFunction(function(n){var a=n.getShaderDescription("fragment");a.addOutput("vec4<f32>","outColor");var i=a.getCode();i=X.substitute(i,"//VTK::RenderEncoder::Impl",["output.outColor = vec4<f32>(computedColor.rgb, computedColor.a);"]).result,a.setCode(i)}),e._mergeEncoder.setPipelineHash("volpf"),e._mergeEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:"bgra8unorm",blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcfactor:"one",dstFactor:"one-minus-src-alpha"}}}]}})},t.setVolumes=function(r){if(!e.volumes||e.volumes.length!==r.length){e.volumes=Y(r),t.modified();return}for(var n=0;n<r.length;n++)if(r[n]!==e.volumes[n]){e.volumes=Y(r),t.modified();return}}}var fE={colorTextureView:null,depthTextureView:null,volumes:null};function ep(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fE,r),Bt.extend(t,e,r),e._lastScale=2,e._mapper=Vs.newInstance(),e._mapper.setFragmentShaderTemplate(sE),e._mapper.getShaderReplacements().set("replaceShaderVolumePass",function(n,a,i){var s=a.getShaderDescription("fragment");s.addBuiltinInput("vec4<f32>","@builtin(position) fragPos")}),e._boundsPoly=qt.newInstance(),e._lastMTimes=[],m.setGet(t,e,["colorTextureView","depthTextureView"]),uE(t,e)}var cE=m.newInstance(ep,"vtkWebGPUVolumePass"),gE={newInstance:cE,extend:ep},vE=`
//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var computedColor: vec4<f32> = clamp(textureSampleLevel(opaquePassColorTexture, finalPassSampler, input.tcoordVS, 0),vec4<f32>(0.0),vec4<f32>(1.0));

  //VTK::RenderEncoder::Impl
  return output;
}
`;function pE(t,e){e.classHierarchy.push("vtkForwardPass"),t.traverse=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!e.deleted){e._currentParent=n,t.setCurrentOperation("buildPass"),r.traverse(t),e.opaquePass||(e.opaquePass=Xw.newInstance());for(var a=r.getRenderable().getNumberOfLayers(),i=r.getChildren(),s=0;s<a;s++)for(var o=0;o<i.length;o++){var u=i[o],c=r.getRenderable().getRenderers()[o];c.getDraw()&&c.getLayer()===s&&(e.opaqueActorCount=0,e.translucentActorCount=0,e.volumes=[],t.setCurrentOperation("queryPass"),u.traverse(t),t.setCurrentOperation("cameraPass"),u.traverse(t),e.opaquePass.traverse(u,r),e.translucentActorCount>0&&(e.translucentPass||(e.translucentPass=Iw.newInstance()),e.translucentPass.setColorTextureView(e.opaquePass.getColorTextureView()),e.translucentPass.setDepthTextureView(e.opaquePass.getDepthTextureView()),e.translucentPass.traverse(u,r)),e.volumes.length>0&&(e.volumePass||(e.volumePass=gE.newInstance()),e.volumePass.setColorTextureView(e.opaquePass.getColorTextureView()),e.volumePass.setDepthTextureView(e.opaquePass.getDepthTextureView()),e.volumePass.setVolumes(e.volumes),e.volumePass.traverse(u,r)),t.finalPass(r,u))}}},t.finalPass=function(r,n){e._finalBlitEncoder||t.createFinalBlitEncoder(r),e._finalBlitOutputTextureView.createFromTextureHandle(r.getCurrentTexture(),{depth:1,format:r.getPresentationFormat()}),e._finalBlitEncoder.attachTextureViews(),e._finalBlitEncoder.begin(r.getCommandEncoder()),n.scissorAndViewport(e._finalBlitEncoder),e._fullScreenQuad.prepareAndDraw(e._finalBlitEncoder),e._finalBlitEncoder.end()},t.createFinalBlitEncoder=function(r){e._finalBlitEncoder=Rt.newInstance({label:"forwardPassBlit"}),e._finalBlitEncoder.setDescription({colorAttachments:[{view:null,loadOp:"load",storeOp:"store"}]}),e._finalBlitEncoder.setPipelineHash("fpf"),e._finalBlitEncoder.setPipelineSettings({primitive:{cullMode:"none"},fragment:{targets:[{format:r.getPresentationFormat(),blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcfactor:"one",dstFactor:"one-minus-src-alpha"}}}]}}),e._fsqSampler=Rs.newInstance({label:"finalPassSampler"}),e._fsqSampler.create(r.getDevice(),{minFilter:"linear",magFilter:"linear"}),e._fullScreenQuad=Hr.newInstance(),e._fullScreenQuad.setDevice(r.getDevice()),e._fullScreenQuad.setPipelineHash("fpfsq"),e._fullScreenQuad.setTextureViews([e.opaquePass.getColorTextureView()]),e._fullScreenQuad.setAdditionalBindables([e._fsqSampler]),e._fullScreenQuad.setFragmentShaderTemplate(vE),e._finalBlitOutputTextureView=pv.newInstance(),e._finalBlitEncoder.setColorTextureView(0,e._finalBlitOutputTextureView)},t.incrementOpaqueActorCount=function(){return e.opaqueActorCount++},t.incrementTranslucentActorCount=function(){return e.translucentActorCount++},t.addVolume=function(r){e.volumes.push(r)}}var lE={opaqueActorCount:0,translucentActorCount:0,volumes:null,opaqueRenderEncoder:null,translucentPass:null,volumePass:null};function tp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lE,r),Bt.extend(t,e,r),m.setGet(t,e,["opaquePass","translucentPass","volumePass"]),pE(t,e)}var hE=m.newInstance(tp,"vtkForwardPass"),yE={newInstance:hE,extend:tp},sr=ge.VtkDataTypes;function dE(t,e){e.classHierarchy.push("vtkWebGPUTextureManager");function r(a){if(a.imageData){a.dataArray=a.imageData.getPointData().getScalars(),a.time=a.dataArray.getMTime(),a.nativeArray=a.dataArray.getData();var i=a.imageData.getDimensions();a.width=i[0],a.height=i[1],a.depth=i[2];var s=a.dataArray.getNumberOfComponents();switch(s){case 1:a.format="r";break;case 2:a.format="rg";break;case 3:case 4:default:a.format="rgba";break}var o=a.dataArray.getDataType();switch(o){case sr.UNSIGNED_CHAR:a.format+="8unorm";break;case sr.FLOAT:case sr.UNSIGNED_INT:case sr.INT:case sr.DOUBLE:case sr.UNSIGNED_SHORT:case sr.SHORT:default:a.format+="16float";break}}a.image&&(a.width=a.image.width,a.height=a.image.height,a.depth=1,a.format="rgba8unorm"),a.jsImageData&&(a.width=a.jsImageData.width,a.height=a.jsImageData.height,a.depth=1,a.format="rgba8unorm",a.flip=!0,a.nativeArray=a.jsImageData.data),a.canvas&&(a.width=a.canvas.width,a.height=a.canvas.height,a.depth=1,a.format="rgba8unorm",a.flip=!0,a.usage=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT)}function n(a){var i=Ct.newInstance();return i.create(e.device,{width:a.width,height:a.height,depth:a.depth,format:a.format,usage:a.usage,mipLevel:a.mipLevel}),(a.nativeArray||a.image||a.canvas)&&i.writeImageData(a),i}t.getTexture=function(a){return a.hash?e.device.getCachedObject(a.hash,n,a):n(a)},t.getTextureForImageData=function(a){var i={time:a.getMTime()};return i.imageData=a,r(i),i.hash=i.time+i.format+i.mipLevel,e.device.getTextureManager().getTexture(i)},t.getTextureForVTKTexture=function(a){var i={time:a.getMTime()};return a.getInputData()?i.imageData=a.getInputData():a.getImage()?i.image=a.getImage():a.getJsImageData()?i.jsImageData=a.getJsImageData():a.getCanvas()&&(i.canvas=a.getCanvas()),r(i),i.mipLevel=a.getMipLevel(),i.hash=i.time+i.format+i.mipLevel,e.device.getTextureManager().getTexture(i)}}var TE={handle:null,device:null};function rp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,TE,r),m.obj(t,e),m.setGet(t,e,["device"]),dE(t,e)}var CE=m.newInstance(rp),SE={newInstance:CE,extend:rp};function xE(t){var e=OE();return function(){var n=ze(t),a;if(e){var i=ze(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Wf(this,a)}}function OE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var mE=function(t){_f(r,t);var e=xE(r);function r(){var n,a,i;return Da(this,r),i=e.call(this),i.registry=new FinalizationRegistry(function(s){var o=Dt((n=Di(i),ze(r.prototype)),"get",n).call(n,s);o&&o.deref&&o.deref()===void 0&&Dt((a=Di(i),ze(r.prototype)),"delete",a).call(a,s)}),i}return Ma(r,[{key:"getValue",value:function(a){var i=Dt(ze(r.prototype),"get",this).call(this,a);if(i){var s=i.deref();if(s!==void 0)return s;Dt(ze(r.prototype),"delete",this).call(this,a)}}},{key:"setValue",value:function(a,i){var s;return i&&Kt(i)==="object"&&(s=new WeakRef(i),this.registry.register(i,a),Dt(ze(r.prototype),"set",this).call(this,a,s)),s}}]),r}(oa(Map));function wE(t,e){e.classHierarchy.push("vtkWebGPUDevice"),t.initialize=function(r){e.handle=r},t.createCommandEncoder=function(){return e.handle.createCommandEncoder()},t.submitCommandEncoder=function(r){e.handle.queue.submit([r.finish()])},t.getShaderModule=function(r){return e.shaderCache.getShaderModule(r)},t.getBindGroupLayout=function(r){if(!r.entries)return null;for(var n=0;n<r.entries.length;n++){var a=r.entries[n];a.binding=a.binding||0,a.visibility=a.visibility||GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT}for(var i=JSON.stringify(r),s=0;s<e.bindGroupLayouts.length;s++)if(e.bindGroupLayouts[s].sval===i)return e.bindGroupLayouts[s].layout;var o=e.handle.createBindGroupLayout(r);return e.bindGroupLayouts.push({sval:i,layout:o}),o},t.getBindGroupLayoutDescription=function(r){for(var n=0;n<e.bindGroupLayouts.length;n++)if(e.bindGroupLayouts[n].layout===r)return e.bindGroupLayouts[n].sval;return vtkErrorMacro("layout not found"),console.trace(),null},t.getPipeline=function(r){return r in e.pipelines?e.pipelines[r]:null},t.createPipeline=function(r,n){n.initialize(t,r),e.pipelines[r]=n},t.onSubmittedWorkDone=function(){return e.handle.queue.onSubmittedWorkDone()},t.hasCachedObject=function(r){return e.objectCache.getValue(r)},t.getCachedObject=function(r,n){if(!r)return vtkErrorMacro("attempt to cache an object without a hash"),null;var a=e.objectCache.getValue(r);if(a)return a;for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];var u=n.apply(void 0,s);return e.objectCache.setValue(r,u),u}}var EE={handle:null,pipelines:null,shaderCache:null,bindGroupLayouts:null,bufferManager:null,textureManager:null};function np(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,EE,r),Ne(t,e),be(t,e,["handle"]),je(t,e,["bufferManager","shaderCache","textureManager"]),e.objectCache=new mE,e.shaderCache=X.newInstance(),e.shaderCache.setDevice(t),e.bindGroupLayouts=[],e.bufferManager=Je.newInstance(),e.bufferManager.setDevice(t),e.textureManager=SE.newInstance(),e.textureManager.setDevice(t),e.pipelines={},wE(t,e)}var DE=ve(np,"vtkWebGPUDevice"),ME={newInstance:DE,extend:np};function VE(t,e){e.classHierarchy.push("vtkWebGPUHardwareSelectionPass"),t.traverse=function(r,n){if(!e.deleted){e._currentParent=null,t.setCurrentOperation("buildPass"),r.traverse(t);var a=r.getDevice();if(e.selectionRenderEncoder)e.colorTexture.resize(r.getCanvas().width,r.getCanvas().height),e.depthTexture.resizeToMatch(e.colorTexture);else{t.createRenderEncoder(),e.colorTexture=Ct.newInstance({label:"hardwareSelectorColor"}),e.colorTexture.create(a,{width:r.getCanvas().width,height:r.getCanvas().height,format:"rgba32uint",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC});var i=e.colorTexture.createView("hardwareSelectColorTexture");e.selectionRenderEncoder.setColorTextureView(0,i),e.depthTexture=Ct.newInstance({label:"hardwareSelectorDepth"}),e.depthTexture.create(a,{width:r.getCanvas().width,height:r.getCanvas().height,format:"depth32float",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC});var s=e.depthTexture.createView("hardwareSelectDepthTexture");e.selectionRenderEncoder.setDepthTextureView(s)}e.selectionRenderEncoder.attachTextureViews(),n.setRenderEncoder(e.selectionRenderEncoder),t.setCurrentOperation("cameraPass"),n.traverse(t),t.setCurrentOperation("opaquePass"),n.traverse(t)}},t.createRenderEncoder=function(){e.selectionRenderEncoder=Rt.newInstance({label:"HardwareSelectionPass"}),e.selectionRenderEncoder.setPipelineHash("sel"),e.selectionRenderEncoder.setReplaceShaderCodeFunction(function(n){var a=n.getShaderDescription("fragment");a.addOutput("vec4<u32>","outColor");var i=a.getCode();i=X.substitute(i,"//VTK::RenderEncoder::Impl",["output.outColor = vec4<u32>(mapperUBO.PropID, compositeID, 0u, 0u);"]).result,a.setCode(i)});var r=e.selectionRenderEncoder.getDescription();r.colorAttachments[0].clearValue=[0,0,0,0],e.selectionRenderEncoder.setPipelineSettings({primitive:{cullMode:"none"},depthStencil:{depthWriteEnabled:!0,depthCompare:"greater",format:"depth32float"},fragment:{targets:[{format:"rgba32uint",blend:void 0}]}})}}var RE={selectionRenderEncoder:null,colorTexture:null,depthTexture:null};function ap(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,RE,r),Bt.extend(t,e,r),m.get(t,e,["colorTexture","depthTexture"]),VE(t,e)}var bE=m.newInstance(ap,"vtkWebGPUHardwareSelectionPass"),LE={newInstance:bE,extend:ap},BE=Xr.SelectionContent,Zu=Xr.SelectionField,Iu=Cr.FieldAssociations,ip=m.vtkErrorMacro;function kE(t){return"".concat(t.propID," ").concat(t.compositeID)}function Ju(t,e,r,n){var a=((r.height-e-1)*r.colorBufferWidth+t)*4+n;return r.colorValues[a]}function Lr(t,e,r,n){var a=r<0?0:r;if(a===0){if(n[0]=e[0],n[1]=e[1],e[0]<0||e[0]>=t.width||e[1]<0||e[1]>=t.height)return null;var i=Ju(e[0],e[1],t,0);if(i<=0)return null;var s={};s.propID=i;var o=Ju(e[0],e[1],t,1);if((o<0||o>16777215)&&(o=0),s.compositeID=o,t.captureZValues){var u=(t.height-e[1]-1)*t.zbufferBufferWidth+e[0];s.zValue=t.depthValues[u],s.zValue=t.webGPURenderer.convertToOpenGLDepth(s.zValue),s.displayPosition=e}return s}var c=[e[0],e[1]],f=[0,0],g=Lr(t,e,0,n);if(g)return g;for(var v=1;v<a;++v){for(var p=c[1]>v?c[1]-v:0;p<=c[1]+v;++p)if(f[1]=p,c[0]>=v&&(f[0]=c[0]-v,g=Lr(t,f,0,n),g)||(f[0]=c[0]+v,g=Lr(t,f,0,n),g))return g;for(var l=c[0]>=v?c[0]-(v-1):0;l<=c[0]+(v-1);++l)if(f[0]=l,c[1]>=v&&(f[1]=c[1]-v,g=Lr(t,f,0,n),g)||(f[1]=c[1]+v,g=Lr(t,f,0,n),g))return g}return n[0]=e[0],n[1]=e[1],null}function NE(t,e,r){var n=[],a=0;return e.forEach(function(i,s){var o=Xr.newInstance();switch(o.setContentType(BE.INDICES),t){case Iu.FIELD_ASSOCIATION_CELLS:o.setFieldType(Zu.CELL);break;case Iu.FIELD_ASSOCIATION_POINTS:o.setFieldType(Zu.POINT);break;default:ip("Unknown field association")}o.getProperties().propID=i.info.propID;var u=r.webGPURenderer.getPropFromID(i.info.propID);o.getProperties().prop=u.getRenderable(),o.getProperties().compositeID=i.info.compositeID,o.getProperties().pixelCount=i.pixelCount,r.captureZValues&&(o.getProperties().displayPosition=[i.info.displayPosition[0],i.info.displayPosition[1],i.info.zValue],o.getProperties().worldPosition=r.webGPURenderWindow.displayToWorld(i.info.displayPosition[0],i.info.displayPosition[1],i.info.zValue,r.renderer)),o.setSelectionList(i.attributeIDs),n[a]=o,a++}),n}function FE(t,e,r,n,a){for(var i=Math.floor(e),s=Math.floor(r),o=Math.floor(n),u=Math.floor(a),c=new Map,f=[0,0],g=s;g<=u;g++)for(var v=i;v<=o;v++){var p=[v,g],l=Lr(t,p,0,f);if(l){var y=kE(l);if(!c.has(y))c.set(y,{info:l,pixelCount:1,attributeIDs:[l.attributeID]});else{var h=c.get(y);h.pixelCount++,t.captureZValues&&l.zValue<h.info.zValue&&(h.info=l),h.attributeIDs.indexOf(l.attributeID)===-1&&h.attributeIDs.push(l.attributeID)}}}return NE(t.fieldAssociation,c,t)}function UE(t,e){e.classHierarchy.push("vtkWebGPUHardwareSelector"),t.endSelection=function(){e.WebGPURenderer.setSelector(null)},t.getSourceDataAsync=function(){var r=St(we.mark(function n(a){var i,s,o,u,c,f,g,v,p,l,y;return we.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!(!a||!e._WebGPURenderWindow)){d.next=3;break}return ip("Renderer and view must be set before calling Select."),d.abrupt("return",!1);case 3:if(e._WebGPURenderWindow.getRenderable().preRender(),e._WebGPURenderWindow.getInitialized()){d.next=8;break}return e._WebGPURenderWindow.initialize(),d.next=8,new Promise(function(S){e._WebGPURenderWindow.onInitialized(S)});case 8:if(i=e._WebGPURenderWindow.getViewNodeFor(a),i){d.next=11;break}return d.abrupt("return",!1);case 11:if(s=i.getSuppressClear(),i.setSuppressClear(!0),e._selectionPass.traverse(e._WebGPURenderWindow,i),i.setSuppressClear(s),o=e._WebGPURenderWindow.getDevice(),u=e._selectionPass.getColorTexture(),c=e._selectionPass.getDepthTexture(),f={area:[0,0,u.getWidth()-1,u.getHeight()-1],captureZValues:e.captureZValues,fieldAssociation:e.fieldAssociation,renderer:a,webGPURenderer:i,webGPURenderWindow:e._WebGPURenderWindow,width:u.getWidth(),height:u.getHeight()},f.colorBufferWidth=16*Math.floor((f.width+15)/16),f.colorBufferSizeInBytes=f.colorBufferWidth*f.height*4*4,g=$r.newInstance({label:"hardwareSelectColorBuffer"}),g.setDevice(o),g.create(f.colorBufferSizeInBytes,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST),v=e._WebGPURenderWindow.getCommandEncoder(),v.copyTextureToBuffer({texture:u.getHandle()},{buffer:g.getHandle(),bytesPerRow:16*f.colorBufferWidth,rowsPerImage:f.height},{width:f.width,height:f.height,depthOrArrayLayers:1}),e.captureZValues&&(f.zbufferBufferWidth=64*Math.floor((f.width+63)/64),p=$r.newInstance({label:"hardwareSelectDepthBuffer"}),p.setDevice(o),f.zbufferSizeInBytes=f.height*f.zbufferBufferWidth*4,p.create(f.zbufferSizeInBytes,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST),v.copyTextureToBuffer({texture:c.getHandle(),aspect:"depth-only"},{buffer:p.getHandle(),bytesPerRow:4*f.zbufferBufferWidth,rowsPerImage:f.height},{width:f.width,height:f.height,depthOrArrayLayers:1})),o.submitCommandEncoder(v),l=g.mapAsync(GPUMapMode.READ),!e.captureZValues){d.next=37;break}return y=p.mapAsync(GPUMapMode.READ),d.next=33,Promise.all([l,y]);case 33:f.depthValues=new Float32Array(p.getMappedRange().slice()),p.unmap(),d.next=39;break;case 37:return d.next=39,l;case 39:return f.colorValues=new Uint32Array(g.getMappedRange().slice()),g.unmap(),f.generateSelection=function(S,T,C,x){return FE(f,S,T,C,x)},d.abrupt("return",f);case 43:case"end":return d.stop()}},n)}));return function(n){return r.apply(this,arguments)}}()}var GE={};function sp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,GE,r),kv.extend(t,e,r),e._selectionPass=LE.newInstance(),m.setGet(t,e,["_WebGPURenderWindow"]),m.moveToProtected(t,e,["WebGPURenderWindow"]),UE(t,e)}var _E=m.newInstance(sp,"vtkWebGPUHardwareSelector"),op={newInstance:_E,extend:sp},ef=m.vtkErrorMacro,WE={position:"absolute",top:0,left:0,width:"100%",height:"100%"};function zE(t,e){e.classHierarchy.push("vtkWebGPURenderWindow"),t.getViewNodeFactory=function(){return e.myFactory};var r=[0,0];function n(){e.renderable&&(e.size[0]!==r[0]||e.size[1]!==r[1])&&(r[0]=e.size[0],r[1]=e.size[1],e.canvas.setAttribute("width",e.size[0]),e.canvas.setAttribute("height",e.size[1]),t.recreateSwapChain()),e.viewStream&&e.viewStream.setSize(e.size[0],e.size[1]),e.canvas.style.display=e.useOffScreen?"none":"block",e.el&&(e.el.style.cursor=e.cursorVisibility?e.cursor:"none"),e.containerSize=null}t.onModified(n),t.recreateSwapChain=function(){e.context&&(e.context.unconfigure(),e.presentationFormat=navigator.gpu.getPreferredCanvasFormat(e.adapter),e.context.configure({device:e.device.getHandle(),format:e.presentationFormat,alphaMode:"premultiplied",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_DST,width:e.size[0],height:e.size[1]}),e._configured=!0)},t.getCurrentTexture=function(){return e.context.getCurrentTexture()},t.buildPass=function(s){if(s){if(!e.renderable)return;t.prepareNodes(),t.addMissingNodes(e.renderable.getRenderersByReference()),t.removeUnusedNodes(),t.initialize()}else e.initialized&&(e._configured||t.recreateSwapChain(),e.commandEncoder=e.device.createCommandEncoder())},t.initialize=function(){if(!e.initializing){if(e.initializing=!0,!navigator.gpu){ef("WebGPU is not enabled.");return}t.create3DContextAsync().then(function(){e.initialized=!0,!e.deleted&&t.invokeInitialized()})}},t.setContainer=function(s){e.el&&e.el!==s&&(e.canvas.parentNode!==e.el&&ef("Error: canvas parent node does not match container"),e.el.removeChild(e.canvas),e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)),e.el!==s&&(e.el=s,e.el&&(e.el.appendChild(e.canvas),e.useBackgroundImage&&e.el.appendChild(e.bgImage)),t.modified())},t.getContainer=function(){return e.el},t.getContainerSize=function(){if(!e.containerSize&&e.el){var s=e.el.getBoundingClientRect(),o=s.width,u=s.height;e.containerSize=[o,u]}return e.containerSize||e.size},t.getFramebufferSize=function(){return e.size},t.create3DContextAsync=St(we.mark(function s(){return we.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,navigator.gpu.requestAdapter({powerPreference:"high-performance"});case 2:if(e.adapter=u.sent,!e.deleted){u.next=5;break}return u.abrupt("return");case 5:return e.device=ME.newInstance(),u.t0=e.device,u.next=9,e.adapter.requestDevice();case 9:if(u.t1=u.sent,u.t0.initialize.call(u.t0,u.t1),!e.deleted){u.next=14;break}return e.device=null,u.abrupt("return");case 14:e.context=e.canvas.getContext("webgpu");case 15:case"end":return u.stop()}},s)})),t.releaseGraphicsResources=function(){var s=Bt.newInstance();s.setCurrentOperation("Release"),s.traverse(t,null),e.adapter=null,e.device=null,e.context=null,e.initialized=!1,e.initializing=!1},t.setBackgroundImage=function(s){e.bgImage.src=s.src},t.setUseBackgroundImage=function(s){e.useBackgroundImage=s,e.useBackgroundImage&&!e.el.contains(e.bgImage)?e.el.appendChild(e.bgImage):!e.useBackgroundImage&&e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)};function a(){return i.apply(this,arguments)}function i(){return i=St(we.mark(function s(){var o,u,c,f,g,v,p,l,y,h=arguments;return we.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return o=h.length>0&&h[0]!==void 0?h[0]:e.imageFormat,u=document.createElement("canvas"),c=u.getContext("2d"),u.width=e.canvas.width,u.height=e.canvas.height,S.next=7,t.getPixelsAsync();case 7:f=S.sent,g=new ImageData(f.colorValues,f.width,f.height),c.putImageData(g,0,0),v=e.canvas.getBoundingClientRect(),p=e.renderable,l=p.getRenderers(),l.forEach(function(T){var C=T.getViewProps();C.forEach(function(x){if(x.getContainer)for(var O=x.getContainer(),w=O.getElementsByTagName("canvas"),E=0;E<w.length;E++){var V=w[E],D=V.getBoundingClientRect(),M=D.x-v.x,L=D.y-v.y;c.drawImage(V,M,L)}})}),y=u.toDataURL(o),u.remove(),t.invokeImageReady(y);case 17:case"end":return S.stop()}},s)})),i.apply(this,arguments)}t.captureNextImage=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=o.resetCamera,c=u===void 0?!1:u,f=o.size,g=f===void 0?null:f,v=o.scale,p=v===void 0?1:v;if(e.deleted)return null;e.imageFormat=s;var l=e.notifyStartCaptureImage;return e.notifyStartCaptureImage=!0,e._screenshot={size:g||p!==1?g||e.size.map(function(y){return y*p}):null},new Promise(function(y,h){var d=t.onImageReady(function(S){if(e._screenshot.size===null)e.notifyStartCaptureImage=l,d.unsubscribe(),e._screenshot.placeHolder&&(e.size=e._screenshot.originalSize,t.modified(),e._screenshot.cameras&&e._screenshot.cameras.forEach(function(x){var O=x.restoreParamsFn,w=x.arg;return O(w)}),t.traverseAllPasses(),e.el.removeChild(e._screenshot.placeHolder),e._screenshot.placeHolder.remove(),e._screenshot=null),y(S);else{var T=document.createElement("img");if(T.style=WE,T.src=S,e._screenshot.placeHolder=e.el.appendChild(T),e.canvas.style.display="none",e._screenshot.originalSize=e.size,e.size=e._screenshot.size,e._screenshot.size=null,t.modified(),c){var C=c!==!0;e._screenshot.cameras=e.renderable.getRenderers().map(function(x){var O=x.getActiveCamera(),w=O.get("focalPoint","position","parallelScale");return{resetCameraArgs:C?{renderer:x}:void 0,resetCameraFn:C?c:x.resetCamera,restoreParamsFn:O.set,arg:JSON.parse(JSON.stringify(w))}}),e._screenshot.cameras.forEach(function(x){var O=x.resetCameraFn,w=x.resetCameraArgs;return O(w)})}t.traverseAllPasses()}})})},t.traverseAllPasses=function(){if(!e.deleted)if(e.initialized){if(e.renderPasses)for(var o=0;o<e.renderPasses.length;++o)e.renderPasses[o].traverse(t,null);e.commandEncoder&&(e.device.submitCommandEncoder(e.commandEncoder),e.commandEncoder=null,e.notifyStartCaptureImage&&e.device.onSubmittedWorkDone().then(function(){a()}))}else{t.initialize();var s=t.onInitialized(function(){s.unsubscribe(),t.traverseAllPasses()})}},t.setViewStream=function(s){if(e.viewStream===s)return!1;if(e.subscription&&(e.subscription.unsubscribe(),e.subscription=null),e.viewStream=s,e.viewStream){var o=e.renderable.getRenderers()[0];o.getBackgroundByReference()[3]=0,t.setUseBackgroundImage(!0),e.subscription=e.viewStream.onImageReady(function(u){return t.setBackgroundImage(u.image)}),e.viewStream.setSize(e.size[0],e.size[1]),e.viewStream.invalidateCache(),e.viewStream.render(),t.modified()}return!0},t.getUniquePropID=function(){return e.nextPropID++},t.getPropFromID=function(s){for(var o=0;o<e.children.length;o++){var u=e.children[o].getPropFromID(s);if(u!==null)return u}return null},t.getPixelsAsync=St(we.mark(function s(){var o,u,c,f,g,v,p,l,y,h,d;return we.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return o=e.device,u=e.renderPasses[0].getOpaquePass().getColorTexture(),c={width:u.getWidth(),height:u.getHeight()},c.colorBufferWidth=32*Math.floor((c.width+31)/32),c.colorBufferSizeInBytes=c.colorBufferWidth*c.height*8,f=$r.newInstance(),f.setDevice(o),f.create(c.colorBufferSizeInBytes,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST),g=e.device.createCommandEncoder(),g.copyTextureToBuffer({texture:u.getHandle()},{buffer:f.getHandle(),bytesPerRow:8*c.colorBufferWidth,rowsPerImage:c.height},{width:c.width,height:c.height,depthOrArrayLayers:1}),o.submitCommandEncoder(g),v=f.mapAsync(GPUMapMode.READ),T.next=14,v;case 14:for(c.colorValues=new Uint16Array(f.getMappedRange().slice()),f.unmap(),p=new Uint8ClampedArray(c.height*c.width*4),l=0;l<c.height;l++)for(y=0;y<c.width;y++)h=(l*c.width+y)*4,d=(l*c.colorBufferWidth+y)*4,p[h]=255*st.fromHalf(c.colorValues[d]),p[h+1]=255*st.fromHalf(c.colorValues[d+1]),p[h+2]=255*st.fromHalf(c.colorValues[d+2]),p[h+3]=255*st.fromHalf(c.colorValues[d+3]);return c.colorValues=p,T.abrupt("return",c);case 20:case"end":return T.stop()}},s)})),t.createSelector=function(){var s=op.newInstance();return s.setWebGPURenderWindow(t),s},t.delete=m.chain(t.delete,t.setViewStream)}var AE={initialized:!1,context:null,adapter:null,device:null,canvas:null,cursorVisibility:!0,cursor:"pointer",containerSize:null,renderPasses:[],notifyStartCaptureImage:!1,imageFormat:"image/png",useOffScreen:!1,useBackgroundImage:!1,nextPropID:1,xrSupported:!1,presentationFormat:null};function HE(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,AE,r),e.canvas=document.createElement("canvas"),e.canvas.style.width="100%",e.bgImage=new Image,e.bgImage.style.position="absolute",e.bgImage.style.left="0",e.bgImage.style.top="0",e.bgImage.style.width="100%",e.bgImage.style.height="100%",e.bgImage.style.zIndex="-1",Kv.extend(t,e,r),e.myFactory=HC.newInstance(),e.myFactory.registerOverride("vtkRenderWindow",up),e.renderPasses[0]=yE.newInstance(),e.selector||(e.selector=op.newInstance(),e.selector.setWebGPURenderWindow(t)),m.event(t,e,"imageReady"),m.event(t,e,"initialized"),m.get(t,e,["commandEncoder","device","presentationFormat","useBackgroundImage","xrSupported"]),m.setGet(t,e,["initialized","context","canvas","device","renderPasses","notifyStartCaptureImage","cursor","useOffScreen"]),m.setGetArray(t,e,["size"],2),zE(t,e)}var up=m.newInstance(HE,"vtkWebGPURenderWindow");bs("WebGPU",up);var $E=Nm.extractURLParameters(),PE={margin:"0",padding:"0",position:"absolute",top:"0",left:"0",width:"100%",height:"100%",overflow:"hidden"},jE={position:"absolute",left:"25px",top:"25px",backgroundColor:"white",borderRadius:"5px",listStyle:"none",padding:"5px 10px",margin:"0",display:"block",border:"solid 1px black",maxWidth:"calc(100% - 70px)",maxHeight:"calc(100% - 60px)",overflow:"auto"};function tf(t,e){Object.keys(e).forEach(function(r){t.style[r]=e[r]})}function KE(t,e){e.classHierarchy.push("vtkFullScreenRenderWindow");var r=document.querySelector("body");e.rootContainer||(e.rootContainer=r),e.container||(e.container=document.createElement("div"),tf(e.container,e.containerStyle||PE),e.rootContainer.appendChild(e.container)),e.rootContainer===r&&(document.documentElement.style.height="100%",r.style.height="100%",r.style.padding="0",r.style.margin="0"),e.renderWindow=sm.newInstance(),e.renderer=em.newInstance(),e.renderWindow.addRenderer(e.renderer),e.apiSpecificRenderWindow=e.renderWindow.newAPISpecificView($E.viewAPI),e.apiSpecificRenderWindow.setContainer(e.container),e.renderWindow.addView(e.apiSpecificRenderWindow),e.interactor=Ov.newInstance(),e.interactor.setInteractorStyle(Lm.newInstance()),e.interactor.setView(e.apiSpecificRenderWindow),e.interactor.initialize(),e.interactor.bindEvents(e.container),t.setBackground=e.renderer.setBackground,t.removeController=function(){var n=e.controlContainer;n&&n.parentNode.removeChild(n)},t.setControllerVisibility=function(n){e.controllerVisibility=n,e.controlContainer&&(n?e.controlContainer.style.display="block":e.controlContainer.style.display="none")},t.toggleControllerVisibility=function(){t.setControllerVisibility(!e.controllerVisibility)},t.addController=function(n){e.controlContainer=document.createElement("div"),tf(e.controlContainer,e.controlPanelStyle||jE),e.rootContainer.appendChild(e.controlContainer),e.controlContainer.innerHTML=n,t.setControllerVisibility(e.controllerVisibility),e.rootContainer.addEventListener("keypress",function(a){String.fromCharCode(a.charCode)==="c"&&t.toggleControllerVisibility()})},t.setBackground.apply(t,Y(e.background)),t.addRepresentation=function(n){n.getActors().forEach(function(a){e.renderer.addActor(a)})},t.removeRepresentation=function(n){n.getActors().forEach(function(a){return e.renderer.removeActor(a)})},t.delete=m.chain(t.setContainer,e.apiSpecificRenderWindow.delete,t.delete),t.resize=function(){var n=e.container.getBoundingClientRect(),a=window.devicePixelRatio||1;e.apiSpecificRenderWindow.setSize(Math.floor(n.width*a),Math.floor(n.height*a)),e.resizeCallback&&e.resizeCallback(n),e.renderWindow.render()},t.setResizeCallback=function(n){e.resizeCallback=n,t.resize()},e.listenWindowResize&&window.addEventListener("resize",t.resize),t.resize()}var XE={background:[.32,.34,.43],containerStyle:null,controlPanelStyle:null,listenWindowResize:!0,resizeCallback:null,controllerVisibility:!0};function fp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,XE,r),m.obj(t,e),m.get(t,e,["renderWindow","renderer","apiSpecificRenderWindow","interactor","rootContainer","container","controlContainer"]),KE(t,e)}var YE=m.newInstance(fp),zM={newInstance:YE,extend:fp},qE=["chemical json","name","inchi","formula","atoms","bonds","properties"];function QE(t,e){e.classHierarchy.push("vtkMolecule")}var ZE={"chemical json":0,name:"",inchi:"",formula:"",atoms:null,bonds:null,properties:null};function cp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ZE,r),m.obj(t,e),e.atoms||(e.atoms={}),e.bonds||(e.bonds={}),e.properties||(e.properties={}),m.setGet(t,e,qE),QE(t,e)}var IE=m.newInstance(cp,"vtkMolecule"),JE={newInstance:IE,extend:cp},Us={};function gp(t){return!!Us[t]}function eD(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"http",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Us[t](e)}function vp(t,e){Us[t]=e}var tD={get:eD,has:gp,registerType:vp},rD=[1],nD=[2],aD=[3],iD=[4],sD=[5],oD=[6],uD=[7],fD=[8],cD=[9],gD=[10],vD=[11],pD=[12],lD=[13],hD=[14],yD=[15],dD=[16],TD=[17],CD=[18],SD=[19],xD=[20],OD=[21],mD=[22],wD=[23],ED=[24],DD=[25],MD=[26],VD=[27],RD=[28],bD=[29],LD=[30],BD=[31],kD=[32],ND=[33],FD=[34],UD=[35],GD=[36],_D=[37],WD=[38],zD=[39],AD=[40],HD=[41],$D=[42],PD=[43],jD=[44],KD=[45],XD=[46],YD=[47],qD=[48],QD=[49],ZD=[50],ID=[51],JD=[52],e3=[53],t3=[54],r3=[55],n3=[56],a3=[57],i3=[58],s3=[59],o3=[60],u3=[61],f3=[62],c3=[63],g3=[64],v3=[65],p3=[66],l3=[67],h3=[68],y3=[69],d3=[70],T3=[71],C3=[72],S3=[73],x3=[74],O3=[75],m3=[76],w3=[77],E3=[78],D3=[79],M3=[80],V3=[81],R3=[82],b3=[83],L3=[84],B3=[85],k3=[86],N3=[87],F3=[88],U3=[89],G3=[90],_3=[91],W3=[92],z3=[93],A3=[94],H3=[95],$3=[96],P3=[97],j3=[98],K3=[99],X3=[100],Y3=[101],q3=[102],Q3=[103],Z3=[104],I3=[105],J3=[106],eM=[107],tM=[108],rM=[109],nM=[110],aM=[111],iM=[112],sM=[113],oM=[114],uM=[115],fM=[116],cM=[117],gM=[118],vM={H:rD,He:nD,Li:aD,Be:iD,B:sD,C:oD,N:uD,O:fD,F:cD,Ne:gD,Na:vD,Mg:pD,Al:lD,Si:hD,P:yD,S:dD,Cl:TD,Ar:CD,K:SD,Ca:xD,Sc:OD,Ti:mD,V:wD,Cr:ED,Mn:DD,Fe:MD,Co:VD,Ni:RD,Cu:bD,Zn:LD,Ga:BD,Ge:kD,As:ND,Se:FD,Br:UD,Kr:GD,Rb:_D,Sr:WD,Y:zD,Zr:AD,Nb:HD,Mo:$D,Tc:PD,Ru:jD,Rh:KD,Pd:XD,Ag:YD,Cd:qD,In:QD,Sn:ZD,Sb:ID,Te:JD,I:e3,Xe:t3,Cs:r3,Ba:n3,La:a3,Ce:i3,Pr:s3,Nd:o3,Pm:u3,Sm:f3,Eu:c3,Gd:g3,Tb:v3,Dy:p3,Ho:l3,Er:h3,Tm:y3,Yb:d3,Lu:T3,Hf:C3,Ta:S3,W:x3,Re:O3,Os:m3,Ir:w3,Pt:E3,Au:D3,Hg:M3,Tl:V3,Pb:R3,Bi:b3,Po:L3,At:B3,Rn:k3,Fr:N3,Ra:F3,Ac:U3,Th:G3,Pa:_3,U:W3,Np:z3,Pu:A3,Am:H3,Cm:$3,Bk:P3,Cf:j3,Es:K3,Fm:X3,Md:Y3,No:q3,Lr:Q3,Rf:Z3,Db:I3,Sg:J3,Bh:eM,Hs:tM,Mt:rM,Ds:nM,Rg:aM,Cn:iM,Uut:sM,Uuq:oM,Uup:uM,Uuh:fM,Uus:cM,Uuo:gM};function pp(){var t=new ArrayBuffer(4),e=new Uint8Array(t),r=new Uint32Array(t);return e[0]=161,e[1]=178,e[2]=195,e[3]=212,r[0]===3569595041?"LittleEndian":r[0]===2712847316?"BigEndian":null}var pM=pp();function lM(t,e){if(!(e<2))for(var r=new Int8Array(t),n=r.length,a=[],i=0;i<n;i+=e){for(var s=0;s<e;s++)a.push(r[i+s]);for(var o=0;o<e;o++)r[i+o]=a.pop()}}var Ci={ENDIANNESS:pM,getEndianness:pp,swapBytes:lM},lp=m.vtkErrorMacro,hM=m.vtkDebugMacro,Gs=function(){return lp("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead."),Promise.reject(new Error("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead."))},Pr=0;function Wa(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=new XMLHttpRequest;return n.open(t,e,!0),r.headers&&Object.entries(r.headers).forEach(function(a){var i=$e(a,2),s=i[0],o=i[1];return n.setRequestHeader(s,o)}),r.progressCallback&&n.addEventListener("progress",r.progressCallback),n}function yM(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(r,n){var a=Wa("GET",t,e);a.onreadystatechange=function(i){a.readyState===4&&(a.status===200||a.status===0?r(a.response):n({xhr:a,e:i}))},a.responseType="arraybuffer",a.send()})}function dM(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return n&&n.compression?Gs():r.ref&&!r.ref.pending?new Promise(function(a,i){var s=[e,r.ref.basepath,r.ref.id].join("/"),o=Wa("GET",s,n);o.onreadystatechange=function(u){o.readyState===1&&(r.ref.pending=!0,++Pr===1&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!0)),o.readyState===4&&(r.ref.pending=!1,o.status===200||o.status===0?(r.buffer=o.response,r.ref.encode==="JSON"?r.values=JSON.parse(r.buffer):(Ci.ENDIANNESS!==r.ref.encode&&Ci.ENDIANNESS&&(hM("Swap bytes of ".concat(r.name)),Ci.swapBytes(r.buffer,jc[r.dataType])),r.values=m.newTypedArray(r.dataType,r.buffer)),r.values.length!==r.size&&lp("Error in FetchArray: ".concat(r.name,", does not have the proper array size. Got ").concat(r.values.length,", instead of ").concat(r.size)),delete r.ref,--Pr===0&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!1),t!=null&&t.modified&&t.modified(),a(r)):i({xhr:o,e:u}))},o.responseType=r.dataType!=="string"?"arraybuffer":"text",o.send()}):Promise.resolve(r)}function TM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return r&&r.compression?Gs():new Promise(function(n,a){var i=Wa("GET",e,r);i.onreadystatechange=function(s){i.readyState===1&&++Pr===1&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!0),i.readyState===4&&(--Pr===0&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!1),i.status===200||i.status===0?n(JSON.parse(i.responseText)):a({xhr:i,e:s}))},i.responseType="text",i.send()})}function CM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return r&&r.compression?Gs():new Promise(function(n,a){var i=Wa("GET",e,r);i.onreadystatechange=function(s){i.readyState===1&&++Pr===1&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!0),i.readyState===4&&(--Pr===0&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!1),i.status===200||i.status===0?n(i.responseText):a({xhr:i,e:s}))},i.responseType="text",i.send()})}function SM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(n,a){var i=new Image;r.crossOrigin&&(i.crossOrigin=r.crossOrigin),i.onload=function(){return n(i)},i.onerror=a,i.src=e})}var xM={fetchArray:dM,fetchJSON:TM,fetchText:CM,fetchBinary:yM,fetchImage:SM};gp("http")||vp("http",function(t){return xM});function OM(t,e){e.classHierarchy.push("vtkPDBReader"),e.dataAccessHelper||(e.dataAccessHelper=tD.get("http"));function r(n,a){return e.dataAccessHelper.fetchText(t,n,a)}t.setUrl=function(n,a){if(n.indexOf(".pdb")===-1)e.baseURL=n,e.url="".concat(n);else{e.url=n;var i=n.split("/");i.pop(),e.baseURL=i.join("/")}return t.loadData(a)},t.loadData=function(n){return r(e.url,n).then(t.parseAsText)},t.parseAsText=function(n){return e.pdb=n,e.molecule=[],e.molecule=e.pdb.split(`
`),t.modified(),!0},t.requestData=function(n,a){var i=JE.newInstance();if(e.molecule){var s=e.molecule.length,o=[],u=[];e.numberOfAtoms=0;for(var c=0;c<s&&e.molecule[c]!=="END";){var f=e.molecule[c].length,g=e.molecule[c],v=g.substr(0,6).replace(/\s+/g,"");if(v.toUpperCase(),v==="ATOM"||v==="HETATM"){var p=g.substr(12,4).replace(/\s+/g,""),l=g.substr(30,8).replace(/\s+/g,""),y=g.substr(38,8).replace(/\s+/g,""),h=g.substr(46,8).replace(/\s+/g,""),d="";f>=78&&(d=g.substr(76,2).replace(/\s+/g,"")),d===""&&(d=p.substr(0,2).replace(/\d/g,"")),o.push(l),o.push(y),o.push(h);var S=$e(vM[d],1),T=S[0];u.push(T),e.numberOfAtoms++}c++}i.getAtoms().elements={},i.getAtoms().elements.number=Int8Array.from(u),i.getAtoms().coords={},i.getAtoms().coords["3d"]=Float32Array.from(o)}e.output[0]=i},t.isBusy=function(){return!!e.requestCount}}var mM={numberOfAtoms:0,requestCount:0};function hp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mM,r),m.obj(t,e),m.get(t,e,["url","baseURL","numberOfAtoms","requestCount"]),m.setGet(t,e,["dataAccessHelper"]),m.algo(t,e,0,1),m.event(t,e,"busy"),OM(t,e)}var wM=m.newInstance(hp,"vtkPDBReader"),AM={newInstance:wM,extend:hp};function EM(t,e){e.classHierarchy.push("vtkSphereMapper")}var DM={scaleArray:null,radius:.05,scaleFactor:1};function yp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,DM,r),Yt.extend(t,e,r),m.setGet(t,e,["radius","scaleArray","scaleFactor"]),EM(t,e)}var MM=m.newInstance(yp,"vtkSphereMapper"),HM={newInstance:MM,extend:yp};function VM(t,e){e.classHierarchy.push("vtkStickMapper")}var RM={scaleArray:null,orientationArray:null,radius:.025,length:.1};function dp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,RM,r),Yt.extend(t,e,r),m.setGet(t,e,["scaleArray","orientationArray","radius","length"]),VM(t,e)}var bM=m.newInstance(dp,"vtkStickMapper"),$M={newInstance:bM,extend:dp},LM=[{id:"Xx",atomicNumber:0,mass:0,exactMass:0,radiusCovalent:0,radiusVDW:0,symbol:"Xx",name:"Dummy",elementColor:[.07,.5,.7]},{id:"H",atomicNumber:1,mass:1.00794,exactMass:1.007825032,ionization:13.5984,electronAffinity:.75420375,electronegativityPauling:2.2,nameOrigin:"Greek 'hydro' and 'gennao' for 'forms water'",radiusCovalent:.37,radiusVDW:1.2,boilingpoint:20.28,meltingpoint:14.01,periodTableBlock:"s",discoveryDate:"1766",period:"1",group:"1",electronicConfiguration:"1s1",family:"Non-Metal",symbol:"H",name:"Hydrogen",elementColor:[1,1,1],discoveryCountry:["uk"],discoverers:["C.","Cavendish"]},{id:"He",atomicNumber:2,mass:4.002602,exactMass:4.002603254,ionization:24.5874,electronAffinity:0,nameOrigin:"The Greek word for the sun was 'helios'",radiusCovalent:.32,radiusVDW:1.4,boilingpoint:4.216,meltingpoint:.95,periodTableBlock:"p",discoveryDate:"1895",period:"1",group:"8",electronicConfiguration:"1s2",family:"Noblegas",symbol:"He",name:"Helium",elementColor:[.85,1,1],discoveryCountry:["se","uk"],discoverers:["P. J. Janssen","J. N. Lockyer"]},{id:"Li",atomicNumber:3,mass:6.941,exactMass:7.01600455,ionization:5.3917,electronAffinity:.618049,electronegativityPauling:.98,nameOrigin:"Greek 'lithos' means 'stone'",radiusCovalent:1.34,radiusVDW:2.2,boilingpoint:1615,meltingpoint:453.7,periodTableBlock:"s",discoveryDate:"1817",period:"2",group:"1",electronicConfiguration:"He 2s1",family:"Alkali_Earth",symbol:"Li",name:"Lithium",elementColor:[.8,.5,1],discoveryCountry:["se"],discoverers:["A.","Arfvedson"]},{id:"Be",atomicNumber:4,mass:9.012182,exactMass:9.0121822,ionization:9.3227,electronAffinity:0,electronegativityPauling:1.57,nameOrigin:"Greek 'beryllos' for 'light-green stone'",radiusCovalent:.9,radiusVDW:1.9,boilingpoint:3243,meltingpoint:1560,periodTableBlock:"s",discoveryDate:"1797",period:"2",group:"2",electronicConfiguration:"He 2s2",family:"Alkaline_Earth",symbol:"Be",name:"Beryllium",elementColor:[.76,1,0],discoveryCountry:["fr"],discoverers:["Nicholas","Louis","Vauquelin"]},{id:"B",atomicNumber:5,mass:10.811,exactMass:11.0093054,ionization:8.298,electronAffinity:.279723,electronegativityPauling:2.04,nameOrigin:"Boron means 'Bor(ax) + (carb)on'. It is found in borax and behaves a lot like carbon",radiusCovalent:.82,radiusVDW:1.8,boilingpoint:4275,meltingpoint:2365,periodTableBlock:"p",discoveryDate:"1808",period:"2",group:"3",electronicConfiguration:"He 2s2 2p1",family:"Metalloids",symbol:"B",name:"Boron",elementColor:[1,.71,.71],discoveryCountry:["uk","fr"],discoverers:["Louis Joseph Gay-Lussac","Louis Jacques Thenard"]},{id:"C",atomicNumber:6,mass:12.0107,exactMass:12,ionization:11.2603,electronAffinity:1.262118,electronegativityPauling:2.55,nameOrigin:"Latin 'carboneum' for carbon",radiusCovalent:.77,radiusVDW:1.7,boilingpoint:5100,meltingpoint:3825,periodTableBlock:"p",discoveryDate:"0",period:"2",group:"4",electronicConfiguration:"He 2s2 2p2",family:"Non-Metal",symbol:"C",name:"Carbon",elementColor:[.5,.5,.5],discoveryCountry:["ancient"]},{id:"N",atomicNumber:7,mass:14.0067,exactMass:14.003074,ionization:14.5341,electronAffinity:-.07,electronegativityPauling:3.04,nameOrigin:"Latin 'nitrogenium' ('forms saltpeter')",radiusCovalent:.75,radiusVDW:1.6,boilingpoint:77.344,meltingpoint:63.15,periodTableBlock:"p",discoveryDate:"1772",period:"2",group:"5",electronicConfiguration:"He 2s2 2p3",family:"Non-Metal",symbol:"N",name:"Nitrogen",elementColor:[.05,.05,1],discoveryCountry:["uk"],discoverers:["D.","Rutherford"]},{id:"O",atomicNumber:8,mass:15.9994,exactMass:15.99491462,ionization:13.6181,electronAffinity:1.461112,electronegativityPauling:3.44,nameOrigin:"Latin 'oxygenium' (forms acids)",radiusCovalent:.73,radiusVDW:1.55,boilingpoint:90.188,meltingpoint:54.8,periodTableBlock:"p",discoveryDate:"1774",period:"2",group:"6",electronicConfiguration:"He 2s2 2p4",family:"Non-Metal",symbol:"O",name:"Oxygen",elementColor:[1,.05,.05],discoveryCountry:["se","uk"],discoverers:["J.","Priestley"]},{id:"F",atomicNumber:9,mass:18.9984032,exactMass:18.99840322,ionization:17.4228,electronAffinity:3.4011887,electronegativityPauling:3.98,nameOrigin:"Latin 'fluere' ('floats')",radiusCovalent:.71,radiusVDW:1.5,boilingpoint:85,meltingpoint:53.55,periodTableBlock:"p",discoveryDate:"1886",period:"2",group:"7",electronicConfiguration:"He 2s2 2p5",family:"Halogen",symbol:"F",name:"Fluorine",elementColor:[.7,1,1],discoveryCountry:["fr"],discoverers:["H.","F.","Moissan"]},{id:"Ne",atomicNumber:10,mass:20.1797,exactMass:19.99244018,ionization:21.5645,electronAffinity:0,nameOrigin:"Greek 'neo'. meaning 'new'",radiusCovalent:.69,radiusVDW:1.54,boilingpoint:27.1,meltingpoint:24.55,periodTableBlock:"p",discoveryDate:"1898",period:"2",group:"8",electronicConfiguration:"He 2s2 2p6",family:"Noblegas",symbol:"Ne",name:"Neon",elementColor:[.7,.89,.96],discoveryCountry:["uk"],discoverers:["W. Ramsay","M.W. Travers"]},{id:"Na",atomicNumber:11,mass:22.98976928,exactMass:22.98976928,ionization:5.1391,electronAffinity:.547926,electronegativityPauling:.93,nameOrigin:"Arabic 'natrun' for 'soda'",radiusCovalent:1.54,radiusVDW:2.4,boilingpoint:1156,meltingpoint:371,periodTableBlock:"s",discoveryDate:"1807",period:"3",group:"1",electronicConfiguration:"Ne 3s1",family:"Alkali_Earth",symbol:"Na",name:"Sodium",elementColor:[.67,.36,.95],discoveryCountry:["uk"],discoverers:["Sir","Humphrey","Davy"]},{id:"Mg",atomicNumber:12,mass:24.305,exactMass:23.9850417,ionization:7.6462,electronAffinity:0,electronegativityPauling:1.31,nameOrigin:"Named after the city of Magnesia",radiusCovalent:1.3,radiusVDW:2.2,boilingpoint:1380,meltingpoint:922,periodTableBlock:"s",discoveryDate:"1808",period:"3",group:"2",electronicConfiguration:"Ne 3s2",family:"Alkaline_Earth",symbol:"Mg",name:"Magnesium",elementColor:[.54,1,0],discoveryCountry:["uk"],discoverers:["H.","B.","Davy"]},{id:"Al",atomicNumber:13,mass:26.9815386,exactMass:26.98153863,ionization:5.9858,electronAffinity:.43283,electronegativityPauling:1.61,nameOrigin:"Latin 'alumen'",radiusCovalent:1.18,radiusVDW:2.1,boilingpoint:2740,meltingpoint:933.5,periodTableBlock:"p",discoveryDate:"1825",period:"3",group:"3",electronicConfiguration:"Ne 3s2 3p1",family:"Other_Metal",symbol:"Al",name:"Aluminium",elementColor:[.75,.65,.65],discoveryCountry:["dk"],discoverers:["H.","Ch.","Oersted"]},{id:"Si",atomicNumber:14,mass:28.0855,exactMass:27.97692653,ionization:8.1517,electronAffinity:1.389521,electronegativityPauling:1.9,nameOrigin:"Latin 'silex'",radiusCovalent:1.11,radiusVDW:2.1,boilingpoint:2630,meltingpoint:1683,periodTableBlock:"p",discoveryDate:"1823",period:"3",group:"4",electronicConfiguration:"Ne 3s2 3p2",family:"Metalloids",symbol:"Si",name:"Silicon",elementColor:[.5,.6,.6],discoveryCountry:["se"],discoverers:["J.","J.","Berzelius"]},{id:"P",atomicNumber:15,mass:30.973762,exactMass:30.97376163,ionization:10.4867,electronAffinity:.7465,electronegativityPauling:2.19,nameOrigin:"Greek 'phosphoros' for 'carries light'",radiusCovalent:1.06,radiusVDW:1.95,boilingpoint:553,meltingpoint:317.3,periodTableBlock:"p",discoveryDate:"1669",period:"3",group:"5",electronicConfiguration:"Ne 3s2 3p3",family:"Non-Metal",symbol:"P",name:"Phosphorus",elementColor:[1,.5,0],discoveryCountry:["de"],discoverers:["H.","Brandt"]},{id:"S",atomicNumber:16,mass:32.065,exactMass:31.972071,ionization:10.36,electronAffinity:2.0771029,electronegativityPauling:2.58,nameOrigin:"In sanskrit 'sweb' means 'to sleep'",radiusCovalent:1.02,radiusVDW:1.8,boilingpoint:717.82,meltingpoint:392.2,periodTableBlock:"p",discoveryDate:"0",period:"3",group:"6",electronicConfiguration:"Ne 3s2 3p4",family:"Non-Metal",symbol:"S",name:"Sulfur",elementColor:[1,1,.19],discoveryCountry:["ancient"]},{id:"Cl",atomicNumber:17,mass:35.453,exactMass:34.96885268,ionization:12.9676,electronAffinity:3.612724,electronegativityPauling:3.16,nameOrigin:"Greek 'chloros' for 'yellow-green'",radiusCovalent:.99,radiusVDW:1.8,boilingpoint:239.18,meltingpoint:172.17,periodTableBlock:"p",discoveryDate:"1774",period:"3",group:"7",electronicConfiguration:"Ne 3s2 3p5",family:"Halogen",symbol:"Cl",name:"Chlorine",elementColor:[.12,.94,.12],discoveryCountry:["se"],discoverers:["C.","W.","Scheele"]},{id:"Ar",atomicNumber:18,mass:39.948,exactMass:39.96238312,ionization:15.7596,electronAffinity:0,nameOrigin:"Greek 'aergon' for 'inactive'",radiusCovalent:.97,radiusVDW:1.88,boilingpoint:87.45,meltingpoint:83.95,periodTableBlock:"p",discoveryDate:"1894",period:"3",group:"8",electronicConfiguration:"Ne 3s2 3p6",family:"Noblegas",symbol:"Ar",name:"Argon",elementColor:[.5,.82,.89],discoveryCountry:["uk"],discoverers:["W. Ramsay","J. Rayleigh"]},{id:"K",atomicNumber:19,mass:39.0983,exactMass:38.96370668,ionization:4.3407,electronAffinity:.501459,electronegativityPauling:.82,nameOrigin:"Arabic 'al qaliy' for potash",radiusCovalent:1.96,radiusVDW:2.8,boilingpoint:1033,meltingpoint:336.8,periodTableBlock:"s",discoveryDate:"1807",period:"4",group:"1",electronicConfiguration:"Ar 4s1",family:"Alkali_Earth",symbol:"K",name:"Potassium",elementColor:[.56,.25,.83],discoveryCountry:["uk"],discoverers:["H.","B.","Davy"]},{id:"Ca",atomicNumber:20,mass:40.078,exactMass:39.96259098,ionization:6.1132,electronAffinity:.02455,electronegativityPauling:1,nameOrigin:"Latin 'calx' for 'lime'",radiusCovalent:1.74,radiusVDW:2.4,boilingpoint:1757,meltingpoint:1112,periodTableBlock:"s",discoveryDate:"1808",period:"4",group:"2",electronicConfiguration:"Ar 4s2",family:"Alkaline_Earth",symbol:"Ca",name:"Calcium",elementColor:[.24,1,0],discoveryCountry:["uk"],discoverers:["H.","B.","Davy"]},{id:"Sc",atomicNumber:21,mass:44.955912,exactMass:44.9559119,ionization:6.5615,electronAffinity:.188,electronegativityPauling:1.36,nameOrigin:"Named because it was found in Scandinavia",radiusCovalent:1.44,radiusVDW:2.3,boilingpoint:3109,meltingpoint:1814,periodTableBlock:"d",discoveryDate:"1879",period:"4",group:"3",electronicConfiguration:"Ar 3d1 4s2",family:"Transition",symbol:"Sc",name:"Scandium",elementColor:[.9,.9,.9],discoveryCountry:["se"],discoverers:["L.","Nilson"]},{id:"Ti",atomicNumber:22,mass:47.867,exactMass:47.9479463,ionization:6.8281,electronAffinity:.084,electronegativityPauling:1.54,nameOrigin:"The Titans were giants in Greek mythology",radiusCovalent:1.36,radiusVDW:2.15,boilingpoint:3560,meltingpoint:1935,periodTableBlock:"d",discoveryDate:"1791",period:"4",group:"4",electronicConfiguration:"Ar 3d2 4s2",family:"Transition",symbol:"Ti",name:"Titanium",elementColor:[.75,.76,.78],discoveryCountry:["uk"],discoverers:["W.","Gregor"]},{id:"V",atomicNumber:23,mass:50.9415,exactMass:50.9439595,ionization:6.7462,electronAffinity:.525,electronegativityPauling:1.63,nameOrigin:"'Vanadis' is another name for the Nordic goddess Freyja",radiusCovalent:1.25,radiusVDW:2.05,boilingpoint:3650,meltingpoint:2163,periodTableBlock:"d",discoveryDate:"1830",period:"4",group:"5",electronicConfiguration:"Ar 3d3 4s2",family:"Transition",symbol:"V",name:"Vanadium",elementColor:[.65,.65,.67],discoveryCountry:["se"],discoverers:["N.","Sefström"]},{id:"Cr",atomicNumber:24,mass:51.9961,exactMass:51.9405075,ionization:6.7665,electronAffinity:.67584,electronegativityPauling:1.66,nameOrigin:"Greek 'chroma' means 'color'",radiusCovalent:1.27,radiusVDW:2.05,boilingpoint:2945,meltingpoint:2130,periodTableBlock:"d",discoveryDate:"1797",period:"4",group:"6",electronicConfiguration:"Ar 3d5 4s1",family:"Transition",symbol:"Cr",name:"Chromium",elementColor:[.54,.6,.78],discoveryCountry:["fr"],discoverers:["Nicholas","Louis","Vauquelin"]},{id:"Mn",atomicNumber:25,mass:54.938045,exactMass:54.9380451,ionization:7.434,electronAffinity:0,electronegativityPauling:1.55,nameOrigin:"It was discovered near a town named Magnesia in black earth. Thus, it was named 'magnesia nigra', or for short, Manganese.",radiusCovalent:1.39,radiusVDW:2.05,boilingpoint:2235,meltingpoint:1518,periodTableBlock:"d",discoveryDate:"1774",period:"4",group:"7",electronicConfiguration:"Ar 3d5 4s2",family:"Transition",symbol:"Mn",name:"Manganese",elementColor:[.61,.48,.78],discoveryCountry:["se"],discoverers:["C.","W.","Scheele"]},{id:"Fe",atomicNumber:26,mass:55.845,exactMass:55.9349375,ionization:7.9024,electronAffinity:.151,electronegativityPauling:1.83,nameOrigin:"Latin 'ferrum'",radiusCovalent:1.25,radiusVDW:2.05,boilingpoint:3023,meltingpoint:1808,periodTableBlock:"d",discoveryDate:"0",period:"4",group:"8",electronicConfiguration:"Ar 3d6 4s2",family:"Transition",symbol:"Fe",name:"Iron",elementColor:[.5,.48,.78],discoveryCountry:["ancient"]},{id:"Co",atomicNumber:27,mass:58.933195,exactMass:58.933195,ionization:7.881,electronAffinity:.6633,electronegativityPauling:1.88,nameOrigin:"Named after the German word 'Kobold' for 'goblin'",radiusCovalent:1.26,radiusVDW:2,boilingpoint:3143,meltingpoint:1768,periodTableBlock:"d",discoveryDate:"1737",period:"4",group:"8",electronicConfiguration:"Ar 3d7 4s2",family:"Transition",symbol:"Co",name:"Cobalt",elementColor:[.44,.48,.78],discoveryCountry:["se"],discoverers:["G.","Brandt"]},{id:"Ni",atomicNumber:28,mass:58.6934,exactMass:57.9353429,ionization:7.6398,electronAffinity:1.15716,electronegativityPauling:1.91,nameOrigin:"'Nickel' was the name of a mountain goblin",radiusCovalent:1.21,radiusVDW:2,boilingpoint:3005,meltingpoint:1726,periodTableBlock:"d",discoveryDate:"1751",period:"4",group:"8",electronicConfiguration:"Ar 3d8 4s2",family:"Transition",symbol:"Ni",name:"Nickel",elementColor:[.36,.48,.76],discoveryCountry:["se"],discoverers:["A.","F.","Cronstedt"]},{id:"Cu",atomicNumber:29,mass:63.546,exactMass:62.9295975,ionization:7.7264,electronAffinity:1.23578,electronegativityPauling:1.9,nameOrigin:"Greek 'cuprum' for Cypres",radiusCovalent:1.38,radiusVDW:2,boilingpoint:2840,meltingpoint:1356.6,periodTableBlock:"d",discoveryDate:"0",period:"4",group:"1",electronicConfiguration:"Ar 3d10 4s1",family:"Transition",symbol:"Cu",name:"Copper",elementColor:[1,.48,.38],discoveryCountry:["ancient"]},{id:"Zn",atomicNumber:30,mass:65.38,exactMass:63.9291422,ionization:9.3942,electronAffinity:0,electronegativityPauling:1.65,nameOrigin:"German 'zinking' for 'rough', because zinc ore is very rough",radiusCovalent:1.31,radiusVDW:2.1,boilingpoint:1180,meltingpoint:692.73,periodTableBlock:"d",discoveryDate:"1746",period:"4",group:"2",electronicConfiguration:"Ar 3d10 4s2",family:"Transition",symbol:"Zn",name:"Zinc",elementColor:[.49,.5,.69],discoveryCountry:["de"],discoverers:["Andreas","Marggraf"]},{id:"Ga",atomicNumber:31,mass:69.723,exactMass:68.9255736,ionization:5.9993,electronAffinity:.41,electronegativityPauling:1.81,nameOrigin:"'Gallia' is an old name for France",radiusCovalent:1.26,radiusVDW:2.1,boilingpoint:2478,meltingpoint:302.92,periodTableBlock:"p",discoveryDate:"1875",period:"4",group:"3",electronicConfiguration:"Ar 3d10 4s2 4p1",family:"Other_Metal",symbol:"Ga",name:"Gallium",elementColor:[.76,.56,.56],discoveryCountry:["fr"],discoverers:["P.","E.","Lecoq","de","Boisbaudran"]},{id:"Ge",atomicNumber:32,mass:72.64,exactMass:73.9211778,ionization:7.8994,electronAffinity:1.232712,electronegativityPauling:2.01,nameOrigin:"Latin 'germania' is an old name for Germany",radiusCovalent:1.22,radiusVDW:2.1,boilingpoint:3107,meltingpoint:1211.5,periodTableBlock:"p",discoveryDate:"1886",period:"4",group:"4",electronicConfiguration:"Ar 3d10 4s2 4p2",family:"Metalloids",symbol:"Ge",name:"Germanium",elementColor:[.4,.56,.56],discoveryCountry:["de"],discoverers:["C.","A.","Winkler"]},{id:"As",atomicNumber:33,mass:74.9216,exactMass:74.9215965,ionization:9.7886,electronAffinity:.814,electronegativityPauling:2.18,nameOrigin:"Greek 'arsenikos' for 'male' or 'bold'",radiusCovalent:1.19,radiusVDW:2.05,boilingpoint:876,meltingpoint:1090,periodTableBlock:"p",discoveryDate:"0",period:"4",group:"5",electronicConfiguration:"Ar 3d10 4s2 4p3",family:"Metalloids",symbol:"As",name:"Arsenic",elementColor:[.74,.5,.89],discoveryCountry:["ancient"]},{id:"Se",atomicNumber:34,mass:78.96,exactMass:79.9165213,ionization:9.7524,electronAffinity:2.02067,electronegativityPauling:2.55,nameOrigin:"Greek 'selena' for 'moon'",radiusCovalent:1.16,radiusVDW:1.9,boilingpoint:958,meltingpoint:494,periodTableBlock:"p",discoveryDate:"1817",period:"4",group:"6",electronicConfiguration:"Ar 3d10 4s2 4p4",family:"Non-Metal",symbol:"Se",name:"Selenium",elementColor:[1,.63,0],discoveryCountry:["se"],discoverers:["J.","J.","Berzelius"]},{id:"Br",atomicNumber:35,mass:79.904,exactMass:78.9183371,ionization:11.8138,electronAffinity:3.363588,electronegativityPauling:2.96,nameOrigin:"Greek 'bromos' for 'smells badly'",radiusCovalent:1.14,radiusVDW:1.9,boilingpoint:331.85,meltingpoint:265.95,periodTableBlock:"p",discoveryDate:"1826",period:"4",group:"7",electronicConfiguration:"Ar 3d10 4s2 4p5",family:"Halogen",symbol:"Br",name:"Bromine",elementColor:[.65,.16,.16],discoveryCountry:["fr"],discoverers:["A.","J.","Balard"]},{id:"Kr",atomicNumber:36,mass:83.798,exactMass:83.911507,ionization:13.9996,electronAffinity:0,electronegativityPauling:3,nameOrigin:"Greek 'kryptos' for 'hidden'",radiusCovalent:1.1,radiusVDW:2.02,boilingpoint:120.85,meltingpoint:116,periodTableBlock:"p",discoveryDate:"1898",period:"4",group:"8",electronicConfiguration:"Ar 3d10 4s2 4p6",family:"Noblegas",symbol:"Kr",name:"Krypton",elementColor:[.36,.72,.82],discoveryCountry:["uk"],discoverers:["W. Ramsay","M. W. Travers"]},{id:"Rb",atomicNumber:37,mass:85.4678,exactMass:84.91178974,ionization:4.1771,electronAffinity:.485916,electronegativityPauling:.82,nameOrigin:"Latin 'rubidus' for 'dark red'",radiusCovalent:2.11,radiusVDW:2.9,boilingpoint:961,meltingpoint:312.63,periodTableBlock:"s",discoveryDate:"1861",period:"5",group:"1",electronicConfiguration:"Kr 5s1",family:"Alkali_Earth",symbol:"Rb",name:"Rubidium",elementColor:[.44,.18,.69],discoveryCountry:["de"],discoverers:["Robert W. Bunsen","Gustav R. Kirchhoff"]},{id:"Sr",atomicNumber:38,mass:87.62,exactMass:87.9056121,ionization:5.6949,electronAffinity:.05206,electronegativityPauling:.95,nameOrigin:"Named after the mineral Strontianit",radiusCovalent:1.92,radiusVDW:2.55,boilingpoint:1655,meltingpoint:1042,periodTableBlock:"s",discoveryDate:"1790",period:"5",group:"2",electronicConfiguration:"Kr 5s2",family:"Alkaline_Earth",symbol:"Sr",name:"Strontium",elementColor:[0,1,0],discoveryCountry:["uk"],discoverers:["H.","B.","Davy"]},{id:"Y",atomicNumber:39,mass:88.90585,exactMass:88.9058483,ionization:6.2173,electronAffinity:.307,electronegativityPauling:1.22,nameOrigin:"Named after the small town of Ytterby near Stockholm in Sweden. Terbium. Ytterbium and Gadolinium are also named after this town.",radiusCovalent:1.62,radiusVDW:2.4,boilingpoint:3611,meltingpoint:1795,periodTableBlock:"d",discoveryDate:"1794",period:"5",group:"3",electronicConfiguration:"Kr 4d1 5s2",family:"Transition",symbol:"Y",name:"Yttrium",elementColor:[.58,1,1],discoveryCountry:["fi"],discoverers:["Johann","Gadolin"]},{id:"Zr",atomicNumber:40,mass:91.224,exactMass:89.9047044,ionization:6.6339,electronAffinity:.426,electronegativityPauling:1.33,nameOrigin:"Named after the mineral zircon",radiusCovalent:1.48,radiusVDW:2.3,boilingpoint:4682,meltingpoint:2128,periodTableBlock:"d",discoveryDate:"1789",period:"5",group:"4",electronicConfiguration:"Kr 4d2 5s2",family:"Transition",symbol:"Zr",name:"Zirconium",elementColor:[.58,.88,.88],discoveryCountry:["de"],discoverers:["Martin","Heinrich","Klaproth"]},{id:"Nb",atomicNumber:41,mass:92.90638,exactMass:92.9063781,ionization:6.7589,electronAffinity:.893,electronegativityPauling:1.6,nameOrigin:"Named after Niobe, the daughter of the Greek god Tantalus.",radiusCovalent:1.37,radiusVDW:2.15,boilingpoint:5015,meltingpoint:2742,periodTableBlock:"d",discoveryDate:"1801",period:"5",group:"5",electronicConfiguration:"Kr 4d4",family:"Transition",symbol:"Nb",name:"Niobium",elementColor:[.45,.76,.79],discoveryCountry:["uk"],discoverers:["Ch.","Hatchett"]},{id:"Mo",atomicNumber:42,mass:95.96,exactMass:97.9054082,ionization:7.0924,electronAffinity:.7472,electronegativityPauling:2.16,nameOrigin:"This name has Greek roots. It means 'like Platinum' - it was difficult to distinguish Molybdenum from Platinum.",radiusCovalent:1.45,radiusVDW:2.1,boilingpoint:4912,meltingpoint:2896,periodTableBlock:"d",discoveryDate:"1778",period:"5",group:"6",electronicConfiguration:"Kr 4d5 5s1",family:"Transition",symbol:"Mo",name:"Molybdenum",elementColor:[.33,.71,.71],discoveryCountry:["se"],discoverers:["C.","W.","Scheele"]},{id:"Tc",atomicNumber:43,mass:98,exactMass:97.907216,ionization:7.28,electronAffinity:.55,electronegativityPauling:1.9,nameOrigin:"Greek 'technetos' for artificial",radiusCovalent:1.56,radiusVDW:2.05,boilingpoint:4538,meltingpoint:2477,periodTableBlock:"d",discoveryDate:"1937",period:"5",group:"7",electronicConfiguration:"Kr 4d6 5s1",family:"Transition",symbol:"Tc",name:"Technetium",elementColor:[.23,.62,.62],discoveryCountry:["it"],discoverers:["C. Perrier","E. G. Segre"]},{id:"Ru",atomicNumber:44,mass:101.07,exactMass:101.9043493,ionization:7.3605,electronAffinity:1.04638,electronegativityPauling:2.2,nameOrigin:"Ruthenia is the old name of Russia",radiusCovalent:1.26,radiusVDW:2.05,boilingpoint:4425,meltingpoint:2610,periodTableBlock:"d",discoveryDate:"1844",period:"5",group:"8",electronicConfiguration:"Kr 4d7 5s1",family:"Transition",symbol:"Ru",name:"Ruthenium",elementColor:[.14,.56,.56],discoveryCountry:["ru"],discoverers:["K.","Klaus"]},{id:"Rh",atomicNumber:45,mass:102.9055,exactMass:102.905504,ionization:7.4589,electronAffinity:1.14289,electronegativityPauling:2.28,nameOrigin:"Greek 'rhodeos' means 'red like a rose'",radiusCovalent:1.35,radiusVDW:2,boilingpoint:3970,meltingpoint:2236,periodTableBlock:"d",discoveryDate:"1803",period:"5",group:"8",electronicConfiguration:"Kr 4d8 5s1",family:"Transition",symbol:"Rh",name:"Rhodium",elementColor:[.04,.49,.55],discoveryCountry:["uk"],discoverers:["W.","Wollaston"]},{id:"Pd",atomicNumber:46,mass:106.42,exactMass:105.903486,ionization:8.3369,electronAffinity:.56214,electronegativityPauling:2.2,nameOrigin:"Named after the asteroid Pallas",radiusCovalent:1.31,radiusVDW:2.05,boilingpoint:3240,meltingpoint:1825,periodTableBlock:"d",discoveryDate:"1803",period:"5",group:"8",electronicConfiguration:"Kr 4d10",family:"Transition",symbol:"Pd",name:"Palladium",elementColor:[0,.41,.52],discoveryCountry:["uk"]},{id:"Ag",atomicNumber:47,mass:107.8682,exactMass:106.905097,ionization:7.5762,electronAffinity:1.30447,electronegativityPauling:1.93,nameOrigin:"Latin 'argentum' for silver",radiusCovalent:1.53,radiusVDW:2.1,boilingpoint:2436,meltingpoint:1235.1,periodTableBlock:"d",discoveryDate:"0",period:"5",group:"1",electronicConfiguration:"Kr 4d10 5s1",family:"Transition",symbol:"Ag",name:"Silver",elementColor:[.88,.88,1],discoveryCountry:["ancient"]},{id:"Cd",atomicNumber:48,mass:112.411,exactMass:113.9033585,ionization:8.9938,electronAffinity:0,electronegativityPauling:1.69,nameOrigin:"Greek 'kadmia' ('Galmei' = Zinc carbonate)",radiusCovalent:1.48,radiusVDW:2.2,boilingpoint:1040,meltingpoint:594.26,periodTableBlock:"d",discoveryDate:"1817",period:"5",group:"2",electronicConfiguration:"Kr 4d10 5s2",family:"Transition",symbol:"Cd",name:"Cadmium",elementColor:[1,.85,.56],discoveryCountry:["de"],discoverers:["F.","Stromeyer"]},{id:"In",atomicNumber:49,mass:114.818,exactMass:114.903878,ionization:5.7864,electronAffinity:.404,electronegativityPauling:1.78,nameOrigin:"Named after 'Indigo' because of its blue spectrum",radiusCovalent:1.44,radiusVDW:2.2,boilingpoint:2350,meltingpoint:429.78,periodTableBlock:"p",discoveryDate:"1863",period:"5",group:"3",electronicConfiguration:"Kr 4d10 5s2 5p1",family:"Other_Metal",symbol:"In",name:"Indium",elementColor:[.65,.46,.45],discoveryCountry:["de"],discoverers:["F. Reich","H.T. Richter"]},{id:"Sn",atomicNumber:50,mass:118.71,exactMass:119.9021947,ionization:7.3439,electronAffinity:1.112066,electronegativityPauling:1.96,nameOrigin:"Latin 'stannum' for tin",radiusCovalent:1.41,radiusVDW:2.25,boilingpoint:2876,meltingpoint:505.12,periodTableBlock:"p",discoveryDate:"0",period:"5",group:"4",electronicConfiguration:"Kr 4d10 5s2 5p2",family:"Other_Metal",symbol:"Sn",name:"Tin",elementColor:[.4,.5,.5],discoveryCountry:["ancient"]},{id:"Sb",atomicNumber:51,mass:121.76,exactMass:120.9038157,ionization:8.6084,electronAffinity:1.047401,electronegativityPauling:2.05,nameOrigin:"Arabic 'anthos ammonos' for 'blossom of the god Ammon'",radiusCovalent:1.38,radiusVDW:2.2,boilingpoint:1860,meltingpoint:903.91,periodTableBlock:"p",discoveryDate:"0",period:"5",group:"5",electronicConfiguration:"Kr 4d10 5s2 5p3",family:"Metalloids",symbol:"Sb",name:"Antimony",elementColor:[.62,.39,.71],discoveryCountry:["ancient"]},{id:"Te",atomicNumber:52,mass:127.6,exactMass:129.9062244,ionization:9.0096,electronAffinity:1.970875,electronegativityPauling:2.1,nameOrigin:"Latin 'tellus' or 'telluris' for 'Planet Earth'",radiusCovalent:1.35,radiusVDW:2.1,boilingpoint:1261,meltingpoint:722.72,periodTableBlock:"p",discoveryDate:"1782",period:"5",group:"6",electronicConfiguration:"Kr 4d10 5s2 5p4",family:"Metalloids",symbol:"Te",name:"Tellurium",elementColor:[.83,.48,0],discoveryCountry:["de"],discoverers:["Franz","Joseph","Muller","von","Reichstein"]},{id:"I",atomicNumber:53,mass:126.90447,exactMass:126.904473,ionization:10.4513,electronAffinity:3.059038,electronegativityPauling:2.66,nameOrigin:"Greek 'ioeides' for 'violet'.",radiusCovalent:1.33,radiusVDW:2.1,boilingpoint:457.5,meltingpoint:386.7,periodTableBlock:"p",discoveryDate:"1811",period:"5",group:"7",electronicConfiguration:"Kr 4d10 5s2 5p5",family:"Halogen",symbol:"I",name:"Iodine",elementColor:[.58,0,.58],discoveryCountry:["fr"],discoverers:["Bernard","Courtois"]},{id:"Xe",atomicNumber:54,mass:131.293,exactMass:131.9041535,ionization:12.1298,electronAffinity:0,electronegativityPauling:2.6,nameOrigin:"Greek 'xenos' for 'foreigner'",radiusCovalent:1.3,radiusVDW:2.16,boilingpoint:165.1,meltingpoint:161.39,periodTableBlock:"p",discoveryDate:"1898",period:"5",group:"8",electronicConfiguration:"Kr 4d10 5s2 5p6",family:"Noblegas",symbol:"Xe",name:"Xenon",elementColor:[.26,.62,.69],discoveryCountry:["uk"],discoverers:["W. Ramsay","M. W. Travers"]},{id:"Cs",atomicNumber:55,mass:132.9054519,exactMass:132.9054519,ionization:3.8939,electronAffinity:.471626,electronegativityPauling:.79,nameOrigin:"Latin 'caesius' for 'heaven blue'.",radiusCovalent:2.25,radiusVDW:3,boilingpoint:944,meltingpoint:301.54,periodTableBlock:"s",discoveryDate:"1860",period:"6",group:"1",electronicConfiguration:"Xe 6s1",family:"Alkali_Earth",symbol:"Cs",name:"Caesium",elementColor:[.34,.09,.56],discoveryCountry:["de"],discoverers:["Robert Wilhelm Bunsen","Gustav Robert Kirchhoff"]},{id:"Ba",atomicNumber:56,mass:137.327,exactMass:137.9052472,ionization:5.2117,electronAffinity:.14462,electronegativityPauling:.89,nameOrigin:"Greek 'barys' for 'heavy'",radiusCovalent:1.98,radiusVDW:2.7,boilingpoint:2078,meltingpoint:1002,periodTableBlock:"s",discoveryDate:"1808",period:"6",group:"2",electronicConfiguration:"Xe 6s2",family:"Alkaline_Earth",symbol:"Ba",name:"Barium",elementColor:[0,.79,0],discoveryCountry:["uk"],discoverers:["Humphry","Bartholomew","Davy"]},{id:"La",atomicNumber:57,mass:138.90547,exactMass:138.9063533,ionization:5.5769,electronAffinity:.47,electronegativityPauling:1.1,nameOrigin:"Greek 'lanthanein' for 'hidden'. The Lanthanoids are also called the 'rare earth' elements.",radiusCovalent:1.69,radiusVDW:2.5,boilingpoint:3737,meltingpoint:1191,periodTableBlock:"f",discoveryDate:"1839",period:"6",group:"3",electronicConfiguration:"Xe 5d1 6s2",family:"Rare_Earth",symbol:"La",name:"Lanthanum",elementColor:[.44,.83,1],discoveryCountry:["se"],discoverers:["K.","G.","Mosander"]},{id:"Ce",atomicNumber:58,mass:140.116,exactMass:139.9054387,ionization:5.5387,electronAffinity:.5,electronegativityPauling:1.12,nameOrigin:"Named after the planetoid Ceres",radiusVDW:2.48,boilingpoint:3715,meltingpoint:1071,periodTableBlock:"f",discoveryDate:"1803",period:"6",group:"4",electronicConfiguration:"Xe 4f1 5d1 6s2",family:"Rare_Earth",symbol:"Ce",name:"Cerium",elementColor:[1,1,.78],discoverers:["Jöns Jacob Berzelius","W. Hisinger","M. Klaproth"]},{id:"Pr",atomicNumber:59,mass:140.90765,exactMass:140.9076528,ionization:5.473,electronAffinity:.5,electronegativityPauling:1.13,nameOrigin:"Greek 'prasinos didymos' for 'green twin'",radiusVDW:2.47,boilingpoint:3785,meltingpoint:1204,periodTableBlock:"f",discoveryDate:"1885",period:"6",group:"5",electronicConfiguration:"Xe 4f3 6s2",family:"Rare_Earth",symbol:"Pr",name:"Praseodymium",elementColor:[.85,1,.78],discoverers:["Carl","F.","Auer","von","Welsbach"]},{id:"Nd",atomicNumber:60,mass:144.242,exactMass:141.9077233,ionization:5.525,electronAffinity:.5,electronegativityPauling:1.14,nameOrigin:"Greek 'neos didymos' for 'new twin'",radiusVDW:2.45,boilingpoint:3347,meltingpoint:1294,periodTableBlock:"f",discoveryDate:"1885",period:"6",group:"6",electronicConfiguration:"Xe 4f4 6s2",family:"Rare_Earth",symbol:"Nd",name:"Neodymium",elementColor:[.78,1,.78],discoverers:["Carl","F.","Auer","von","Welsbach"]},{id:"Pm",atomicNumber:61,mass:145,exactMass:144.912749,ionization:5.582,electronAffinity:.5,nameOrigin:"Named after the Greek Prometheus. Prometheus stole the fire from the gods and gave it to mankind.",radiusVDW:2.43,boilingpoint:3273,meltingpoint:1315,periodTableBlock:"f",discoveryDate:"1945",period:"6",group:"7",electronicConfiguration:"Xe 4f5 6s2",family:"Rare_Earth",symbol:"Pm",name:"Promethium",elementColor:[.64,1,.78],discoverers:["J. A. Marinsky","C. D. Coryell","L. E. Glendenin"]},{id:"Sm",atomicNumber:62,mass:150.36,exactMass:151.9197324,ionization:5.6437,electronAffinity:.5,electronegativityPauling:1.17,nameOrigin:"Named after the mineral Samarskit",radiusVDW:2.42,boilingpoint:2067,meltingpoint:1347,periodTableBlock:"f",discoveryDate:"1879",period:"6",group:"8",electronicConfiguration:"Xe 4f6 6s2",family:"Rare_Earth",symbol:"Sm",name:"Samarium",elementColor:[.56,1,.78],discoverers:["P.","Lecoq","de","Boisbaudran"]},{id:"Eu",atomicNumber:63,mass:151.964,exactMass:152.9212303,ionization:5.6704,electronAffinity:.5,nameOrigin:"Named after Europe",radiusVDW:2.4,boilingpoint:1800,meltingpoint:1095,periodTableBlock:"f",discoveryDate:"1901",period:"6",group:"8",electronicConfiguration:"Xe 4f7 6s2",family:"Rare_Earth",symbol:"Eu",name:"Europium",elementColor:[.38,1,.78],discoverers:["E.","A.","Demarcay"]},{id:"Gd",atomicNumber:64,mass:157.25,exactMass:157.9241039,ionization:6.1498,electronAffinity:.5,electronegativityPauling:1.2,nameOrigin:"Named after the Finnish chemist Johan Gadolin",radiusVDW:2.38,boilingpoint:3545,meltingpoint:1585,periodTableBlock:"f",discoveryDate:"1880",period:"6",group:"8",electronicConfiguration:"Xe 4f7 5d1 6s2",family:"Rare_Earth",symbol:"Gd",name:"Gadolinium",elementColor:[.27,1,.78],discoverers:["Jean","de","Marignac"]},{id:"Tb",atomicNumber:65,mass:158.92535,exactMass:158.9253468,ionization:5.8638,electronAffinity:.5,nameOrigin:"Named after the Swedish town of Ytterby",radiusVDW:2.37,boilingpoint:3500,meltingpoint:1629,periodTableBlock:"f",discoveryDate:"1843",period:"6",group:"1",electronicConfiguration:"Xe 4f9 6s2",family:"Rare_Earth",symbol:"Tb",name:"Terbium",elementColor:[.19,1,.78],discoverers:["K.","G.","Mosander"]},{id:"Dy",atomicNumber:66,mass:162.5,exactMass:163.9291748,ionization:5.9389,electronAffinity:.5,electronegativityPauling:1.22,nameOrigin:"Greek 'dysprositor' for 'difficult to reach'",radiusVDW:2.35,boilingpoint:2840,meltingpoint:1685,periodTableBlock:"f",discoveryDate:"1886",period:"6",group:"2",electronicConfiguration:"Xe 4f10 6s2",family:"Rare_Earth",symbol:"Dy",name:"Dysprosium",elementColor:[.12,1,.78],discoverers:["F.","E.","Lecoq","de","Boisbaudran"]},{id:"Ho",atomicNumber:67,mass:164.93032,exactMass:164.9303221,ionization:6.0215,electronAffinity:.5,electronegativityPauling:1.23,nameOrigin:"Latin 'holmia' for the old name of Stockholm",radiusVDW:2.33,boilingpoint:2968,meltingpoint:1747,periodTableBlock:"f",discoveryDate:"1878",period:"6",group:"3",electronicConfiguration:"Xe 4f11 6s2",family:"Rare_Earth",symbol:"Ho",name:"Holmium",elementColor:[0,1,.61],discoverers:["J. L. Soret","P.T. Cleve"]},{id:"Er",atomicNumber:68,mass:167.259,exactMass:165.9302931,ionization:6.1077,electronAffinity:.5,electronegativityPauling:1.24,nameOrigin:"Named ofter the Swedish town of Ytterby. Terbium and Ytterbium are also named after this town.",radiusVDW:2.32,boilingpoint:3140,meltingpoint:1802,periodTableBlock:"f",discoveryDate:"1843",period:"6",group:"4",electronicConfiguration:"Xe 4f12 6s2",family:"Rare_Earth",symbol:"Er",name:"Erbium",elementColor:[0,.9,.46],discoverers:["K.","G.","Mosander"]},{id:"Tm",atomicNumber:69,mass:168.93421,exactMass:168.9342133,ionization:6.1843,electronAffinity:.5,electronegativityPauling:1.25,nameOrigin:"Named after the old name of Scandinavia, 'Thule'.",radiusVDW:2.3,boilingpoint:2223,meltingpoint:1818,periodTableBlock:"f",discoveryDate:"1879",period:"6",group:"5",electronicConfiguration:"Xe 4f13 6s2",family:"Rare_Earth",symbol:"Tm",name:"Thulium",elementColor:[0,.83,.32],discoverers:["P.","T.","Cleve"]},{id:"Yb",atomicNumber:70,mass:173.054,exactMass:173.9388621,ionization:6.2542,electronAffinity:.5,nameOrigin:"Like Terbium and Gadolinium, this is named after the Swedish town of Ytterby.",radiusVDW:2.28,boilingpoint:1469,meltingpoint:1092,periodTableBlock:"f",discoveryDate:"1878",period:"6",group:"6",electronicConfiguration:"Xe 4f14 6s2",family:"Rare_Earth",symbol:"Yb",name:"Ytterbium",elementColor:[0,.75,.22],discoverers:["J.","Ch.","Marignac"]},{id:"Lu",atomicNumber:71,mass:174.9668,exactMass:174.9407718,ionization:5.4259,electronAffinity:.5,electronegativityPauling:1.27,nameOrigin:"Named after the Roman name 'Lutetia' for Paris",radiusCovalent:1.6,radiusVDW:2.27,boilingpoint:3668,meltingpoint:1936,periodTableBlock:"f",discoveryDate:"1907",period:"6",group:"7",electronicConfiguration:"Xe 4f14 5d1 6s2",family:"Rare_Earth",symbol:"Lu",name:"Lutetium",elementColor:[0,.67,.14],discoverers:["Carl F. Auer von Welsbach","G. Urbain"]},{id:"Hf",atomicNumber:72,mass:178.49,exactMass:179.94655,ionization:6.8251,electronAffinity:0,electronegativityPauling:1.3,nameOrigin:"'Hafnia' is the old name of Kopenhagen (Denmark)",radiusCovalent:1.5,radiusVDW:2.25,boilingpoint:4875,meltingpoint:2504,periodTableBlock:"d",discoveryDate:"1923",period:"6",group:"4",electronicConfiguration:"Xe 4f14 5d2 6s2",family:"Transition",symbol:"Hf",name:"Hafnium",elementColor:[.3,.76,1],discoveryCountry:["dk"],discoverers:["D. Coster","G. Hevesy"]},{id:"Ta",atomicNumber:73,mass:180.94788,exactMass:180.9479958,ionization:7.5496,electronAffinity:.322,electronegativityPauling:1.5,nameOrigin:"Named after the Greek myth of Tantalos",radiusCovalent:1.38,radiusVDW:2.2,boilingpoint:5730,meltingpoint:3293,periodTableBlock:"d",discoveryDate:"1802",period:"6",group:"5",electronicConfiguration:"Xe 4f14 5d3 6s2",family:"Transition",symbol:"Ta",name:"Tantalum",elementColor:[.3,.65,1],discoveryCountry:["se"],discoverers:["A.","Ekeberg"]},{id:"W",atomicNumber:74,mass:183.84,exactMass:183.9509312,ionization:7.864,electronAffinity:.815,electronegativityPauling:2.36,nameOrigin:"'tung sten' means 'heavy stone' in Swedish. The old name (and thus the symbol 'W') was Wolfram, named after a mineral.",radiusCovalent:1.46,radiusVDW:2.1,boilingpoint:5825,meltingpoint:3695,periodTableBlock:"d",discoveryDate:"1783",period:"6",group:"6",electronicConfiguration:"Xe 4f14 5d4 6s2",family:"Transition",symbol:"W",name:"Tungsten",elementColor:[.13,.58,.84],discoveryCountry:["es"],discoverers:["C.","W.","Scheele"]},{id:"Re",atomicNumber:75,mass:186.207,exactMass:186.9557531,ionization:7.8335,electronAffinity:.15,electronegativityPauling:1.9,nameOrigin:"Named after the German river Rhine (latin 'Rhenium').",radiusCovalent:1.59,radiusVDW:2.05,boilingpoint:5870,meltingpoint:3455,periodTableBlock:"d",discoveryDate:"1925",period:"6",group:"7",electronicConfiguration:"Xe 4f14 5d5 6s2",family:"Transition",symbol:"Re",name:"Rhenium",elementColor:[.15,.49,.67],discoveryCountry:["de"],discoverers:["Walter Noddack","Ida Tacke-Noddack","Otto Berg"]},{id:"Os",atomicNumber:76,mass:190.23,exactMass:191.9614807,ionization:8.4382,electronAffinity:1.0778,electronegativityPauling:2.2,nameOrigin:"Greek for 'smell'. Its oxides smell strongly like radishes.",radiusCovalent:1.28,radiusVDW:2,boilingpoint:5300,meltingpoint:3300,periodTableBlock:"d",discoveryDate:"1804",period:"6",group:"8",electronicConfiguration:"Xe 4f14 5d6 6s2",family:"Transition",symbol:"Os",name:"Osmium",elementColor:[.15,.4,.59],discoveryCountry:["uk"],discoverers:["S.","Tennant"]},{id:"Ir",atomicNumber:77,mass:192.217,exactMass:192.9629264,ionization:8.967,electronAffinity:1.56436,electronegativityPauling:2.2,nameOrigin:"Greek 'iris' for 'rainbow'",radiusCovalent:1.37,radiusVDW:2,boilingpoint:4700,meltingpoint:2720,periodTableBlock:"d",discoveryDate:"1804",period:"6",group:"8",electronicConfiguration:"Xe 4f14 5d7 6s2",family:"Transition",symbol:"Ir",name:"Iridium",elementColor:[.09,.33,.53],discoveryCountry:["uk"],discoverers:["S.","Tennant"]},{id:"Pt",atomicNumber:78,mass:195.084,exactMass:194.9647911,ionization:8.9588,electronAffinity:2.1251,electronegativityPauling:2.28,nameOrigin:"Spanish 'platina' means 'small silver'",radiusCovalent:1.28,radiusVDW:2.05,boilingpoint:4100,meltingpoint:2042.1,periodTableBlock:"d",discoveryDate:"1735",period:"6",group:"8",electronicConfiguration:"Xe 4f14 5d9 6s1",family:"Transition",symbol:"Pt",name:"Platinum",elementColor:[.96,.93,.82],discoveryCountry:["uk"],discoverers:["A.","de","Ulloa"]},{id:"Au",atomicNumber:79,mass:196.966569,exactMass:196.9665687,ionization:9.2255,electronAffinity:2.30861,electronegativityPauling:2.54,nameOrigin:"Latin 'aurum'. Named after Aurora, the goddess of sunrise",radiusCovalent:1.44,radiusVDW:2.1,boilingpoint:3130,meltingpoint:1337.58,periodTableBlock:"d",discoveryDate:"0",period:"6",group:"1",electronicConfiguration:"Xe 4f14 5d10 6s1",family:"Transition",symbol:"Au",name:"Gold",elementColor:[.8,.82,.12],discoveryCountry:["ancient"]},{id:"Hg",atomicNumber:80,mass:200.59,exactMass:201.970643,ionization:10.4375,electronAffinity:0,electronegativityPauling:2,nameOrigin:"Graeco-Latin 'hydrargyrum' for 'liquid silver'",radiusCovalent:1.49,radiusVDW:2.05,boilingpoint:629.88,meltingpoint:234.31,periodTableBlock:"d",discoveryDate:"0",period:"6",group:"2",electronicConfiguration:"Xe 4f14 5d10 6s2",family:"Transition",symbol:"Hg",name:"Mercury",elementColor:[.71,.71,.76],discoveryCountry:["ancient"]},{id:"Tl",atomicNumber:81,mass:204.3833,exactMass:204.9744275,ionization:6.1082,electronAffinity:.377,electronegativityPauling:1.62,nameOrigin:"Greek 'tallos' for 'young twig'",radiusCovalent:1.48,radiusVDW:2.2,boilingpoint:1746,meltingpoint:577,periodTableBlock:"p",discoveryDate:"1861",period:"6",group:"3",electronicConfiguration:"Xe 4f14 5d10 6s2 6p1",family:"Other_Metal",symbol:"Tl",name:"Thallium",elementColor:[.65,.33,.3],discoveryCountry:["uk"],discoverers:["W.","Crookes"]},{id:"Pb",atomicNumber:82,mass:207.2,exactMass:207.9766521,ionization:7.4167,electronAffinity:.364,electronegativityPauling:2.33,nameOrigin:"Latin 'plumbum' for Lead",radiusCovalent:1.47,radiusVDW:2.3,boilingpoint:2023,meltingpoint:600.65,periodTableBlock:"p",discoveryDate:"0",period:"6",group:"4",electronicConfiguration:"Xe 4f14 5d10 6s2 6p2",family:"Other_Metal",symbol:"Pb",name:"Lead",elementColor:[.34,.35,.38],discoveryCountry:["ancient"]},{id:"Bi",atomicNumber:83,mass:208.9804,exactMass:208.9803987,ionization:7.2855,electronAffinity:.942363,electronegativityPauling:2.02,nameOrigin:"The old name of Bismuth is 'Wismut', which stood for 'white mass'.",radiusCovalent:1.46,radiusVDW:2.3,boilingpoint:1837,meltingpoint:544.59,periodTableBlock:"p",discoveryDate:"0",period:"6",group:"5",electronicConfiguration:"Xe 4f14 5d10 6s2 6p3",family:"Other_Metal",symbol:"Bi",name:"Bismuth",elementColor:[.62,.31,.71],discoveryCountry:["ancient"]},{id:"Po",atomicNumber:84,mass:209,exactMass:208.9824304,ionization:8.414,electronAffinity:1.9,electronegativityPauling:2,nameOrigin:"Named after Poland to honor Marie Curie",radiusVDW:2,meltingpoint:527,periodTableBlock:"p",discoveryDate:"1898",period:"6",group:"6",electronicConfiguration:"Xe 4f14 5d10 6s2 6p4",family:"Metalloids",symbol:"Po",name:"Polonium",elementColor:[.67,.36,0],discoveryCountry:["fr"],discoverers:["M. Sklodowska-Curie","P. Curie"]},{id:"At",atomicNumber:85,mass:210,exactMass:209.987148,ionization:0,electronAffinity:2.8,electronegativityPauling:2.2,nameOrigin:"Greek 'astator' for 'changing'",radiusVDW:2,boilingpoint:610,meltingpoint:575,periodTableBlock:"p",discoveryDate:"1940",period:"6",group:"7",electronicConfiguration:"Xe 4f14 5d10 6s2 6p5",family:"Halogen",symbol:"At",name:"Astatine",elementColor:[.46,.31,.27],discoveryCountry:["us"],discoverers:["D. R. Corson","K. R. McKenzie","E. Segre"]},{id:"Rn",atomicNumber:86,mass:222,exactMass:222.0175777,ionization:10.7485,electronAffinity:0,nameOrigin:"Named after Radium. It ends with 'on' to make it clear that it is a noble gas.",radiusCovalent:1.45,radiusVDW:2,boilingpoint:211.4,meltingpoint:202,periodTableBlock:"p",discoveryDate:"1898",period:"6",group:"8",electronicConfiguration:"Xe 4f14 5d10 6s2 6p6",family:"Noblegas",symbol:"Rn",name:"Radon",elementColor:[.26,.51,.59],discoveryCountry:["de"],discoverers:["E.","Dorn"]},{id:"Fr",atomicNumber:87,mass:223,exactMass:223.0197359,ionization:4.0727,electronegativityPauling:.7,nameOrigin:"Named after France to honor Marguerite Perey",radiusVDW:2,boilingpoint:950,meltingpoint:300,periodTableBlock:"s",discoveryDate:"1939",period:"7",group:"1",electronicConfiguration:"Rn 7s1",family:"Alkali_Earth",symbol:"Fr",name:"Francium",elementColor:[.26,0,.4],discoveryCountry:["fr"],discoverers:["M.","Perey"]},{id:"Ra",atomicNumber:88,mass:226,exactMass:226.0254098,ionization:5.2784,electronegativityPauling:.9,nameOrigin:"Latin 'radius' for 'beam', as it is radioactive",radiusVDW:2,boilingpoint:1413,meltingpoint:973,periodTableBlock:"s",discoveryDate:"1898",period:"7",group:"2",electronicConfiguration:"Rn 7s2",family:"Alkaline_Earth",symbol:"Ra",name:"Radium",elementColor:[0,.49,0],discoveryCountry:["fr"],discoverers:["M. Sklodowska-Curie","P. Curie"]},{id:"Ac",atomicNumber:89,mass:227,exactMass:227.0277521,ionization:5.17,electronegativityPauling:1.1,nameOrigin:"Greek 'aktis' for 'beam' - actinium is radioactive",radiusVDW:2,boilingpoint:3470,meltingpoint:1324,periodTableBlock:"f",discoveryDate:"1899",period:"7",group:"3",electronicConfiguration:"Rn 6d1 7s2",family:"Other_Metal",symbol:"Ac",name:"Actinium",elementColor:[.44,.67,.98],discoveryCountry:["fr"],discoverers:["A.","L.","Debierne"]},{id:"Th",atomicNumber:90,mass:232.03806,exactMass:232.0380553,ionization:6.3067,electronegativityPauling:1.3,nameOrigin:"Named after the German god of thunder: Thor",radiusVDW:2.4,boilingpoint:5060,meltingpoint:2028,periodTableBlock:"f",discoveryDate:"1828",period:"7",group:"4",electronicConfiguration:"Rn 6d2 7s2",family:"Other_Metal",symbol:"Th",name:"Thorium",elementColor:[0,.73,1],discoverers:["J.","J.","Berzelius"]},{id:"Pa",atomicNumber:91,mass:231.03588,exactMass:231.035884,ionization:5.89,electronegativityPauling:1.5,nameOrigin:"Greek 'protos' for 'ancester'. Protactinium is before Actinium in the periodic table.",radiusVDW:2,boilingpoint:4300,meltingpoint:1845,periodTableBlock:"f",discoveryDate:"1917",period:"7",group:"5",electronicConfiguration:"Rn 5f2 6d1 7s2",family:"Other_Metal",symbol:"Pa",name:"Protactinium",elementColor:[0,.63,1],discoverers:["O. Hahn","L. Meitern","W. Wollaston"]},{id:"U",atomicNumber:92,mass:238.02891,exactMass:238.0507882,ionization:6.1941,electronegativityPauling:1.38,nameOrigin:"Greek 'ouranos' for 'heaven'. Named after the planet Uranus.",radiusVDW:2.3,boilingpoint:4407,meltingpoint:1408,periodTableBlock:"f",discoveryDate:"1789",period:"7",group:"6",electronicConfiguration:"Rn 5f3 6d1 7s2",family:"Other_Metal",symbol:"U",name:"Uranium",elementColor:[0,.56,1],discoverers:["M.","M.","Klaproth"]},{id:"Np",atomicNumber:93,mass:237,exactMass:237.0481734,ionization:6.2657,electronegativityPauling:1.36,nameOrigin:"Named after the planet Neptune.",radiusVDW:2,boilingpoint:4175,meltingpoint:912,periodTableBlock:"f",discoveryDate:"1940",period:"7",group:"7",electronicConfiguration:"Rn 5f4 6d1 7s2",family:"Other_Metal",symbol:"Np",name:"Neptunium",elementColor:[0,.5,1],discoverers:["E. M. McMillan","P. Aberson"]},{id:"Pu",atomicNumber:94,mass:244,exactMass:244.064204,ionization:6.026,electronegativityPauling:1.28,nameOrigin:"Named after the planet Pluto.",radiusVDW:2,boilingpoint:3505,meltingpoint:913,periodTableBlock:"f",discoveryDate:"1940",period:"7",group:"8",electronicConfiguration:"Rn 5f6 7s2",family:"Other_Metal",symbol:"Pu",name:"Plutonium",elementColor:[0,.42,1],discoverers:["Glenn T. Seaborg","E. M. McMillan","J. W. Kennedy","A.C. Wahl"]},{id:"Am",atomicNumber:95,mass:243,exactMass:243.0613811,ionization:5.9738,electronegativityPauling:1.3,nameOrigin:"Named after America.",radiusVDW:2,boilingpoint:2880,meltingpoint:1449,periodTableBlock:"f",discoveryDate:"1945",period:"7",group:"8",electronicConfiguration:"Rn 5f7 7s2",family:"Other_Metal",symbol:"Am",name:"Americium",elementColor:[.33,.36,.95],discoverers:["Glenn T. Seaborg","L. O. Morgan","R. A. James","A. Ghiors"]},{id:"Cm",atomicNumber:96,mass:247,exactMass:247.070354,ionization:5.9914,electronegativityPauling:1.3,nameOrigin:"Named after Marie Curie.",radiusVDW:2,boilingpoint:3383,meltingpoint:1620,periodTableBlock:"f",discoveryDate:"1944",period:"7",group:"8",electronicConfiguration:"Rn 5f7 6d1 7s2",family:"Other_Metal",symbol:"Cm",name:"Curium",elementColor:[.47,.36,.89],discoverers:["Glenn T. Seaborg","R. A. James","A. Ghiors"]},{id:"Bk",atomicNumber:97,mass:247,exactMass:247.070307,ionization:6.1979,electronegativityPauling:1.3,nameOrigin:"Named after the town Berkeley where it was discovered.",radiusVDW:2,boilingpoint:983,meltingpoint:1258,periodTableBlock:"f",discoveryDate:"1949",period:"7",group:"1",electronicConfiguration:"Rn 5f9 7s2",family:"Other_Metal",symbol:"Bk",name:"Berkelium",elementColor:[.54,.31,.89],discoverers:["Glenn T. Seaborg","A. Ghiors","S. G. Thompson"]},{id:"Cf",atomicNumber:98,mass:251,exactMass:251.079587,ionization:6.2817,electronegativityPauling:1.3,nameOrigin:"Named after the US-State of California.",radiusVDW:2,boilingpoint:1173,meltingpoint:1172,periodTableBlock:"f",discoveryDate:"1950",period:"7",group:"2",electronicConfiguration:"Rn 5f10 7s2",family:"Other_Metal",symbol:"Cf",name:"Californium",elementColor:[.63,.21,.83],discoverers:["Glenn T. Seaborg","A. Ghiors","S. G. Thompson"]},{id:"Es",atomicNumber:99,mass:252,exactMass:252.08298,ionization:6.42,electronegativityPauling:1.3,nameOrigin:"Named after the scientist Albert Einstein.",radiusVDW:2,meltingpoint:1130,periodTableBlock:"f",discoveryDate:"1952",period:"7",group:"3",electronicConfiguration:"Rn 5f11 7s2",family:"Other_Metal",symbol:"Es",name:"Einsteinium",elementColor:[.7,.12,.83],discoverers:["Glenn T. Seaborg","et al."]},{id:"Fm",atomicNumber:100,mass:257,exactMass:257.095105,ionization:6.5,electronegativityPauling:1.3,nameOrigin:"Named after the scientist Enrico Fermi.",radiusVDW:2,meltingpoint:1800,periodTableBlock:"f",discoveryDate:"1953",period:"7",group:"4",electronicConfiguration:"Rn 5f12 7s2",family:"Other_Metal",symbol:"Fm",name:"Fermium",elementColor:[.7,.12,.73],discoverers:["Glenn T. Seaborg","et al."]},{id:"Md",atomicNumber:101,mass:258,exactMass:258.098431,ionization:6.58,electronegativityPauling:1.3,nameOrigin:"Named after the scientist D.I. Mendeleev.",radiusVDW:2,meltingpoint:1100,periodTableBlock:"f",discoveryDate:"1955",period:"7",group:"5",electronicConfiguration:"Rn 5f13 7s2",family:"Other_Metal",symbol:"Md",name:"Mendelevium",elementColor:[.7,.05,.65],discoverers:["Glenn T. Seaborg","Albert Ghiorso","Bernard Harvey","Gregory Choppin","Stanley G. Thompson"]},{id:"No",atomicNumber:102,mass:259,exactMass:259.10103,ionization:6.65,electronegativityPauling:1.3,nameOrigin:"Named after the scientist Alfred Nobel.",radiusVDW:2,meltingpoint:1100,periodTableBlock:"f",discoveryDate:"1958",period:"7",group:"6",electronicConfiguration:"Rn 5f14 7s2",family:"Other_Metal",symbol:"No",name:"Nobelium",elementColor:[.74,.05,.53]},{id:"Lr",atomicNumber:103,mass:262,exactMass:262.10963,ionization:4.9,nameOrigin:"Named after the scientist Ernest Orlando Lawrence.",radiusVDW:2,meltingpoint:1900,periodTableBlock:"f",discoveryDate:"1961",period:"7",group:"7",electronicConfiguration:"Rn 5f14 7s2 7p1",family:"Other_Metal",symbol:"Lr",name:"Lawrencium",elementColor:[.78,0,.4],discoverers:["Albert Ghiorso","Torbjorn Sikkeland","Almon Larsh","Robert M. Latimer"]},{id:"Rf",atomicNumber:104,mass:267,exactMass:261.10877,ionization:6,nameOrigin:"Named after the scientist Ernest Rutherford",radiusVDW:2,periodTableBlock:"d",discoveryDate:"1964",period:"7",group:"4",electronicConfiguration:"Rn 5f14 6d2 7s2",family:"Transition",symbol:"Rf",name:"Rutherfordium",elementColor:[.8,0,.35],discoveryCountry:["ru","us"]},{id:"Db",atomicNumber:105,mass:268,exactMass:262.11408,nameOrigin:"Named after the science-town Dubna in Russia",radiusVDW:2,periodTableBlock:"d",discoveryDate:"1967",period:"7",group:"5",electronicConfiguration:"Rn 5f14 6d3 7s2",family:"Transition",symbol:"Db",name:"Dubnium",elementColor:[.82,0,.31],discoveryCountry:["ru","us"]},{id:"Sg",atomicNumber:106,mass:271,exactMass:263.11832,nameOrigin:"Named after the scientist G. Theodore Seaborg.",radiusVDW:2,periodTableBlock:"d",discoveryDate:"1974",period:"7",group:"6",family:"Transition",symbol:"Sg",name:"Seaborgium",elementColor:[.85,0,.27],discoveryCountry:["ru","us"],discoverers:["Albert Ghiorso","et al."]},{id:"Bh",atomicNumber:107,mass:272,exactMass:264.1246,nameOrigin:"Named after the scientist Niels Bohr.",radiusVDW:2,periodTableBlock:"d",discoveryDate:"1981",period:"7",group:"7",family:"Transition",symbol:"Bh",name:"Bohrium",elementColor:[.88,0,.22],discoveryCountry:["ru"],discoverers:["Peter Armbruster","Gottfried Münzenber","et al."]},{id:"Hs",atomicNumber:108,mass:270,exactMass:265.13009,nameOrigin:"Latin 'hassia' for the German county Hessen. In Hessen a lot elements have been discovered.",radiusVDW:2,periodTableBlock:"d",discoveryDate:"1984",period:"7",group:"8",family:"Transition",symbol:"Hs",name:"Hassium",elementColor:[.9,0,.18],discoveryCountry:["de"],discoverers:["Peter Armbruster","Gottfried Münzenber","et al."]},{id:"Mt",atomicNumber:109,mass:276,exactMass:268.13873,nameOrigin:"Named after the scientist Lise Meitner.",radiusVDW:2,periodTableBlock:"d",discoveryDate:"1982",period:"7",group:"8",family:"Transition",symbol:"Mt",name:"Meitnerium",elementColor:[.91,0,.15],discoveryCountry:["de"],discoverers:["Peter Armbruster","Gottfried Münzenber","et al."]},{id:"Ds",atomicNumber:110,mass:281,exactMass:271.14606,nameOrigin:"Named after the German city Darmstadt where many elements have been discovered.",periodTableBlock:"d",discoveryDate:"1994",period:"7",group:"8",family:"Transition",symbol:"Ds",name:"Darmstadtium",elementColor:[.92,0,.14],discoveryCountry:["de"],discoverers:["S. Hofmann","V. Ninov","F. P. Hessberger","P. Armbruster","H. Folger","G. Münzenberg","H. J. Schött","et al."]},{id:"Rg",atomicNumber:111,mass:280,exactMass:272.15362,nameOrigin:"Named after Wilhelm Conrad Röntgen.",periodTableBlock:"d",discoveryDate:"1994",period:"7",group:"1",family:"Transition",symbol:"Rg",name:"Roentgenium",elementColor:[.93,0,.13],discoveryCountry:["de"],discoverers:["S. Hofmann","V. Ninov","F. P. Hessberger","P. Armbruster","H. Folger","G. Münzenberg","et al."]},{id:"Cn",atomicNumber:112,mass:285,exactMass:285.17411,nameOrigin:"Historically known as eka-mercury. Ununbium is a temporary IUPAC systematic element name.",periodTableBlock:"d",discoveryDate:"1996",period:"7",family:"Transition",symbol:"Cn",name:"Copernicium",elementColor:[.94,0,.12],discoveryCountry:["de"],discoverers:["First","created","at","the","Gesellschaft","für","Schwerionenforschung"]},{id:"Uut",atomicNumber:113,mass:284,exactMass:284.17808,nameOrigin:"Historically known as eka-thallium. Ununtrium is a temporary IUPAC systematic element name.",periodTableBlock:"p",discoveryDate:"2003",period:"7",family:"Other_Metal",symbol:"Uut",name:"Ununtrium",elementColor:[.95,0,.11],discoveryCountry:["ru","us"],discoverers:["Russian scientists at Dubna (JINR)","American scientists at the Lawrence Livermore National Laboratory."]},{id:"Uuq",atomicNumber:114,mass:289,exactMass:289.18728,nameOrigin:"Historically known as eka-lead. Ununquadium is a temporary IUPAC systematic element name.",periodTableBlock:"p",discoveryDate:"1998",period:"7",family:"Other_Metal",symbol:"Uuq",name:"Ununquadium",elementColor:[.96,0,.1],discoveryCountry:["ru","us"],discoverers:["Joint","Institute","for","Nuclear","Research"]},{id:"Uup",atomicNumber:115,mass:288,exactMass:288.19249,nameOrigin:"Historically known as eka-bismuth. Ununpentium is a temporary IUPAC systematic element name.",periodTableBlock:"p",discoveryDate:"2004",period:"7",family:"Other_Metal",symbol:"Uup",name:"Ununpentium",elementColor:[.97,0,.09],discoveryCountry:["ru","us"],discoverers:["Russian scientists at Dubna (JINR)","American scientists at the Lawrence Livermore National Laboratory."]},{id:"Uuh",atomicNumber:116,mass:293,exactMass:292.19979,nameOrigin:"Historically known as eka-polonium. Ununhexium is a temporary IUPAC systematic element name.",periodTableBlock:"p",discoveryDate:"2000",period:"7",family:"Other_Metal",symbol:"Uuh",name:"Ununhexium",elementColor:[.98,0,.08],discoveryCountry:["ru"],discoverers:["Joint","Institute","for","Nuclear","Research"]},{id:"Uus",atomicNumber:117,nameOrigin:"Temporary symbol and name. Can also be referred to as eka-astatine.",periodTableBlock:"p",discoveryDate:"0",period:"7",family:"Halogen",symbol:"Uus",name:"Ununseptium",elementColor:[.99,0,.07]},{id:"Uuo",atomicNumber:118,mass:294,nameOrigin:"Historically known as eka-radon, eka-emanation before 1960. Ununoctium is a temporary IUPAC systematic element name.",periodTableBlock:"p",discoveryDate:"2002",period:"7",family:"Noblegas",symbol:"Uuo",name:"Ununoctium",elementColor:[1,0,.06],discoveryCountry:["ru","us"],discoverers:["Russian scientists at Dubna (JINR)","American scientists at the Lawrence Livermore National Laboratory."]}],BM={atoms:LM},kM=m.vtkErrorMacro,NM=m.vtkDebugMacro,mt={};BM.atoms.forEach(function(t){mt[t.atomicNumber]=t});function FM(t,e){var r=[],n=[],a=[],i=[];e.classHierarchy.push("vtkMoleculeToRepresentation");function s(o,u,c){var f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:e.bondRadius;n.push(c),n.push(g),a.push(u[0]),a.push(u[1]),a.push(u[2]),r.push(o[0]),r.push(o[1]),r.push(o[2]);for(var v=0;v<f.length;++v)i.push(f[v]*255)}t.requestData=function(o,u){var c=o[0];if(!c)return kM("Invalid or missing input"),1;var f=qt.newInstance(),g=qt.newInstance(),v=0,p=0,l=null,y=null,h=null,d=null;r.length=0,n.length=0,a.length=0,i.length=0,c.getAtoms()&&(c.getAtoms().coords!==void 0&&c.getAtoms().coords["3d"]!==void 0&&(l=c.getAtoms().coords["3d"],v=l.length/3),c.getAtoms().elements!==void 0&&c.getAtoms().elements.number!==void 0&&(y=c.getAtoms().elements.number)),c.getBonds()&&(c.getBonds().connections!==void 0&&c.getBonds().connections.index!==void 0&&(h=c.getBonds().connections.index,p=h.length/2),c.getBonds().order!==void 0&&(d=c.getBonds().order));var S=[],T=[],C=[],x=[],O=[],w=[];NM("Checking for bonds with tolerance ",e.tolerance);for(var E=0,V=0;V<v;V++)y&&(x.push(mt[y[V]][e.radiusType]),O.push(mt[y[V]].radiusCovalent),w.push(mt[y[V]].elementColor[0]),w.push(mt[y[V]].elementColor[1]),w.push(mt[y[V]].elementColor[2])),e.hideElements.indexOf(mt[y[V]].id)===-1&&(E=V*3,S.push(l[E]),S.push(l[E+1]),S.push(l[E+2]),x.length>0&&T.push(x[V]*e.atomicRadiusScaleFactor),w.length>0&&(E=V*3,C.push(w[E]*255),C.push(w[E+1]*255),C.push(w[E+2]*255)));if(!h){h=[],d=[];for(var D=0;D<v;D++)for(var M=D+1;M<v;M++){var L=O[D]+O[M]+e.tolerance,N=M*3,B=D*3,_=[l[N],l[N+1],l[N+2]];if(_[0]-=l[B],_[1]-=l[B+1],_[2]-=l[B+2],!(Math.abs(_[0])>L||Math.abs(_[1])>L||Math.abs(_[2])>L)){var A=L*L,W=_[0]*_[0]+_[1]*_[1]+_[2]*_[2];W<A&&W>.1&&(h.push(D),h.push(M),d.push(1))}}p=h.length/2}for(var z=0;z<p;z++){var R=h[z*2],b=h[z*2+1];if(!(e.hideElements.indexOf(mt[y[R]].id)!==-1||e.hideElements.indexOf(mt[y[b]].id)!==-1)){var F=b*3,G=R*3,U=[l[F],l[F+1],l[F+2]];U[0]-=l[G],U[1]-=l[G+1],U[2]-=l[G+2];var H=U[0]*U[0]+U[1]*U[1]+U[2]*U[2],j=(2+e.deltaBondFactor)*e.bondRadius,I=Math.min(x[R]*e.atomicRadiusScaleFactor,x[b]*e.atomicRadiusScaleFactor),re=(d[z]-1)*j+2*e.bondRadius;re>2*I*.6&&(e.bondRadius*=2*I*.6/re,j=(2+e.deltaBondFactor)*e.bondRadius);for(var ue=d[z]%2,Le=ue;Le<d[z]+ue;Le++){for(var le=(Math.floor(Le/2)*2+1-ue)*j/2,J=[U[0]/Math.sqrt(H),U[1]/Math.sqrt(H),U[2]/Math.sqrt(H)],te=[0,0,0],$=0;$<3;$++)if(!(Math.abs(J[$])<1e-6)){te[$]=-(J[($+2)%3]*J[($+2)%3]+J[($+1)%3]*J[($+1)%3])/J[$],te[($+1)%3]=J[($+1)%3],te[($+2)%3]=J[($+2)%3],Wr(te);break}le*=Math.pow(-1,Le%2);var Q=void 0;if(y&&y[R]!==y[b]&&w.length>0){var Z=Math.sqrt(H)/2;Q=[l[F]-Z*J[0]/2+le*te[0],l[F+1]-Z*J[1]/2+le*te[1],l[F+2]-Z*J[2]/2+le*te[2]],s(Q,J,Z,w.slice(F,F+3)),Q=[l[G]+Z*J[0]/2+le*te[0],l[G+1]+Z*J[1]/2+le*te[1],l[G+2]+Z*J[2]/2+le*te[2]],s(Q,J,Z,w.slice(G,G+3))}else{var K=Math.sqrt(H);Q=[l[F]-U[0]/2+le*te[0],l[F+1]-U[1]/2+le*te[1],l[F+2]-U[2]/2+le*te[2]],w.length>0?s(Q,J,K,w.slice(G,G+3)):s(Q,J,K)}}}}if(f.getPoints().setData(S,3),x){var De=ge.newInstance({numberOfComponents:1,values:T,name:t.getSphereScaleArrayName()});f.getPointData().addArray(De)}if(w.length>0){var et=ge.newInstance({numberOfComponents:3,values:Uint8Array.from(C),name:"colors"});f.getPointData().setScalars(et)}g.getPoints().setData(r,3);var kt=ge.newInstance({numberOfComponents:2,values:n,name:"stickScales"});g.getPointData().addArray(kt);var Ke=ge.newInstance({numberOfComponents:3,values:a,name:"orientation"});if(g.getPointData().addArray(Ke),w.length>0){var xt=ge.newInstance({numberOfComponents:3,values:Uint8Array.from(i),name:"colors"});g.getPointData().setScalars(xt)}return u[0]=f,u[1]=g,1}}var UM={sphereScaleArrayName:"radius",tolerance:.45,atomicRadiusScaleFactor:.3,bondRadius:.075,deltaBondFactor:.6,radiusType:"radiusVDW",hideElements:""};function Tp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,UM,r),m.obj(t,e),m.setGet(t,e,["atomicRadiusScaleFactor","bondRadius","deltaBondFactor","hideElements","radiusType","sphereScaleArrayName","tolerance"]),m.algo(t,e,1,2),FM(t,e)}var GM=m.newInstance(Tp,"vtkMoleculeToRepresentation"),PM={newInstance:GM,extend:Tp};window&&(window.p5=rf);const jM=(t,e)=>{const r=_s(null),n=_s(null),a=xp(),i=()=>{n.value&&n.value.remove()},s=()=>{i(),o()},o=()=>{r.value&&(n.value=new rf(function(u){t(u,r.value,e)},r.value))};return Op(()=>{mp(()=>a.viewStyle,Ws(s,100)),e!=null&&e.banResize||addEventListener("resize",Ws(s,100),!1)}),wp(()=>{i(),removeEventListener("resize",s,!1)}),Ep(()=>{o()}),{container:r,p5_instance:n,drop_instance:i,update:s}};export{AM as a,PM as b,HM as c,$M as d,Ar as e,Ua as f,PO as g,jM as u,zM as v};
